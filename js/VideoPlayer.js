new class{constructor(){this.initDom(),this.initVideo(),this.initVideoLinks(),this.initKeyboard(),this.initFooterScroll()}initDom(){this.container=document.body.appendChild(document.createElement("div")),this.frame=this.container.appendChild(document.createElement("div")),this.header=this.frame.appendChild(document.createElement("header")),this.video=this.frame.appendChild(document.createElement("video")),this.footer=this.frame.appendChild(document.createElement("footer")),this.page=document.querySelector("#page"),this.container.id="video-container",this.container.addEventListener("click",(e=>e.target===this.container&&this.deactivate()))}initVideo(){this.video.controls=this.video.autoplay=!0;const e=this.loadVolumeState();this.video.volume=e.volume,this.video.muted=e.muted,this.video.addEventListener("volumechange",(e=>this.saveVolumeState())),this.video.addEventListener("loadedmetadata",(e=>{this.video.removeAttribute("width"),this.video.removeAttribute("height"),this.frame.style.maxWidth=this.video.videoWidth+"px"}))}initVideoLinks(){document.querySelectorAll("[data-video]").forEach((e=>e.addEventListener("click",(t=>{"A"===t.target.tagName&&t.target!==e||(this.loadThumbs(e.getAttribute("data-video").split(",")),this.header.innerHTML=e.getAttribute("data-title"),"href"in e&&(this.header.innerHTML=`<a href="${e.href}">${this.header.innerHTML}</a>`),this.footer.firstChild.click(),t.stopPropagation(),t.preventDefault())}))))}initKeyboard(){document.addEventListener("keydown",(e=>"Escape"===e.key&&this.deactivate()))}initFooterScroll(){this.footer.addEventListener("mousemove",(e=>{const t=this.footer.getBoundingClientRect();this.footer.scroll({left:(this.footer.scrollWidth-t.width)*((e.clientX-t.x)/t.width*1.2-.1),behavior:"undefined"!=typeof InstallTrigger?"smooth":"auto"})}))}loadThumbs(e){for(;this.footer.lastChild;)this.footer.removeChild(this.footer.lastChild);for(let t=0;t<e.length;++t){const i=this.footer.appendChild(document.createElement("div"));i.setAttribute("data-index",t+1);const o=i.appendChild(document.createElement("img"));o.src=`https://cdn.cloudflare.steamstatic.com/steam/apps/${e[t]}/movie.184x123.jpg`,i.addEventListener("click",(a=>{this.play(e[t]),i.parentNode.querySelectorAll("img").forEach((e=>e.classList.remove("active"))),o.classList.add("active"),this.header.setAttribute("data-video-id",t+1),this.header.setAttribute("data-videos",e.length)}))}}loadVolumeState(){return localStorage.hasOwnProperty("video.volume")?JSON.parse(localStorage.getItem("video.volume")):{volume:.5,muted:!1}}saveVolumeState(){localStorage.setItem("video.volume",JSON.stringify({volume:this.video.volume,muted:this.video.muted}))}activate(){this.container.classList.add("active"),this.page.classList.add("video")}deactivate(){this.video.pause(),this.container.classList.remove("active"),this.page.classList.remove("video")}play(e){for(this.video.width=this.video.clientWidth,this.video.height=this.video.clientHeight;this.video.lastChild;)this.video.removeChild(this.video.lastChild);const t=this.video.appendChild(document.createElement("source"));t.src=`https://steamcdn-a.akamaihd.net/steam/apps/${e}/movie480.webm`,t.type="video/webm";const i=this.video.appendChild(document.createElement("source"));i.src=`https://steamcdn-a.akamaihd.net/steam/apps/${e}/movie480.mp4`,i.type="video/mp4",this.activate(),this.video.load()}};