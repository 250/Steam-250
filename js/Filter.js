new class{constructor(){this.form=document.querySelector(".ranking form"),this.filtersButton=this.form.previousElementSibling,this.checks=[...this.form.querySelectorAll("input[type=checkbox]")],this.initFilterForm(),this.loadState()}initFilterForm(){this.filtersButton.addEventListener("click",(t=>this.form.classList.toggle("open"))),this.form.parentElement.querySelector("form > button.ok").addEventListener("click",(t=>{this.saveState(),this.form.classList.remove("open"),t.preventDefault()})),this.form.parentElement.querySelector("form > button.cancel").addEventListener("click",(t=>{this.loadState(),this.form.classList.remove("open"),t.preventDefault()})),this.form.parentElement.querySelector("form > button.reset").addEventListener("click",(t=>{setTimeout((t=>this.filterApps()))})),this.checks.forEach((t=>t.addEventListener("change",(t=>this.filterApps()))))}filterApps(){const t=document.querySelectorAll(".ranking > div[id]"),e=this.checks.filter((t=>t.checked));let r=0;this.filtersButton.getAttribute("data-filtered")||e.length<this.checks.length?t.forEach((t=>{let s=e.some((e=>"vr"===e.name?!!t.querySelector(".platforms > .vive, .platforms > .rift, .platforms > .wmr, .platforms > .index"):!!t.querySelector(".platforms > ."+e.name)));t.classList.toggle("filtered",!s),s&&(t.classList.remove("primary","secondary"),t.classList.add(1&++r?"primary":"secondary"))})):r=t.length;const s=t.length-r;this.filtersButton.setAttribute("data-filtered",s?`[-${s}]`:"")}saveState(){let t={};return this.checks.forEach((e=>t[e.name]=e.checked)),localStorage.setItem("filter",JSON.stringify(t)),t}loadState(){let t;(t=this.validateState())||(t=this.saveState());for(const[e,r]of Object.entries(t))this.form[e].checked=r;this.filterApps()}validateState(){try{return JSON.parse(localStorage.getItem("filter"))}catch(t){return!1}}};