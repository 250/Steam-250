@import "func/icons";

nav {
  position: sticky;
  top: 0;
  z-index: 10;
  flex-shrink: 0;

  font-weight: 450;
  background: linear-gradient(180deg, #14161c 70%, #171a21);

  >ol {
    display: flex;
    max-width: 629px;
    height: 38px;
    margin: 0 auto;
    justify-content: space-between;

    color: #aab3ce;
    letter-spacing: -.01em;

    >li {
      @1: #d5dbed;
      @2: #aab6da;

      .sub-indent(@font-size) {
        // Gap (.6em) + width of icon (1.1em) scaled to rem.
        margin-left: calc(@font-size/16 * 1.7rem);
      }
      .grid-gap() {
        column-gap: 3.3ch;
      }
      .annumdar() {
        display: grid;
        grid-template-columns: repeat(5, min-content);
        gap: .1ex .7ch;
        float: right;

        font-size: 14px;
        text-align: center;

        >:last-child {
          grid-column: 1 / -1;
          text-align: right;
          margin-top: .2ex;
        }
      }

      display: flex;
      align-items: center;
      position: relative;
      padding: 0 1.3ch;
      align-content: center;

      cursor: pointer;
      border-radius: 3px;

      transition: color .3s .15s;

      &:before {
        content: '';
        display: inline-block;
        width: 15px;
        height: 15px;
        margin-right: .8ch;

        background: #9da0c5;

        transition: background-color .3s;
      }
      &:after {
        content: '';
        position: absolute;
        width: 0;
        height: 1px;
        bottom: 0;
        left: 50%;

        background: #e0c17d;

        transition: all .3s .15s;
      }
      &:hover {
        // Show active menu over any transitioning menu.
        z-index: 1;

        color: #cec3aa;

        transition-delay: 0s;

        &:after {
          width: 100%;
          left: 0;

          transition-delay: 0s;
        }

        >div {
          // Ostensibly 306.5.
          max-height: 320px;
          padding: 25px 23px 15px;

          transition-delay: 0s;
        }
      }

      &:nth-of-type(1) {
        &:before {
          #icons.cup();
        }
        &:hover:before {
          background: #c39a40;
        }
      }
      &:nth-of-type(2) {
        &:before {
          #icons.tags();
          width: 1.1em;

          rotate: 45deg;
          mask-repeat: no-repeat;
          mask-position: right;
        }
        &:after {
          background: #7ba7f2;
        }
        &:hover {
          color: #a4c5ff;

          &:before {
            background: #6294ea;;
          }
        }
      }
      &:nth-of-type(3) {
        &:before {
          #icons.discount();
        }
        &:after {
          background: #7de099;
        }
        &:hover {
          color: #aaceb4;

          &:before {
            background: #3bb05c;
          }
        }
      }
      &:nth-of-type(4) {
        &:before {
          #icons.dt7();
          margin-top: -.1em;
        }
        &:after {
          background: #98a1ff;
        }
        &:hover {
          color: #a6adff;

          &:before {
            background: #7680ec;
          }
        }
      }
      &:nth-of-type(5) {
        &:before {
          #icons.members();
        }
        &:hover:before {
          background: #c39b3a;
        }
        //> div:extend(nav > ol > li:hover > div) {}
      }
      &:nth-of-type(-n+3) > div {
        >div:nth-of-type(n+2) {
          // Divider.
          &:before {
            content: '';
            display: block;
            grid-column: 1 / -1;
            width: calc(100% + 12px);
            height: 1px;
            margin: 1.6ex -6px;

            background: #20252a;
          }
        }
      }

      >div {
        box-sizing: border-box;
        position: absolute;
        left: 50%;
        top: 38px;
        translate: -50%;
        max-height: 0;
        padding: 0 23px;
        overflow: hidden;

        cursor: auto;
        font-size: 17px;
        font-weight: 430;
        color: @1;
        background: #14191f;
        border-radius: 0 0 6px 6px;
        box-shadow: 0 1px 8px #17222f;

        transition: all .3s .15s;

        // Sibling or sub-links.
        >div > div {
          >a:first-child ~ a, >a.sub {
            color: @2;
            font-size: 15px;

            &:is(.sub) {
              .sub-indent(15);

              font-size: 14px;

              &:before {
                content: none;
              }
            }
          }
        }

        >div:first-of-type {
          display: grid;
          grid-template-columns: 1fr 1fr;
          align-items: start;
          .grid-gap();
        }

        a, a:visited {
          white-space: nowrap;

          color: inherit;

          &[class]:where(:not(.tag)) {
            display: flex;
            align-items: center;
            gap: .6em;

            &:before {
              content: '';
              width: 1.02em;
              aspect-ratio: 1;
              justify-self: center;

              mask: no-repeat right;
              background: #7680ec;
            }
          }

          &.cup:before {
            #icons.cup();
            background: #c39a40;
          }
          &.gem:before {
            #icons.gem();
            width: 1.1em;

            background: #41aaf0;
          }
          &.trend:before {
            #icons.trend();
            aspect-ratio: 5/7;

            background: #e66262;
            mask-position-y: top;
          }
          &.custom:before {
            #icons.custom();
            width: 1.1em;
          }
          &.pad:before {
            #icons.gamepad();
            width: 1.2em;
          }
          &.preview:before {
            #icons.preview();
            width: 1.1em;
          }
          &.bottom:before {
            #icons.bottom();
            width: .95em;
          }
          &.adult:before {
            #icons.adult();
            position: relative;
            left: .2ch;
            width: 1.1em;

            background: #d96bca;
          }
          &.review:before {
            #icons.review();
          }

          &.mac:before {
            #icons.mac();
          }
          &.linux:before {
            #icons.linux();
          }
          &.deck:before {
            #icons.deck();
          }
          &.vr:before {
            #icons.vr();
          }

          &.tags:before {
            #icons.tags();
            width: 1.1em;
            rotate: 45deg;

            background: #6294EA;
          }
          &.hier:before {
            #icons.hierarchy();
            aspect-ratio: 9/10;
          }

          &.discount:before {
            #icons.discount();
          }
          &.free:before {
            #icons.free();
          }
          &.price:before {
            #icons.price();
            width: 1.1em;
            aspect-ratio: 18/17;
          }

          &.dt7:before {
            #icons.dt7();
          }
          &.dt30:before {
            #icons.dt30();
          }
          &.dt90:before {
            #icons.dt90();
          }
          &.dt365:before {
            #icons.dt365();
          }

          &.join:before {
            #icons.join();
          }
          &.myrank:before {
            #icons.myrank();
            width: 1.1em;
            margin-left: -.1em;
          }
          &.members:before {
            #icons.user();
            width: .9em;
          }
          &.email:before {
            #icons.email();
          }
          &.about:before {
            #icons.info();
          }
          &.contrib:before {
            #icons.group();
          }

          &.discord:before {
            #icons.discord();
            width: 1.2em;
          }
          &.steam:before {
            #icons.steam();
          }
          &.patreon:before {
            #icons.patreon();
          }
          &.x:before {
            #icons.x();
            width: .9em;
            margin: 0 .15em;
          }
        }

        span {
          white-space: nowrap;

          color: #818797;

          &.middot {
            display: inline-block;
            width: .2em;
            height: $width;
            vertical-align: middle;

            background: #aab6da;
            border-radius: 9px;
          }
        }

        p {
          margin: 0;

          color: #aeb6cf;
          font-size: 13px;
          font-weight: normal;
          line-height: 1.3;
          text-align: left;

          i {
            font-style: italic;
          }
        }

        .micro.tier {
          margin-left: .5ch;

          font-size: 11px;
        }
      }

      // Rankings.
      &:nth-of-type(1) > div {
        display: grid;
        grid-template-columns: auto auto auto;
        .grid-gap();

        >div {
          display: grid;
          grid-template-columns: subgrid;
          grid-column: 1 / -1;

          // First row.
          &:nth-of-type(1) {
            white-space: nowrap;

            >div {
              // Fine adjustments.
              &:nth-of-type(2) > a {
                margin-bottom: -.05em;
              }
              &:nth-of-type(3) > a {
                margin: calc(5/7 / 2 * -.5em) 0;
              }

              >a:nth-of-type(1) {
                line-height: 1;
              }
              >a:nth-of-type(2) {
                .sub-indent(17);
              }
            }
          }

          // Second row.
          &:nth-of-type(2) {
            // Key links.
            >:nth-of-type(1) {
              display: grid;
              grid-template-columns: min-content 1fr;
              grid-auto-rows: min-content;
              gap: .6ex;

              >a {
                display: grid;
                grid-template-columns: subgrid;
                grid-column: 1 / -1;

                color: @1;
                font-size: 16px;
              }
            }

            // Lesser headings.
            >div:nth-of-type(n+2) > :first-child {
              margin-bottom: .1ex;

              font-size: 16px;
            }

            // Most reviewed.
            >div:nth-of-type(2) {
              >div {
                .annumdar();
                color: @2;
              }
            }

            // Platforms.
            >div:nth-of-type(3) {
              display: flex;
              flex-flow: column;

              >a:not(.sub) {
                color: inherit;
                font-size: 15px;
              }
            }
          }

          // Third row.
          &:nth-of-type(3) {
            font-size: 14px;

            >a {
              margin-top: .3ex;
            }
          }
        }
      }

      // Tags.
      &:nth-of-type(2) > div {
        width: 538px;

        p {
          .sub-indent(17);
        }

        // Tag list.
        >div:last-of-type {
          >ol.tags {
            gap: 1px;
            overflow: auto;
            max-height: 200px;
          }
        }
      }

      // Deals.
      &:nth-of-type(3) > div {
        display: grid;
        grid-template-columns: 1fr 1fr;
        .grid-gap();

        >div {
          display: grid;
          grid-template-columns: subgrid;
          grid-column: 1 / -1;

          &:first-of-type {
            >a:before {
              background: #3bb05c;
            }
          }

          &:last-of-type > div {
            display: flex;
            flex-flow: column;
            gap: .6ex;

            >a {
              color: @1;
              font-size: 16px;
            }
          }
        }
      }

      // Dates.
      &:nth-of-type(4) > div {
        display: grid;
        grid-template-columns: 1fr 1fr;
        .grid-gap();

        >div {
          &:first-of-type {
            display: flex;
            flex-flow: column;
            gap: .6ex;

            >a:before {
              position: relative;
              top: -2px;

              font-size: 16px;
            }
          }
          &:last-of-type > div {
            .annumdar();
            margin-top: 1ex;

            >a {
              color: @1;
              font-size: 14px;
            }
          }
        }
      }

      // Club 250.
      &:nth-of-type(5) > div {
        >div:nth-of-type(1) {
          display: grid;
          grid-template-columns: min-content min-content auto;
          margin: -25px -23px 15px;
          padding: 20px 22px 16px;

          border-radius: 5px;
          border: 1px solid #f5c03b80;
          background: linear-gradient(#313021, #2b2820);

          a {
            color: #e7bf60;

            &:before {
              background: #e7bf60;
            }
          }
          p {
            color: #c6bc9a;
          }

          &:before {
            content: '';
            width: 65px;
            aspect-ratio: 11/12;

            background: url('//s.steam250.com/img/club 250 logo x96.webp') 0/cover;
          }

          >div {
            display: flex;
            flex-flow: column;
            justify-content: center;
            height: 100%;

            &:last-of-type {
              gap: .6ex;

              >div {
                display: flex;
                align-items: end;
                gap: .5ch;
              }
            }
          }
        }

        >div:nth-of-type(2) {
          display: grid;
          grid-template-columns: 1fr auto;
          .grid-gap();

          >div:first-of-type {
            display: flex;
            flex-flow: column;
            gap: .6ex;

            >a {
              color: @1;
              font-size: 17px;

              &:last-of-type {
                margin-top: .1em;
                .sub-indent(17);

                font-size: 14px;
              }
            }
          }

          p {
            .sub-indent(17);
            min-width: 18em;
          }
        }

        // Footer.
        >div:nth-of-type(3) {
          display: grid;
          grid-template-columns: repeat(3, auto);
          margin: 15px -23px -15px;
          padding: 15px 23px;
          .grid-gap();
          row-gap: .8ex;

          font-size: 14px;
          background: #111519;

          >a:before {
            background: currentColor;
          }
        }
      }
    }
  }

  >div {
    display: none;
  }
}
