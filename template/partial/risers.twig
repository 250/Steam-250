{% import 'macro/steam.twig' as steam %}

{% macro game_link(game, rank_column) %}
{% set href =
    game.developer is defined ? steam.developer_url(game.developer)
        : game.publisher is defined ? steam.publisher_url(game.publisher)
        : steam.app_url(game.id)
%}
<span class="title">
    <a href="{{ href }}" {{ steam.video_attr(game.id, game.videos) }}>
        <img alt="Logo" src="https://steamcdn-a.akamaihd.net/steam/apps/{{ game.id }}/capsule_sm_120.jpg">
    </a>
    <a href="{{ href }}">
        {% if game.movement is defined %}
        {{ include('partial/movement.twig', {movement: game.movement}) }}
        {% endif %}
        {% if not rank_column %}
        {{ game.rank }}.
        {% endif %}
        <span>{{ game.developer is defined ? game.developer
            : game.publisher is defined ? game.publisher
            : game.name }}</span>
    </a>
</span>
{% endmacro %}

<div class="compact ranking">
    {% if title is defined %}
    <h2>{{ title }}</h2>
    {% endif %}
    <ol>
        {% for game in games %}
        <li>
            {% if rank_column is defined %}
            <a href="{{ base_url ?? '' }}#{{ game.rank }}" class="rank">{{ game.rank }}</a>
            {% endif %}
            {{ _self.game_link(game, rank_column is defined) }}
            {% if shadow is defined %}
            {{ _self.game_link(game, rank_column is defined) }}
            {% endif %}
        {% endfor %}
    </ol>
</div>
