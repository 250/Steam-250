/*! For license information please see 250.js.LICENSE.txt */
(()=>{var e={66:()=>{},89:()=>{},208:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});new(i(n(225)).default)},225:function(e){e.exports=function(){"use strict";function e(){return e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},e.apply(this,arguments)}var t="undefined"!=typeof window,n=t&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),i=t&&"IntersectionObserver"in window,r=t&&"classList"in document.createElement("p"),a=t&&window.devicePixelRatio>1,o={elements_selector:".lazy",container:n||t?document:null,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",data_bg_hidpi:"bg-hidpi",data_bg_multi:"bg-multi",data_bg_multi_hidpi:"bg-multi-hidpi",data_bg_set:"bg-set",data_poster:"poster",class_applied:"applied",class_loading:"loading",class_loaded:"loaded",class_error:"error",class_entered:"entered",class_exited:"exited",unobserve_completed:!0,unobserve_entered:!1,cancel_on_exit:!0,callback_enter:null,callback_exit:null,callback_applied:null,callback_loading:null,callback_loaded:null,callback_error:null,callback_finish:null,callback_cancel:null,use_native:!1,restore_on_error:!1},s=function(t){return e({},o,t)},u=function(e,t){var n,i="LazyLoad::Initialized",r=new e(t);try{n=new CustomEvent(i,{detail:{instance:r}})}catch(e){(n=document.createEvent("CustomEvent")).initCustomEvent(i,!1,!1,{instance:r})}window.dispatchEvent(n)},l="src",c="srcset",d="sizes",h="poster",f="llOriginalAttrs",p="data",g="loading",m="loaded",v="applied",y="error",b="native",w="data-",_="ll-status",S=function(e,t){return e.getAttribute(w+t)},T=function(e){return S(e,_)},x=function(e,t){return function(e,t,n){var i="data-ll-status";null!==n?e.setAttribute(i,n):e.removeAttribute(i)}(e,0,t)},k=function(e){return x(e,null)},A=function(e){return null===T(e)},E=function(e){return T(e)===b},I=[g,m,v,y],C=function(e,t,n,i){e&&"function"==typeof e&&(void 0===i?void 0===n?e(t):e(t,n):e(t,n,i))},M=function(e,t){""!==t&&(r?e.classList.add(t):e.className+=(e.className?" ":"")+t)},P=function(e,t){""!==t&&(r?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,""))},R=function(e){return e.llTempImage},D=function(e,t){if(t){var n=t._observer;n&&n.unobserve(e)}},L=function(e,t){e&&(e.loadingCount+=t)},N=function(e,t){e&&(e.toLoadCount=t)},O=function(e){for(var t,n=[],i=0;t=e.children[i];i+=1)"SOURCE"===t.tagName&&n.push(t);return n},j=function(e,t){var n=e.parentNode;n&&"PICTURE"===n.tagName&&O(n).forEach(t)},U=function(e,t){O(e).forEach(t)},F=[l],B=[l,h],H=[l,c,d],V=[p],q=function(e){return!!e[f]},G=function(e){return e[f]},z=function(e){return delete e[f]},$=function(e,t){if(!q(e)){var n={};t.forEach((function(t){n[t]=e.getAttribute(t)})),e[f]=n}},K=function(e,t){if(q(e)){var n=G(e);t.forEach((function(t){!function(e,t,n){n?e.setAttribute(t,n):e.removeAttribute(t)}(e,t,n[t])}))}},W=function(e,t,n){M(e,t.class_applied),x(e,v),n&&(t.unobserve_completed&&D(e,t),C(t.callback_applied,e,n))},X=function(e,t,n){M(e,t.class_loading),x(e,g),n&&(L(n,1),C(t.callback_loading,e,n))},Y=function(e,t,n){n&&e.setAttribute(t,n)},J=function(e,t){Y(e,d,S(e,t.data_sizes)),Y(e,c,S(e,t.data_srcset)),Y(e,l,S(e,t.data_src))},Q={IMG:function(e,t){j(e,(function(e){$(e,H),J(e,t)})),$(e,H),J(e,t)},IFRAME:function(e,t){$(e,F),Y(e,l,S(e,t.data_src))},VIDEO:function(e,t){U(e,(function(e){$(e,F),Y(e,l,S(e,t.data_src))})),$(e,B),Y(e,h,S(e,t.data_poster)),Y(e,l,S(e,t.data_src)),e.load()},OBJECT:function(e,t){$(e,V),Y(e,p,S(e,t.data_src))}},Z=["IMG","IFRAME","VIDEO","OBJECT"],ee=function(e,t){!t||function(e){return e.loadingCount>0}(t)||function(e){return e.toLoadCount>0}(t)||C(e.callback_finish,t)},te=function(e,t,n){e.addEventListener(t,n),e.llEvLisnrs[t]=n},ne=function(e,t,n){e.removeEventListener(t,n)},ie=function(e){return!!e.llEvLisnrs},re=function(e){if(ie(e)){var t=e.llEvLisnrs;for(var n in t){var i=t[n];ne(e,n,i)}delete e.llEvLisnrs}},ae=function(e,t,n){!function(e){delete e.llTempImage}(e),L(n,-1),function(e){e&&(e.toLoadCount-=1)}(n),P(e,t.class_loading),t.unobserve_completed&&D(e,n)},oe=function(e,t,n){var i=R(e)||e;ie(i)||function(e,t,n){ie(e)||(e.llEvLisnrs={});var i="VIDEO"===e.tagName?"loadeddata":"load";te(e,i,t),te(e,"error",n)}(i,(function(r){!function(e,t,n,i){var r=E(t);ae(t,n,i),M(t,n.class_loaded),x(t,m),C(n.callback_loaded,t,i),r||ee(n,i)}(0,e,t,n),re(i)}),(function(r){!function(e,t,n,i){var r=E(t);ae(t,n,i),M(t,n.class_error),x(t,y),C(n.callback_error,t,i),n.restore_on_error&&K(t,H),r||ee(n,i)}(0,e,t,n),re(i)}))},se=function(e,t,n){!function(e){return Z.indexOf(e.tagName)>-1}(e)?function(e,t,n){!function(e){e.llTempImage=document.createElement("IMG")}(e),oe(e,t,n),function(e){q(e)||(e[f]={backgroundImage:e.style.backgroundImage})}(e),function(e,t,n){var i=S(e,t.data_bg),r=S(e,t.data_bg_hidpi),o=a&&r?r:i;o&&(e.style.backgroundImage='url("'.concat(o,'")'),R(e).setAttribute(l,o),X(e,t,n))}(e,t,n),function(e,t,n){var i=S(e,t.data_bg_multi),r=S(e,t.data_bg_multi_hidpi),o=a&&r?r:i;o&&(e.style.backgroundImage=o,W(e,t,n))}(e,t,n),function(e,t,n){var i=S(e,t.data_bg_set);if(i){var r=i.split("|"),a=r.map((function(e){return"image-set(".concat(e,")")}));e.style.backgroundImage=a.join(),""===e.style.backgroundImage&&(a=r.map((function(e){return"-webkit-image-set(".concat(e,")")})),e.style.backgroundImage=a.join()),W(e,t,n)}}(e,t,n)}(e,t,n):function(e,t,n){oe(e,t,n),function(e,t,n){var i=Q[e.tagName];i&&(i(e,t),X(e,t,n))}(e,t,n)}(e,t,n)},ue=function(e){e.removeAttribute(l),e.removeAttribute(c),e.removeAttribute(d)},le=function(e){j(e,(function(e){K(e,H)})),K(e,H)},ce={IMG:le,IFRAME:function(e){K(e,F)},VIDEO:function(e){U(e,(function(e){K(e,F)})),K(e,B),e.load()},OBJECT:function(e){K(e,V)}},de=function(e,t){(function(e){var t=ce[e.tagName];t?t(e):function(e){if(q(e)){var t=G(e);e.style.backgroundImage=t.backgroundImage}}(e)})(e),function(e,t){A(e)||E(e)||(P(e,t.class_entered),P(e,t.class_exited),P(e,t.class_applied),P(e,t.class_loading),P(e,t.class_loaded),P(e,t.class_error))}(e,t),k(e),z(e)},he=["IMG","IFRAME","VIDEO"],fe=function(e){return e.use_native&&"loading"in HTMLImageElement.prototype},pe=function(e,t,n){e.forEach((function(e){return function(e){return e.isIntersecting||e.intersectionRatio>0}(e)?function(e,t,n,i){var r=function(e){return I.indexOf(T(e))>=0}(e);x(e,"entered"),M(e,n.class_entered),P(e,n.class_exited),function(e,t,n){t.unobserve_entered&&D(e,n)}(e,n,i),C(n.callback_enter,e,t,i),r||se(e,n,i)}(e.target,e,t,n):function(e,t,n,i){A(e)||(M(e,n.class_exited),function(e,t,n,i){n.cancel_on_exit&&function(e){return T(e)===g}(e)&&"IMG"===e.tagName&&(re(e),function(e){j(e,(function(e){ue(e)})),ue(e)}(e),le(e),P(e,n.class_loading),L(i,-1),k(e),C(n.callback_cancel,e,t,i))}(e,t,n,i),C(n.callback_exit,e,t,i))}(e.target,e,t,n)}))},ge=function(e){return Array.prototype.slice.call(e)},me=function(e){return e.container.querySelectorAll(e.elements_selector)},ve=function(e){return function(e){return T(e)===y}(e)},ye=function(e,t){return function(e){return ge(e).filter(A)}(e||me(t))},be=function(e,n){var r=s(e);this._settings=r,this.loadingCount=0,function(e,t){i&&!fe(e)&&(t._observer=new IntersectionObserver((function(n){pe(n,e,t)}),function(e){return{root:e.container===document?null:e.container,rootMargin:e.thresholds||e.threshold+"px"}}(e)))}(r,this),function(e,n){t&&(n._onlineHandler=function(){!function(e,t){var n;(n=me(e),ge(n).filter(ve)).forEach((function(t){P(t,e.class_error),k(t)})),t.update()}(e,n)},window.addEventListener("online",n._onlineHandler))}(r,this),this.update(n)};return be.prototype={update:function(e){var t,r,a=this._settings,o=ye(e,a);N(this,o.length),!n&&i?fe(a)?function(e,t,n){e.forEach((function(e){-1!==he.indexOf(e.tagName)&&function(e,t,n){e.setAttribute("loading","lazy"),oe(e,t,n),function(e,t){var n=Q[e.tagName];n&&n(e,t)}(e,t),x(e,b)}(e,t,n)})),N(n,0)}(o,a,this):(r=o,function(e){e.disconnect()}(t=this._observer),function(e,t){t.forEach((function(t){e.observe(t)}))}(t,r)):this.loadAll(o)},destroy:function(){this._observer&&this._observer.disconnect(),t&&window.removeEventListener("online",this._onlineHandler),me(this._settings).forEach((function(e){z(e)})),delete this._observer,delete this._settings,delete this._onlineHandler,delete this.loadingCount,delete this.toLoadCount},loadAll:function(e){var t=this,n=this._settings;ye(e,n).forEach((function(e){D(e,t),se(e,n,t)}))},restoreAll:function(){var e=this._settings;me(e).forEach((function(t){de(t,e)}))}},be.load=function(e,t){var n=s(t);se(e,n)},be.resetStatus=function(e){k(e)},t&&function(e,t){if(t)if(t.length)for(var n,i=0;n=t[i];i+=1)u(e,n);else u(e,t)}(be,window.lazyLoadOptions),be}()},226:function(e,t,n){"use strict";var i,r=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(i=function(e){return i=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},i(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=i(e),o=0;o<n.length;o++)"default"!==n[o]&&r(t,e,n[o]);return a(t,e),t}),s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{u(i.next(e))}catch(e){a(e)}}function s(e){try{u(i.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),new class{constructor(){!1!==this.initDom()&&(this.initVideo(),this.initVideoLinks(),this.initKeyboard(),this.initFooterScroll())}initDom(){if(!document.body)return console.debug("Video player aborted: body not ready."),!1;this.container=document.body.appendChild(document.createElement("div")),this.frame=this.container.appendChild(document.createElement("div")),this.header=this.frame.appendChild(document.createElement("header")),this.video=this.frame.appendChild(document.createElement("video")),this.footer=this.frame.appendChild(document.createElement("footer")),this.page=document.querySelector("#page"),this.container.id="video-container",this.container.addEventListener("click",(e=>e.target===this.container&&this.deactivate()))}initVideo(){this.video.controls=this.video.autoplay=!0;const e=this.loadVolumeState();this.video.volume=e.volume,this.video.muted=e.muted,this.video.addEventListener("volumechange",(e=>this.saveVolumeState())),this.video.addEventListener("resize",(e=>{this.video.removeAttribute("width"),this.video.removeAttribute("height"),this.frame.style.maxWidth=this.video.videoWidth+"px"}))}initVideoLinks(){document.querySelectorAll("[data-video]").forEach((e=>e.addEventListener("click",(t=>{t.target instanceof HTMLAnchorElement&&t.target!==e||(this.loadThumbs(("href"in e?e.href:location.pathname).match(/\/app\/(\d+)/)[1],e.getAttribute("data-video").split(","),e.getAttribute("data-hx").split(",")),this.header.innerHTML=e.getAttribute("data-title"),"href"in e&&(this.header.innerHTML=`<a href="${e.href}">${this.header.innerHTML}</a>`),this.footer.firstChild.dispatchEvent(new Event("click")),t.stopPropagation(),t.preventDefault())}))))}initKeyboard(){document.addEventListener("keydown",(e=>"Escape"===e.key&&this.deactivate()))}initFooterScroll(){this.footer.addEventListener("mousemove",(e=>{const t=this.footer.getBoundingClientRect();this.footer.scroll({left:(this.footer.scrollWidth-t.width)*((e.clientX-t.x)/t.width*1.2-.1),behavior:"InstallTrigger"in window?"smooth":"auto"})}))}loadThumbs(e,t,n){for(;this.footer.lastChild;)this.footer.removeChild(this.footer.lastChild);for(let i=0;i<t.length;++i){const r=this.footer.appendChild(document.createElement("div"));r.setAttribute("data-index",String(i+1));let a=t[i],o="";a.length>40&&(o=a.substring(0,40),a=a.substring(40));const s=r.appendChild(document.createElement("img"));s.src=`https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/${a}/${o}/`+(o?"movie_232x130.jpg":"movie.184x123.jpg"),r.addEventListener("click",(a=>{this.play(e,n[i]),r.parentNode.querySelectorAll("img").forEach((e=>e.classList.remove("active"))),s.classList.add("active"),this.header.setAttribute("data-video-id",String(i+1)),this.header.setAttribute("data-videos",t.length.toString())}))}}loadVolumeState(){return localStorage.hasOwnProperty("video.volume")?JSON.parse(localStorage.getItem("video.volume")):{volume:.5,muted:!1}}saveVolumeState(){localStorage.setItem("video.volume",JSON.stringify({volume:this.video.volume,muted:this.video.muted}))}activate(){this.container.classList.add("active"),this.page.classList.add("video")}deactivate(){this.video.pause(),this.container.classList.remove("active"),this.page.classList.remove("video")}play(e,t){return s(this,void 0,void 0,(function*(){this.shaka||(this.shaka=yield Promise.resolve().then((()=>o(n(552)))));const i=this.player||(this.player=new this.shaka.Player);yield i.attach(this.video),i.configure("abr.restrictToScreenSize",!0),i.configure("abr.defaultBandwidthEstimate",1/0),i.addEventListener("adaptation",(e=>this.header.dataset.res=e.newTrack.height+"p")),this.video.width=this.video.clientWidth,this.video.height=this.video.clientHeight,yield this.loadCompatibleMedia(i,e,t),this.activate()}))}loadCompatibleMedia(e,t,n){return s(this,void 0,void 0,(function*(){const i=`https://video.akamai.steamstatic.com/store_trailers/${t}/${n}`;return MediaSource.isTypeSupported('video/mp4; codecs="av01.0.09M.08"')?yield e.load(`${i}/dash_av1.mpd`):MediaSource.isTypeSupported('video/mp4; codecs="avc1.640029"')?yield e.load(`${i}/dash_h264.mpd`):yield e.load(`${i}/hls_264_master.m3u8`)}))}}},228:function(e){e.exports=function(){"use strict";function e(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),c(d(t,e),n)}function t(t){t._clipped=!1,t._unclipped=t.slice(0);for(var n=0;n<=3;n++)n<3?((t[n]<0||t[n]>255)&&(t._clipped=!0),t[n]=e(t[n],0,255)):3===n&&(t[n]=e(t[n],0,1));return t}for(var n={},i=0,r=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];i<r.length;i+=1){var a=r[i];n["[object "+a+"]"]=a.toLowerCase()}function o(e){return n[Object.prototype.toString.call(e)]||"object"}function s(e,t){return void 0===t&&(t=null),e.length>=3?Array.prototype.slice.call(e):"object"==o(e[0])&&t?t.split("").filter((function(t){return void 0!==e[0][t]})).map((function(t){return e[0][t]})):e[0]}function u(e){if(e.length<2)return null;var t=e.length-1;return"string"==o(e[t])?e[t].toLowerCase():null}var l=Math.PI,c=Math.min,d=Math.max,h=2*l,f=l/3,p=l/180,g=180/l,m={format:{},autodetect:[]},v=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var i=this;if("object"===o(e[0])&&e[0].constructor&&e[0].constructor===this.constructor)return e[0];var r=u(e),a=!1;if(!r){a=!0,m.sorted||(m.autodetect=m.autodetect.sort((function(e,t){return t.p-e.p})),m.sorted=!0);for(var s=0,l=m.autodetect;s<l.length;s+=1){var c=l[s];if(r=c.test.apply(c,e))break}}if(!m.format[r])throw new Error("unknown format: "+e);var d=m.format[r].apply(null,a?e:e.slice(0,-1));i._rgb=t(d),3===i._rgb.length&&i._rgb.push(1)};v.prototype.toString=function(){return"function"==o(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var y="2.6.0",b=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(b.Color,[null].concat(e)))};b.Color=v,b.version=y;var w=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=s(e,"cmyk"))[0],i=e[1],r=e[2],a=e[3],o=e.length>4?e[4]:1;return 1===a?[0,0,0,o]:[n>=1?0:255*(1-n)*(1-a),i>=1?0:255*(1-i)*(1-a),r>=1?0:255*(1-r)*(1-a),o]},_=Math.max,S=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"rgb"),i=n[0],r=n[1],a=n[2],o=1-_(i/=255,_(r/=255,a/=255)),u=o<1?1/(1-o):0;return[(1-i-o)*u,(1-r-o)*u,(1-a-o)*u,o]};v.prototype.cmyk=function(){return S(this._rgb)},b.cmyk=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["cmyk"])))},m.format.cmyk=w,m.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===o(e=s(e,"cmyk"))&&4===e.length)return"cmyk"}});var T=function(e){return Math.round(100*e)/100},x=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"hsla"),i=u(e)||"lsa";return n[0]=T(n[0]||0),n[1]=T(100*n[1])+"%",n[2]=T(100*n[2])+"%","hsla"===i||n.length>3&&n[3]<1?(n[3]=n.length>3?n[3]:1,i="hsla"):n.length=3,i+"("+n.join(",")+")"},k=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,i,r=(e=s(e,"rgba"))[0],a=e[1],o=e[2],u=c(r/=255,a/=255,o/=255),l=d(r,a,o),h=(l+u)/2;return l===u?(n=0,i=Number.NaN):n=h<.5?(l-u)/(l+u):(l-u)/(2-l-u),r==l?i=(a-o)/(l-u):a==l?i=2+(o-r)/(l-u):o==l&&(i=4+(r-a)/(l-u)),(i*=60)<0&&(i+=360),e.length>3&&void 0!==e[3]?[i,n,h,e[3]]:[i,n,h]},A=Math.round,E=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"rgba"),i=u(e)||"rgb";return"hsl"==i.substr(0,3)?x(k(n),i):(n[0]=A(n[0]),n[1]=A(n[1]),n[2]=A(n[2]),("rgba"===i||n.length>3&&n[3]<1)&&(n[3]=n.length>3?n[3]:1,i="rgba"),i+"("+n.slice(0,"rgb"===i?3:4).join(",")+")")},I=Math.round,C=function(){for(var e,t=[],n=arguments.length;n--;)t[n]=arguments[n];var i,r,a,o=(t=s(t,"hsl"))[0],u=t[1],l=t[2];if(0===u)i=r=a=255*l;else{var c=[0,0,0],d=[0,0,0],h=l<.5?l*(1+u):l+u-l*u,f=2*l-h,p=o/360;c[0]=p+1/3,c[1]=p,c[2]=p-1/3;for(var g=0;g<3;g++)c[g]<0&&(c[g]+=1),c[g]>1&&(c[g]-=1),6*c[g]<1?d[g]=f+6*(h-f)*c[g]:2*c[g]<1?d[g]=h:3*c[g]<2?d[g]=f+(h-f)*(2/3-c[g])*6:d[g]=f;i=(e=[I(255*d[0]),I(255*d[1]),I(255*d[2])])[0],r=e[1],a=e[2]}return t.length>3?[i,r,a,t[3]]:[i,r,a,1]},M=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,P=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,R=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,D=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,L=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,N=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,O=Math.round,j=function(e){var t;if(e=e.toLowerCase().trim(),m.format.named)try{return m.format.named(e)}catch(e){}if(t=e.match(M)){for(var n=t.slice(1,4),i=0;i<3;i++)n[i]=+n[i];return n[3]=1,n}if(t=e.match(P)){for(var r=t.slice(1,5),a=0;a<4;a++)r[a]=+r[a];return r}if(t=e.match(R)){for(var o=t.slice(1,4),s=0;s<3;s++)o[s]=O(2.55*o[s]);return o[3]=1,o}if(t=e.match(D)){for(var u=t.slice(1,5),l=0;l<3;l++)u[l]=O(2.55*u[l]);return u[3]=+u[3],u}if(t=e.match(L)){var c=t.slice(1,4);c[1]*=.01,c[2]*=.01;var d=C(c);return d[3]=1,d}if(t=e.match(N)){var h=t.slice(1,4);h[1]*=.01,h[2]*=.01;var f=C(h);return f[3]=+t[4],f}};j.test=function(e){return M.test(e)||P.test(e)||R.test(e)||D.test(e)||L.test(e)||N.test(e)},v.prototype.css=function(e){return E(this._rgb,e)},b.css=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["css"])))},m.format.css=j,m.autodetect.push({p:5,test:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(!t.length&&"string"===o(e)&&j.test(e))return"css"}}),m.format.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"rgba");return n[0]*=255,n[1]*=255,n[2]*=255,n},b.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["gl"])))},v.prototype.gl=function(){var e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]};var U=Math.floor,F=function(){for(var e,t,n,i,r,a,o=[],u=arguments.length;u--;)o[u]=arguments[u];var l,c,d,h=(o=s(o,"hcg"))[0],f=o[1],p=o[2];p*=255;var g=255*f;if(0===f)l=c=d=p;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var m=U(h/=60),v=h-m,y=p*(1-f),b=y+g*(1-v),w=y+g*v,_=y+g;switch(m){case 0:l=(e=[_,w,y])[0],c=e[1],d=e[2];break;case 1:l=(t=[b,_,y])[0],c=t[1],d=t[2];break;case 2:l=(n=[y,_,w])[0],c=n[1],d=n[2];break;case 3:l=(i=[y,b,_])[0],c=i[1],d=i[2];break;case 4:l=(r=[w,y,_])[0],c=r[1],d=r[2];break;case 5:l=(a=[_,y,b])[0],c=a[1],d=a[2]}}return[l,c,d,o.length>3?o[3]:1]},B=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,i=s(e,"rgb"),r=i[0],a=i[1],o=i[2],u=c(r,a,o),l=d(r,a,o),h=l-u,f=100*h/255,p=u/(255-h)*100;return 0===h?n=Number.NaN:(r===l&&(n=(a-o)/h),a===l&&(n=2+(o-r)/h),o===l&&(n=4+(r-a)/h),(n*=60)<0&&(n+=360)),[n,f,p]};v.prototype.hcg=function(){return B(this._rgb)},b.hcg=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["hcg"])))},m.format.hcg=F,m.autodetect.push({p:1,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===o(e=s(e,"hcg"))&&3===e.length)return"hcg"}});var H=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,V=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,q=function(e){if(e.match(H)){4!==e.length&&7!==e.length||(e=e.substr(1)),3===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t=parseInt(e,16);return[t>>16,t>>8&255,255&t,1]}if(e.match(V)){5!==e.length&&9!==e.length||(e=e.substr(1)),4===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);var n=parseInt(e,16);return[n>>24&255,n>>16&255,n>>8&255,Math.round((255&n)/255*100)/100]}throw new Error("unknown hex color: "+e)},G=Math.round,z=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"rgba"),i=n[0],r=n[1],a=n[2],o=n[3],l=u(e)||"auto";void 0===o&&(o=1),"auto"===l&&(l=o<1?"rgba":"rgb");var c="000000"+((i=G(i))<<16|(r=G(r))<<8|(a=G(a))).toString(16);c=c.substr(c.length-6);var d="0"+G(255*o).toString(16);switch(d=d.substr(d.length-2),l.toLowerCase()){case"rgba":return"#"+c+d;case"argb":return"#"+d+c;default:return"#"+c}};v.prototype.hex=function(e){return z(this._rgb,e)},b.hex=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["hex"])))},m.format.hex=q,m.autodetect.push({p:4,test:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(!t.length&&"string"===o(e)&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}});var $=Math.cos,K=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var i,r,a,o=(t=s(t,"hsi"))[0],u=t[1],l=t[2];return isNaN(o)&&(o=0),isNaN(u)&&(u=0),o>360&&(o-=360),o<0&&(o+=360),(o/=360)<1/3?r=1-((a=(1-u)/3)+(i=(1+u*$(h*o)/$(f-h*o))/3)):o<2/3?a=1-((i=(1-u)/3)+(r=(1+u*$(h*(o-=1/3))/$(f-h*o))/3)):i=1-((r=(1-u)/3)+(a=(1+u*$(h*(o-=2/3))/$(f-h*o))/3)),[255*(i=e(l*i*3)),255*(r=e(l*r*3)),255*(a=e(l*a*3)),t.length>3?t[3]:1]},W=Math.min,X=Math.sqrt,Y=Math.acos,J=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,i=s(e,"rgb"),r=i[0],a=i[1],o=i[2],u=W(r/=255,a/=255,o/=255),l=(r+a+o)/3,c=l>0?1-u/l:0;return 0===c?n=NaN:(n=(r-a+(r-o))/2,n/=X((r-a)*(r-a)+(r-o)*(a-o)),n=Y(n),o>a&&(n=h-n),n/=h),[360*n,c,l]};v.prototype.hsi=function(){return J(this._rgb)},b.hsi=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["hsi"])))},m.format.hsi=K,m.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===o(e=s(e,"hsi"))&&3===e.length)return"hsi"}}),v.prototype.hsl=function(){return k(this._rgb)},b.hsl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["hsl"])))},m.format.hsl=C,m.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===o(e=s(e,"hsl"))&&3===e.length)return"hsl"}});var Q=Math.floor,Z=function(){for(var e,t,n,i,r,a,o=[],u=arguments.length;u--;)o[u]=arguments[u];var l,c,d,h=(o=s(o,"hsv"))[0],f=o[1],p=o[2];if(p*=255,0===f)l=c=d=p;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var g=Q(h/=60),m=h-g,v=p*(1-f),y=p*(1-f*m),b=p*(1-f*(1-m));switch(g){case 0:l=(e=[p,b,v])[0],c=e[1],d=e[2];break;case 1:l=(t=[y,p,v])[0],c=t[1],d=t[2];break;case 2:l=(n=[v,p,b])[0],c=n[1],d=n[2];break;case 3:l=(i=[v,y,p])[0],c=i[1],d=i[2];break;case 4:l=(r=[b,v,p])[0],c=r[1],d=r[2];break;case 5:l=(a=[p,v,y])[0],c=a[1],d=a[2]}}return[l,c,d,o.length>3?o[3]:1]},ee=Math.min,te=Math.max,ne=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,i,r,a=(e=s(e,"rgb"))[0],o=e[1],u=e[2],l=ee(a,o,u),c=te(a,o,u),d=c-l;return r=c/255,0===c?(n=Number.NaN,i=0):(i=d/c,a===c&&(n=(o-u)/d),o===c&&(n=2+(u-a)/d),u===c&&(n=4+(a-o)/d),(n*=60)<0&&(n+=360)),[n,i,r]};v.prototype.hsv=function(){return ne(this._rgb)},b.hsv=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["hsv"])))},m.format.hsv=Z,m.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===o(e=s(e,"hsv"))&&3===e.length)return"hsv"}});var ie={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},re=Math.pow,ae=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,i,r,a=(e=s(e,"lab"))[0],o=e[1],u=e[2];return i=(a+16)/116,n=isNaN(o)?i:i+o/500,r=isNaN(u)?i:i-u/200,i=ie.Yn*se(i),n=ie.Xn*se(n),r=ie.Zn*se(r),[oe(3.2404542*n-1.5371385*i-.4985314*r),oe(-.969266*n+1.8760108*i+.041556*r),oe(.0556434*n-.2040259*i+1.0572252*r),e.length>3?e[3]:1]},oe=function(e){return 255*(e<=.00304?12.92*e:1.055*re(e,1/2.4)-.055)},se=function(e){return e>ie.t1?e*e*e:ie.t2*(e-ie.t0)},ue=Math.pow,le=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"rgb"),i=n[0],r=n[1],a=n[2],o=he(i,r,a),u=o[0],l=o[1],c=116*l-16;return[c<0?0:c,500*(u-l),200*(l-o[2])]},ce=function(e){return(e/=255)<=.04045?e/12.92:ue((e+.055)/1.055,2.4)},de=function(e){return e>ie.t3?ue(e,1/3):e/ie.t2+ie.t0},he=function(e,t,n){return e=ce(e),t=ce(t),n=ce(n),[de((.4124564*e+.3575761*t+.1804375*n)/ie.Xn),de((.2126729*e+.7151522*t+.072175*n)/ie.Yn),de((.0193339*e+.119192*t+.9503041*n)/ie.Zn)]};v.prototype.lab=function(){return le(this._rgb)},b.lab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["lab"])))},m.format.lab=ae,m.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===o(e=s(e,"lab"))&&3===e.length)return"lab"}});var fe=Math.sin,pe=Math.cos,ge=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"lch"),i=n[0],r=n[1],a=n[2];return isNaN(a)&&(a=0),[i,pe(a*=p)*r,fe(a)*r]},me=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=s(e,"lch"))[0],i=e[1],r=e[2],a=ge(n,i,r),o=a[0],u=a[1],l=a[2],c=ae(o,u,l);return[c[0],c[1],c[2],e.length>3?e[3]:1]},ve=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"hcl").reverse();return me.apply(void 0,n)},ye=Math.sqrt,be=Math.atan2,we=Math.round,_e=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"lab"),i=n[0],r=n[1],a=n[2],o=ye(r*r+a*a),u=(be(a,r)*g+360)%360;return 0===we(1e4*o)&&(u=Number.NaN),[i,o,u]},Se=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"rgb"),i=n[0],r=n[1],a=n[2],o=le(i,r,a),u=o[0],l=o[1],c=o[2];return _e(u,l,c)};v.prototype.lch=function(){return Se(this._rgb)},v.prototype.hcl=function(){return Se(this._rgb).reverse()},b.lch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["lch"])))},b.hcl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["hcl"])))},m.format.lch=me,m.format.hcl=ve,["lch","hcl"].forEach((function(e){return m.autodetect.push({p:2,test:function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];if("array"===o(t=s(t,e))&&3===t.length)return e}})}));var Te={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};v.prototype.name=function(){for(var e=z(this._rgb,"rgb"),t=0,n=Object.keys(Te);t<n.length;t+=1){var i=n[t];if(Te[i]===e)return i.toLowerCase()}return e},m.format.named=function(e){if(e=e.toLowerCase(),Te[e])return q(Te[e]);throw new Error("unknown color name: "+e)},m.autodetect.push({p:5,test:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(!t.length&&"string"===o(e)&&Te[e.toLowerCase()])return"named"}});var xe=function(e){if("number"==o(e)&&e>=0&&e<=16777215)return[e>>16,e>>8&255,255&e,1];throw new Error("unknown num color: "+e)},ke=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"rgb");return(n[0]<<16)+(n[1]<<8)+n[2]};v.prototype.num=function(){return ke(this._rgb)},b.num=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["num"])))},m.format.num=xe,m.autodetect.push({p:5,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(1===e.length&&"number"===o(e[0])&&e[0]>=0&&e[0]<=16777215)return"num"}});var Ae=Math.round;v.prototype.rgb=function(e){return void 0===e&&(e=!0),!1===e?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Ae)},v.prototype.rgba=function(e){return void 0===e&&(e=!0),this._rgb.slice(0,4).map((function(t,n){return n<3?!1===e?t:Ae(t):t}))},b.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["rgb"])))},m.format.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"rgba");return void 0===n[3]&&(n[3]=1),n},m.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===o(e=s(e,"rgba"))&&(3===e.length||4===e.length&&"number"==o(e[3])&&e[3]>=0&&e[3]<=1))return"rgb"}});var Ee=Math.log,Ie=function(e){var t,n,i,r=e/100;return r<66?(t=255,n=r<6?0:-155.25485562709179-.44596950469579133*(n=r-2)+104.49216199393888*Ee(n),i=r<20?0:.8274096064007395*(i=r-10)-254.76935184120902+115.67994401066147*Ee(i)):(t=351.97690566805693+.114206453784165*(t=r-55)-40.25366309332127*Ee(t),n=325.4494125711974+.07943456536662342*(n=r-50)-28.0852963507957*Ee(n),i=255),[t,n,i,1]},Ce=Math.round,Me=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var n,i=s(e,"rgb"),r=i[0],a=i[2],o=1e3,u=4e4,l=.4;u-o>l;){var c=Ie(n=.5*(u+o));c[2]/c[0]>=a/r?u=n:o=n}return Ce(n)};v.prototype.temp=v.prototype.kelvin=v.prototype.temperature=function(){return Me(this._rgb)},b.temp=b.kelvin=b.temperature=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["temp"])))},m.format.temp=m.format.kelvin=m.format.temperature=Ie;var Pe=Math.pow,Re=Math.sign,De=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=s(e,"lab"))[0],i=e[1],r=e[2],a=Pe(n+.3963377774*i+.2158037573*r,3),o=Pe(n-.1055613458*i-.0638541728*r,3),u=Pe(n-.0894841775*i-1.291485548*r,3);return[255*Le(4.0767416621*a-3.3077115913*o+.2309699292*u),255*Le(-1.2684380046*a+2.6097574011*o-.3413193965*u),255*Le(-.0041960863*a-.7034186147*o+1.707614701*u),e.length>3?e[3]:1]};function Le(e){var t=Math.abs(e);return t>.0031308?(Re(e)||1)*(1.055*Pe(t,1/2.4)-.055):12.92*e}var Ne=Math.cbrt,Oe=Math.pow,je=Math.sign,Ue=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"rgb"),i=n[0],r=n[1],a=n[2],o=[Fe(i/255),Fe(r/255),Fe(a/255)],u=o[0],l=o[1],c=o[2],d=Ne(.4122214708*u+.5363325363*l+.0514459929*c),h=Ne(.2119034982*u+.6806995451*l+.1073969566*c),f=Ne(.0883024619*u+.2817188376*l+.6299787005*c);return[.2104542553*d+.793617785*h-.0040720468*f,1.9779984951*d-2.428592205*h+.4505937099*f,.0259040371*d+.7827717662*h-.808675766*f]};function Fe(e){var t=Math.abs(e);return t<.04045?e/12.92:(je(e)||1)*Oe((t+.055)/1.055,2.4)}v.prototype.oklab=function(){return Ue(this._rgb)},b.oklab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["oklab"])))},m.format.oklab=De,m.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===o(e=s(e,"oklab"))&&3===e.length)return"oklab"}});var Be=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=s(e,"lch"))[0],i=e[1],r=e[2],a=ge(n,i,r),o=a[0],u=a[1],l=a[2],c=De(o,u,l);return[c[0],c[1],c[2],e.length>3?e[3]:1]},He=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s(e,"rgb"),i=n[0],r=n[1],a=n[2],o=Ue(i,r,a),u=o[0],l=o[1],c=o[2];return _e(u,l,c)};v.prototype.oklch=function(){return He(this._rgb)},b.oklch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(v,[null].concat(e,["oklch"])))},m.format.oklch=Be,m.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("array"===o(e=s(e,"oklch"))&&3===e.length)return"oklch"}}),v.prototype.alpha=function(e,t){return void 0===t&&(t=!1),void 0!==e&&"number"===o(e)?t?(this._rgb[3]=e,this):new v([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]},v.prototype.clipped=function(){return this._rgb._clipped||!1},v.prototype.darken=function(e){void 0===e&&(e=1);var t=this,n=t.lab();return n[0]-=ie.Kn*e,new v(n,"lab").alpha(t.alpha(),!0)},v.prototype.brighten=function(e){return void 0===e&&(e=1),this.darken(-e)},v.prototype.darker=v.prototype.darken,v.prototype.brighter=v.prototype.brighten,v.prototype.get=function(e){var t=e.split("."),n=t[0],i=t[1],r=this[n]();if(i){var a=n.indexOf(i)-("ok"===n.substr(0,2)?2:0);if(a>-1)return r[a];throw new Error("unknown channel "+i+" in mode "+n)}return r};var Ve=Math.pow,qe=1e-7,Ge=20;v.prototype.luminance=function(e,t){if(void 0===t&&(t="rgb"),void 0!==e&&"number"===o(e)){if(0===e)return new v([0,0,0,this._rgb[3]],"rgb");if(1===e)return new v([255,255,255,this._rgb[3]],"rgb");var n=this.luminance(),i=Ge,r=function(n,a){var o=n.interpolate(a,.5,t),s=o.luminance();return Math.abs(e-s)<qe||!i--?o:s>e?r(n,o):r(o,a)},a=(n>e?r(new v([0,0,0]),this):r(this,new v([255,255,255]))).rgb();return new v(a.concat([this._rgb[3]]))}return ze.apply(void 0,this._rgb.slice(0,3))};var ze=function(e,t,n){return.2126*(e=$e(e))+.7152*(t=$e(t))+.0722*(n=$e(n))},$e=function(e){return(e/=255)<=.03928?e/12.92:Ve((e+.055)/1.055,2.4)},Ke={};function We(e,t,n){void 0===n&&(n=.5);for(var i=[],r=arguments.length-3;r-- >0;)i[r]=arguments[r+3];var a=i[0]||"lrgb";if(Ke[a]||i.length||(a=Object.keys(Ke)[0]),!Ke[a])throw new Error("interpolation mode "+a+" is not defined");return"object"!==o(e)&&(e=new v(e)),"object"!==o(t)&&(t=new v(t)),Ke[a](e,t,n).alpha(e.alpha()+n*(t.alpha()-e.alpha()))}v.prototype.mix=v.prototype.interpolate=function(e,t){void 0===t&&(t=.5);for(var n=[],i=arguments.length-2;i-- >0;)n[i]=arguments[i+2];return We.apply(void 0,[this,e,t].concat(n))},v.prototype.premultiply=function(e){void 0===e&&(e=!1);var t=this._rgb,n=t[3];return e?(this._rgb=[t[0]*n,t[1]*n,t[2]*n,n],this):new v([t[0]*n,t[1]*n,t[2]*n,n],"rgb")},v.prototype.saturate=function(e){void 0===e&&(e=1);var t=this,n=t.lch();return n[1]+=ie.Kn*e,n[1]<0&&(n[1]=0),new v(n,"lch").alpha(t.alpha(),!0)},v.prototype.desaturate=function(e){return void 0===e&&(e=1),this.saturate(-e)},v.prototype.set=function(e,t,n){void 0===n&&(n=!1);var i=e.split("."),r=i[0],a=i[1],s=this[r]();if(a){var u=r.indexOf(a)-("ok"===r.substr(0,2)?2:0);if(u>-1){if("string"==o(t))switch(t.charAt(0)){case"+":case"-":s[u]+=+t;break;case"*":s[u]*=+t.substr(1);break;case"/":s[u]/=+t.substr(1);break;default:s[u]=+t}else{if("number"!==o(t))throw new Error("unsupported value for Color.set");s[u]=t}var l=new v(s,r);return n?(this._rgb=l._rgb,this):l}throw new Error("unknown channel "+a+" in mode "+r)}return s},v.prototype.tint=function(e){void 0===e&&(e=.5);for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return We.apply(void 0,[this,"white",e].concat(t))},v.prototype.shade=function(e){void 0===e&&(e=.5);for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return We.apply(void 0,[this,"black",e].concat(t))};var Xe=function(e,t,n){var i=e._rgb,r=t._rgb;return new v(i[0]+n*(r[0]-i[0]),i[1]+n*(r[1]-i[1]),i[2]+n*(r[2]-i[2]),"rgb")};Ke.rgb=Xe;var Ye=Math.sqrt,Je=Math.pow,Qe=function(e,t,n){var i=e._rgb,r=i[0],a=i[1],o=i[2],s=t._rgb,u=s[0],l=s[1],c=s[2];return new v(Ye(Je(r,2)*(1-n)+Je(u,2)*n),Ye(Je(a,2)*(1-n)+Je(l,2)*n),Ye(Je(o,2)*(1-n)+Je(c,2)*n),"rgb")};Ke.lrgb=Qe;var Ze=function(e,t,n){var i=e.lab(),r=t.lab();return new v(i[0]+n*(r[0]-i[0]),i[1]+n*(r[1]-i[1]),i[2]+n*(r[2]-i[2]),"lab")};function et(e,t,n,i){var r,a,o,s,u,l,c,d,h,f,p,g,m;return"hsl"===i?(o=e.hsl(),s=t.hsl()):"hsv"===i?(o=e.hsv(),s=t.hsv()):"hcg"===i?(o=e.hcg(),s=t.hcg()):"hsi"===i?(o=e.hsi(),s=t.hsi()):"lch"===i||"hcl"===i?(i="hcl",o=e.hcl(),s=t.hcl()):"oklch"===i&&(o=e.oklch().reverse(),s=t.oklch().reverse()),"h"!==i.substr(0,1)&&"oklch"!==i||(u=(r=o)[0],c=r[1],h=r[2],l=(a=s)[0],d=a[1],f=a[2]),isNaN(u)||isNaN(l)?isNaN(u)?isNaN(l)?g=Number.NaN:(g=l,1!=h&&0!=h||"hsv"==i||(p=d)):(g=u,1!=f&&0!=f||"hsv"==i||(p=c)):g=u+n*(l>u&&l-u>180?l-(u+360):l<u&&u-l>180?l+360-u:l-u),void 0===p&&(p=c+n*(d-c)),m=h+n*(f-h),new v("oklch"===i?[m,p,g]:[g,p,m],i)}Ke.lab=Ze;var tt=function(e,t,n){return et(e,t,n,"lch")};Ke.lch=tt,Ke.hcl=tt;var nt=function(e,t,n){var i=e.num(),r=t.num();return new v(i+n*(r-i),"num")};Ke.num=nt;var it=function(e,t,n){return et(e,t,n,"hcg")};Ke.hcg=it;var rt=function(e,t,n){return et(e,t,n,"hsi")};Ke.hsi=rt;var at=function(e,t,n){return et(e,t,n,"hsl")};Ke.hsl=at;var ot=function(e,t,n){return et(e,t,n,"hsv")};Ke.hsv=ot;var st=function(e,t,n){var i=e.oklab(),r=t.oklab();return new v(i[0]+n*(r[0]-i[0]),i[1]+n*(r[1]-i[1]),i[2]+n*(r[2]-i[2]),"oklab")};Ke.oklab=st;var ut=function(e,t,n){return et(e,t,n,"oklch")};Ke.oklch=ut;var lt=Math.pow,ct=Math.sqrt,dt=Math.PI,ht=Math.cos,ft=Math.sin,pt=Math.atan2;function gt(e,t,n){void 0===t&&(t="lrgb"),void 0===n&&(n=null);var i=e.length;n||(n=Array.from(new Array(i)).map((function(){return 1})));var r=i/n.reduce((function(e,t){return e+t}));if(n.forEach((function(e,t){n[t]*=r})),e=e.map((function(e){return new v(e)})),"lrgb"===t)return mt(e,n);for(var a=e.shift(),o=a.get(t),s=[],u=0,l=0,c=0;c<o.length;c++)if(o[c]=(o[c]||0)*n[0],s.push(isNaN(o[c])?0:n[0]),"h"===t.charAt(c)&&!isNaN(o[c])){var d=o[c]/180*dt;u+=ht(d)*n[0],l+=ft(d)*n[0]}var h=a.alpha()*n[0];e.forEach((function(e,i){var r=e.get(t);h+=e.alpha()*n[i+1];for(var a=0;a<o.length;a++)if(!isNaN(r[a]))if(s[a]+=n[i+1],"h"===t.charAt(a)){var c=r[a]/180*dt;u+=ht(c)*n[i+1],l+=ft(c)*n[i+1]}else o[a]+=r[a]*n[i+1]}));for(var f=0;f<o.length;f++)if("h"===t.charAt(f)){for(var p=pt(l/s[f],u/s[f])/dt*180;p<0;)p+=360;for(;p>=360;)p-=360;o[f]=p}else o[f]=o[f]/s[f];return h/=i,new v(o,t).alpha(h>.99999?1:h,!0)}var mt=function(e,n){for(var i=e.length,r=[0,0,0,0],a=0;a<e.length;a++){var o=e[a],s=n[a]/i,u=o._rgb;r[0]+=lt(u[0],2)*s,r[1]+=lt(u[1],2)*s,r[2]+=lt(u[2],2)*s,r[3]+=u[3]*s}return r[0]=ct(r[0]),r[1]=ct(r[1]),r[2]=ct(r[2]),r[3]>.9999999&&(r[3]=1),new v(t(r))},vt=Math.pow;function yt(t){var n="rgb",i=b("#ccc"),r=0,a=[0,1],s=[],u=[0,0],l=!1,c=[],d=!1,h=0,f=1,p=!1,g={},m=!0,v=1,y=function(e){if((e=e||["#fff","#000"])&&"string"===o(e)&&b.brewer&&b.brewer[e.toLowerCase()]&&(e=b.brewer[e.toLowerCase()]),"array"===o(e)){1===e.length&&(e=[e[0],e[0]]),e=e.slice(0);for(var t=0;t<e.length;t++)e[t]=b(e[t]);s.length=0;for(var n=0;n<e.length;n++)s.push(n/(e.length-1))}return x(),c=e},w=function(e){if(null!=l){for(var t=l.length-1,n=0;n<t&&e>=l[n];)n++;return n-1}return 0},_=function(e){return e},S=function(e){return e},T=function(t,r){var a,d;if(null==r&&(r=!1),isNaN(t)||null===t)return i;d=r?t:l&&l.length>2?w(t)/(l.length-2):f!==h?(t-h)/(f-h):1,d=S(d),r||(d=_(d)),1!==v&&(d=vt(d,v)),d=e(d=u[0]+d*(1-u[0]-u[1]),0,1);var p=Math.floor(1e4*d);if(m&&g[p])a=g[p];else{if("array"===o(c))for(var y=0;y<s.length;y++){var T=s[y];if(d<=T){a=c[y];break}if(d>=T&&y===s.length-1){a=c[y];break}if(d>T&&d<s[y+1]){d=(d-T)/(s[y+1]-T),a=b.interpolate(c[y],c[y+1],d,n);break}}else"function"===o(c)&&(a=c(d));m&&(g[p]=a)}return a},x=function(){return g={}};y(t);var k=function(e){var t=b(T(e));return d&&t[d]?t[d]():t};return k.classes=function(e){if(null!=e){if("array"===o(e))l=e,a=[e[0],e[e.length-1]];else{var t=b.analyze(a);l=0===e?[t.min,t.max]:b.limits(t,"e",e)}return k}return l},k.domain=function(e){if(!arguments.length)return a;h=e[0],f=e[e.length-1],s=[];var t=c.length;if(e.length===t&&h!==f)for(var n=0,i=Array.from(e);n<i.length;n+=1){var r=i[n];s.push((r-h)/(f-h))}else{for(var o=0;o<t;o++)s.push(o/(t-1));if(e.length>2){var u=e.map((function(t,n){return n/(e.length-1)})),l=e.map((function(e){return(e-h)/(f-h)}));l.every((function(e,t){return u[t]===e}))||(S=function(e){if(e<=0||e>=1)return e;for(var t=0;e>=l[t+1];)t++;var n=(e-l[t])/(l[t+1]-l[t]);return u[t]+n*(u[t+1]-u[t])})}}return a=[h,f],k},k.mode=function(e){return arguments.length?(n=e,x(),k):n},k.range=function(e,t){return y(e),k},k.out=function(e){return d=e,k},k.spread=function(e){return arguments.length?(r=e,k):r},k.correctLightness=function(e){return null==e&&(e=!0),p=e,x(),_=p?function(e){for(var t=T(0,!0).lab()[0],n=T(1,!0).lab()[0],i=t>n,r=T(e,!0).lab()[0],a=t+(n-t)*e,o=r-a,s=0,u=1,l=20;Math.abs(o)>.01&&l-- >0;)i&&(o*=-1),o<0?(s=e,e+=.5*(u-e)):(u=e,e+=.5*(s-e)),r=T(e,!0).lab()[0],o=r-a;return e}:function(e){return e},k},k.padding=function(e){return null!=e?("number"===o(e)&&(e=[e,e]),u=e,k):u},k.colors=function(e,n){arguments.length<2&&(n="hex");var i=[];if(0===arguments.length)i=c.slice(0);else if(1===e)i=[k(.5)];else if(e>1){var r=a[0],o=a[1]-r;i=bt(0,e).map((function(t){return k(r+t/(e-1)*o)}))}else{t=[];var s=[];if(l&&l.length>2)for(var u=1,d=l.length,h=1<=d;h?u<d:u>d;h?u++:u--)s.push(.5*(l[u-1]+l[u]));else s=a;i=s.map((function(e){return k(e)}))}return b[n]&&(i=i.map((function(e){return e[n]()}))),i},k.cache=function(e){return null!=e?(m=e,k):m},k.gamma=function(e){return null!=e?(v=e,k):v},k.nodata=function(e){return null!=e?(i=b(e),k):i},k}function bt(e,t,n){for(var i=[],r=e<t,a=t,o=e;r?o<a:o>a;r?o++:o--)i.push(o);return i}var wt=function(e){for(var t=[1,1],n=1;n<e;n++){for(var i=[1],r=1;r<=t.length;r++)i[r]=(t[r]||0)+t[r-1];t=i}return t},_t=function(e){var t,n,i,r,a,o,s;if(2===(e=e.map((function(e){return new v(e)}))).length)t=e.map((function(e){return e.lab()})),a=t[0],o=t[1],r=function(e){var t=[0,1,2].map((function(t){return a[t]+e*(o[t]-a[t])}));return new v(t,"lab")};else if(3===e.length)n=e.map((function(e){return e.lab()})),a=n[0],o=n[1],s=n[2],r=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*a[t]+2*(1-e)*e*o[t]+e*e*s[t]}));return new v(t,"lab")};else if(4===e.length){var u;i=e.map((function(e){return e.lab()})),a=i[0],o=i[1],s=i[2],u=i[3],r=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*(1-e)*a[t]+3*(1-e)*(1-e)*e*o[t]+3*(1-e)*e*e*s[t]+e*e*e*u[t]}));return new v(t,"lab")}}else{if(!(e.length>=5))throw new RangeError("No point in running bezier with only one color.");var l,c,d;l=e.map((function(e){return e.lab()})),d=e.length-1,c=wt(d),r=function(e){var t=1-e,n=[0,1,2].map((function(n){return l.reduce((function(i,r,a){return i+c[a]*Math.pow(t,d-a)*Math.pow(e,a)*r[n]}),0)}));return new v(n,"lab")}}return r};function St(e){var t=_t(e);return t.scale=function(){return yt(t)},t}var Tt=function(e,t,n){if(!Tt[n])throw new Error("unknown blend mode "+n);return Tt[n](e,t)},xt=function(e){return function(t,n){var i=b(n).rgb(),r=b(t).rgb();return b.rgb(e(i,r))}},kt=function(e){return function(t,n){var i=[];return i[0]=e(t[0],n[0]),i[1]=e(t[1],n[1]),i[2]=e(t[2],n[2]),i}},At=function(e){return e},Et=function(e,t){return e*t/255},It=function(e,t){return e>t?t:e},Ct=function(e,t){return e>t?e:t},Mt=function(e,t){return 255*(1-(1-e/255)*(1-t/255))},Pt=function(e,t){return t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255))},Rt=function(e,t){return 255*(1-(1-t/255)/(e/255))},Dt=function(e,t){return 255===e||(e=t/255*255/(1-e/255))>255?255:e};Tt.normal=xt(kt(At)),Tt.multiply=xt(kt(Et)),Tt.screen=xt(kt(Mt)),Tt.overlay=xt(kt(Pt)),Tt.darken=xt(kt(It)),Tt.lighten=xt(kt(Ct)),Tt.dodge=xt(kt(Dt)),Tt.burn=xt(kt(Rt));var Lt=Math.pow,Nt=Math.sin,Ot=Math.cos;function jt(e,n,i,r,a){void 0===e&&(e=300),void 0===n&&(n=-1.5),void 0===i&&(i=1),void 0===r&&(r=1),void 0===a&&(a=[0,1]);var s,u=0;"array"===o(a)?s=a[1]-a[0]:(s=0,a=[a,a]);var l=function(o){var l=h*((e+120)/360+n*o),c=Lt(a[0]+s*o,r),d=(0!==u?i[0]+o*u:i)*c*(1-c)/2,f=Ot(l),p=Nt(l);return b(t([255*(c+d*(-.14861*f+1.78277*p)),255*(c+d*(-.29227*f-.90649*p)),255*(c+d*(1.97294*f)),1]))};return l.start=function(t){return null==t?e:(e=t,l)},l.rotations=function(e){return null==e?n:(n=e,l)},l.gamma=function(e){return null==e?r:(r=e,l)},l.hue=function(e){return null==e?i:("array"===o(i=e)?0==(u=i[1]-i[0])&&(i=i[1]):u=0,l)},l.lightness=function(e){return null==e?a:("array"===o(e)?(a=e,s=e[1]-e[0]):(a=[e,e],s=0),l)},l.scale=function(){return b.scale(l)},l.hue(i),l}var Ut="0123456789abcdef",Ft=Math.floor,Bt=Math.random;function Ht(){for(var e="#",t=0;t<6;t++)e+=Ut.charAt(Ft(16*Bt()));return new v(e,"hex")}var Vt=Math.log,qt=Math.pow,Gt=Math.floor,zt=Math.abs;function $t(e,t){void 0===t&&(t=null);var n={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===o(e)&&(e=Object.values(e)),e.forEach((function(e){t&&"object"===o(e)&&(e=e[t]),null==e||isNaN(e)||(n.values.push(e),n.sum+=e,e<n.min&&(n.min=e),e>n.max&&(n.max=e),n.count+=1)})),n.domain=[n.min,n.max],n.limits=function(e,t){return Kt(n,e,t)},n}function Kt(e,t,n){void 0===t&&(t="equal"),void 0===n&&(n=7),"array"==o(e)&&(e=$t(e));var i=e.min,r=e.max,a=e.values.sort((function(e,t){return e-t}));if(1===n)return[i,r];var s=[];if("c"===t.substr(0,1)&&(s.push(i),s.push(r)),"e"===t.substr(0,1)){s.push(i);for(var u=1;u<n;u++)s.push(i+u/n*(r-i));s.push(r)}else if("l"===t.substr(0,1)){if(i<=0)throw new Error("Logarithmic scales are only possible for values > 0");var l=Math.LOG10E*Vt(i),c=Math.LOG10E*Vt(r);s.push(i);for(var d=1;d<n;d++)s.push(qt(10,l+d/n*(c-l)));s.push(r)}else if("q"===t.substr(0,1)){s.push(i);for(var h=1;h<n;h++){var f=(a.length-1)*h/n,p=Gt(f);if(p===f)s.push(a[p]);else{var g=f-p;s.push(a[p]*(1-g)+a[p+1]*g)}}s.push(r)}else if("k"===t.substr(0,1)){var m,v=a.length,y=new Array(v),b=new Array(n),w=!0,_=0,S=null;(S=[]).push(i);for(var T=1;T<n;T++)S.push(i+T/n*(r-i));for(S.push(r);w;){for(var x=0;x<n;x++)b[x]=0;for(var k=0;k<v;k++)for(var A=a[k],E=Number.MAX_VALUE,I=void 0,C=0;C<n;C++){var M=zt(S[C]-A);M<E&&(E=M,I=C),b[I]++,y[k]=I}for(var P=new Array(n),R=0;R<n;R++)P[R]=null;for(var D=0;D<v;D++)null===P[m=y[D]]?P[m]=a[D]:P[m]+=a[D];for(var L=0;L<n;L++)P[L]*=1/b[L];w=!1;for(var N=0;N<n;N++)if(P[N]!==S[N]){w=!0;break}S=P,++_>200&&(w=!1)}for(var O={},j=0;j<n;j++)O[j]=[];for(var U=0;U<v;U++)O[m=y[U]].push(a[U]);for(var F=[],B=0;B<n;B++)F.push(O[B][0]),F.push(O[B][O[B].length-1]);F=F.sort((function(e,t){return e-t})),s.push(F[0]);for(var H=1;H<F.length;H+=2){var V=F[H];isNaN(V)||-1!==s.indexOf(V)||s.push(V)}}return s}function Wt(e,t){e=new v(e),t=new v(t);var n=e.luminance(),i=t.luminance();return n>i?(n+.05)/(i+.05):(i+.05)/(n+.05)}var Xt=Math.sqrt,Yt=Math.pow,Jt=Math.min,Qt=Math.max,Zt=Math.atan2,en=Math.abs,tn=Math.cos,nn=Math.sin,rn=Math.exp,an=Math.PI;function on(e,t,n,i,r){void 0===n&&(n=1),void 0===i&&(i=1),void 0===r&&(r=1);var a=function(e){return 360*e/(2*an)},o=function(e){return 2*an*e/360};e=new v(e),t=new v(t);var s=Array.from(e.lab()),u=s[0],l=s[1],c=s[2],d=Array.from(t.lab()),h=d[0],f=d[1],p=d[2],g=(u+h)/2,m=(Xt(Yt(l,2)+Yt(c,2))+Xt(Yt(f,2)+Yt(p,2)))/2,y=.5*(1-Xt(Yt(m,7)/(Yt(m,7)+Yt(25,7)))),b=l*(1+y),w=f*(1+y),_=Xt(Yt(b,2)+Yt(c,2)),S=Xt(Yt(w,2)+Yt(p,2)),T=(_+S)/2,x=a(Zt(c,b)),k=a(Zt(p,w)),A=x>=0?x:x+360,E=k>=0?k:k+360,I=en(A-E)>180?(A+E+360)/2:(A+E)/2,C=1-.17*tn(o(I-30))+.24*tn(o(2*I))+.32*tn(o(3*I+6))-.2*tn(o(4*I-63)),M=E-A;M=en(M)<=180?M:E<=A?M+360:M-360,M=2*Xt(_*S)*nn(o(M)/2);var P=h-u,R=S-_,D=1+.015*Yt(g-50,2)/Xt(20+Yt(g-50,2)),L=1+.045*T,N=1+.015*T*C,O=30*rn(-Yt((I-275)/25,2)),j=-2*Xt(Yt(T,7)/(Yt(T,7)+Yt(25,7)))*nn(2*o(O)),U=Xt(Yt(P/(n*D),2)+Yt(R/(i*L),2)+Yt(M/(r*N),2)+j*(R/(i*L))*(M/(r*N)));return Qt(0,Jt(100,U))}function sn(e,t,n){void 0===n&&(n="lab"),e=new v(e),t=new v(t);var i=e.get(n),r=t.get(n),a=0;for(var o in i){var s=(i[o]||0)-(r[o]||0);a+=s*s}return Math.sqrt(a)}function un(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];try{return new(Function.prototype.bind.apply(v,[null].concat(e))),!0}catch(e){return!1}}for(var ln={cool:function(){return yt([b.hsl(180,1,.9),b.hsl(250,.7,.4)])},hot:function(){return yt(["#000","#f00","#ff0","#fff"]).mode("rgb")}},cn={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},dn=0,hn=Object.keys(cn);dn<hn.length;dn+=1){var fn=hn[dn];cn[fn.toLowerCase()]=cn[fn]}return Object.assign(b,{average:gt,bezier:St,blend:Tt,cubehelix:jt,mix:We,interpolate:We,random:Ht,scale:yt,analyze:$t,contrast:Wt,deltaE:on,distance:sn,limits:Kt,valid:un,scales:ln,input:m,colors:Te,brewer:cn}),b}()},275:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(980),a=i(n(277)),o=i(n(919)),s=i(n(228)),u=i(n(713));class l{constructor(){this.constrainDropdownMenuPositions(),addEventListener("resize",(e=>this.constrainDropdownMenuPositions())),l.initRatingColourGradient(),o.default.initCheckboxes(),l.initChevrons(),this.initLogInOut(),a.default.syncLoginUi(),l.tryRemoveAds(),this.scrollToCurrentHash(),this.overrideHashChange(),this.overrideFixedLinks(),this.initSearchValue(),this.initTracker(),this.initAppLinkMenu(),this.initRankingHoverItems()}initLogInOut(){const e=document.querySelector("#lout form");e?(e["openid.realm"].value="https://club.steam250.com",e["openid.return_to"].value=`https://club.steam250.com/steam/login?r=${location.origin+location.pathname}`,document.querySelector("#lout button").addEventListener("click",(e=>localStorage.setItem("login","sync"))),document.querySelector("#lin button").addEventListener("click",(e=>a.default.logout())),"#!"===location.hash&&(a.default.syncLogout(),history.replaceState(null,"",location.pathname+location.search),console.debug("Club 250 logout signal received.")),"sync"===localStorage.getItem("login")&&(localStorage.removeItem("login"),a.default.syncLogin())):console.debug("Steam user area unavailable: skipped.")}constrainDropdownMenuPositions(){document.querySelectorAll("nav > ol > li > div").forEach((e=>{const t=e.getBoundingClientRect();t.left<0&&(e.style.left=`calc(${getComputedStyle(e).left} - ${t.left}px)`),t.right>document.documentElement.clientWidth&&(e.style.left=`calc(${getComputedStyle(e).left} - ${t.right-document.documentElement.clientWidth}px)`)}))}scrollToCurrentHash(){addEventListener("load",(e=>this.scrollToHash(location.hash)))}overrideHashChange(){addEventListener("hashchange",(e=>this.scrollToHash(location.hash)))}overrideFixedLinks(){document.querySelectorAll(".fixedlinks a").forEach((e=>{e.addEventListener("click",(t=>{this.scrollToHash(e.hash),t.preventDefault()}))}))}scrollToHash(e){const t="highlight";if(document.querySelectorAll(".ranking [id]").forEach((e=>e.classList.remove(t))),!e)return;const n=document.querySelector("nav").getBoundingClientRect().height,i=this.resolveHashTarget(e);if(i){let e=i.getBoundingClientRect().top-n;const r=document.querySelector(".applist, .main.ranking");if(r&&r.contains(i)){if(i.classList.add(t),function(e){const t=e.getBoundingClientRect();return t.top>=n&&t.left>=0&&t.bottom<=innerHeight&&t.right<=innerWidth}(i))return;e+=i.getBoundingClientRect().height/2-innerHeight/3}scrollTo(scrollX,scrollY+Math.ceil(e))}}resolveHashTarget(e){if(e.startsWith("#app/")){let[,t,n]=e.split("/",3),i=document.querySelector(`.applist a[href$="/${t}"], .ranking a[href$="/${t}"]`);return i?i.closest("[id]"):void console.error(`Couldn't find game on this ranking: "${decodeURIComponent(n)}".`)}return document.getElementById(e.substring(1))}static isLoggedIn(){return a.default.isLoggedIn()}static isClub250(){return"https://club.steam250.com"===location.origin}static syncLogin(){return a.default.syncLogin()}static syncLogout(){return a.default.syncLogout()}static syncGames(){a.default.syncGames()}static showAds(){const e=localStorage.getItem("user");if(e){const t=JSON.parse(e);return!(t.hasOwnProperty("noads")&&t.noads)}return!0}static tryRemoveAds(){l.showAds()||document.querySelectorAll("ins").forEach((e=>e.remove()))}initSearchValue(){const e=(0,r.parseParam)("q");null!==e&&document.querySelectorAll("input[name=q]").forEach((t=>t.value=e.replace(/\+/g," ")))}initTracker(){""==="MISSING_ENV_VAR".NOTRACK||u.default.init("phc_Rjmhrs656s6Say2ICy0A5xFi0HHGD38KTXxh1XI4ntD",{api_host:"//ph.steam250.com",person_profiles:"always"})}initAppLinkMenu(){const e=document.getElementById("linkmenu"),t="show";let n;document.querySelectorAll(".ranking .links").forEach((i=>{i.addEventListener("click",(r=>{e.style.top=i.offsetTop+i.offsetHeight+5+"px",e.style.left=i.offsetLeft+"px",e.querySelector("a:first-of-type > span").innerHTML=i.closest("[id]").id,e.classList.toggle(t,n!==i||void 0),i.classList.toggle(t,e.classList.contains(t)),n=i,r.preventDefault()})),i.addEventListener("blur",(n=>{e.classList.remove(t),i.classList.remove(t)}))})),document.querySelectorAll("#linkmenu a").forEach((e=>{e.addEventListener("click",(t=>{if(e.classList.contains("cp")&&(e.classList.contains("rank")&&this.copyToClipboard(n.href),e.classList.contains("app"))){const e=this.findSteamAppId(n.closest("[id]")),t=encodeURIComponent(this.findSteamAppName(n.closest("div")));this.copyToClipboard(`${location.origin}${location.pathname}#app/${e}/${t}`)}}))}))}initRankingHoverItems(){document.querySelectorAll(".compact.ranking li > .title").forEach((e=>{const t=e.appendChild(e.cloneNode(!0));t.style.pointerEvents="none",e.addEventListener("mouseenter",(e=>{t.classList.remove("animate"),t.offsetWidth,t.classList.add("animate")})),e.addEventListener("animationend",(e=>{t.classList.remove("animate")}))}))}static initRatingColourGradient(){const e=s.default.scale(["#de5854","#dfe372","#83d866"]).domain([0,60,100]);document.querySelectorAll(".rating").forEach((t=>{const[n,i]=/(\D*)(\d+%?)/.exec(t.innerText).slice(1);if(n){const e=document.createElement("span");t.innerHTML=n,e.innerHTML=i,t.insertAdjacentElement("beforeend",e),t=e}t.style.color=e(parseFloat(t.innerText)).hex()}))}static initChevrons(){document.querySelectorAll(".more-button > span:last-of-type").forEach((e=>{e.parentNode.appendChild(e.cloneNode()),e.parentNode.appendChild(e.cloneNode())}))}findSteamAppId(e){const t=e.querySelector("img[src]");if(t)return t.src.match(/\/(\d+)\//)[1]}findSteamAppName(e){return e.querySelector(".title > a").innerText}copyToClipboard(e){document.queryCommandSupported&&document.queryCommandSupported("copy")||alert("Clipboard is not supported in this browser!");const t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch(e){return alert("Failed to copy clipboard data."),!1}finally{document.body.removeChild(t)}}}window.S250=l,new l},277:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{u(i.next(e))}catch(e){a(e)}}function s(e){try{u(i.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.default=class{static isLoggedIn(){return localStorage.hasOwnProperty("user")||localStorage.hasOwnProperty("whoami")}static logout(){document.body.insertAdjacentHTML("beforeend",`\n            <form method="post" action="https://club.steam250.com/logout" name="logout">\n                <input type="hidden" name="r" value="${location.origin+location.pathname}">\n            </form>\n        `),this.syncLogout(),document.forms.namedItem("logout").submit()}static syncLogin(){return n(this,void 0,void 0,(function*(){var e;const t=yield fetch("https://club.steam250.com/api/whoami",{credentials:"include"}),n=yield t.text();if(!t.ok)return console.error("Login sync failed:",t.status,t.statusText,n);const[i,r,a,o]=n.split("\0",4);let s=null===(e=r.match(/^(?:\d+\/[\da-z]{40}\..{3}|[\da-z]{40})/))||void 0===e?void 0:e[0];localStorage.setItem("user",JSON.stringify({id:i,avatar:s,name:s?r.substring(s.length):"ERROR",noads:"1"===a,tier:+o})),this.postClub250Message("login synced"),S250.tryRemoveAds(),this.syncLoginUi(),this.syncGames()}))}static syncLogout(){localStorage.removeItem("user"),this.postClub250Message("logout synced")}static syncGames(){this.postClub250Message("games"),addEventListener("message",(e=>{"https://club.steam250.com"===e.origin&&(console.debug("C250:",e.data),"games"===e.data.message&&(localStorage.setItem("games",e.data.games),localStorage.setItem("games.date",e.data.modified)))})),localStorage.getItem("games.date")||localStorage.removeItem("games")}static syncLoginUi(){if(this.isLoggedIn()&&(this.rewireTagLinks(),this.hideObsoleteTiers()),S250.isClub250())return;const e=document.getElementById("user");if(!e)return;const t=e.classList;t.remove("lin","lout"),t.add(this.isLoggedIn()?"lin":"lout"),this.isLoggedIn()&&this.updateUserBar()}static hideObsoleteTiers(){const e=this.fetchUser();e.tier&&document.querySelectorAll("nav .micro.tier"+(S250.isClub250()?"":", #body .micro.tier")).forEach((t=>{const n=+[...t.classList].filter((e=>/^t\d$/.test(e)))[0].substring(1);e.tier>=n&&t.remove()}))}static rewireTagLinks(){this.fetchUser().tier&&document.querySelectorAll("a[data-id]").forEach((e=>{new RegExp("^https://[^/]+/tag/").test(e.href)&&(e.href=`https://club.steam250.com/tag/${e.dataset.id}`)}))}static updateUserBar(){const e="https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images",t=this.fetchUser(),n=document.querySelector("#lin .avatar");if(!n)return;n.href="https://club.steam250.com/me";const i=n.appendChild(document.createElement("img"));i.alt=i.title=t.name,t.avatar.includes("/")?i.src=`${e}/items/${t.avatar}`:i.src=`${e}/avatars/${t.avatar.substring(0,2)}/${t.avatar}.jpg'`}static fetchUser(){const e=localStorage.getItem("user");if(e)return JSON.parse(e)}static formatTimePlayed(e){return e<60?e+" minute"+(1!==e?"s":""):(e/60).toFixed(1)+" hour"+(60!==e?"s":"")}static postClub250Message(e){parent!==window&&parent.postMessage(e,"https://club.steam250.com")}}},552:(e,t,n)=>{!function(){var e="undefined"!=typeof window?window:n.g,i={};for(var r in function(e,t,n){var i,r="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t},a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var o,s=function(n){n=["object"==typeof globalThis&&globalThis,n,"object"==typeof e&&e,"object"==typeof self&&self,"object"==typeof t&&t];for(var i=0;i<n.length;++i){var r=n[i];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function u(e,t){if(t)e:{var n=s;e=e.split(".");for(var i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))break e;n=n[r]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&a(n,e,{configurable:!0,writable:!0,value:t})}}if("function"==typeof Object.setPrototypeOf)o=Object.setPrototypeOf;else{var l;e:{var c={};try{c.__proto__={a:!0},l=c.a;break e}catch(e){}l=!1}o=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var d=o;function h(e,t){if(e.prototype=r(t.prototype),e.prototype.constructor=e,d)d(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n];e.Gm=t.prototype}function f(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function p(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return{next:f(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}function g(e){if(!(e instanceof Array)){e=p(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}function m(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function v(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.B=this.i=null}function y(e){if(e.o)throw new TypeError("Generator is already running");e.o=!0}function b(e,t){e.i={Wh:t,li:!0},e.g=e.m||e.j}function w(e,t,n){return e.g=n,{value:t}}function _(e){e.g=0}function S(e,t,n){e.m=t,null!=n&&(e.j=n)}function T(e,t){e.m=0,e.j=t||0}function x(e,t,n){e.g=t,e.m=n||0}function k(e,t){return e.m=t||0,t=e.i.Wh,e.i=null,t}function A(e){e.B=[e.i],e.m=0,e.j=0}function E(e,t){var n=e.B.splice(0)[0];(n=e.i=e.i||n)?n.li?e.g=e.m||e.j:null!=n.A&&e.j<n.A?(e.g=n.A,e.i=null):e.g=e.j:e.g=t}function I(e){this.g=new v,this.h=e}function C(e,t,n,i){try{var r=t.call(e.g.l,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return e.g.o=!1,r;var a=r.value}catch(t){return e.g.l=null,b(e.g,t),M(e)}return e.g.l=null,i.call(e.g,a),M(e)}function M(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.o=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,b(e.g,t)}if(e.g.o=!1,e.g.i){if(t=e.g.i,e.g.i=null,t.li)throw t.Wh;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function P(e){this.next=function(t){return y(e.g),e.g.l?t=C(e,e.g.l.next,t,e.g.u):(e.g.u(t),t=M(e)),t},this.throw=function(t){return y(e.g),e.g.l?t=C(e,e.g.l.throw,t,e.g.u):(b(e.g,t),t=M(e)),t},this.return=function(t){return function(e,t){y(e.g);var n=e.g.l;return n?C(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),M(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function R(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(i,r){!function e(a){a.done?i(a.value):Promise.resolve(a.value).then(t,n).then(e,r)}(e.next())}))}(new P(new I(e)))}function D(){for(var e=Number(this),t=[],n=e;n<arguments.length;n++)t[n-e]=arguments[n];return t}function L(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function N(e,t,n){e instanceof String&&(e=String(e));for(var i=e.length,r=0;r<i;r++){var a=e[r];if(t.call(n,a,r,e))return{gi:r,v:a}}return{gi:-1,v:void 0}}function O(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}function j(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}u("Symbol",(function(e){function t(e,t){this.g=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+i++,r)}})),u("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=s[t[n]];"function"==typeof i&&"function"!=typeof i.prototype[e]&&a(i.prototype,e,{configurable:!0,writable:!0,value:function(){return m(f(this))}})}return e})),v.prototype.u=function(e){this.h=e},v.prototype.return=function(e){this.i={return:e},this.g=this.j},v.prototype.A=function(e){this.g=e},u("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function i(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var r=s.setTimeout;n.prototype.i=function(e){r(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(i){n||(n=!0,e.call(t,i))}}var t=this,n=!1;return{resolve:e(this.G),reject:e(this.l)}},t.prototype.G=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.I(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.F(e):this.m(e)}},t.prototype.F=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.J(t,e):this.m(e)},t.prototype.l=function(e){this.u(2,e)},t.prototype.m=function(e){this.u(1,e)},t.prototype.u=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.H(),this.B()},t.prototype.H=function(){var e=this;r((function(){if(e.C()){var t=s.console;void 0!==t&&t.error(e.i)}}),1)},t.prototype.C=function(){if(this.o)return!1;var e=s.CustomEvent,t=s.Event,n=s.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=s.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.B=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new n;return t.prototype.I=function(e){var t=this.j();e.Qe(t.resolve,t.reject)},t.prototype.J=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function i(e,t){return"function"==typeof e?function(t){try{r(e(t))}catch(e){a(e)}}:t}var r,a,o=new t((function(e,t){r=e,a=t}));return this.Qe(i(e,r),i(n,a)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Qe=function(e,t){function n(){switch(i.h){case 1:e(i.i);break;case 2:t(i.i);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},t.resolve=i,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var r=p(e),a=r.next();!a.done;a=r.next())i(a.value).Qe(t,n)}))},t.all=function(e){var n=p(e),r=n.next();return r.done?i([]):new t((function(e,t){function a(t){return function(n){o[t]=n,0==--s&&e(o)}}var o=[],s=0;do{o.push(void 0),s++,i(r.value).Qe(a(o.length-1),t),r=n.next()}while(!r.done)}))},t})),u("WeakMap",(function(e){function t(e){if(this.g=(u+=Math.random()+1).toString(),e){e=p(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function i(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function r(e){if(!L(e,s)){var t=new n;a(e,s,{value:t})}}function o(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&r(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([[t,2],[n,3]]);return 2==i.get(t)&&3==i.get(n)&&(i.delete(t),i.set(n,4),!i.has(t)&&4==i.get(n))}catch(e){return!1}}())return e;var s="$jscomp_hidden_"+Math.random();o("freeze"),o("preventExtensions"),o("seal");var u=0;return t.prototype.set=function(e,t){if(!i(e))throw Error("Invalid WeakMap key");if(r(e),!L(e,s))throw Error("WeakMap key fail: "+e);return e[s][this.g]=t,this},t.prototype.get=function(e){return i(e)&&L(e,s)?e[s][this.g]:void 0},t.prototype.has=function(e){return i(e)&&L(e,s)&&L(e[s],this.g)},t.prototype.delete=function(e){return!!(i(e)&&L(e,s)&&L(e[s],this.g))&&delete e[s][this.g]},t})),u("Map",(function(e){function t(){var e={};return e.wc=e.next=e.head=e}function n(e,t){var n=e[1];return m((function(){if(n){for(;n.head!=e[1];)n=n.wc;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function i(e,t){var n=t&&typeof t;"object"==n||"function"==n?a.has(t)?n=a.get(t):(n=""+ ++o,a.set(t,n)):n="p_"+t;var i=e[0][n];if(i&&L(e[0],n))for(e=0;e<i.length;e++){var r=i[e];if(t!=t&&r.key!=r.key||t===r.key)return{id:n,list:i,index:e,entry:r}}return{id:n,list:i,index:-1,entry:void 0}}function r(e){if(this[0]={},this[1]=t(),this.size=0,e){e=p(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(p([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&"s"==r.value[1]&&!((r=i.next()).done||4!=r.value[0].x||"t"!=r.value[1]||!i.next().done)}catch(e){return!1}}())return e;var a=new WeakMap;r.prototype.set=function(e,t){var n=i(this,e=0===e?0:e);return n.list||(n.list=this[0][n.id]=[]),n.entry?n.entry.value=t:(n.entry={next:this[1],wc:this[1].wc,head:this[1],key:e,value:t},n.list.push(n.entry),this[1].wc.next=n.entry,this[1].wc=n.entry,this.size++),this},r.prototype.delete=function(e){return!(!(e=i(this,e)).entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this[0][e.id],e.entry.wc.next=e.entry.next,e.entry.next.wc=e.entry.wc,e.entry.head=null,this.size--,!0)},r.prototype.clear=function(){this[0]={},this[1]=this[1].wc=t(),this.size=0},r.prototype.has=function(e){return!!i(this,e).entry},r.prototype.get=function(e){return(e=i(this,e).entry)&&e.value},r.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},r.prototype.keys=function(){return n(this,(function(e){return e.key}))},r.prototype.values=function(){return n(this,(function(e){return e.value}))},r.prototype.forEach=function(e,t){for(var n,i=this.entries();!(n=i.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var o=0;return r})),u("Set",(function(e){function t(e){if(this.g=new Map,e){e=p(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(p([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&r.value[1]==t&&(!(r=i.next()).done&&r.value[0]!=t&&4==r.value[0].x&&r.value[1]==r.value[0]&&i.next().done)}catch(e){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach((function(i){return e.call(t,i,i,n)}))},t)})),u("Array.prototype.findIndex",(function(e){return e||function(e,t){return N(this,e,t).gi}})),u("Array.prototype.values",(function(e){return e||function(){return O(this,(function(e,t){return t}))}})),u("Array.from",(function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var i=[],r="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof r){e=r.call(e);for(var a=0;!(r=e.next()).done;)i.push(t.call(n,r.value,a++))}else for(r=e.length,a=0;a<r;a++)i.push(t.call(n,e[a],a));return i}})),u("Array.prototype.keys",(function(e){return e||function(){return O(this,(function(e){return e}))}})),u("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),u("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length;for((t=t||0)<0&&(t=Math.max(t+i,0));t<i;t++){var r=n[t];if(r===e||Object.is(r,e))return!0}return!1}})),u("String.prototype.includes",(function(e){return e||function(e,t){return-1!==j(this,e,"includes").indexOf(e,t||0)}})),u("String.fromCodePoint",(function(e){return e||function(e){for(var t="",n=0;n<arguments.length;n++){var i=Number(arguments[n]);if(i<0||i>1114111||i!==Math.floor(i))throw new RangeError("invalid_code_point "+i);i<=65535?t+=String.fromCharCode(i):(i-=65536,t+=String.fromCharCode(i>>>10&1023|55296),t+=String.fromCharCode(1023&i|56320))}return t}})),u("WeakSet",(function(e){function t(e){if(this.g=new WeakMap,e){e=p(e);for(var t;!(t=e.next()).done;)this.add(t.value)}}return function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([t]);return!(!i.has(t)||i.has(n))&&(i.delete(t),i.add(n),!i.has(t)&&i.has(n))}catch(e){return!1}}()?e:(t.prototype.add=function(e){return this.g.set(e,!0),this},t.prototype.has=function(e){return this.g.has(e)},t.prototype.delete=function(e){return this.g.delete(e)},t)})),u("Array.prototype.find",(function(e){return e||function(e,t){return N(this,e,t).v}})),u("String.prototype.startsWith",(function(e){return e||function(e,t){var n=j(this,e,"startsWith"),i=n.length,r=e.length;t=Math.max(0,Math.min(0|t,n.length));for(var a=0;a<r&&t<i;)if(n[t++]!=e[a++])return!1;return a>=r}})),u("Object.entries",(function(e){return e||function(e){var t,n=[];for(t in e)L(e,t)&&n.push([t,e[t]]);return n}}));var U="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)L(i,r)&&(e[r]=i[r])}return e};u("Object.assign",(function(e){return e||U})),u("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}})),u("Array.prototype.entries",(function(e){return e||function(){return O(this,(function(e,t){return[e,t]}))}})),u("Number.isNaN",(function(e){return e||function(e){return"number"==typeof e&&isNaN(e)}})),u("String.prototype.repeat",(function(e){return e||function(e){var t=j(this,null,"repeat");if(e<0||e>1342177279)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n}})),u("Number.EPSILON",(function(){return 2220446049250313e-31})),u("Number.MAX_SAFE_INTEGER",(function(){return 9007199254740991})),u("Number.isFinite",(function(e){return e||function(e){return"number"==typeof e&&(!isNaN(e)&&e!==1/0&&e!==-1/0)}})),u("Object.values",(function(e){return e||function(e){var t,n=[];for(t in e)L(e,t)&&n.push(e[t]);return n}})),u("Math.log2",(function(e){return e||function(e){return Math.log(e)/Math.LN2}})),u("String.prototype.endsWith",(function(e){return e||function(e,t){var n=j(this,e,"endsWith");void 0===t&&(t=n.length),t=Math.max(0,Math.min(0|t,n.length));for(var i=e.length;i>0&&t>0;)if(n[--t]!=e[--i])return!1;return i<=0}})),u("Math.trunc",(function(e){return e||function(e){if(e=Number(e),isNaN(e)||e===1/0||e===-1/0||0===e)return e;var t=Math.floor(Math.abs(e));return e<0?-t:t}}));var F=this||self;function B(e,t){e=e.split(".");var n,i=F;e[0]in i||void 0===i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=t}function H(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}function V(e){return e.h/(1-Math.pow(e.g,e.i))}function q(){this.h=new H(2),this.j=new H(5),this.g=0,this.i=128e3,this.l=16e3}function G(){}function z(){}function $(){}function K(e){var t=D.apply(1,arguments);X.has(e)||(X.add(e),$.apply(G,g(t)))}function W(){}H.prototype.sample=function(e,t){var n=Math.pow(this.g,e);t=t*(1-n)+n*this.h,isNaN(t)||(this.h=t,this.i+=e)},q.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},q.prototype.sample=function(e,t){if(!(t<this.l)){var n=8e3*t/e;e/=1e3,this.g+=t,this.h.sample(e,n),this.j.sample(e,n)}},q.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(V(this.h),V(this.j))};var X=new Set;function Y(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function J(e,t){(t=e.indexOf(t))>-1&&e.splice(t,1)}function Q(e,t,n){if(n||(n=Y),e.length!=t.length)return!1;t=t.slice();for(var i=(e=p(e)).next(),r={};!i.done;r={mi:void 0},i=e.next()){if(r.mi=i.value,-1==(i=t.findIndex(function(e){return function(t){return n(e.mi,t)}}(r))))return!1;t[i]=t[t.length-1],t.pop()}return 0==t.length}function Z(e,t,n){if(e===t)return!0;if(!e||!t)return e==t;if(n||(n=Y),e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0}function ee(){this.g=new Map}function te(){this.g=new ee}function ne(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.g=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter((function(e){return!n.has(e)})),function(e){var t=ie;if(null==t){t=!1;try{var n={},i={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(e){t=!1}ie=t}return t||!1}(e)?t:t.capture||!1}(e,i),this.target.addEventListener(t,n,this.g)}e.console&&((new Map).set(1,(function(){return console.error.apply(console,g(D.apply(0,arguments)))})).set(2,(function(){return console.warn.apply(console,g(D.apply(0,arguments)))})).set(3,(function(){return console.info.apply(console,g(D.apply(0,arguments)))})).set(4,(function(){return console.log.apply(console,g(D.apply(0,arguments)))})).set(5,(function(){return console.debug.apply(console,g(D.apply(0,arguments)))})).set(6,(function(){return console.debug.apply(console,g(D.apply(0,arguments)))})),$=function(){return console.warn.apply(console,g(D.apply(0,arguments)))},z=function(){console.error.apply(console,g(D.apply(0,arguments)))}),(i=ee.prototype).push=function(e,t){this.g.has(e)?this.g.get(e).push(t):this.g.set(e,[t])},i.get=function(e){return this.g.has(e)?this.g.get(e).slice():null},i.remove=function(e,t){if(this.g.has(e)){var n=this.g.get(e).filter((function(e){return e!=t}));this.g.set(e,n),n.length||this.g.delete(e)}},i.forEach=function(e){this.g.forEach((function(t,n){e(n,t)}))},i.size=function(){return this.g.size},i.keys=function(){return Array.from(this.g.keys())},(i=te.prototype).release=function(){this.Pa(),this.g=null},i.D=function(e,t,n,i){this.g&&(e=new ne(e,t,n,i),this.g.push(t,e))},i.Ba=function(e,t,n,i){var r=this;this.D(e,t,(function i(a){r.Ma(e,t,i),n(a)}),i)},i.Ma=function(e,t,n){if(this.g)for(var i=this.g.get(t)||[],r=(i=p(i)).next();!r.done;r=i.next())(r=r.value).target!=e||n!=r.listener&&n||(r.Ma(),this.g.remove(t,r))},i.Pa=function(){if(this.g){for(var e=[],t=p(this.g.g.values()),n=t.next();!n.done;n=t.next())e.push.apply(e,g(n.value));for(t=(e=p(e)).next();!t.done;t=e.next())t.value.Ma();this.g.g.clear()}},B("shaka.util.EventManager",te),te.prototype.removeAll=te.prototype.Pa,te.prototype.unlisten=te.prototype.Ma,te.prototype.listenOnce=te.prototype.Ba,te.prototype.listen=te.prototype.D,te.prototype.release=te.prototype.release,ne.prototype.Ma=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};var ie=void 0;function re(e){this.h=e,this.g=void 0}function ae(){return ue.value()}B("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3}),re.prototype.value=function(){return void 0===this.g&&(this.g=this.h()),this.g};var oe=null,se=null,ue=new re((function(){var e=void 0;return oe&&(e=oe()),!e&&se&&(e=se()),e}));function le(e,t){this.g=e,this.h=t}function ce(e,t){var n=new le(5,0),i=fe,r=i.g,a=n.h-r.h;((n.g-r.g||a)>0?i.i:i.h)(i.g,n,e,t)}function de(e,t,n,i){$([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",i].join(" "))}function he(e,t,n,i){z([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",i].join(" "))}le.prototype.toString=function(){return"v"+this.g+"."+this.h};var fe=null,pe=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function ge(e){var t;e instanceof ge?(me(this,e.bc),this.hd=e.hd,ve(this,e.Db),ye(this,e.Cd),this.Sb=e.Sb,be(this,e.g.clone()),this.Rc=e.Rc):e&&(t=String(e).match(pe))?(me(this,t[1]||"",!0),this.hd=we(t[2]||""),ve(this,t[3]||"",!0),ye(this,t[4]),this.Sb=we(t[5]||"",!0),be(this,t[6]||"",!0),this.Rc=we(t[7]||"")):this.g=new Ie(null)}function me(e,t,n){e.bc=n?we(t,!0):t,e.bc&&(e.bc=e.bc.replace(/:$/,""))}function ve(e,t,n){e.Db=n?we(t,!0):t}function ye(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.Cd=t}else e.Cd=null}function be(e,t,n){t instanceof Ie?e.g=t:(n||(t=_e(t,Ae)),e.g=new Ie(t))}function we(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function _e(e,t,n){return null!=e?(e=encodeURI(e).replace(t,Se),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Se(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(i=ge.prototype).bc="",i.hd="",i.Db="",i.Cd=null,i.Sb="",i.Rc="",i.toString=function(){var e=[],t=this.bc;if(t&&e.push(_e(t,Te,!0),":"),t=this.Db){e.push("//");var n=this.hd;n&&e.push(_e(n,Te,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.Cd)&&e.push(":",String(t))}return(t=this.Sb)&&(this.Db&&"/"!=t.charAt(0)&&e.push("/"),e.push(_e(t,"/"==t.charAt(0)?ke:xe,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.Rc)&&e.push("#",_e(t,Ee)),e.join("")},i.resolve=function(e){var t=this.clone();"data"===t.bc&&(t=new ge);var n=!!e.bc;n?me(t,e.bc):n=!!e.hd,n?t.hd=e.hd:n=!!e.Db,n?ve(t,e.Db):n=null!=e.Cd;var i=e.Sb;if(n)ye(t,e.Cd);else if(n=!!e.Sb){if("/"!=i.charAt(0))if(this.Db&&!this.Sb)i="/"+i;else{var r=t.Sb.lastIndexOf("/");-1!=r&&(i=t.Sb.substr(0,r+1)+i)}if(".."==i||"."==i)i="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var a=[],o=0;o<i.length;){var s=i[o++];"."==s?r&&o==i.length&&a.push(""):".."==s?((a.length>1||1==a.length&&""!=a[0])&&a.pop(),r&&o==i.length&&a.push("")):(a.push(s),r=!0)}i=a.join("/")}}return n?t.Sb=i:n=""!==e.g.toString(),n?be(t,e.g.clone()):n=!!e.Rc,n&&(t.Rc=e.Rc),t},i.clone=function(){return new ge(this)};var Te=/[#\/\?@]/g,xe=/[#\?:]/g,ke=/[#\?]/g,Ae=/[#\?@]/g,Ee=/#/g;function Ie(e){this.g=e||null}function Ce(e){if(!e.eb&&(e.eb=new Map,e.Sd=0,e.g))for(var t=e.g.split("&"),n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(i>=0){var a=t[n].substring(0,i);r=t[n].substring(i+1)}else a=t[n];a=decodeURIComponent(a),r=r||"",e.add(a,decodeURIComponent(r))}}function Me(e){return Ce(e),e.Sd}function Pe(){}function Re(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if((ArrayBuffer.isView(e)?e.buffer:e)==(ArrayBuffer.isView(t)?t.buffer:t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;var n=Le(e);t=Le(t);for(var i=0;i<e.byteLength;i++)if(n[i]!=t[i])return!1;return!0}function De(e){return ArrayBuffer.isView(e)?0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer:e}function Le(e,t,n){return je(e,void 0===t?0:t,n=void 0===n?1/0:n,Uint8Array)}function Ne(e,t,n){return je(e,void 0===t?0:t,n=void 0===n?1/0:n,Uint16Array)}function Oe(e,t,n){return je(e,void 0===t?0:t,n=void 0===n?1/0:n,DataView)}function je(e,t,n,i){var r=ArrayBuffer.isView(e)?e.buffer:e,a=1;"BYTES_PER_ELEMENT"in i&&(a=i.BYTES_PER_ELEMENT);var o=((e.byteOffset||0)+e.byteLength)/a;return new i(r,e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/a,o))),Math.floor(Math.min(e+Math.max(n,0),o))-e)}function Ue(e,t,n){var i=D.apply(3,arguments);if(this.severity=e,this.category=t,this.code=n,this.data=i,this.handled=!1,this.message="Shaka Error "+this.code,Fe)try{throw Error(this.message||"Shaka Error")}catch(e){this.stack=e.stack}}(i=Ie.prototype).eb=null,i.Sd=null,i.add=function(e,t){Ce(this),this.g=null;var n=this.eb.has(e)?this.eb.get(e):null;return n||this.eb.set(e,n=[]),n.push(t),this.Sd++,this},i.set=function(e,t){return Ce(this),this.g=null,this.eb.has(e)?this.eb.set(e,[t]):this.add(e,t),this},i.get=function(e){return Ce(this),this.eb.get(e)||[]},i.toString=function(){if(this.g)return this.g;if(!this.eb||!this.eb.size)return"";for(var e=[],t=p(this.eb.keys()),n=t.next();!n.done;n=t.next()){var i=n.value;n=encodeURIComponent(i),i=this.eb.get(i);for(var r=0;r<i.length;r++){var a=n;""!==i[r]&&(a+="="+encodeURIComponent(i[r])),e.push(a)}}return this.g=e.join("&")},i.clone=function(){var e=new Ie;if(e.g=this.g,this.eb){for(var t=new Map,n=p(this.eb),i=n.next();!i.done;i=n.next()){var r=p(i.value);i=r.next().value,r=r.next().value,t.set(i,r.concat())}e.eb=t,e.Sd=this.Sd}return e},B("shaka.util.BufferUtils",Pe),Pe.toDataView=Oe,Pe.toUint16=Ne,Pe.toUint8=Le,Pe.toArrayBuffer=De,Pe.equal=Re,Ue.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},B("shaka.util.Error",Ue);var Fe=!0;function Be(){}function He(t){if(!t)return"";if(239==(t=Le(t))[0]&&187==t[1]&&191==t[2]&&(t=t.subarray(3)),e.TextDecoder&&!ae().rh())return(t=(new TextDecoder).decode(t)).includes("�")&&z('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),t;for(var n="",i=0;i<t.length;++i){var r=65533;if(128&t[i]?t.length>=i+2&&192==(224&t[i])&&128==(192&t[i+1])?(r=(31&t[i])<<6|63&t[i+1],i+=1):t.length>=i+3&&224==(240&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])?(r=(15&t[i])<<12|(63&t[i+1])<<6|63&t[i+2],i+=2):t.length>=i+4&&240==(241&t[i])&&128==(192&t[i+1])&&128==(192&t[i+2])&&128==(192&t[i+3])&&(r=(7&t[i])<<18|(63&t[i+1])<<12|(63&t[i+2])<<6|63&t[i+3],i+=3):r=t[i],r<=65535)n+=String.fromCharCode(r);else{var a=1023&(r-=65536);n+=String.fromCharCode(55296+(r>>10)),n+=String.fromCharCode(56320+a)}}return n}function Ve(e,t,n){if(!e)return"";if(!n&&e.byteLength%2!=0)throw new Ue(2,2,2004);n=Math.floor(e.byteLength/2);var i=new Uint16Array(n);e=Oe(e);for(var r=0;r<n;r++)i[r]=e.getUint16(2*r,t);return $e(i)}function qe(e){function t(e){return n.byteLength<=e||n[e]>=9&&n[e]<=126}if(!e)return"";var n=Le(e);if(239==n[0]&&187==n[1]&&191==n[2])return He(n);if(254==n[0]&&255==n[1])return Ve(n.subarray(2),!1);if(255==n[0]&&254==n[1])return Ve(n.subarray(2),!0);if(0==n[0]&&0==n[2])return Ve(e,!1);if(0==n[1]&&0==n[3])return Ve(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return He(e);throw new Ue(2,2,2003)}function Ge(t){if(e.TextEncoder&&!ae().rh()){var n=new TextEncoder;return De(n.encode(t))}t=encodeURIComponent(t),t=unescape(t),n=new Uint8Array(t.length);for(var i=0;i<t.length;i++)n[i]=t[i].charCodeAt(0);return De(n)}function ze(e,t){for(var n=new ArrayBuffer(2*e.length),i=new DataView(n),r=0;r<e.length;++r)i.setUint16(2*r,e.charCodeAt(r),t);return n}function $e(e){return We.value()(e)}function Ke(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&nbsp;":" ","&lrm;":"‎","&rlm;":"‏"},n=/&(?:amp|lt|gt|quot|apos|nbsp|lrm|rlm|#[xX]?[0-9a-fA-F]+);/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,(function(e){return"#"==e[1]?(e="x"==e[2]||"X"==e[2]?parseInt(e.substring(3),16):parseInt(e.substring(2),10))>=0&&e<=1114111?String.fromCodePoint(e):"":t[e]||"'"})):e||""}Ue.Severity={RECOVERABLE:1,CRITICAL:2},Ue.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},Ue.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,STREAMING_NOT_ALLOWED:3024,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,DASH_INVALID_PATCH:4052,HLS_EMPTY_MEDIA_PLAYLIST:4053,DASH_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4054,CANNOT_ADD_EXTERNAL_CHAPTERS_TO_LIVE_STREAM:4055,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,MISSING_EME_SUPPORT:6020,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,SRC_EQUALS_PRELOAD_NOT_SUPPORTED:7005,PRELOAD_DESTROYED:7006,QUEUE_INDEX_OUT_OF_BOUNDS:7007,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005,INTERSTITIAL_AD_MANAGER_NOT_INITIALIZED:10006,VAST_INVALID_XML:10007},B("shaka.util.StringUtils",Be),Be.resetFromCharCode=function(){We.g=void 0},Be.toUTF16=ze,Be.toUTF8=Ge,Be.fromBytesAutoDetect=qe,Be.fromUTF16=Ve,Be.fromUTF8=He;var We=new re((function(){function e(e){try{var t=new Uint8Array(e);return String.fromCharCode.apply(null,t).length>0}catch(e){return!1}}for(var t={Oc:65536};t.Oc>0;(t={Oc:t.Oc}).Oc/=2)if(e(t.Oc))return function(e){return function(t){for(var n="",i=0;i<t.length;i+=e.Oc)n+=String.fromCharCode.apply(null,t.subarray(i,i+e.Oc));return n}}(t);return null}));function Xe(){}function Ye(e){return e=$e(Le(e)),btoa(e)}function Je(e,t){return t=null==t||t,e=Ye(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")}function Qe(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}function Ze(t){for(var n=t.length/2,i=new Uint8Array(n),r=0;r<n;r++)i[r]=e.parseInt(t.substr(2*r,2),16);return i}function et(e){var t=Le(e);e="";for(var n=(t=p(t)).next();!n.done;n=t.next())1==(n=(n=n.value).toString(16)).length&&(n="0"+n),e+=n;return e}function tt(){for(var e=D.apply(0,arguments),t=0,n=0;n<e.length;++n)t+=e[n].byteLength;t=new Uint8Array(t);for(var i=n=0;i<e.length;++i){var r=e[i];ArrayBuffer.isView(r)&&1===r.BYTES_PER_ELEMENT?t.set(r,n):t.set(Le(r),n),n+=r.byteLength}return t}function nt(e,t,n){if(n=void 0===n?"":n,0==t.length)return e;if(1==e.length&&1==t.length){var i=new ge(e[0]);return t=new ge(t[0]),t=i.resolve(t),n&&be(t,n),[t.toString()]}t=t.map((function(e){return new ge(e)})),i=[];for(var r=(e=p(e)).next();!r.done;r=e.next()){r=new ge(r.value);for(var a=p(t),o=a.next();!o.done;o=a.next())o=r.resolve(o.value),n&&be(o,n),i.push(o.toString())}return i}function it(e,t,n,i){return e={keySystem:e,encryptionScheme:t,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:n||[],keyIds:new Set},i&&(e.keySystemUris=new Set([i])),e}function rt(t,n){n=void 0===n?"cenc":n;var i=[],r=[],a=[];t.forEach((function(e,t){var n=t;22!=n.length&&(n=Je(Ze(t),!1));var o=e;22!=o.length&&(o=Je(Ze(e),!1)),e={kty:"oct",kid:n,k:o},i.push(e),r.push(e.kid),a.push(t)})),t=JSON.stringify({keys:i});var o=JSON.stringify({kids:r});return o=[{initData:Le(Ge(o)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",encryptionScheme:n,licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:o,keyIds:new Set(a)}}function at(e,t){if(1==t.length)return t[0];if(null!=(e=ot(e,t)))return e;throw new Ue(2,4,4025,t)}function ot(e,t){for(var n=dt.get(e),i=(n=p(n)).next();!i.done;i=n.next()){i=i.value;for(var r=p(t),a=r.next();!a.done;a=r.next())if(a=a.value,i.test(a.trim()))return a.trim()}return e==ut?"":null}function st(e,t){for(var n=[],i=(e=p(e=dt.get(e))).next();!i.done;i=e.next()){i=i.value;for(var r=p(t),a=r.next();!a.done;a=r.next())a=a.value,i.test(a.trim())&&n.push(a.trim())}return n}B("shaka.util.Uint8ArrayUtils",Xe),Xe.concat=tt,Xe.toHex=et,Xe.fromHex=Ze,Xe.fromBase64=Qe,Xe.toBase64=Je,Xe.toStandardBase64=Ye;var ut="text",lt={Aa:"video",ka:"audio",Na:ut,Uf:"image",ol:"application"},ct=1/15,dt=(new Map).set("audio",[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4/,/^dts[cex]$/,/^iamf/,/^mhm[12]/,/^ac3$/,/^eac3$/,/^apac$/]).set("video",[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/,/^dva/,/^dav/]).set("text",[/^vtt$/,/^wvtt/,/^stpp/]);function ht(e,t,n,i){this.g=null,this.l=e,this.i=t,this.m=n,this.o=i,this.j=!1;e:{if("undefined"==typeof libDPIModule&&$("Could not find LCEVC Library dependencies on this page"),"undefined"!=typeof LCEVCdec)this.h=LCEVCdec;else{if("undefined"==typeof LcevcDil){$("Could not find LCEVC Library on this page"),e=!1;break e}this.h=LcevcDil,this.j=!0,ce("LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead")}void 0===this.h.SupportObject?($("Could not find LCEVC Library on this page"),e=!1):(this.h.SupportObject.SupportStatus||$(this.h.SupportObject.SupportError),e=void 0!==this.h&&"undefined"!=typeof libDPIModule&&this.i instanceof HTMLCanvasElement&&this.h.SupportObject.SupportStatus)}e&&!this.g&&this.h.SupportObject.webGLSupport(this.i)&&(this.i.classList.remove("shaka-hidden"),this.g=this.j?new this.h.LcevcDil(this.l,this.i,this.m):new this.h.LCEVCdec(this.l,this.i,this.m))}function ft(e,t,n,i){"video"!==i.type||e.o&&!i.baseOriginalId||e.g&&e.g.appendBuffer(t,"video",i.id,-n,!e.o)}function pt(e){e.g&&e.i.classList.add("shaka-hidden")}function gt(e){return!(!e||"undefined"==typeof LCEVCdec)&&"lvc1"==e.codecs}function mt(t){if(bt.has(t))return bt.get(t);var n=e.ManagedMediaSource||e.MediaSource;return!!n&&(n=n.isTypeSupported(t),bt.set(t,n),n)}function vt(){var t=e.ManagedSourceBuffer||e.SourceBuffer;return!!t&&!!t.prototype&&!!t.prototype.changeType}function yt(){var t=e.ManagedMediaSource||e.MediaSource;return!(!t||!t.prototype)&&(!!t.prototype.setLiveSeekableRange&&!!t.prototype.clearLiveSeekableRange)}ht.prototype.release=function(){this.g&&(this.g.close(),this.g=null)},B("shaka.lcevc.Dec",ht),ht.prototype.release=ht.prototype.release;var bt=new Map;function wt(){}function _t(){}function St(){}function Tt(e){this.h=new Map,this.i=0,this.j=new _t,(e=kt(e.toLowerCase()))&&(this.j=e()),this.g=new wt,(e=Et)&&(this.g=e(),this.h.set(this.i,this.g))}function xt(e,t){At.set(e,t)}function kt(e){return At.get(e)}wt.prototype.extract=function(){},wt.prototype.decode=function(){return[]},wt.prototype.clear=function(){},wt.prototype.getStreams=function(){return[]},_t.prototype.init=function(){},_t.prototype.parse=function(){return[]},(i=St.prototype).init=function(){},i.xf=function(){},i.Nd=function(){},i.remove=function(){},i.Vf=function(){},B("shaka.media.IClosedCaptionParser",St),(i=Tt.prototype).init=function(e,t,n){if(t=void 0!==t&&t,-1!=(n=void 0===n?-1:n)&&this.i!=n){t=n;var i=this.h.get(t);this.h.set(this.i,this.g),i?this.g=i:((i=Et)&&(this.g=i()),this.h.set(t,this.g))}else t||this.Nd();this.j.init(e),-1!=n&&(this.i=n)},i.xf=function(e){for(var t=(e=p(e=this.j.parse(e))).next();!t.done;t=e.next()){var n=Le((t=t.value).packet);n.length>0&&this.g.extract(n,t.pts)}return this.g.decode()},i.Nd=function(){this.g.clear()},i.remove=function(e){e=void 0===e?[]:e,e=new Set(e);for(var t=p(this.h.keys()),n=t.next();!n.done;n=t.next())if(n=n.value,!e.has(n)){var i=this.h.get(n);i&&i.clear(),this.h.delete(n)}},i.Vf=function(){return this.g.getStreams()},B("shaka.media.ClosedCaptionParser",Tt),Tt.findDecoder=function(){return Et},Tt.unregisterDecoder=function(){Et=null},Tt.registerDecoder=function(e){Et=e},Tt.findParser=kt,Tt.unregisterParser=function(e){At.delete(e)},Tt.registerParser=xt;var At=new Map,Et=null;function It(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Ct,this.scroll=Mt}B("shaka.text.CueRegion",It);var Ct=1;It.units={PX:0,PERCENTAGE:Ct,LINES:2};var Mt="";function Pt(e){this.h=e||"",this.g=0}function Rt(e){Dt(e,/[ \t]+/gm)}function Dt(e,t){return t.lastIndex=e.g,t=null==(t=t.exec(e.h))?null:{position:t.index,length:t[0].length,results:t},e.g==e.h.length||null==t||t.position!=e.g?null:(e.g+=t.length,t.results)}function Lt(e){return e.g==e.h.length?null:(e=Dt(e,/[^ \t\n]*/gm))?e[0]:null}function Nt(e){if(null==(e=Dt(e,jt)))return null;var t=Number(e[2]),n=Number(e[3]);return t>59||n>59?null:(Number(e[6])||0)/1e3+n+60*t+3600*(Number(e[1])||0)}function Ot(e){return e?Nt(new Pt(e)):null}It.scrollMode={NONE:Mt,UP:"up"};var jt=/(?:(\d{1,}):)?(\d{2}):(\d{2})((\.(\d{1,3})))?/g;function Ut(){}function Ft(e){var t=new WeakSet;return function e(n){switch(typeof n){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return n;default:if(!n||ArrayBuffer.isView(n))return n;if(t.has(n))return null;var i=Array.isArray(n);if(n.constructor!=Object&&!i)return null;t.add(n);var r,a=i?[]:{};for(r in n)a[r]=e(n[r]);return i&&(a.length=n.length),a}}(e)}function Bt(e){var t,n={};for(t in e)n[t]=e[t];return n}function Ht(e){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++){var i=n.toString(),r=e[n];void 0!==r&&(r=Ht(r))&&t.push(i+":"+r)}e="["+t.join(",")+"]"}else if("function"==typeof e)e="";else if(e instanceof Object){for((n=Object.keys(e)).sort(),t=[],i=(n=p(n)).next();!i.done;i=n.next())r=i.value,i=JSON.stringify(r),void 0!==(r=e[r])&&(r=Ht(r))&&t.push(i+":"+r);e="{"+t.join(",")+"}"}else e=JSON.stringify(e);return e}function Vt(e,t){var n=void 0!==n&&n;return qt(e=qe(e),t,n)}function qt(e,t,n){return e=function(e,t){function n(a,o){o=void 0!==o&&o;for(var s=[];e[r];)if(60==e.charCodeAt(r)){if(47===e.charCodeAt(r+1)){o=r+2,r=e.indexOf(">",r);var u=(o=e.substring(o,r)).indexOf(a);if(-1==u){var l=a.indexOf(".");l>0&&(u=o.indexOf(a.substring(0,l)))}if(-1==u)throw a=e.substring(0,r).split("\n"),Error("Unexpected close tag\nLine: "+(a.length-1)+"\nColumn: "+(a[a.length-1].length+1)+"\nChar: "+e[r]);r+1&&(r+=1);break}if(33===e.charCodeAt(r+1)){if(45==e.charCodeAt(r+2)){for(;-1!==r&&(62!==e.charCodeAt(r)||45!=e.charCodeAt(r-1)||45!=e.charCodeAt(r-2)||-1==r);)r=e.indexOf(">",r+1);-1===r&&(r=e.length)}else if(91===e.charCodeAt(r+2)&&91===e.charCodeAt(r+8)&&"cdata"===e.substr(r+3,5).toLowerCase()){-1==(u=e.indexOf("]]>",r))?(s.push(e.substr(r+9)),r=e.length):(s.push(e.substring(r+9,u)),r=u+3);continue}r++;continue}e:{l=o,r++;var c=i(),d={};for(u=[];62!==e.charCodeAt(r)&&e[r];){var h=e.charCodeAt(r);if(h>64&&h<91||h>96&&h<123){h=i();for(var f=e.charCodeAt(r);f&&39!==f&&34!==f&&!(f>64&&f<91||f>96&&f<123)&&62!==f;)r++,f=e.charCodeAt(r);var p=r+1;if(r=e.indexOf(e[r],p),p=e.slice(p,r),39===f||34===f){if(-1===r){if(l={tagName:c,attributes:d,children:u,parent:null},t)for(c=0;c<u.length;c++)"string"!=typeof u[c]&&(u[c].parent=l);u=l;break e}}else p=null,r--;if(h.startsWith("xmlns:")){f=p;var m=h.split(":")[1];bn.set(f,m),wn.set(m,f)}"tt"===c&&"xml:space"===h&&"preserve"===p&&(l=!0),d[h]=p}r++}for(47!==e.charCodeAt(r-1)?(r++,u=n(c,l)):r++,l={tagName:c,attributes:d,children:u,parent:null},c=u.length,d=0;d<c;d++)"string"!=typeof(h=u[d])?t&&(h.parent=l):d==c-1&&"\n"==h&&u.pop();u=l}if(s.push(u),"string"==typeof u)break;"?"===u.tagName[0]&&u.children&&(s.push.apply(s,g(u.children)),u.children=[])}else u=r,-2===(r=e.indexOf("<",r)-1)&&(r=e.length),u=e.slice(u,r+1),o?u.length>0&&s.push(u):(s.length&&1==u.length&&"\n"==u[0]||u.trim().length>0)&&s.push(u),r++;return s}function i(){for(var t=r;-1==="\r\n\t>/= ".indexOf(e[r])&&e[r];)r++;return e.slice(t,r)}var r=0;return n("")}(e,void 0!==n&&n),!t&&e.length?e[0]:(e=e.find((function(e){return t.split(",").includes(e.tagName)})))?e:null}function Gt(e){return bn.has(e)?bn.get(e):""}function zt(e){return"string"==typeof e}function $t(e){var t=[];if(!e.children)return[];for(var n=(e=p(e.children)).next();!n.done;n=e.next())"string"!=typeof(n=n.value)&&t.push(n);return t}function Kt(e,t){var n=[];if(!e.children)return[];for(var i=(e=p(e.children)).next();!i.done;i=e.next())(i=i.value).tagName===t&&n.push(i);return n}function Wt(e){return"string"==typeof e?Ke(e):""===(e=e.children.reduce((function(e,t){return"string"==typeof t?e+t:e}),""))?null:Ke(e)}function Xt(e){return Array.from(e.children).every((function(e){return"string"==typeof e}))?((e=Wt(e))&&(e=e.trim()),e):null}function Yt(e,t,n){if(n=void 0===n?[]:n,e.tagName===t&&n.push(e),e.children)for(var i=(e=p(e.children)).next();!i.done;i=e.next())Yt(i.value,t,n);return n}function Jt(e,t){return 1!=(e=Kt(e,t)).length?null:e[0]}function Qt(e,t,n){return 1!=(e=tn(e,t,n)).length?null:e[0]}function Zt(e,t,n,i){i=void 0===i?null:i;var r=null;return null!=(e=e.attributes[t])&&(r=n(e)),null==r?i:r}function en(e,t,n){return t=Gt(t),e.attributes[t+":"+n]||null}function tn(e,t,n){var i=Gt(t);if(t=[],e.children)for(n=i?i+":"+n:n,i=(e=p(e.children)).next();!i.done;i=e.next())(i=i.value)&&i.tagName===n&&t.push(i);return t}function nn(e,t,n){for(var i=(t=p(t)).next();!i.done;i=t.next())if(i=en(e,i.value,n))return i;return null}function rn(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function an(e){return e&&(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$","i").exec(e))?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null}function on(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null}function sn(e){return(e=Number(e))%1==0?e:null}function un(e){return(e=Number(e))%1==0&&e>0?e:null}function ln(e){return(e=Number(e))%1==0&&e>=0?e:null}function cn(e){return e=Number(e),isNaN(e)?null:e}function dn(e){return!!e&&"true"===e.toLowerCase()}function hn(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}function fn(e){for(var t=[],n=(e=p(e=Ke(e).split(/\/+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/))).next();!n.done;n=e.next()){var i=(n=n.value).match(/^([\w]+)/);if(i){var r=n.match(/(@id='(.*?)')/),a=n.match(/(@t='(\d+)')/),o=n.match(/(@n='(\d+)')/),s=n.match(/\[(\d+)\]/);t.push({name:i[0],id:r?r[0].match(/'(.*?)'/)[0].replace(/'/gm,""):null,t:a?Number(a[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,n:o?Number(o[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,position:s?Number(s[1])-1:null,Cc:n.split("/@")[1]||null})}else n.startsWith("@")&&t.length&&(t[t.length-1].Cc=n.slice(1))}return t}function pn(e,t){var n=fn(t.attributes.sel||"");if(n.length){var i=n[n.length-1],r=t.attributes.pos||null;null==(n=i.position)&&(null!==i.t&&(n=gn(e,"t",i.t)),null!==i.n&&(n=gn(e,"n",i.n))),null===n?n="prepend"===r?0:e.length:"prepend"===r?--n:"after"===r&&++n,r=t.tagName,(i=i.Cc)&&e[n]?mn(e[n],r,i,Xt(t)||""):("remove"!==r&&"replace"!==r||e.splice(n,1),"add"!==r&&"replace"!==r||e.splice.apply(e,[n,0].concat(g(t.children))))}}function gn(e,t,n){for(var i=0,r=(e=p(e)).next();!r.done;r=e.next()){if(Number(r.value.attributes[t])===n)return i;i++}return null}function mn(e,t,n,i){"remove"===t?delete e.attributes[n]:"add"!==t&&"replace"!==t||(e.attributes[n]=i)}function vn(e){var t="",n=e.tagName.split(":");for(var i in n.length>0&&(t=n[0],t=wn.has(t)?wn.get(t):""),t=document.createElementNS(t,e.tagName),e.attributes)t.setAttribute(i,e.attributes[i]);for(i=(e=p(e.children)).next();!i.done;i=e.next())n=void 0,n="string"==typeof(i=i.value)?new Text(i):vn(i),t.appendChild(n);return t}function yn(e){if(!e)return null;for(var t={tagName:e.tagName,attributes:Bt(e.attributes),children:[],parent:null},n=(e=p(e.children)).next();!n.done;n=e.next())"string"==typeof(n=n.value)||((n=yn(n)).parent=t),t.children.push(n);return t}B("shaka.util.ObjectUtils",Ut),Ut.alphabeticalKeyOrderStringify=Ht,Ut.shallowCloneObject=Bt,Ut.cloneObject=Ft;var bn=new Map,wn=new Map;function _n(e,t,n){this.startTime=e,this.endTime=t,this.payload=n,this.region=new It,this.position=null,this.positionAlign=In,this.size=0,this.textAlign=Cn,this.direction=Dn,this.writingMode=Ln,this.lineInterpretation=Nn,this.line=null,this.lineHeight="",this.lineAlign=On,this.displayAlign=Pn,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=Bn,this.fontStyle=Vn,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={columns:32,rows:15}}function Sn(e,t){return(e=new _n(e,t,"")).lineBreak=!0,e}function Tn(e,t){if(e.payload!=t.payload||!(Math.abs(e.startTime-t.startTime)<.001&&Math.abs(e.endTime-t.endTime)<.001))return!1;for(var n in e)if("startTime"!=n&&"endTime"!=n&&"payload"!=n)if("nestedCues"==n){if(!Z(e.nestedCues,t.nestedCues,Tn))return!1}else if("region"==n||"cellResolution"==n){for(var i in e[n])if(e[n][i]!=t[n][i])return!1}else if(Array.isArray(e[n])){if(!Z(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}function xn(e,t){t=void 0===t?new Map:t;var n=e.payload;if(n.includes("<")){0===t.size&&kn(t);var i=n;n=[];for(var r=-1,a=0;a<i.length;a++)"<"===i[a]?r=a+1:">"===i[a]&&r>0&&((r=i.substr(r,a-r)).match($n)&&n.push(r),r=-1);for(a=(n=p(n)).next();!a.done;a=n.next())a=a.value,i=i.replace("<"+a+">",'<div time="'+a+'">'),i+="</div>";e:{a=i,r=[];var o=-1;n="",i=!1;for(var s=0;s<a.length;s++)if("/"===a[s]){var u=a.indexOf(">",s);if(-1===u){n=a;break e}if((u=a.substring(s+1,u))&&"v"==u){i=!0;var l=null;if(r.length&&(l=r[r.length-1]),l){if(l===u)n+="/"+u+">";else{if(!l.startsWith("v")){n+=a[s];continue}n+="/"+l+">"}s+=u.length+1}else n+=a[s]}else n+=a[s]}else"<"===a[s]?"v"!=a[o=s+1]&&(o=-1):">"===a[s]&&o>0&&(r.push(a.substr(o,s-o)),o=-1),n+=a[s];for(r=(a=p(r)).next();!r.done;r=a.next())o=(r=r.value).replace(" ",".voice-"),n=(n=n.replace("<"+r+">","<"+o+">")).replace("</"+r+">","</"+o+">"),i||(n+="</"+o+">")}n=function(e){var t={"< ":""," >":" &gt;"},n=/(< +>|<\s|\s>)/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,(function(e){return t[e]||""})):e||""}(n),e.payload="",i="<span>"+n.replace(/\n/g,"<br />")+"</span>";try{var c=qt(i,"span")}catch(e){}if(c)if(1!=(c=c.children).length||c[0].tagName)for(n=(c=p(c)).next();!n.done;n=c.next())An(n.value,e,t);else e.payload=Ke(n);else e.payload=Ke(n)}else e.payload=Ke(n)}function kn(e){for(var t=p(Object.entries(Un)),n=t.next();!n.done;n=t.next()){var i=p(n.value);n=i.next().value,i=i.next().value;var r=new _n(0,0,"");r.color=i,e.set("."+n,r)}for(n=(t=p(Object.entries(Fn))).next();!n.done;n=t.next())n=(i=p(n.value)).next().value,i=i.next().value,(r=new _n(0,0,"")).backgroundColor=i,e.set("."+n,r)}function An(e,t,n){var i=t.clone();if(i.nestedCues=[],i.payload="",i.rubyTag="",i.line=null,i.region=new It,i.position=null,i.size=0,i.textAlign=Cn,e.tagName)for(var r=p(e.tagName.split(/(?=[ .])+/g)),a=r.next();!a.done;a=r.next()){var o=a=a.value;if(o.startsWith(".voice-")){var s=o.split("-").pop();o='v[voice="'+s+'"]',n.has(o)||(o="v[voice="+s+"]")}switch(n.has(o)&&(s=i,o=n.get(o))&&(s.backgroundColor=En(o.backgroundColor,s.backgroundColor),s.color=En(o.color,s.color),s.fontFamily=En(o.fontFamily,s.fontFamily),s.fontSize=En(o.fontSize,s.fontSize),s.textShadow=En(o.textShadow,s.textShadow),s.fontWeight=o.fontWeight,s.fontStyle=o.fontStyle,s.opacity=o.opacity,s.rubyTag=o.rubyTag,s.textCombineUpright=o.textCombineUpright,s.wrapLine=o.wrapLine),a){case"br":return i=Sn(i.startTime,i.endTime),void t.nestedCues.push(i);case"b":i.fontWeight=Hn;break;case"i":i.fontStyle=qn;break;case"u":i.textDecoration.push(zn);break;case"font":(a=e.attributes.color)&&(i.color=a);break;case"div":if(!(a=e.attributes.time))break;(a=Ot(a))&&(i.startTime=a);break;case"ruby":case"rp":case"rt":i.rubyTag=a}}if(r=e.children,zt(e)||1==r.length&&zt(r[0]))for(n=Wt(e).split("\n"),e=!0,r=(n=p(n)).next();!r.done;r=n.next())r=r.value,e||(e=Sn(i.startTime,i.endTime),t.nestedCues.push(e)),r.length>0&&((e=i.clone()).payload=Ke(r),t.nestedCues.push(e)),e=!1;else for(t.nestedCues.push(i),e=(t=p(r)).next();!e.done;e=t.next())An(e.value,i,n)}function En(e,t){return e&&e.length>0?e:t}_n.prototype.clone=function(){var e,t=new _n(0,0,"");for(e in this)t[e]=this[e],Array.isArray(t[e])&&(t[e]=t[e].slice());return t},B("shaka.text.Cue",_n),_n.parseCuePayload=xn,_n.equal=Tn,_n.prototype.clone=_n.prototype.clone;var In="auto";_n.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:In};var Cn="center",Mn={LEFT:"left",RIGHT:"right",CENTER:Cn,START:"start",END:"end"};_n.textAlign=Mn;var Pn="after",Rn={BEFORE:"before",CENTER:"center",AFTER:Pn};_n.displayAlign=Rn;var Dn="ltr";_n.direction={HORIZONTAL_LEFT_TO_RIGHT:Dn,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var Ln="horizontal-tb";_n.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Ln,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var Nn=0;_n.lineInterpretation={LINE_NUMBER:Nn,PERCENTAGE:1};var On="start",jn={CENTER:"center",START:On,END:"end"};_n.lineAlign=jn;var Un={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"};_n.defaultTextColor=Un;var Fn={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"};_n.defaultTextBackgroundColor=Fn;var Bn=400,Hn=700;_n.fontWeight={NORMAL:Bn,BOLD:Hn};var Vn="normal",qn="italic",Gn={NORMAL:Vn,ITALIC:qn,OBLIQUE:"oblique"};_n.fontStyle=Gn;var zn="underline";_n.textDecoration={UNDERLINE:zn,LINE_THROUGH:"lineThrough",OVERLINE:"overline"};var $n=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;function Kn(){}function Wn(e,t,n){Yn.set(e.toLowerCase().split(";")[0]+"-"+n,{priority:n,yf:t})}function Xn(e,t){for(var n=e.toLowerCase().split(";")[0],i=p([ei,Zn,Qn,Jn]),r=i.next();!r.done;r=i.next())if(r=Yn.get(n+"-"+r.value)){var a=r.yf(),o=a.isSupported(e,t);if(a.destroy(),o)return r.yf}return null}Kn.prototype.destroy=function(){},B("shaka.transmuxer.TransmuxerEngine",Kn),Kn.findTransmuxer=Xn,Kn.unregisterTransmuxer=function(e,t){Yn.delete(e.toLowerCase().split(";")[0]+"-"+t)},Kn.registerTransmuxer=Wn,Kn.prototype.destroy=Kn.prototype.destroy;var Yn=new Map,Jn=1,Qn=2,Zn=3,ei=4;function ti(){}function ni(e,t){var n=e;return t&&!hi.includes(e)&&(n+='; codecs="'+t+'"'),n}function ii(e,t){return t&&(e+='; codecs="'+t+'"'),e}function ri(e,t,n){var i=ni(e,t);return Xn(t=ii(e,t))?(e=Xn(t))?(n=(e=e()).convertCodecs(n,t),e.destroy()):n=t:n="video/mp2t"!=e&&"audio"==n?i.replace("video","audio"):i,n}function ai(e){return e.split(";")[0].split("/")[1]}function oi(e){var t=di(e);switch(e=t[0].toLowerCase(),t=t[1].toLowerCase(),!0){case"mp4a"===e&&"69"===t:case"mp4a"===e&&"6b"===t:case"mp4a"===e&&"40.34"===t:return"mp3";case"mp4a"===e&&"66"===t:case"mp4a"===e&&"67"===t:case"mp4a"===e&&"68"===t:case"mp4a"===e&&"40.2"===t:case"mp4a"===e&&"40.02"===t:case"mp4a"===e&&"40.5"===t:case"mp4a"===e&&"40.05"===t:case"mp4a"===e&&"40.29"===t:case"mp4a"===e&&"40.42"===t:return"aac";case"mp4a"===e&&"a5"===t:case"ac3"===e:case"ac-3"===e:return"ac-3";case"mp4a"===e&&"a6"===t:case"eac3"===e:case"ec-3"===e:return"ec-3";case"ac-4"===e:return"ac-4";case"mp4a"===e&&"b2"===t:return"dtsx";case"mp4a"===e&&"a9"===t:return"dtsc";case"vp09"===e:case"vp9"===e:return"vp9";case"avc1"===e:case"avc3"===e:return"avc";case"hvc1"===e:case"hev1"===e:return"hevc";case"vvc1"===e:case"vvi1"===e:return"vvc";case"dvh1"===e:case"dvhe"===e:return t&&t.startsWith("05")?"dovi-p5":"dovi-hevc";case"dvav"===e:case"dva1"===e:return"dovi-avc";case"dav1"===e:return"dovi-av1";case"dvc1"===e:case"dvi1"===e:return"dovi-vvc"}return e}function si(e){for(var t=[],n=(e=p(e.split(","))).next();!n.done;n=e.next())n=di(n.value),t.push(n[0]);return t.sort().join(",")}function ui(e){return e.split(";")[0]}function li(e){return(e=e.split(/ *; */)).shift(),(e=e.find((function(e){return e.startsWith("codecs=")})))?e.split("=")[1].replace(/^"|"$/g,""):""}function ci(e){return"application/x-mpegurl"===e||"application/vnd.apple.mpegurl"===e}function di(e){var t=(e=e.split("."))[0];return e.shift(),[t,e.join(".")]}Kn.PluginPriority={FALLBACK:Jn,PREFERRED_SECONDARY:Qn,PREFERRED:Zn,APPLICATION:ei},B("shaka.util.MimeUtils",ti),ti.getFullTypeWithAllCodecs=ii,ti.getFullType=ni,(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");var hi=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function fi(e){this.i=null,this.l=e,this.C=!1,this.m=this.u=0,this.o=1/0,this.h=this.g=null,this.F="",this.B=function(){},this.j=new Map}function pi(e,t){wi.set(e,t)}function gi(e){return wi.get(e)}function mi(e){return!!wi.has(e)||("application/cea-608"==e||"application/cea-708"==e)&&!!Et}function vi(e,t,n){e.F=t,(t=e.j.get(t))&&((t=t.filter((function(e){return e.endTime<=n}))).length&&e.l.append(t))}function yi(e,t,n){t.startTime+=n,t.endTime+=n;for(var i=(t=p(t.nestedCues)).next();!i.done;i=t.next())yi(e,i.value,n)}function bi(e){for(var t=1/0,n=-1/0,i=p(e.j.values()),r=i.next();!r.done;r=i.next())for(var a=(r=p(r.value)).next();!a.done;a=r.next())a=a.value,t=Math.min(t,a.startTime),n=Math.max(n,a.endTime);t!==1/0&&n!==-1/0&&(e.g=null==e.g?Math.max(t,e.m):Math.min(e.g,Math.max(t,e.m)),e.h=Math.max(e.h,Math.min(n,e.o)))}fi.prototype.destroy=function(){return this.l=this.i=null,this.j.clear(),Promise.resolve()},fi.prototype.remove=function(e,t,n){n=void 0!==n&&n;var i=this;return R((function(r){return 1==r.g?w(r,Promise.resolve(),2):e>=t?r.return():(n&&function(e,t,n){for(var i=p(e.j.keys()),r=i.next();!r.done;r=i.next()){r=r.value;var a=e.j.get(r);a=a.filter((function(e){return e.startTime<t||e.endTime>=n})),e.j.set(r,a)}}(i,e,t),i.l&&i.l.remove(e,t)&&null!=i.g&&(t<=i.g||e>=i.h||(e<=i.g&&t>=i.h?i.g=i.h=null:e<=i.g&&t<i.h?i.g=t:e>i.g&&t>=i.h&&(i.h=e)),bi(i)),void _(r))}))},B("shaka.text.TextEngine",fi),fi.prototype.destroy=fi.prototype.destroy,fi.findParser=gi,fi.unregisterParser=function(e){wi.delete(e)},fi.registerParser=pi;var wi=new Map;function _i(e){this.h=e,this.g=null}function Si(e){this.h=e,this.g=null}function Ti(e,t){return e.concat(t)}function xi(){}function ki(e){return null!=e}function Ai(e,t){return Promise.race([t,new Promise((function(t,n){new Si(n).ia(e)}))])}function Ei(){}function Ii(e,t){return e=Pi(e),t=Pi(t),e.split("-")[0]==t.split("-")[0]}function Ci(e,t){return e=Pi(e),t=Pi(t),e=e.split("-"),t=t.split("-"),e[0]==t[0]&&1==e.length&&2==t.length}function Mi(e,t){return e=Pi(e),t=Pi(t),e=e.split("-"),t=t.split("-"),2==e.length&&2==t.length&&e[0]==t[0]}function Pi(e){var t=(e=p(e.split("-x-"))).next().value;t=void 0===t?"":t,e=void 0===(e=e.next().value)?"":e;var n=p(t.split("-"));return t=void 0===(t=n.next().value)?"":t,n=void 0===(n=n.next().value)?"":n,e=e?"x-"+e:"",t=t.toLowerCase(),t=Oi.get(t)||t,((n=n.toUpperCase())?t+"-"+n:t)+(e?"-"+e:"")}function Ri(e,t){return e=Pi(e),(t=Pi(t))==e?4:Ci(t,e)?3:Mi(t,e)?2:Ci(e,t)?1:0}function Di(e){var t=e.indexOf("-");return e=(e=t>=0?e.substring(0,t):e).toLowerCase(),Oi.get(e)||e}function Li(e){return e.language?Pi(e.language):e.audio&&e.audio.language?Pi(e.audio.language):e.video&&e.video.language?Pi(e.video.language):"und"}function Ni(e,t){e=Pi(e);for(var n=new Set,i=(t=p(t)).next();!i.done;i=t.next())n.add(Pi(i.value));for(i=(t=p(n)).next();!i.done;i=t.next())if((i=i.value)==e)return i;for(i=(t=p(n)).next();!i.done;i=t.next())if(Ci(i=i.value,e))return i;for(i=(t=p(n)).next();!i.done;i=t.next())if(Mi(i=i.value,e))return i;for(t=(n=p(n)).next();!t.done;t=n.next())if(Ci(e,t=t.value))return t;return null}_i.prototype.ia=function(t){var n=this;this.stop();var i=!0,r=null;return this.g=function(){e.clearTimeout(r),i=!1},r=e.setTimeout((function(){i&&n.h()}),1e3*t),this},_i.prototype.stop=function(){this.g&&(this.g(),this.g=null)},Si.prototype.Jb=function(){return this.stop(),this.h(),this},Si.prototype.ia=function(e){var t=this;return this.stop(),this.g=new _i((function(){t.h()})).ia(e),this},Si.prototype.Ea=function(e){var t=this;return this.stop(),this.g=new _i((function(){t.g.ia(e),t.h()})).ia(e),this},Si.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},B("shaka.util.Timer",Si),Si.prototype.stop=Si.prototype.stop,Si.prototype.tickEvery=Si.prototype.Ea,Si.prototype.tickAfter=Si.prototype.ia,Si.prototype.tickNow=Si.prototype.Jb,B("shaka.util.LanguageUtils",Ei),Ei.findClosestLocale=Ni,Ei.getLocaleForVariant=Li,Ei.getLocaleForText=function(e){return Pi(e.language||"und")},Ei.getBase=Di,Ei.relatedness=Ri,Ei.areSiblings=function(e,t){var n=Di(e),i=Di(t);return e!=n&&t!=i&&n==i},Ei.normalize=Pi,Ei.isSiblingOf=Mi,Ei.isParentOf=Ci,Ei.areLanguageCompatible=Ii,Ei.areLocaleCompatible=function(e,t){return(e=Pi(e))==(t=Pi(t))};var Oi=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function ji(){}function Ui(e,t,n,i,r){function a(e){var t=String(e.width||"")+String(e.height||"")+String(Math.round(e.frameRate||0))+(e.hdr||"")+e.fastSwitching;return e.dependencyStream&&(t+=e.dependencyStream.baseOriginalId||""),e.roles&&(t+=e.roles.sort().join("_")),t}if(r.length){for(var o=e.textStreams,s=(r=p(r)).next(),u={};!s.done;u={Bh:void 0},s=r.next())if(u.Bh=s.value,(s=o.filter(function(e){return function(t){return!(!t.codecs.startsWith(e.Bh)&&!t.mimeType.startsWith(e.Bh))}}(u))).length){o=s;break}e.textStreams=o}if(o=e.variants,(t.length||n.length)&&(o=function(e,t,n){for(var i=(t=p(t)).next(),r={};!i.done;r={videoCodec:void 0},i=t.next())if(r.videoCodec=i.value,i=e.filter(function(e){return function(t){return t.video&&t.video.codecs.startsWith(e.videoCodec)}}(r)),i.length){e=i;break}for(n=p(n),t=n.next(),i={};!t.done;i={audioCodec:void 0},t=n.next())if(i.audioCodec=t.value,t=e.filter(function(e){return function(t){return t.audio&&t.audio.codecs.startsWith(e.audioCodec)}}(i)),t.length){e=t;break}return e}(o,t,n)),i.length){for(t=new ee,o=(n=p(o)).next();!o.done;o=n.next())o=o.value,t.push(String(o.video.width||0),o);var l=[];t.forEach((function(e,t){e=0;for(var n=[],r=(t=p(t)).next(),a={};!r.done;a={Tf:void 0},r=t.next())a.Tf=r.value,(r=i.filter(function(e){return function(t){return e.Tf.decodingInfos[0][t]}}(a)).length)>e?(e=r,n=[a.Tf]):r==e&&n.push(a.Tf);l.push.apply(l,g(n))})),o=l}for(n=new Set,t=new Set,r=(o=p(o)).next();!r.done;r=o.next())(r=r.value).audio&&n.add(r.audio),r.video&&t.add(r.video);o=Array.from(n).sort((function(e,t){return e.bandwidth-t.bandwidth}));var c,d,h=[];for(n=new Map,r=(o=p(o)).next();!r.done;r=o.next()){if(r=r.value,d=void 0,d=(c=r).language+(c.channelsCount||0)+(c.audioSamplingRate||0)+c.roles.join(",")+c.label+c.groupId+c.fastSwitching,c.dependencyStream&&(d+=c.dependencyStream.baseOriginalId||""),s=d,(u=n.get(s)||[]).length){var f=u[u.length-1],m=oi(f.codecs),v=oi(r.codecs);m!=v||r.bandwidth&&f.bandwidth&&!(r.bandwidth>f.bandwidth)||(u.push(r),h.push(r.id))}else u.push(r),h.push(r.id);n.set(s,u)}var y={vp8:1,avc:1,"dovi-avc":.95,vp9:.9,vp09:.9,hevc:.85,"dovi-hevc":.8,"dovi-p5":.75,av01:.7,"dovi-av1":.65,vvc:.6};o=Array.from(t).sort((function(e,t){if(!e.bandwidth||!t.bandwidth||e.bandwidth==t.bandwidth){if(e.codecs&&t.codecs&&e.codecs!=t.codecs&&e.width==t.width){var n=oi(e.codecs),i=oi(t.codecs);if(n!=i)return(y[n]||1)-(y[i]||1)}return e.width-t.width}return e.bandwidth-t.bandwidth})),t=vt();var b=[];for(n=new Map,r=(o=p(o)).next();!r.done;r=o.next()){if(s=a(r=r.value),(u=n.get(s)||[]).length){if(f=u[u.length-1],!t&&(m=oi(f.codecs))!==(v=oi(r.codecs)))continue;(m=oi(f.codecs))!=(v=oi(r.codecs))||r.bandwidth&&f.bandwidth&&!(r.bandwidth>f.bandwidth)||(u.push(r),b.push(r.id))}else u.push(r),b.push(r.id);n.set(s,u)}e.variants=e.variants.filter((function(e){var t=e.audio;return e=e.video,!(t&&!h.includes(t.id)||e&&!b.includes(e.id))}))}function Fi(e,t,n){function i(e,t,n){return e>=t&&e<=n}var r=e.video;if(r&&r.width&&r.height){var a=r.width,o=r.height;if(o>a&&(a=(o=p([o,a])).next().value,o=o.next().value),!i(a,t.minWidth,Math.min(t.maxWidth,n.width))||!i(o,t.minHeight,Math.min(t.maxHeight,n.height))||!i(r.width*r.height,t.minPixels,t.maxPixels))return!1}return!(e&&e.video&&e.video.frameRate&&!i(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||e&&e.audio&&e.audio.channelsCount&&!i(e.audio.channelsCount,t.minChannelsCount,t.maxChannelsCount)||!i(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function Bi(e,t,n,i){return n=void 0===n?[]:n,i=void 0===i?{}:i,R((function(r){return 1==r.g?w(r,Hi(e,t,t.offlineSessionIds.length>0,n,i),2):(function(e){e.textStreams=e.textStreams.filter((function(e){return mi(e=ni(e.mimeType,e.codecs))}))}(t),w(r,function(e){var t,n,i,r,a,o,s;return R((function(u){switch(u.g){case 1:t=[],n=p(e.imageStreams),i=n.next();case 2:if(i.done){u.A(4);break}if(r=i.value,"application/mp4"==(a=r.mimeType)&&"mjpg"==r.codecs&&(a="image/jpg"),dr.has(a)){u.A(5);break}if(!(o=hr.get(a))){dr.set(a,!1),u.A(5);break}return w(u,function(e){return new Promise((function(t){var n=new Image;n.src=e,"decode"in n?n.decode().then((function(){t(!0)})).catch((function(){t(!1)})):n.onload=n.onerror=function(){t(2===n.height)}}))}(o),7);case 7:s=u.h,dr.set(a,s);case 5:dr.get(a)&&t.push(r),i=n.next(),u.A(2);break;case 4:e.imageStreams=t,_(u)}}))}(t),0))}))}function Hi(e,t,n,i,r){var a,o;return R((function(s){if(1==s.g)return ae().Ui()&&function(e){for(var t=(new Map).set("dvav","avc3").set("dva1","avc1").set("dvhe","hev1").set("dvh1","hvc1").set("dvc1","vvc1").set("dvi1","vvi1"),n=new Set,i=(e=p(e)).next();!i.done;i=e.next())(i=i.value).video&&n.add(i.video);for(n=p(n),e=n.next();!e.done;e=n.next()){e=e.value;for(var r=(i=p(t)).next();!r.done;r=i.next()){var a=p(r.value);if(r=a.next().value,a=a.next().value,e.codecs.includes(r)){e.codecs=e.codecs.replace(r,a);break}}}}(t.variants),w(s,Gi(t.variants,n,!1,i),2);a=null,e&&(o=e.g)&&(a=o.keySystem),t.variants=t.variants.filter((function(e){var t=function(e,t,n){if(!e.decodingInfos.some((function(e){return!(!e.supported||t&&(e=e.keySystemAccess)&&(n[e.keySystem]||e.keySystem)!=t)})))return!1;var i=ae(),r="Xbox"===i.Nb();i="MOBILE"===i.Ua()&&"GECKO"===i.Ha();var a=e.video,o=a&&a.width||0,s=a&&a.height||0;return!(r&&a&&(o>1920||s>1080)&&(a.codecs.includes("avc1.")||a.codecs.includes("avc3."))||(r=a&&a.dependencyStream)&&!gt(r))&&(e=e.audio,!(i&&e&&e.encrypted&&e.codecs.toLowerCase().includes("opus")||e&&e.dependencyStream))}(e,a,r);if(!t){var n=[];e.audio&&n.push(or(e.audio)),e.video&&n.push(or(e.video))}return t})),_(s)}))}function Vi(e,t){var n,i,r,a,o,s,u;return R((function(l){if(1==l.g){for(n=function(e,t){if(e){var n=Bt(e);return n.supported=e.supported&&t.supported,n.powerEfficient=e.powerEfficient&&t.powerEfficient,n.smooth=e.smooth&&t.smooth,t.keySystemAccess&&!n.keySystemAccess&&(n.keySystemAccess=t.keySystemAccess),n}return t},i=null,r=[],a=p(t),o=a.next(),s={};!o.done;s={cache:void 0,Pe:void 0},o=a.next())u=o.value,s.Pe=Ht(u),s.cache=lr,s.cache.has(s.Pe)?i=n(i,s.cache.get(s.Pe)):r.push(qi(u).then(function(e){return function(t){for(var r=null,a=(t=p(t||[])).next();!a.done;a=t.next())r=n(r,a.value);r&&(e.cache.set(e.Pe,r),i=n(i,r))}}(s)));return w(l,Promise.all(r),2)}i&&e.decodingInfos.push(i),_(l)}))}function qi(e){var t=[""];e.video&&(t=li(e.video.contentType).split(","));var n=[""];e.audio&&(n=li(e.audio.contentType).split(","));for(var i=[],r=(t=p(t)).next();!r.done;r=t.next()){r=r.value;for(var a=p(n),o=a.next(),s={};!o.done;s={Qc:void 0},o=a.next())o=o.value,s.Qc=Ft(e),e.video&&(s.Qc.video.contentType=ni(ui(s.Qc.video.contentType),r)),e.audio&&(s.Qc.audio.contentType=ni(ui(s.Qc.audio.contentType),o)),i.push(new Promise(function(e){return function(t,n){("MOBILE"==ae().Ua()?Ai(5,navigator.mediaCapabilities.decodingInfo(e.Qc)):navigator.mediaCapabilities.decodingInfo(e.Qc)).then((function(e){t(e)})).catch(n)}}(s)))}return Promise.all(i).catch((function(){return JSON.stringify(e),null}))}function Gi(e,t,n,i){var r,a,o,s,u,l,c,d,h,f,g,m,v,y,b,_,S,T;return R((function(x){switch(x.g){case 1:if(e.some((function(e){return e.decodingInfos.length})))return x.return();r=p(i),a=r.next(),o={};case 2:if(a.done){x.A(4);break}o.Ci=a.value,s=!1,u=p(e),l=u.next();case 5:if(l.done){x.A(7);break}c=l.value,d=zi(c,t,n).filter((k=o,function(e){return((e=e[0]).keySystemConfiguration&&e.keySystemConfiguration.keySystem)===k.Ci})),h=p(d),f=h.next();case 8:if(f.done){x.A(10);break}return g=f.value,w(x,Vi(c,g),9);case 9:f=h.next(),x.A(8);break;case 10:c.decodingInfos.some((function(e){return e.supported}))&&(s=!0),l=u.next(),x.A(5);break;case 7:if(s)return x.return();o={Ci:void 0},a=r.next(),x.A(2);break;case 4:m=p(e),v=m.next();case 12:if(v.done){x.A(0);break}y=v.value,b=zi(y,t,n).filter((function(e){return!(e=(e=e[0]).keySystemConfiguration&&e.keySystemConfiguration.keySystem)||!i.includes(e)})),_=p(b),S=_.next();case 15:if(S.done){v=m.next(),x.A(12);break}return T=S.value,w(x,Vi(y,T),16);case 16:S=_.next(),x.A(15)}var k}))}function zi(e,t,n){var i=e.audio,r=e.video,a=[],o=[];if(r)for(var s=p(r.fullMimeTypes),u=s.next();!u.done;u=s.next()){var l=li(u=u.value);if(l.includes(",")&&!i){var c=l.split(","),d=ui(u);l=at("video",c),d=ri(d,c=$i(c=at("audio",c),d),"audio"),o.push({contentType:d,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1})}if(l=Ki(l),u={contentType:ri(ui(u),l,"video"),width:r.width||64,height:r.height||64,bitrate:r.bandwidth||e.bandwidth||1,framerate:r.frameRate||30},r.hdr)switch(r.hdr){case"PQ":u.transferFunction="pq";break;case"HLG":u.transferFunction="hlg"}r.colorGamut&&(u.colorGamut=r.colorGamut),a.push(u)}if(i)for(u=(s=p(i.fullMimeTypes)).next();!u.done;u=s.next())u=ri(u=ui(l=u.value),l=$i(li(l),u),"audio"),o.push({contentType:u,channels:i.channelsCount||2,bitrate:i.bandwidth||e.bandwidth||1,samplerate:i.audioSamplingRate||1,spatialRendering:i.spatialAudio});for(s=[],0==a.length&&a.push(null),0==o.length&&o.push(null),u=(a=p(a)).next();!u.done;u=a.next())for(u=u.value,d=(l=p(o)).next();!d.done;d=l.next())d=d.value,c={type:n?"file":"media-source"},u&&(c.video=u),d&&(c.audio=d),s.push(c);if(!(o=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])).length)return[s];for(e=[],n=new Map,a=(o=p(o)).next();!a.done;a=o.next())a=a.value,n.get(a.keySystem)||n.set(a.keySystem,[]),n.get(a.keySystem).push(a);for(o=t?"required":"optional",t=t?["persistent-license"]:["temporary"],u=(a=p(n.keys())).next();!u.done;u=a.next()){for(u=u.value,d=n.get(u),l=new Map,c=(d=p(d)).next();!c.done;c=d.next()){var h=(c=c.value).videoRobustness+","+c.audioRobustness;l.get(h)||l.set(h,[]),l.get(h).push(c)}for(d=(l=p(l.values())).next();!d.done;d=l.next()){d=d.value,c=[];for(var f=(h=p(s)).next();!f.done;f=h.next()){f=Object.assign({},f.value);for(var g={keySystem:u,initDataType:"cenc",persistentState:o,distinctiveIdentifier:"optional",sessionTypes:t},m=p(d),v=m.next();!v.done;v=m.next()){if((v=v.value).initData&&v.initData.length){for(var y=new Set,b=p(v.initData),w=b.next();!w.done;w=b.next())y.add(w.value.initDataType);g.initDataType=v.initData[0].initDataType}v.distinctiveIdentifierRequired&&(g.distinctiveIdentifier="required"),v.persistentStateRequired&&(g.persistentState="required"),v.sessionType&&(g.sessionTypes=[v.sessionType]),i&&(g.audio?(v.encryptionScheme&&(g.audio.encryptionScheme=g.audio.encryptionScheme||v.encryptionScheme),g.audio.robustness=g.audio.robustness||v.audioRobustness):(g.audio={robustness:v.audioRobustness},v.encryptionScheme&&(g.audio.encryptionScheme=v.encryptionScheme)),""==g.audio.robustness&&delete g.audio.robustness),r&&(g.video?(v.encryptionScheme&&(g.video.encryptionScheme=g.video.encryptionScheme||v.encryptionScheme),g.video.robustness=g.video.robustness||v.videoRobustness):(g.video={robustness:v.videoRobustness},v.encryptionScheme&&(g.video.encryptionScheme=v.encryptionScheme)),""==g.video.robustness&&delete g.video.robustness)}f.keySystemConfiguration=g,c.push(f)}e.push(c)}}return e}function $i(e,t){var n=ae();return"flac"==e.toLowerCase()?"WEBKIT"!=n.Ha()?"flac":"fLaC":"opus"===e.toLowerCase()?"WEBKIT"!=n.Ha()?"opus":"mp4"==ai(t)?"Opus":"opus":"ac-3"==e.toLowerCase()&&n.oe()?"ec-3":e}function Ki(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",(e+=parseInt(t.shift(),10).toString(16))+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if("vp9"==e)return"vp09.00.41.08";return e}function Wi(e){var t=e.audio,n=e.video,i=t?t.mimeType:null,r=n?n.mimeType:null,a=t?t.codecs:null,o=n?n.codecs:null,s=t?t.groupId:null,u=[];n&&u.push(n.mimeType),t&&u.push(t.mimeType),u=u[0]||null;var l=[];t&&l.push(t.kind),n&&l.push(n.kind),l=l[0]||null;var c=new Set;if(t)for(var d=p(t.roles),h=d.next();!h.done;h=d.next())c.add(h.value);if(n)for(h=(d=p(n.roles)).next();!h.done;h=d.next())c.add(h.value);if(e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,videoLabel:null,kind:l,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:u,audioMimeType:i,videoMimeType:r,codecs:"",audioCodec:a,videoCodec:o,primary:e.primary,roles:Array.from(c),audioRoles:null,videoRoles:null,forced:!1,videoId:null,audioId:null,audioGroupId:s,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null,e.hdr=n.hdr||null,e.colorGamut=n.colorGamut||null,e.videoLayout=n.videoLayout||null,e.videoRoles=n.roles,e.videoLabel=n.label,(i=n.dependencyStream)&&(e.width=i.width||e.width,e.height=i.height||e.height,e.videoCodec=i.codecs||e.videoCodec,e.videoBandwidth&&i.bandwidth&&(e.videoBandwidth+=i.bandwidth)),o.includes(","))){e.channelsCount=n.channelsCount,e.audioSamplingRate=n.audioSamplingRate,e.spatialAudio=n.spatialAudio,e.originalLanguage=n.originalLanguage,e.audioMimeType=r,r=o.split(",");try{e.videoCodec=at("video",r),e.audioCodec=at("audio",r)}catch(e){}}return t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles,e.accessibilityPurpose=t.accessibilityPurpose,e.originalLanguage=t.originalLanguage,r=t.dependencyStream)&&(e.audioCodec=r.codecs||e.audioCodec,e.audioBandwidth&&r.bandwidth&&(e.audioBandwidth+=r.bandwidth)),n&&!e.videoBandwidth&&(t?e.audioBandwidth&&(e.videoBandwidth=e.bandwidth-e.audioBandwidth):e.videoBandwidth=e.bandwidth),t&&!e.audioBandwidth&&(n?e.videoBandwidth&&(e.audioBandwidth=e.bandwidth-e.videoBandwidth):e.audioBandwidth=e.bandwidth),t=[],e.videoCodec&&t.push(e.videoCodec),e.audioCodec&&t.push(e.audioCodec),e.codecs=t.join(", "),e}function Xi(e){return{id:e.id,active:!1,type:ut,bandwidth:e.bandwidth||0,language:e.language,label:e.label,kind:e.kind||null,mimeType:e.mimeType,codecs:e.codecs||null,primary:e.primary,roles:e.roles,accessibilityPurpose:e.accessibilityPurpose,forced:e.forced,originalTextId:e.originalId,originalLanguage:e.originalLanguage}}function Yi(e){var t=e.width||null,n=e.height||null,i=null;e.segmentIndex&&(i=Pu(e.segmentIndex));var r=e.tilesLayout;return i&&(r=i.tilesLayout||r),r&&null!=t&&(t/=Number(r.split("x")[0])),r&&null!=n&&(n/=Number(r.split("x")[1])),{id:e.id,type:"image",bandwidth:e.bandwidth||0,width:t,height:n,mimeType:e.mimeType,codecs:e.codecs||null,tilesLayout:r||null,originalImageId:e.originalId}}function Ji(e){return e.__shaka_id||(e.__shaka_id=cr++),e.__shaka_id}function Qi(e){var t={id:Ji(e),active:"disabled"!=e.mode,type:ut,bandwidth:0,language:Pi(e.language||"und"),label:e.label,kind:e.kind,mimeType:null,codecs:null,primary:!1,roles:[],accessibilityPurpose:null,forced:"forced"==e.kind,originalTextId:e.id,originalLanguage:e.language};return"captions"==e.kind&&(t.mimeType="unknown"),"subtitles"==e.kind&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),t}function Zi(e,t){var n=e?e.language:null;if(n={id:Ji(e||t),active:e?e.enabled:t.selected,type:"variant",bandwidth:0,language:Pi(n||"und"),label:e?e.label:null,videoLabel:null,kind:e?e.kind:null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!!e&&"main"==e.kind,roles:[],forced:!1,audioRoles:null,videoRoles:null,videoId:null,audioId:null,audioGroupId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:t?t.id:null,originalAudioId:e?e.id:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:n},e&&e.kind&&(n.roles=[e.kind],n.audioRoles=[e.kind]),e&&e.configuration&&(e.configuration.codec&&(n.audioCodec=e.configuration.codec,n.codecs=n.audioCodec),e.configuration.bitrate&&(n.audioBandwidth=e.configuration.bitrate,n.bandwidth+=n.audioBandwidth),e.configuration.sampleRate&&(n.audioSamplingRate=e.configuration.sampleRate),e.configuration.numberOfChannels&&(n.channelsCount=e.configuration.numberOfChannels)),t&&t.configuration&&(t.configuration.codec&&(n.videoCodec=t.configuration.codec,n.codecs=n.codecs?n.codecs+","+n.videoCodec:n.videoCodec),t.configuration.bitrate&&(n.videoBandwidth=t.configuration.bitrate,n.bandwidth+=n.videoBandwidth),t.configuration.framerate&&(n.frameRate=t.configuration.framerate),t.configuration.width&&(n.width=t.configuration.width),t.configuration.height&&(n.height=t.configuration.height),t.configuration.colorSpace&&t.configuration.colorSpace.transfer))switch(t.configuration.colorSpace.transfer){case"pq":n.hdr="PQ";break;case"hlg":n.hdr="HLG";break;case"bt709":n.hdr="SDR"}return n}function er(e){return e.allowedByApplication&&e.allowedByKeySystem&&0==e.disabledUntilTime}function tr(e){return e.filter((function(e){return er(e)}))}function nr(e,t,n,i){var r=e,a=e.filter((function(e){return e.primary}));a.length&&(r=a);var o=r.length?r[0].language:"";if(r=r.filter((function(e){return e.language==o})),t){var s=Ni(Pi(t),e.map((function(e){return e.language})));s&&(r=e.filter((function(e){return Pi(e.language)==s})))}if(r=r.filter((function(e){return e.forced==i})),n){if((e=ir(r,n)).length)return e}else if(e=r.filter((function(e){return 0==e.roles.length})),e.length)return e;return e=r.map((function(e){return e.roles})).reduce(Ti,[]),e.length?ir(r,e[0]):r}function ir(e,t){return e.filter((function(e){return e.roles.includes(t)}))}function rr(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t}function ar(e,t){t.length&&(t=t.filter((function(t){return oi(e.codecs)==oi(t.codecs)})).sort((function(e,t){return e.bandwidth&&t.bandwidth&&e.bandwidth!=t.bandwidth?e.bandwidth-t.bandwidth:(e.width||0)-(t.width||0)})),e.trickModeVideo=t[0],t.length>1&&(t=t.find((function(t){return e.width==t.width&&e.height==t.height}))))&&(e.trickModeVideo=t)}function or(e){return"audio"==e.type?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:"video"==e.type?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}function sr(e,t,n){if(0==n.autoShowText)return!1;if(1==n.autoShowText)return!0;var i=Pi(n.preferredTextLanguage);return t=Pi(t.language),2==n.autoShowText?Ii(t,i):3==n.autoShowText?!!e&&(e=Pi(e.language),Ii(t,i)&&!Ii(e,t)):($("Invalid autoShowText setting!"),!1)}function ur(e){for(var t={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},n=(e=p(e)).next();!n.done;n=e.next()){var i={id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:(n=n.value)?ui(n):"",codecs:n?li(n):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:"video",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null};i.fullMimeTypes.add(ni(i.mimeType,i.codecs)),n.startsWith("audio/")?(i.type="audio",t.audio=i):t.video=i}return t}B("shaka.util.StreamUtils",ji),ji.meetsRestrictions=Fi;var lr=new Map,cr=0,dr=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),hr=(new Map).set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function fr(){var t=this;this.H=null,this.B=!1,this.u=new q,this.j=new te,navigator.connection&&navigator.connection.addEventListener&&this.j.D(navigator.connection,"change",(function(){if(t.B&&t.g.useNetworkInformation){t.u=new q,t.g&&t.u.configure(t.g.advanced);var e=t.chooseVariant();e&&navigator.onLine&&t.H(e,t.g.clearBufferSwitch,t.g.safeMarginSwitch)}})),this.o=[],this.I=1,this.J=!1,this.h=this.m=this.g=this.C=null,this.l=new Si((function(){if(t.B&&(t.g.restrictToElementSize||t.g.restrictToScreenSize)){var e=t.chooseVariant();e&&t.H(e,t.g.clearBufferSwitch,t.g.safeMarginSwitch)}})),this.F=e,"documentPictureInPicture"in e&&this.j.D(e.documentPictureInPicture,"enter",(function(){t.F=e.documentPictureInPicture.window,t.l&&t.l.Jb(),t.j.Ba(t.F,"pagehide",(function(){t.F=e,t.l&&t.l.Jb()}))})),this.G=this.i=null}function pr(e,t){if(void 0===t||!t){if(!e.J){if(!((t=e.u).g>=t.i))return;e.J=!0,e.C-=1e3*(e.g.switchInterval-e.g.minTimeToSwitch)}if(Date.now()-e.C<1e3*e.g.switchInterval)return}t=e.chooseVariant(),e.getBandwidthEstimate(),t&&e.H(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}function gr(e,t,n,i,r){if(e.G){var a=e.G.bi();a&&(n=n.filter((function(e){return!e.bandwidth||!a||e.bandwidth<=a})))}return t&&(n=n.filter((function(e){return Fi(e,t,{width:r,height:i})}))),n.sort((function(e,t){return e.bandwidth-t.bandwidth}))}(i=fr.prototype).stop=function(){this.H=null,this.B=!1,this.o=[],this.I=1,this.m=this.C=null,this.h&&(this.h.disconnect(),this.h=null),this.l&&this.l.stop(),this.G=this.i=null},i.release=function(){this.stop(),this.j.release(),this.l=null},i.init=function(e){this.H=e},i.chooseVariant=function(e){e=void 0!==e&&e;var t=1/0,n=1/0;if(this.g.restrictToScreenSize&&(n=this.g.ignoreDevicePixelRatio?1:this.F.devicePixelRatio,t=this.F.screen.height*n,n*=this.F.screen.width),this.h&&this.g.restrictToElementSize){var i=this.g.ignoreDevicePixelRatio?1:this.F.devicePixelRatio,r=this.m.clientHeight,a=this.m.clientWidth;this.i&&document.pictureInPictureElement&&document.pictureInPictureElement==this.m&&(r=this.i.height,a=this.i.width),t=Math.min(t,r*i),n=Math.min(n,a*i)}if((r=this.o.filter((function(e){return e&&!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)}))).length||(r=this.o),i=r,e&&r.length!=this.o.length&&(i=this.o.filter((function(e){return e&&!!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)}))),e=gr(this,this.g.restrictions,i,1/0,1/0),t!=1/0||n!=1/0){for(e=function(e){for(var t=[],n=(e=p(e)).next();!n.done;n=e.next())(n=n.value.video)&&n.height&&n.width&&t.push({height:n.height,width:n.width});return t.sort((function(e,t){return e.width-t.width}))}(e),r=(e=p(e)).next();!r.done;r=e.next())if((r=r.value).height>=t&&r.width>=n){t=r.height,n=r.width;break}e=gr(this,this.g.restrictions,i,t,n)}for(t=this.getBandwidthEstimate(),i.length&&!e.length&&(e=[(e=gr(this,null,i,1/0,1/0))[0]]),n=e[0]||null,i=0;i<e.length;i++){r=e[i];var o=isNaN(this.I)?1:Math.abs(this.I);a=o*r.bandwidth/this.g.bandwidthDowngradeTarget;for(var s={bandwidth:1/0},u=i+1;u<e.length;u++)if(r.bandwidth!=e[u].bandwidth){s=e[u];break}o=o*s.bandwidth/this.g.bandwidthUpgradeTarget,t>=a&&t<=o&&(n.bandwidth!=r.bandwidth||n.bandwidth==r.bandwidth&&n.video&&r.video&&(n.video.width<r.video.width||n.video.height<r.video.height))&&(n=r)}return this.C=Date.now(),n},i.enable=function(){this.B=!0},i.disable=function(){this.B=!1},i.segmentDownloaded=function(e,t,n,i){var r=e;this.g.removeLatencyFromFirstPacketTime&&i&&1===i.packetNumber&&i.timeToFirstByte&&(r=e-i.timeToFirstByte),r>=this.g.cacheLoadThreshold&&this.u.sample(r,t),n&&null!=this.C&&this.B&&pr(this)},i.trySuggestStreams=function(){this.B&&(this.C=Date.now(),pr(this,!0))},i.getBandwidthEstimate=function(){var e=this.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&(e=1e6*navigator.connection.downlink),navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&this.g.preferNetworkInformationBandwidth?e:(e=this.u.getBandwidthEstimate(e),this.G?this.G.getBandwidthEstimate(e):e)},i.setVariants=function(e){return!Q(e,this.o)&&(this.o=e,!0)},i.playbackRateChanged=function(e){this.I=e},i.setMediaElement=function(t){function n(){i.l.ia(mr)}var i=this;this.m=t,this.h&&(this.h.disconnect(),this.h=null),this.m&&"ResizeObserver"in e&&(this.h=new ResizeObserver(n),this.h.observe(this.m)),this.j.D(t,"enterpictureinpicture",(function(e){e.pictureInPictureWindow&&(i.i=e.pictureInPictureWindow,i.j.D(i.i,"resize",n))})),this.j.D(t,"leavepictureinpicture",(function(){i.i&&i.j.Ma(i.i,"resize",n),i.i=null}))},i.setCmsdManager=function(e){this.G=e},i.configure=function(e){this.g=e,this.u&&this.g&&this.u.configure(this.g.advanced)},B("shaka.abr.SimpleAbrManager",fr),fr.prototype.configure=fr.prototype.configure,fr.prototype.setCmsdManager=fr.prototype.setCmsdManager,fr.prototype.setMediaElement=fr.prototype.setMediaElement,fr.prototype.playbackRateChanged=fr.prototype.playbackRateChanged,fr.prototype.setVariants=fr.prototype.setVariants,fr.prototype.getBandwidthEstimate=fr.prototype.getBandwidthEstimate,fr.prototype.trySuggestStreams=fr.prototype.trySuggestStreams,fr.prototype.segmentDownloaded=fr.prototype.segmentDownloaded,fr.prototype.disable=fr.prototype.disable,fr.prototype.enable=fr.prototype.enable,fr.prototype.chooseVariant=fr.prototype.chooseVariant,fr.prototype.init=fr.prototype.init,fr.prototype.release=fr.prototype.release,fr.prototype.stop=fr.prototype.stop;var mr=1;function vr(e,t){if(e===t||!e.length||!t.length)return!0;for(var n=(e=p(e)).next();!n.done;n=e.next()){if(_r(n=n.value))return!0;for(var i=p(t),r=i.next();!r.done;r=i.next())if(r=r.value,n.keySystem===r.keySystem||_r(r))return!0}return!1}function yr(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],i=(e=p(e)).next();!i.done;i=e.next()){i=i.value;for(var r=p(t),a=r.next();!a.done;a=r.next()){if(a=a.value,i.keySystem==a.keySystem){r=new Map;for(var o=p((i.initData||[]).concat(a.initData||[])),s=o.next();!s.done;s=o.next())s=s.value,r.set(s.keyId,s);r=Array.from(r.values()),o=i.keyIds&&a.keyIds?new Set([].concat(g(i.keyIds),g(a.keyIds))):i.keyIds||a.keyIds,n.push({keySystem:i.keySystem,licenseServerUri:i.licenseServerUri||a.licenseServerUri,distinctiveIdentifierRequired:i.distinctiveIdentifierRequired||a.distinctiveIdentifierRequired,persistentStateRequired:i.persistentStateRequired||a.persistentStateRequired,videoRobustness:i.videoRobustness||a.videoRobustness,audioRobustness:i.audioRobustness||a.audioRobustness,serverCertificate:i.serverCertificate||a.serverCertificate,serverCertificateUri:i.serverCertificateUri||a.serverCertificateUri,initData:r,keyIds:o});break}_r(i)?n.push(i):_r(a)&&n.push(a)}}return n}function br(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)}function wr(e){return!!e&&!!e.match(/^com\.apple\.fps/)}function _r(e){return!!(e=e.licenseServerUri)&&e.startsWith("data:application/json;base64,")}var Sr=new re((function(){return De(new Uint8Array([0]))})),Tr=new Map;function xr(e,t){var n={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4};this.l=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.j=null==e.baseDelay?n.baseDelay:e.baseDelay,this.o=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.m=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=void 0!==t&&t)&&(this.g=1)}function kr(e){var t,n;return R((function(i){if(1==i.g){if(e.g>=e.l){if(!e.i)throw new Ue(2,7,1010);e.g=1,e.h=e.j}return t=e.g,e.g++,0==t?i.return():(n=e.h*(1+(2*Math.random()-1)*e.o),w(i,new Promise((function(e){new Si(e).ia(n/1e3)})),2))}e.h*=e.m,_(i)}))}function Ar(){var e,t,n=new Promise((function(n,i){e=n,t=i}));return n.resolve=e,n.reject=t,n}function Er(e,t){this.promise=e,this.i=t,this.g=null}function Ir(e){return new Er(Promise.reject(e),(function(){return Promise.resolve()}))}function Cr(){var e=Promise.reject(new Ue(2,7,7001));return e.catch((function(){})),new Er(e,(function(){return Promise.resolve()}))}function Mr(e){return new Er(Promise.resolve(e),(function(){return Promise.resolve()}))}function Pr(e){return new Er(e,(function(){return e.catch((function(){}))}))}function Rr(e){return new Er(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))}function Dr(t,n){if(n)if(n instanceof Map)for(var i=p(n.keys()),r=i.next();!r.done;r=i.next())r=r.value,Object.defineProperty(this,r,{value:n.get(r),writable:!0,enumerable:!0});else for(i in n)Object.defineProperty(this,i,{value:n[i],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function Lr(e){var t,n=new Dr(e.type);for(t in e)Object.defineProperty(n,t,{value:e[t],writable:!0,enumerable:!0});return n}Ar.prototype.resolve=function(){},Ar.prototype.reject=function(){},Er.prototype.abort=function(){return this.g||(this.g=this.i()),this.g},Er.prototype.finally=function(e){return this.promise.then((function(){return e(!0)}),(function(){return e(!1)})),this},Er.prototype.Xa=function(e,t){function n(n){return function(s){if(r.g&&n)a.reject(o);else{var u=n?e:t;u?i=function(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then((function(){}),(function(){}))})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}(u,s,a):(n?a.resolve:a.reject)(s)}}}function i(){return a.reject(o),r.abort()}var r=this,a=new Ar;a.catch((function(){}));var o=new Ue(2,7,7001);return this.promise.then(n(!0),n(!1)),new Er(a,(function(){return i()}))},s.Object.defineProperties(Er.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return null!==this.g}}}),B("shaka.util.AbortableOperation",Er),Er.prototype.chain=Er.prototype.Xa,Er.prototype.finally=Er.prototype.finally,Er.all=Rr,Er.prototype.abort=Er.prototype.abort,Er.notAbortable=Pr,Er.completed=Mr,Er.aborted=Cr,Er.failed=Ir,Dr.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Dr.prototype.stopImmediatePropagation=function(){this.g=!0},Dr.prototype.stopPropagation=function(){},B("shaka.util.FakeEvent",Dr);var Nr={rl:"abrstatuschanged",ul:"adaptation",vl:"audiotrackchanged",wl:"audiotrackschanged",xl:"boundarycrossed",yl:"buffering",zl:"canupdatestarttime",Al:"complete",Bl:"currentitemchanged",Cl:"downloadcompleted",Dl:"downloadfailed",El:"downloadheadersreceived",Fl:"drmsessionupdate",Gl:"emsg",Ml:"itemsinserted",Nl:"itemsremoved",bm:"prft",Error:"error",Hl:"expirationupdated",Il:"firstquartile",Jl:"gapjumped",Ol:"keystatuschanged",Rl:"loaded",Sl:"loading",Ul:"manifestparsed",Vl:"manifestupdated",Wl:"mediaqualitychanged",Xl:"mediasourcerecovered",Yl:"metadataadded",Metadata:"metadata",Zl:"midpoint",$l:"nospatialvideoinfo",am:"onstatechange",dm:"ratechange",hm:"segmentappended",im:"sessiondata",jm:"spatialvideoinfo",lm:"stalldetected",nm:"started",om:"statechanged",pm:"streaming",qm:"textchanged",rm:"texttrackvisibility",sm:"thirdquartile",tm:"timelineregionadded",um:"timelineregionenter",vm:"timelineregionexit",wm:"trackschanged",ym:"unloading",Am:"variantchanged"};function Or(){this.ab=new ee,this.Fe=this}function jr(){this.g=[]}function Ur(e,t){e.g.push(t.finally((function(){J(e.g,t)})))}function Fr(e,t,n,i,r,a,o){Or.call(this),this.i=null,this.j=!1,this.u=new jr,this.g=new Set,this.h=new Set,this.o=e||null,this.m=t||null,this.B=n||null,this.C=i||null,this.F=r||null,this.H=a||null,this.G=o||null,this.l=new Map}function Br(e,t,n,i){i=void 0!==i&&i,n=n||Wr;var r=Xr.get(e);(!r||n>=r.priority)&&Xr.set(e,{priority:n,yf:t,Fk:i})}function Hr(e,t){for(var n=p(e.g),i=n.next();!i.done;i=n.next())t.g.add(i.value);for(n=(e=p(e.h)).next();!n.done;n=e.next())t.h.add(n.value)}function Vr(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===n?null:n}}function qr(e,t,n,i,r,a,o,s){e.i.forceHTTP&&(n.uris[a]=n.uris[a].replace("https://","http://")),e.i.forceHTTPS&&(n.uris[a]=n.uris[a].replace("http://","https://")),a>0&&e.H&&e.H(t,i,n.uris[a],n.uris[a-1]);var u=new ge(n.uris[a]),l=u.bc,c=!1;l||(me(u,l=(l=location.protocol).slice(0,-1)),n.uris[a]=u.toString()),l=l.toLowerCase();var d=(l=Xr.get(l))?l.yf:null;if(!d)return Ir(new Ue(2,1,1e3,u));var h=l.Fk;(u=e.l.get(u.Db))&&(n.headers["common-access-token"]=u);var f,p=null,g=null,m=!1,v=!1;return Pr(kr(r)).Xa((function(){if(e.j)return Cr();f=Date.now();var r=0;n.requestStartTime=Date.now();var o=d(n.uris[a],n,t,(function(a,o,u){p&&p.stop(),g&&g.ia(l/1e3),e.o&&t==Kr&&(r++,n.packetNumber=r,e.o(a,o,Gr(i),n,i),c=!0,s.g=u)}),(function(i){v=!0,n.timeToFirstByte=Date.now()-n.requestStartTime,e.m&&e.m(i,n,t)}),{minBytesForProgressEvents:e.i.minBytesForProgressEvents});if(!h)return o;var u=n.retryParameters.connectionTimeout;u&&(p=new Si((function(){m=!0,o.abort()}))).ia(u/1e3);var l=n.retryParameters.stallTimeout;return l&&(g=new Si((function(){m=!0,o.abort()}))),o})).Xa((function(i){p&&p.stop(),g&&g.stop(),null==i.timeMs&&(i.timeMs=Date.now()-f);var r=i.headers["common-access-token"];if(r){var a=new ge(i.uri);e.l.set(a.Db,r)}return r={response:i,fk:c},!v&&e.m&&e.m(i.headers,n,t),e.B&&e.B(n,i),r}),(function(u){if(p&&p.stop(),g&&g.stop(),e.C){var l=null,c=0;u instanceof Ue&&(l=u,1001==u.code&&(c=u.data[1])),e.C(n,l,c,m)}if(e.j)return Cr();if(m&&(u=new Ue(1,1,1003,n.uris[a],t)),u instanceof Ue){if(7001==u.code)throw u;if(1010==u.code)throw o;if(1==u.severity){if((l=new Dr("retry",l=(new Map).set("error",u))).cancelable=!0,e.dispatchEvent(l),l.defaultPrevented)throw u;return a=(a+1)%n.uris.length,qr(e,t,n,i,r,a,u,s)}}throw u}))}function Gr(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.Xc)return!1}return!0}function zr(){this.g=0}function $r(e,t,n){Er.call(this,e,t),this.h=n}Or.prototype.addEventListener=function(e,t){this.ab&&this.ab.push(e,t)},Or.prototype.removeEventListener=function(e,t){this.ab&&this.ab.remove(e,t)},Or.prototype.dispatchEvent=function(e){if(!this.ab)return!0;var t=this.ab.get(e.type)||[],n=this.ab.get("All");for(n&&(t=t.concat(n)),n=(t=p(t)).next();!n.done;n=t.next()){n=n.value,e.target=this.Fe,e.currentTarget=this.Fe;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(e){}if(e.g)break}return e.defaultPrevented},Or.prototype.release=function(){this.ab=null},jr.prototype.destroy=function(){for(var e=[],t=p(this.g),n=t.next();!n.done;n=t.next())(n=n.value).promise.catch((function(){})),e.push(n.abort());return this.g=[],Promise.all(e)},h(Fr,Or),(i=Fr.prototype).configure=function(e){this.i=e},i.Ik=function(e){this.g.add(e)},i.hl=function(e){this.g.delete(e)},i.oj=function(){this.g.clear()},i.Jk=function(e){this.h.add(e)},i.il=function(e){this.h.delete(e)},i.pj=function(){this.h.clear()},i.Qh=function(){this.l.clear()},i.destroy=function(){return this.j=!0,this.g.clear(),this.h.clear(),this.l.clear(),Or.prototype.release.call(this),this.u.destroy()},i.request=function(e,t,n){var i=this,r=new zr;if(this.j){var a=Promise.reject(new Ue(2,7,7001));return a.catch((function(){})),new $r(a,(function(){return Promise.resolve()}),r)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?Ft(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},t.uris=Ft(t.uris),a=function(e,t,n,i){function r(e){a=a.Xa((function(){return n.body&&(n.body=De(n.body)),e(t,n,i)}))}var a=Mr(void 0);e.F&&r(e.F);for(var o=(e=p(e.g)).next();!o.done;o=e.next())r(o.value);return a.Xa(void 0,(function(e){if(e instanceof Ue&&7001==e.code)throw e;throw new Ue(2,1,1006,e)}))}(this,e,t,n);var o=a.Xa((function(){return qr(i,e,t,n,new xr(t.retryParameters,!1),0,null,r)})),s=o.Xa((function(t){return function(e,t,n,i){for(var r=Mr(void 0),a=(e=p(e.h)).next(),o={};!a.done;o={Ji:void 0},a=e.next())o.Ji=a.value,r=r.Xa(function(e){return function(){var r=n.response;return r.data&&(r.data=De(r.data)),(0,e.Ji)(t,r,i)}}(o));return r.Xa((function(){return n}),(function(e){var t=2;if(e instanceof Ue){if(7001==e.code)throw e;t=e.severity}throw new Ue(t,1,1007,e)}))}(i,e,t,n)})),u=Date.now(),l=0;a.promise.then((function(){l=Date.now()-u}),(function(){}));var c=0;o.promise.then((function(){c=Date.now()}),(function(){}));var d=s.Xa((function(r){var a=Date.now()-c,o=r.response;return o.timeMs+=l,o.timeMs+=a,r.fk||!i.o||o.fromCache||"HEAD"==t.method||e!=Kr||i.o(o.timeMs,o.data.byteLength,Gr(n),t,n),i.G&&i.G(e,o,n),o}),(function(e){throw e&&(e.severity=2),e}));return a=new $r(d.promise,(function(){return d.abort()}),r),Ur(this.u,a),a},B("shaka.net.NetworkingEngine",Fr),Fr.prototype.request=Fr.prototype.request,Fr.prototype.destroy=Fr.prototype.destroy,Fr.makeRequest=Vr,Fr.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}},Fr.prototype.clearCommonAccessTokenMap=Fr.prototype.Qh,Fr.prototype.clearAllResponseFilters=Fr.prototype.pj,Fr.prototype.unregisterResponseFilter=Fr.prototype.il,Fr.prototype.registerResponseFilter=Fr.prototype.Jk,Fr.prototype.clearAllRequestFilters=Fr.prototype.oj,Fr.prototype.unregisterRequestFilter=Fr.prototype.hl,Fr.prototype.registerRequestFilter=Fr.prototype.Ik,Fr.unregisterScheme=function(e){Xr.delete(e)},Fr.registerScheme=Br,Fr.prototype.configure=Fr.prototype.configure,Fr.NumBytesRemainingClass=zr,h($r,Er),Fr.PendingRequest=$r;var Kr=1;Fr.RequestType={MANIFEST:0,SEGMENT:Kr,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8,CMCD:9},Fr.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5,MPD_PATCH:6,MEDIATAILOR_SESSION_INFO:7,MEDIATAILOR_TRACKING_INFO:8,MEDIATAILOR_STATIC_RESOURCE:9,MEDIATAILOR_TRACKING_EVENT:10,INTERSTITIAL_ASSET_LIST:11,INTERSTITIAL_AD_URL:12};var Wr=3;Fr.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:Wr};var Xr=new Map;function Yr(e){this.g=!1,this.h=new Ar,this.i=e}function Jr(e,t){if(e.g){if(t instanceof Ue&&7003==t.code)throw t;throw new Ue(2,7,7003,t)}}function Qr(e,t){for(var n=[],i=(e=p(e)).next();!i.done;i=e.next())n.push(t(i.value));return n}function Zr(e){for(var t=new Map,n=p(Object.keys(e)),i=n.next();!i.done;i=n.next())i=i.value,t.set(i,e[i]);return t}function ea(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}function ta(e,t){this.h=Oe(e),this.i=t==ia,this.g=0}function na(){return new Ue(2,3,3e3)}Yr.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then((function(){e.h.resolve()}),(function(){e.h.resolve()})))},(i=ta.prototype).Ia=function(){return this.g<this.h.byteLength},i.Oa=function(){return this.g},i.getLength=function(){return this.h.byteLength},i.Y=function(){try{var e=this.h.getUint8(this.g);return this.g+=1,e}catch(e){throw na()}},i.Ca=function(){try{var e=this.h.getUint16(this.g,this.i);return this.g+=2,e}catch(e){throw na()}},i.U=function(){try{var e=this.h.getUint32(this.g,this.i);return this.g+=4,e}catch(e){throw na()}},i.Zg=function(){try{var e=this.h.getInt32(this.g,this.i);return this.g+=4,e}catch(e){throw na()}},i.Dd=function(){try{if(this.i)var e=this.h.getUint32(this.g,!0),t=this.h.getUint32(this.g+4,!0);else t=this.h.getUint32(this.g,!1),e=this.h.getUint32(this.g+4,!1)}catch(e){throw na()}if(t>2097151)throw new Ue(2,3,3001);return this.g+=8,4294967296*t+e},i.Tb=function(e,t){if(this.g+e>this.h.byteLength)throw na();var n=Le(this.h,this.g,e);return this.g+=e,t?new Uint8Array(n):n},i.skip=function(e){if(this.g+e>this.h.byteLength)throw na();this.g+=e},i.Ki=function(e){if(this.g<e)throw na();this.g-=e},i.seek=function(e){if(e<0||e>this.h.byteLength)throw na();this.g=e},i.Yc=function(){for(var e=this.g;this.Ia()&&0!=this.h.getUint8(this.g);)this.g+=1;return e=Le(this.h,e,this.g-e),this.g+=1,He(e)},B("shaka.util.DataViewReader",ta),ta.prototype.readTerminatedString=ta.prototype.Yc,ta.prototype.seek=ta.prototype.seek,ta.prototype.rewind=ta.prototype.Ki,ta.prototype.skip=ta.prototype.skip,ta.prototype.readBytes=ta.prototype.Tb,ta.prototype.readUint64=ta.prototype.Dd,ta.prototype.readInt32=ta.prototype.Zg,ta.prototype.readUint32=ta.prototype.U,ta.prototype.readUint16=ta.prototype.Ca,ta.prototype.readUint8=ta.prototype.Y,ta.prototype.getLength=ta.prototype.getLength,ta.prototype.getPosition=ta.prototype.Oa,ta.prototype.hasMoreData=ta.prototype.Ia;var ia=1;function ra(){this.i=new Map,this.h=new Map,this.g=!1}function aa(e){for(var t=ha(e);e.reader.Ia()&&!e.parser.g;)e.parser.zd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial)}function oa(e){for(var t=ha(e),n=e.reader.U(),i=0;i<n&&(e.parser.zd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial),!e.parser.g);i++);}function sa(e){var t=ha(e);for(e.reader.skip(78);e.reader.Ia()&&!e.parser.g;)e.parser.zd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial)}function ua(e){var t=ha(e);e.reader.skip(8);var n=e.reader.Ca();for(e.reader.skip(6),2==n?e.reader.skip(48):e.reader.skip(12),1==n&&e.reader.skip(16);e.reader.Ia()&&!e.parser.g;)e.parser.zd(e.start+t,e.reader,e.partialOkay,e.stopOnPartial)}function la(e,t){return function(n){e(n.reader.Tb(n.reader.getLength()-n.reader.Oa(),t))}}function ca(e){for(var t=0,n=(e=p(e)).next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function da(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function ha(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)}ta.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:ia},(i=ra.prototype).box=function(e,t){return e=ca(e),this.i.set(e,fa),this.h.set(e,t),this},i.S=function(e,t){return e=ca(e),this.i.set(e,pa),this.h.set(e,t),this},i.stop=function(){this.g=!0},i.parse=function(e,t,n){for(e=new ta(e,0),this.g=!1;e.Ia()&&!this.g;)this.zd(0,e,t,n)},i.zd=function(e,t,n,i){var r=t.Oa();if(i&&r+8>t.getLength())this.g=!0;else{var a=t.U(),o=t.U(),s=da(o),u=!1;switch(a){case 0:a=t.getLength()-r;break;case 1:if(i&&t.Oa()+8>t.getLength())return void(this.g=!0);a=t.Dd(),u=!0}var l=this.h.get(o);if(l){var c=null,d=null;if(this.i.get(o)==pa){if(i&&t.Oa()+4>t.getLength())return void(this.g=!0);c=(d=t.U())>>>24,d&=16777215}o=r+a,n&&o>t.getLength()&&(o=t.getLength()),i&&o>t.getLength()?this.g=!0:(o-=t.Oa(),l({name:s,parser:this,partialOkay:n||!1,stopOnPartial:i||!1,version:c,flags:d,reader:t=new ta(t=o>0?t.Tb(o,!1):new Uint8Array(0),0),size:a,start:r+e,has64BitSize:u}))}else t.skip(Math.min(r+a-t.Oa(),t.getLength()-t.Oa()))}},B("shaka.util.Mp4Parser",ra),ra.headerSize=ha,ra.typeToString=da,ra.allData=la,ra.audioSampleEntry=ua,ra.visualSampleEntry=sa,ra.sampleDescription=oa,ra.children=aa,ra.prototype.parseNext=ra.prototype.zd,ra.prototype.parse=ra.prototype.parse,ra.prototype.stop=ra.prototype.stop,ra.prototype.fullBox=ra.prototype.S,ra.prototype.box=ra.prototype.box;var fa=0,pa=1;function ga(e){var t=this;this.g=[],this.h=[],this.data=[],(new ra).box("moov",aa).box("moof",aa).S("pssh",(function(e){if(!(e.version>1)){var n=Le(e.reader.h,-12,e.size);if(t.data.push(n),n=e.reader.Tb(16,!1),t.g.push(et(n)),e.version>0){n=e.reader.U();for(var i=0;i<n;i++){var r=e.reader.Tb(16,!1);r=et(r),t.h.push(r)}}}})).parse(e)}function ma(e,t,n,i){var r=e.length,a=12+t.length+4+r;i>0&&(a+=4+16*n.size);var o=new Uint8Array(a),s=Oe(o),u=0;if(s.setUint32(u,a),u+=4,s.setUint32(u,1886614376),u+=4,i<1?s.setUint32(u,0):s.setUint32(u,16777216),u+=4,o.set(t,u),u+=t.length,i>0)for(s.setUint32(u,n.size),u+=4,n=(t=p(n)).next();!n.done;n=t.next())n=Ze(n.value),o.set(n,u),u+=n.length;return s.setUint32(u,r),o.set(e,u+4),o}function va(e){var t=this;this.F=e,this.j=this.B=null,this.oa=this.T=!1,this.J=0,this.g=null,this.o=new te,this.i=new Map,this.X=[],this.C=new Map,this.K=!1,this.m=new Ar,this.h=null,this.u=function(n){2==n.severity&&t.m.reject(n),e.onError(n)},this.aa=new Map,this.ma=new Map,this.M=new Si((function(){return function(e){var t=e.aa,n=e.ma;n.clear(),t.forEach((function(e,t){return n.set(t,e)})),t=Array.from(n.values()),t.length&&t.every((function(e){return"expired"==e}))&&e.u(new Ue(2,6,6014)),e.F.vf(ea(n))}(t)})),this.R=!1,this.N=[],this.$=!1,this.G=new Si((function(){!function(e){e.i.forEach((function(t,n){var i=t.Ug,r=n.expiration;isNaN(r)&&(r=1/0),r!=i&&(e.F.onExpirationUpdated(n.sessionId,r),t.Ug=r)}))}(t)})),this.m.catch((function(){})),this.l=new Yr((function(){return function(e){return R((function(t){switch(t.g){case 1:return e.o.release(),e.o=null,e.m.reject(),e.G.stop(),e.G=null,e.M.stop(),e.M=null,w(t,Pa(e),2);case 2:if(!e.j){t.A(3);break}return S(t,4),w(t,e.j.setMediaKeys(null),6);case 6:x(t,5);break;case 4:k(t);case 5:e.j=null;case 3:e.g=null,e.B=null,e.C=new Map,e.h=null,e.u=function(){},e.F=null,e.O=!1,e.I=null,_(t)}}))}(t)})),this.O=!1,this.H=this.I=null,this.V=function(){return!1}}function ya(e,t,n,i){i=void 0===i||i,e.C=new Map;for(var r=(n=p(n)).next();!r.done;r=n.next())e.C.set(r.value,{initData:null,initDataType:null});for(r=(n=p(e.h.persistentSessionsMetadata)).next();!r.done;r=n.next())r=r.value,e.C.set(r.sessionId,{initData:r.initData,initDataType:r.initDataType});return e.R=e.C.size>0,ba(e,t,i)}function ba(e,t,n){var i,r,a,o,s,u,l,c,d,h,f,g,m,v,y,b,_;return R((function(S){if(1==S.g){for(Na(e.h.clearKeys,t),i=t.some((function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)})),r=Zr(e.h.servers),a=Zr(e.h.advanced||{}),!i&&n&&function(e,t){var n=[];for(t.forEach((function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})})),e=p(e),t=e.next();!t.done;t=e.next())(t=t.value).video&&(t.video.drmInfos=n),t.audio&&(t.audio.drmInfos=n)}(t,r),o=new WeakSet,s=p(t),u=s.next();!u.done;u=s.next())for(l=u.value,c=Ra(l),d=p(c),h=d.next();!h.done;h=d.next())f=h.value,o.has(f)||(o.add(f),La(f,r,a,e.h.keySystemsMapping));for(g=function(t,n){for(var i=[],r=(t=p(t)).next();!r.done;r=t.next()){var o,s=(r=r.value)[n]||a.has(r.keySystem)&&a.get(r.keySystem)[n]||"";if((o=""==s)&&(o=!!(o=r.keySystem)&&!!o.match(/^com\.widevine\.alpha/)),o&&("audioRobustness"==n?s=[e.h.defaultAudioRobustnessForWidevine]:"videoRobustness"==n&&(s=[e.h.defaultVideoRobustnessForWidevine])),"string"==typeof s)i.push(r);else if(Array.isArray(s))for(0===s.length&&(s=[""]),o=(s=p(s)).next();!o.done;o=s.next()){var u={};i.push(Object.assign({},r,(u[n]=o.value,u)))}}return i},m=new WeakSet,v=p(t),y=v.next();!y.done;y=v.next())(b=y.value).video&&!m.has(b.video)&&(b.video.drmInfos=g(b.video.drmInfos,"videoRobustness"),b.video.drmInfos=g(b.video.drmInfos,"audioRobustness"),m.add(b.video)),b.audio&&!m.has(b.audio)&&(b.audio.drmInfos=g(b.audio.drmInfos,"videoRobustness"),b.audio.drmInfos=g(b.audio.drmInfos,"audioRobustness"),m.add(b.audio));return w(S,Gi(t,e.R,e.O,e.h.preferredKeySystems),2)}return Jr(e.l),i||r.size>0?(_=xa(e,t),S.return(i?_:_.catch((function(){})))):(e.T=!0,S.return(Promise.resolve()))}))}function wa(e){var t;return R((function(n){switch(n.g){case 1:if(e.j.mediaKeys)return n.return();if(!e.I){n.A(2);break}return w(n,e.I,3);case 3:return Jr(e.l),n.return();case 2:return S(n,4),e.I=e.j.setMediaKeys(e.B),w(n,e.I,6);case 6:x(n,5);break;case 4:t=k(n),e.u(new Ue(2,6,6003,t.message));case 5:Jr(e.l),_(n)}}))}function _a(e){var t,n,i,r;return R((function(a){if(1==a.g)return e.C.size?(e.C.forEach((function(t,n){Ea(e,n,t)})),w(a,e.m,3)):a.A(2);if(2!=a.g){if((e.g&&e.g.keyIds||new Set([])).size>0&&function(e){for(var t=p(e.g&&e.g.keyIds||new Set([])),n=t.next();!n.done;n=t.next())if("usable"!==e.aa.get(n.value))return!1;return!0}(e))return a.return(e.m);e.K=!1,e.m=new Ar,e.m.catch((function(){}))}for(t=(e.g?e.g.initData:[])||[],n=p(t),i=n.next();!i.done;i=n.next())r=i.value,Sa(e,r.initDataType,r.initData);return Da(e)&&e.m.resolve(),a.return(e.m)}))}function Sa(e,t,n){if(n.length){if(e.h.ignoreDuplicateInitData){for(var i=e.i.values(),r=(i=p(i)).next();!r.done;r=i.next())if(Re(n,r.value.initData))return;var a=!1;if(e.C.forEach((function(e){!a&&Re(n,e.initData)&&(a=!0)})),a)return}e.K=!0,e.i.size>0&&Da(e)&&(e.m.resolve(),e.K=!1,e.m=new Ar,e.m.catch((function(){}))),function(e,t,n,i){try{var r=e.B.createSession(i)}catch(t){return void e.u(new Ue(2,6,6005,t.message))}e.o.D(r,"message",(function(t){e.j&&e.h.delayLicenseRequestUntilPlayed&&e.j.paused&&!e.$?e.N.push(t):Ia(e,t)})),e.o.D(r,"keystatuseschange",(function(t){return Ca(e,t)})),e.i.set(r,{initData:n,initDataType:t,loaded:!1,Ug:1/0,Kb:null,type:i});try{n=e.h.initDataTransform(n,t,e.g)}catch(n){return t=n,n instanceof Ue||(t=new Ue(2,6,6016,n)),void e.u(t)}e.h.logLicenseExchange&&Je(n),r.generateRequest(t,n).catch((function(t){if(!e.l.g){e.i.delete(r);var n=t.errorCode;if(n&&n.systemCode){var i=n.systemCode;i<0&&(i+=4294967296),i="0x"+i.toString(16)}e.u(new Ue(2,6,6006,t.message,t,i))}}))}(e,t,n,e.g.sessionType)}}function Ta(e){return e=Qr(e=e.i.keys(),(function(e){return e.sessionId})),Array.from(e)}function xa(t,n){var i,r,a,o,s,u;return R((function(l){switch(l.g){case 1:if(i=new Map,r=function(e,t,n){for(var i=p(t),r=i.next();!r.done;r=i.next())for(var a=(r=p(Ra(r.value))).next();!a.done;a=r.next())a=a.value,n.has(a.keySystem)||n.set(a.keySystem,[]),n.get(a.keySystem).push(a);if(1==n.size&&n.has(""))throw new Ue(2,6,6e3);i=e.h.preferredKeySystems,i.length||(r=Zr(e.h.servers),1==r.size&&(i=Array.from(r.keys()))),r=p(i);var o=r.next();for(a={};!o.done;a={Di:void 0},o=r.next()){a.Di=o.value;for(var s=(o=p(t)).next();!s.done;s=o.next())if(s=s.value.decodingInfos.find(function(e){return function(t){return t.supported&&null!=t.keySystemAccess&&t.keySystemAccess.keySystem==e.Di}}(a)))return s.keySystemAccess}for(r=p([!0,!1]),a=r.next();!a.done;a=r.next())for(a=a.value,o=p(t),s=o.next();!s.done;s=o.next())for(var u=(s=p(s.value.decodingInfos)).next();!u.done;u=s.next())if((u=u.value).supported&&u.keySystemAccess){var l=u.keySystemAccess.keySystem;if(!i.includes(l)){var c=n.get(l);for(!c&&e.h.keySystemsMapping[l]&&(c=n.get(e.h.keySystemsMapping[l])),c=(l=p(c)).next();!c.done;c=l.next())if(!!c.value.licenseServerUri==a)return u.keySystemAccess}}return null}(t,n,i),!r){if(!navigator.requestMediaKeySystemAccess)throw new Ue(2,6,6020);throw new Ue(2,6,6001)}Jr(t.l),S(l,2),r.getConfiguration();var c=a=t.h.keySystemsMapping[r.keySystem]||r.keySystem,d=i.get(a),h=[],f=[],m=[],v=[],y=[],b=new Set,_=new Set;!function(t,n,i,r,a,o,s,u){for(var l=[],c=(t=p(t)).next(),d={};!c.done;d={Ka:void 0},c=t.next()){if(d.Ka=c.value,n.includes(d.Ka.encryptionScheme)||n.push(d.Ka.encryptionScheme),"org.w3.clearkey"==d.Ka.keySystem&&d.Ka.licenseServerUri.startsWith("data:application/json;base64,")?l.includes(d.Ka.licenseServerUri)||l.push(d.Ka.licenseServerUri):i.includes(d.Ka.licenseServerUri)||i.push(d.Ka.licenseServerUri),a.includes(d.Ka.serverCertificateUri)||a.push(d.Ka.serverCertificateUri),d.Ka.serverCertificate&&(r.some(function(e){return function(t){return Re(t,e.Ka.serverCertificate)}}(d))||r.push(d.Ka.serverCertificate)),d.Ka.initData)for(var h=(c=p(d.Ka.initData)).next(),f={};!h.done;f={Lg:void 0},h=c.next())f.Lg=h.value,o.some(function(e){return function(t){var n=e.Lg;return!(!t.keyId||t.keyId!=n.keyId)||t.initDataType==n.initDataType&&Re(t.initData,n.initData)}}(f))||o.push(f.Lg);if(d.Ka.keyIds)for(h=(c=p(d.Ka.keyIds)).next();!h.done;h=c.next())s.add(h.value);if(d.Ka.keySystemUris&&u)for(c=(d=p(d.Ka.keySystemUris)).next();!c.done;c=d.next())u.add(c.value)}if(1==l.length)i.push(l[0]);else if(l.length>0){for(n=[],r=(l=p(l)).next();!r.done;r=l.next())r=e.atob(r.value.split("data:application/json;base64,").pop()),r=JSON.parse(r),n.push.apply(n,g(r.keys));l=JSON.stringify({keys:n}),i.push("data:application/json;base64,"+e.btoa(l))}}(d,h,f,v,m,y,b,_);var T=t.R?"persistent-license":"temporary";for(c={keySystem:c,encryptionScheme:h[0],licenseServerUri:f[0],distinctiveIdentifierRequired:d[0].distinctiveIdentifierRequired,persistentStateRequired:d[0].persistentStateRequired,sessionType:d[0].sessionType||T,audioRobustness:d[0].audioRobustness||"",videoRobustness:d[0].videoRobustness||"",serverCertificate:v[0],serverCertificateUri:m[0],initData:y,keyIds:b},_.size>0&&(c.keySystemUris=_),_=(d=p(d)).next();!_.done;_=d.next())(_=_.value).distinctiveIdentifierRequired&&(c.distinctiveIdentifierRequired=_.distinctiveIdentifierRequired),_.persistentStateRequired&&(c.persistentStateRequired=_.persistentStateRequired);if(t.g=c,!t.g.licenseServerUri)throw new Ue(2,6,6012,t.g.keySystem);return w(l,r.createMediaKeys(),4);case 4:if(o=l.h,Jr(t.l),t.B=o,""==t.h.minHdcpVersion||!("getStatusForPolicy"in t.B)){l.A(5);break}return S(l,6),w(l,t.B.getStatusForPolicy({minHdcpVersion:t.h.minHdcpVersion}),8);case 8:if("usable"!=l.h)throw new Ue(2,6,6018);Jr(t.l),x(l,5,2);break;case 6:if((s=k(l,2))instanceof Ue)throw s;throw new Ue(2,6,6019,s.message);case 5:return t.T=!0,t.G.Ea(t.h.updateExpirationTime),w(l,function(e){var t,n;return R((function(i){switch(i.g){case 1:if(!e.B||!e.g)return i.return();if(!e.g.serverCertificateUri||e.g.serverCertificate&&e.g.serverCertificate.length){i.A(2);break}return t=Vr([e.g.serverCertificateUri],e.h.retryParameters),S(i,3),w(i,e.F.tc.request(5,t,{isPreload:e.V()}).promise,5);case 5:n=i.h,e.g.serverCertificate=Le(n.data),x(i,4);break;case 3:throw new Ue(2,6,6017,k(i));case 4:if(e.l.g)return i.return();case 2:return e.g.serverCertificate&&e.g.serverCertificate.length?(S(i,6),w(i,e.B.setServerCertificate(e.g.serverCertificate),8)):i.return();case 8:x(i,0);break;case 6:throw new Ue(2,6,6004,k(i).message)}}))}(t),9);case 9:Jr(t.l),x(l,0);break;case 2:if(u=k(l),Jr(t.l,u),t.g=null,u instanceof Ue)throw u;throw new Ue(2,6,6002,u.message)}}))}function ka(e){Da(e)&&e.m.resolve()}function Aa(e,t){new Si((function(){t.loaded=!0,ka(e)})).ia(ja)}function Ea(e,t,n){var i,r,a,o,s,u,l;return R((function(c){switch(c.g){case 1:try{i=e.B.createSession("persistent-license")}catch(t){return r=new Ue(2,6,6005,t.message),e.u(r),c.return(Promise.reject(r))}return e.o.D(i,"message",(function(t){e.j&&e.h.delayLicenseRequestUntilPlayed&&e.j.paused&&!e.$?e.N.push(t):Ia(e,t)})),e.o.D(i,"keystatuseschange",(function(t){return Ca(e,t)})),a={initData:n.initData,initDataType:n.initDataType,loaded:!1,Ug:1/0,Kb:null,type:"persistent-license"},e.i.set(i,a),S(c,2),w(c,i.load(t),4);case 4:return o=c.h,Jr(e.l),o||(e.i.delete(i),s=e.h.persistentSessionOnlinePlayback?1:2,e.u(new Ue(s,6,6013)),a.loaded=!0),Aa(e,a),ka(e),c.return(i);case 2:u=k(c),Jr(e.l,u),e.i.delete(i),l=e.h.persistentSessionOnlinePlayback?1:2,e.u(new Ue(l,6,6005,u.message)),a.loaded=!0,ka(e);case 3:return c.return(Promise.resolve())}}))}function Ia(e,t){var n,i,r,a,o,s,u,l,c,d,h,f,g,m,v,y;R((function(b){switch(b.g){case 1:if(n=t.target,e.h.logLicenseExchange&&Je(t.message),i=e.i.get(n),r=e.g.licenseServerUri,a=e.h.advanced[e.g.keySystem],"individualization-request"==t.messageType&&a&&a.individualizationServer&&(r=a.individualizationServer),(o=Vr([r],e.h.retryParameters)).body=t.message,o.method="POST",o.licenseRequestType=t.messageType,o.sessionId=n.sessionId,o.drmInfo=e.g,i&&(o.initData=i.initData,o.initDataType=i.initDataType),a&&a.headers)for(s in a.headers)o.headers[s]=a.headers[s];if("org.w3.clearkey"===e.g.keySystem){var T=o,A=e.g;try{var E=qe(T.body);if(E){var I=JSON.parse(E);I.type||(I.type=A.sessionType,T.body=Ge(JSON.stringify(I)))}}catch(e){}}if(br(e.g.keySystem))if((T=Ve(o.body,!0,!0)).includes("PlayReadyKeyMessage")){for(E=(A=p(A=Yt(T=qt(T,"PlayReadyKeyMessage"),"HttpHeader"))).next();!E.done;E=A.next())E=Yt(I=E.value,"name")[0],I=Yt(I,"value")[0],o.headers[Wt(E)]=Wt(I);T=Yt(T,"Challenge")[0],o.body=Qe(Wt(T))}else o.headers["Content-Type"]="text/xml; charset=utf-8";return u=Date.now(),S(b,2),c=e.F.tc.request(2,o,{isPreload:e.V()}),e.X.push(c),w(b,c.promise,4);case 4:l=b.h,J(e.X,c),x(b,3);break;case 2:return d=k(b),e.l.g?b.return():(h={sessionId:n.sessionId,sessionType:i.type,initData:i.initData,initDataType:i.initDataType},f=new Ue(2,6,6007,d,h),1==e.i.size?(e.u(f),i&&i.Kb&&i.Kb.reject(f)):(i&&i.Kb&&i.Kb.reject(f),e.i.delete(n),Da(e)&&(e.m.resolve(),e.M.ia(.1))),b.return());case 3:return e.l.g?b.return():(e.J+=(Date.now()-u)/1e3,e.h.logLicenseExchange&&Je(l.data),S(b,5),w(b,n.update(l.data),7));case 7:x(b,6);break;case 5:return m=(g=k(b))&&g.message||String(g),v=new Ue(2,6,6008,m),e.u(v),i&&i.Kb&&i.Kb.reject(v),b.return();case 6:if(e.l.g)return b.return();y=new Dr("drmsessionupdate"),e.F.onEvent(y),i&&(i.Kb&&i.Kb.resolve(),Aa(e,i)),_(b)}}))}function Ca(e,t){t=t.target;var n=e.i.get(t),i=!1;t.keyStatuses.forEach((function(t,r){if("string"==typeof r){var a=r;r=t,t=a}if(a=ae(),br(e.g.keySystem)&&16==r.byteLength&&a.gh()){var o=(a=Oe(r)).getUint32(0,!0),s=a.getUint16(4,!0),u=a.getUint16(6,!0);a.setUint32(0,o,!1),a.setUint16(4,s,!1),a.setUint16(6,u,!1)}"status-pending"!=t&&(n.loaded=!0),"expired"==t&&(i=!0),r=et(r).slice(0,32),e.aa.set(r,t)}));var r=t.expiration-Date.now();(r<0||i&&r<1e3)&&n&&!n.Kb&&(e.i.delete(t),Ma(t)),Da(e)&&(e.m.resolve(),e.M.ia(Ua))}function Ma(e){return R((function(t){return 1==t.g?(S(t,2),w(t,Ai(Oa,Promise.all([e.close().catch((function(){})),e.closed])),4)):2!=t.g?x(t,0):(k(t),void _(t))}))}function Pa(e){var t;return R((function(n){return t=Array.from(e.i.entries()),e.i.clear(),w(n,Promise.all(t.map((function(t){var n=(t=p(t)).next().value,i=t.next().value;return R((function(t){return 1==t.g?(S(t,2),e.oa||e.C.has(n.sessionId)||"persistent-license"!==i.type||e.h.persistentSessionOnlinePlayback?w(t,Ma(n),5):w(t,n.remove(),5)):2!=t.g?x(t,0):(k(t),void _(t))}))}))),0)}))}function Ra(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function Da(e){return function(e,t){for(var n=(e=p(e)).next();!n.done;n=e.next())if(!t(n.value))return!1;return!0}(e=e.i.values(),(function(e){return e.loaded}))}function La(t,n,i,r){var a=t.keySystem;!a||"org.w3.clearkey"==a&&t.licenseServerUri||(n.size&&n.get(a)&&(n=n.get(a),t.licenseServerUri=n),t.keyIds||(t.keyIds=new Set),(i=i.get(a))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=i.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=i.persistentStateRequired),t.serverCertificate||(t.serverCertificate=i.serverCertificate),i.sessionType&&(t.sessionType=i.sessionType),t.serverCertificateUri||(t.serverCertificateUri=i.serverCertificateUri)),r[a]&&(t.keySystem=r[a]),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==a&&(t.keySystem="com.chromecast.playready"))}function Na(e,t){if(0!=(e=Zr(e)).size){e=rt(e);for(var n=(t=p(t)).next();!n.done;n=t.next())(n=n.value).video&&(n.video.drmInfos=[e]),n.audio&&(n.audio.drmInfos=[e])}}(i=va.prototype).destroy=function(){return this.l.destroy()},i.configure=function(e,t){this.h=e,t&&(this.V=t),this.G&&this.T&&this.g&&this.G.Ea(this.h.updateExpirationTime)},i.fc=function(e){var t,n,i=this;return R((function(r){if(1==r.g)return i.j===e?r.return():i.B?(i.j=e,i.h.delayLicenseRequestUntilPlayed&&i.o.Ba(i.j,"play",(function(){for(var e=p(i.N),t=e.next();!t.done;t=e.next())Ia(i,t.value);i.$=!0,i.N=[]})),i.j.remote?(i.o.D(i.j.remote,"connect",(function(){return Pa(i)})),i.o.D(i.j.remote,"connecting",(function(){return Pa(i)})),i.o.D(i.j.remote,"disconnect",(function(){return Pa(i)}))):"webkitCurrentPlaybackTargetIsWireless"in i.j&&i.o.D(i.j,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return Pa(i)})),i.H=i.g&&i.g.initData.find((function(e){return e.initData.length>0}))||null,t=i.g.keySystem,(n=ae().Rg(t))||!i.H&&"com.apple.fps"===i.g.keySystem&&!i.C.size?r.A(2):w(r,wa(i),2)):(i.o.Ba(e,"encrypted",(function(){i.u(new Ue(2,6,6010))})),r.return());_a(i).catch((function(){})),!n&&(i.H||i.C.size||i.h.parseInbandPsshEnabled)||i.o.D(i.j,"encrypted",(function(e){return function(e,t){return R((function(n){if(1==n.g)return w(n,wa(e),2);Sa(e,t.initDataType,Le(t.initData)),_(n)}))}(i,e)})),_(r)}))},i.Gg=function(){var e=this,t=this.i.keys();return t=Qr(t,(function(t){var n=e.i.get(t);return{sessionId:t.sessionId,sessionType:n.type,initData:n.initData,initDataType:n.initDataType}})),Array.from(t)},i.Wd=function(){for(var e=1/0,t=this.i.keys(),n=(t=p(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},i.Xe=function(){return ea(this.ma)};var Oa=1,ja=5,Ua=.5;function Fa(){this.g=Va,this.i=(new Map).set(Va,2).set(Ha,1),this.h=0}function Ba(e,t){var n=e.g!==t;return e.g=t,n&&t===Va&&(e.h=Date.now()),n}var Ha=0,Va=1;function qa(e,t,n){this.g=e,this.i=t,this.h=n}function Ga(e,t){return R((function(n){if(1==n.g)return w(n,Bi(e.h,t,e.g.drm.preferredKeySystems,e.g.drm.keySystemsMapping),2);if(e.g.streaming.dontChooseCodecs||Ui(t,e.g.preferredVideoCodecs,e.g.preferredAudioCodecs,e.g.preferredDecodingAttributes,e.g.preferredTextFormats),!t.variants.some(er))throw new Ue(2,4,4032);return n.return($a(e,t))}))}function za(e,t){var n=e.g.restrictions;e=e.i;for(var i=!1,r=(t=p(t.variants)).next();!r.done;r=t.next()){var a=(r=r.value).allowedByApplication;r.allowedByApplication=Fi(r,n,e),a!=r.allowedByApplication&&(i=!0)}return i}function $a(e,t){var n=za(e,t);if(t){var i=e.h?e.h.g:null;if(i&&e.h.B){for(var r=new Set,a=p(t.variants),o=a.next();!o.done;o=a.next())(o=o.value).audio&&r.add(o.audio),o.video&&r.add(o.video);for(a=(r=p(r)).next();!a.done;a=r.next())Ka(e,i.keySystem,a.value)}Wa(e,t)}return n}function Ka(e,t,n){for(var i=(n=p(n.drmInfos)).next();!i.done;i=n.next())if((i=i.value).keySystem==t)for(var r=(i=p(i.initData||[])).next();!r.done;r=i.next())r=r.value,Sa(e.h,r.initDataType,r.initData)}function Wa(e,t){e=e.h?e.h.Xe():{};var n=Object.keys(e);n=n.length&&"00"==n[0];for(var i=!1,r=!1,a=new Set,o=new Set,s=new Set,u=(t=p(t.variants)).next();!u.done;u=t.next())(u=u.value).audio&&s.add(u.audio),u.video&&s.add(u.video),u.allowedByApplication?u.allowedByKeySystem&&(i=!0):r=!0;for(t=(s=p(s)).next();!t.done;t=s.next())if((t=t.value).keyIds.size)for(u=(t=p(t.keyIds)).next();!u.done;u=t.next()){u=u.value;var l=e[n?"00":u];l?Xa.includes(l)&&o.add(l):a.add(u)}if(!i)throw new Ue(2,4,4012,e={hasAppRestrictions:r,missingKeys:Array.from(a),restrictedKeyStatuses:Array.from(o)})}var Xa=["output-restricted","internal-error"];function Ya(){}function Ja(e,t){Za.set(e,t)}function Qa(e,t){if(t){var n=Za.get(t.toLowerCase());if(n)return n}throw new Ue(2,4,4e3,e,t)}B("shaka.media.ManifestParser",Ya),Ya.unregisterParserByMime=function(e){Za.delete(e)},Ya.registerParserByMime=Ja,Ya.registerParserByExtension=function(){ce("ManifestParser.registerParserByExtension","Please use an ManifestParser with registerParserByMime function.")},Ya.AccessibilityPurpose={zm:"visually impaired",Kl:"hard of hearing",gm:"spoken subtitles"};var Za=new Map;function eo(e,t){var n=null,i=null,r=null,a=null,o=e.U();return 1&t&&(r=e.Dd()),2&t&&(a=e.U()),8&t&&(n=e.U()),16&t&&(i=e.U()),{trackId:o,Td:n,Ud:i,kj:r,Li:a}}function to(e,t){return 1==t?{baseMediaDecodeTime:4294967296*(t=e.U())+(e=e.U())}:{baseMediaDecodeTime:e.U()}}function no(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.U(),e.skip(4),e=e.Ca(),{timescale:t,language:String.fromCharCode(96+(e>>10))+String.fromCharCode(96+((960&e)>>5))+String.fromCharCode(96+(31&e))}}function io(e,t,n){var i=e.U(),r=[],a=null;1&n&&(a=e.Zg()),4&n&&e.skip(4);for(var o=0;o<i;o++){var s={ih:null,sampleSize:null,Cf:null};256&n&&(s.ih=e.U()),512&n&&(s.sampleSize=e.U()),1024&n&&e.skip(4),2048&n&&(s.Cf=0==t?e.U():e.Zg()),r.push(s)}return{Fm:i,hh:r,mg:a}}function ro(e){e.skip(6),e.skip(2),e.skip(8);var t=e.Ca();return e.skip(2),e.skip(2),e.skip(2),{channelCount:t,sampleRate:e=e.Ca()+e.Ca()/65536}}function ao(e){return{codec:da(e=e.U())}}function oo(e,t){return t=void 0!==t&&t,e=e.toString(16).toUpperCase(),t?e:("0"+e).slice(-2)}function so(e){return(e<10?"0":"")+e}function uo(e){this.g=e}function lo(e){for(var t=[],n=p(e.g),i=n.next();!i.done;i=n.next()){var r=t,a=r.push,o=i.value;i=wo;var s=o.id+1,u=o.stream.width||0,l=o.stream.height||0;"audio"==o.type&&(l=u=0);var c=o.duration*o.timescale,d=Math.floor(c/(_o+1));switch(c=Math.floor(c%(_o+1)),s=wo("tkhd",s=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(g(vo(s,4)),[0,0,0,0],g(vo(d,4)),g(vo(c,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],g(vo(u,2)),[0,0],g(vo(l,2)),[0,0]))),u=wo,d=o.duration*o.timescale,l=Math.floor(d/(_o+1)),d=Math.floor(d%(_o+1)),c=(c=o.stream.language).charCodeAt(0)-96<<10|c.charCodeAt(1)-96<<5|c.charCodeAt(2)-96,l=wo("mdhd",l=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(g(vo(o.timescale,4)),g(vo(l,4)),g(vo(d,4)),g(vo(c,2)),[0,0]))),d=o,c=new Uint8Array([]),d.type){case"video":c=To.value();break;case"audio":c=xo.value()}d=wo("hdlr",c);e:{switch(o.type){case"video":o=wo("minf",wo("vmhd",Co.value()),Do.value(),co(o));break e;case"audio":o=wo("minf",wo("smhd",Mo.value()),Do.value(),co(o));break e}o=new Uint8Array([])}i=i("trak",s,o=u("mdia",l,d,o)),a.call(r,i)}for(t=tt.apply(Xe,g(t)),n=wo,i=(a=e.g[0]).duration*a.timescale,r=Math.floor(i/(_o+1)),i=Math.floor(i%(_o+1)),r=wo("mvhd",r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(g(vo(a.timescale,4)),g(vo(r,4)),g(vo(i,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))),i=[],u=(e=p(e.g)).next();!u.done;u=e.next())s=(o=i).push,u=wo("trex",u=new Uint8Array([0,0,0,0].concat(g(vo(u.value.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]))),s.call(o,u);if(e=wo("mvex",e=tt.apply(Xe,g(i))),i=[],a.encrypted){for(o=(a=p(a.stream.drmInfos)).next();!o.done;o=a.next())if((o=o.value).initData)for(s=(o=p(o.initData)).next();!s.done;s=o.next())i.push(s.value.initData);a=tt.apply(Xe,g(i))}else a=new Uint8Array([]);return e=n("moov",r,t,e,a),t=Ro.value(),(n=new Uint8Array(t.byteLength+e.byteLength)).set(t),n.set(e,t.byteLength),n}function co(e){var t=wo,n="aac";e.codecs.includes("mp3")?n="mp3":e.codecs.includes("ac-3")?n=ae().oe()?"ec-3":"ac-3":e.codecs.includes("ec-3")?n="ec-3":e.codecs.includes("opus")&&(n="opus");var i=new Uint8Array([]);switch(e.type){case"video":if(e.codecs.includes("avc1")){if(n=e.stream.width||0,i=e.stream.height||0,e.Ra.byteLength>0)var r=wo("avcC",e.Ra);else{r=wo;for(var a=7,o=[],s=[],u=0,l=0,c=0,d=0;d<e.Bb.length;d++){var h=yo(e.Bb[d]);switch(31&h[0]){case 7:o.push(h),a+=h.length+2;break;case 8:s.push(h),a+=h.length+2}}for(o.length>0&&(u=o[0][1],c=o[0][2],l=o[0][3]),d=0,(a=new Uint8Array(a))[d++]=1,a[d++]=u,a[d++]=c,a[d++]=l,a[d++]=255,a[d++]=224|o.length,u=0;u<o.length;u++)a[d++]=(65280&o[u].length)>>8,a[d++]=255&o[u].length,a.set(o[u],d),d+=o[u].length;for(a[d++]=s.length,o=0;o<s.length;o++)a[d++]=(65280&s[o].length)>>8,a[d++]=255&s[o].length,a.set(s[o],d),d+=s[o].length;r=r("avcC",a)}n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(g(vo(n,2)),g(vo(i,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),i="avc1",s=ho(e),o=new Uint8Array([]),e.encrypted&&(o=po(e.stream,e.codecs),i="encv"),i=wo(i,n,r,s,o)}else e.codecs.includes("hvc1")&&(i=e.stream.width||0,r=e.stream.height||0,n=new Uint8Array([]),e.Ra.byteLength>0&&(n=wo("hvcC",e.Ra)),i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(g(vo(i,2)),g(vo(r,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),r="hvc1",s=ho(e),o=new Uint8Array([]),e.encrypted&&(o=po(e.stream,e.codecs),r="encv"),i=wo(r,i,n,s,o));break;case"audio":"mp3"==n?e=wo(".mp3",fo(e)):"ac-3"==n?(n=wo("dac3",e.Ga),i="ac-3",r=new Uint8Array([]),e.encrypted&&(r=po(e.stream,e.codecs),i="enca"),e=wo(i,fo(e),n,r)):"ec-3"==n?(n=wo("dec3",e.Ga),i="ec-3",r=new Uint8Array([]),e.encrypted&&(r=po(e.stream,e.codecs),i="enca"),e=wo(i,fo(e),n,r)):"opus"==n?(n=wo("dOps",e.Ga),i="Opus",r=new Uint8Array([]),e.encrypted&&(r=po(e.stream,e.codecs),i="enca"),e=wo(i,fo(e),n,r)):(e.Ga.byteLength>0?n=wo("esds",e.Ga):(n=wo,i=e.id+1,r=e.stream.channelsCount||2,o=e.stream.audioSamplingRate||44100,u=at("audio",e.codecs.split(",")),s=(l={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12})[o],"mp4a.40.5"!==u&&"mp4a.40.29"!==u||(s=l[2*o]),o=parseInt(u.split(".").pop(),10),n=n("esds",i=new Uint8Array([0,0,0,0,3,25].concat(g(vo(i,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,o<<3|s>>>1,s<<7|r<<3,6,1,2])))),i="mp4a",r=new Uint8Array([]),e.encrypted&&(r=po(e.stream,e.codecs),i="enca"),e=wo(i,fo(e),n,r)),i=e}return t("stbl",e=wo("stsd",Po.value(),i),wo("stts",ko.value()),wo("stsc",Ao.value()),wo("stsz",Io.value()),wo("stco",Eo.value()))}function ho(e){if(!e.Za&&!e.$a)return new Uint8Array([]);var t=e.$a;return wo("pasp",e=new Uint8Array([].concat(g(vo(e.Za,4)),g(vo(t,4)))))}function fo(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat(g(vo(e.stream.audioSamplingRate||44100,2)),[0,0]))}function po(e,t){var n=wo;t=wo("frma",t=new Uint8Array([].concat(g(vo(bo(t.split(".")[0]),4)))));var i="cenc",r=e.drmInfos[0];r&&r.encryptionScheme&&(i=r.encryptionScheme),i=wo("schm",i=new Uint8Array([0,0,0,0].concat(g(vo(bo(i),4)),[0,1,0,0]))),r=wo;for(var a=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),o=(e=p(e.drmInfos)).next();!o.done;o=e.next())if((o=o.value)&&o.keyIds&&o.keyIds.size)for(var s=(o=p(o.keyIds)).next();!s.done;s=o.next())a=yo(s.value);return n("sinf",t,i,r("schi",a=wo("tenc",e=new Uint8Array([0,0,0,0,0,0,1,8]),a)))}function go(e){for(var t=[],n=(e=p(e.g)).next();!n.done;n=e.next()){n=n.value;var i,r=t.push,a=r.apply,o=wo,s=new Uint8Array([0,0,0,0].concat(g(vo(n.data?n.data.sequenceNumber:0,4))));s=wo("mfhd",s);var u=n.data?n.data.zb:[],l=new Uint8Array(4+u.length);for(i=0;i<u.length;i++){var c=u[i].flags;l[i+4]=c.hb<<4|c.mb<<2|c.jb}var d=(u=wo("sdtp",l)).length+32+20+8+16+8+8;l=wo,i=wo("tfhd",i=new Uint8Array([0,0,0,58].concat(g(vo(n.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]))),c=n.data?n.data.baseMediaDecodeTime:0;var h=Math.floor(c%(_o+1));c=wo("tfdt",c=new Uint8Array([1,0,0,0].concat(g(vo(Math.floor(c/(_o+1)),4)),g(vo(h,4)))));var f=d,m=12+16*(h=(d=n.data?n.data.zb:[]).length),v=new Uint8Array(m);for(f+=8+m,v.set(["video"===n.type?1:0,0,15,1].concat(g(vo(h,4)),g(vo(f,4))),0),f=0;f<h;f++){var y=d[f];m=vo(y.duration,4);var b=vo(y.size,4),w=y.flags;y=vo(y.sb,4),v.set([].concat(g(m),g(b),[w.xb<<2|w.hb,w.mb<<6|w.jb<<4|w.yb,61440&w.gb,15&w.gb],g(y)),12+16*f)}o=o("moof",s,u=l("traf",i,c,d=wo("trun",v),u)),a.call(r,t,[o,mo(n)])}return tt.apply(Xe,g(t))}function mo(e){return e=(e.data?e.data.zb:[]).map((function(e){return e.data})),wo("mdat",e=tt.apply(Xe,g(e)))}function vo(e,t){var n=[];for(--t;t>=0;t--)n.push(e>>8*t&255);return n}function yo(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length/2;n+=1)t[n]=parseInt(String(e[2*n]+e[2*n+1]),16);return t}function bo(e){for(var t=0,n=0;n<e.length;n+=1)t|=e.charCodeAt(n)<<8*(e.length-n-1);return t}function wo(e){var t=D.apply(1,arguments),n=So.get(e);n||(n=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],So.set(e,n));for(var i=8,r=t.length-1;r>=0;r--)i+=t[r].byteLength;for((r=new Uint8Array(i))[0]=i>>24&255,r[1]=i>>16&255,r[2]=i>>8&255,r[3]=255&i,r.set(n,4),n=0,i=8;n<t.length;n++)r.set(t[n],i),i+=t[n].byteLength;return r}B("shaka.config.CodecSwitchingStrategy",{RELOAD:"reload",SMOOTH:"smooth"});var _o=4294967295,So=new Map,To=new re((function(){return new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0])})),xo=new re((function(){return new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])})),ko=new re((function(){return new Uint8Array([0,0,0,0,0,0,0,0])})),Ao=new re((function(){return new Uint8Array([0,0,0,0,0,0,0,0])})),Eo=new re((function(){return new Uint8Array([0,0,0,0,0,0,0,0])})),Io=new re((function(){return new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0])})),Co=new re((function(){return new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])})),Mo=new re((function(){return new Uint8Array([0,0,0,0,0,0,0,0])})),Po=new re((function(){return new Uint8Array([0,0,0,0,0,0,0,1])})),Ro=new re((function(){var e=new Uint8Array([105,115,111,109]),t=new Uint8Array([97,118,99,49]);return wo("ftyp",e,new Uint8Array([0,0,0,1]),e,t)})),Do=new re((function(){var e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);return e=wo("dref",e),wo("dinf",e)}));function Lo(e){function t(e){o.push(e),aa(e)}var n,i,r,a,o=[];if((new ra).box("moof",t).box("traf",t).S("tfhd",(function(e){n=e,r=eo(e.reader,e.flags)})).S("trun",(function(e){i=e,a=io(e.reader,e.version,e.flags)})).parse(e),r&&2!==r.Li){var s=n.start+ha(n)+4+(null!==r.kj?8:0),u=Oe(e);if(null!==r.Li)u.setUint32(s,2);else{Oo(e,n.start,n.size+4);var l=u.getUint32(n.start+8);u.setUint32(n.start+8,2|l),a&&null!==a.mg&&u.setInt32(i.start+ha(i)+4,a.mg+4),l=e.subarray(0,s),u=e.subarray(s),(e=new Uint8Array(e.byteLength+4)).set(l),l=[];for(var c=3;c>=0;c--)l.push(2>>8*c&255);for(e.set(new Uint8Array(l),s),e.set(u,s+4),u=(s=p(o)).next();!u.done;u=s.next())Oo(e,(u=u.value).start,u.size+4)}}return e}function No(e,t,n,i,r,a){var o=po(e,i.name),s=t.subarray(i.start,i.start+i.size);for((e=new Uint8Array(i.size+o.byteLength)).set(s,0),Oe(e).setUint32(4,a),e.set(o,i.size),Oo(e,0,e.byteLength),a=new Uint8Array(t.byteLength+e.byteLength),i=ae().df()?i.start:i.start+i.size,o=t.subarray(i),a.set(t.subarray(0,i)),a.set(e,i),a.set(o,i+e.byteLength),r=(t=p(r)).next();!r.done;r=t.next())Oo(a,(r=r.value).start,r.size+e.byteLength);return e=Oe(a,n.start),n=ha(n),t=e.getUint32(n),e.setUint32(n,t+1),a}function Oo(e,t,n){0!=(t=(e=Oe(e,t)).getUint32(0))&&(1==t?(e.setUint32(8,n>>32),e.setUint32(12,4294967295&n)):e.setUint32(0,n))}function jo(e,t,n,i,r,a,o,s){this.P=e,this.startByte=t,this.endByte=n,this.xd=void 0===i?null:i,this.timescale=void 0===r?null:r,this.h=void 0===a?null:a,this.aesKey=void 0===o?null:o,this.g=this.mimeType=this.codecs=null,this.encrypted=void 0!==s&&s}function Uo(e,t){return e===t||(e&&t?e.Ic()==t.Ic()&&e.Gc()==t.Gc()&&Z(e.P().sort(),t.P().sort())&&Re(e.Yb(),t.Yb()):e==t)}function Fo(e,t,n,i,r,a,o,s,u,l,c,d,h,f,g,m){for(l=void 0===l?[]:l,f=void 0===f?Vo:f,this.startTime=e,this.j=this.endTime=t,this.C=n,this.startByte=i,this.endByte=r,this.ba=a,this.timestampOffset=o,this.appendWindowStart=s,this.appendWindowEnd=u,this.g=l,this.tilesLayout=void 0===c?"":c,this.B=void 0===d?null:d,this.h=void 0===h?null:h,this.status=f,this.preload=!1,this.l=!0,this.o=!1,this.aesKey=void 0===g?null:g,this.thumbnailSprite=null,this.i=-1,this.m=void 0!==m&&m,this.ee=this.Xc=!1,t=(e=p(this.g)).next();!t.done;t=e.next())t.value.ri();this.m&&this.g.length&&this.g[this.g.length-1].pi(),this.u=this.bandwidth=this.mimeType=this.codecs=null,this.F=!1}function Bo(e){if(e.endByte)return e.endByte+1-e.startByte;if(e.bandwidth){var t=e.bandwidth*(e.endTime-e.startTime);if(!isNaN(t)&&t>0)return t}if(e.g.length>0&&e.m)for(e=(e=p(e.g)).next();!e.done;e=e.next()){Bo(e.value);break}return null}function Ho(e,t){e.ba=t;for(var n=(e=p(e.g)).next();!n.done;n=e.next())Ho(n.value,t)}jo.prototype.Ic=function(){return this.startByte},jo.prototype.Gc=function(){return this.endByte},jo.prototype.pe=function(e){this.h=e},jo.prototype.Yb=function(){return this.h},B("shaka.media.InitSegmentReference",jo),jo.prototype.getEndByte=jo.prototype.Gc,jo.prototype.getStartByte=jo.prototype.Ic,(i=Fo.prototype).P=function(){return this.C()},i.getStartTime=function(){return this.startTime},i.Ej=function(){return this.endTime},i.Ic=function(){return this.startByte},i.Gc=function(){return this.endByte},i.$j=function(){return this.tilesLayout},i.Zj=function(){return this.B},i.Jc=function(){return this.status},i.xk=function(){this.status=qo},i.Qg=function(){this.preload=!0},i.isPreload=function(){return this.preload},i.wd=function(){this.l=!1},i.kk=function(){return this.l},i.ri=function(){this.Xc=!0},i.nk=function(){return this.Xc},i.pi=function(){this.ee=!0},i.lk=function(){return this.ee},i.oi=function(){this.o=!0},i.gk=function(){return this.o},i.If=function(e){this.thumbnailSprite=e},i.Xj=function(){return this.thumbnailSprite},i.offset=function(e){this.startTime+=e,this.endTime+=e,this.j+=e;for(var t=p(this.g),n=t.next();!n.done;n=t.next())(n=n.value).startTime+=e,n.endTime+=e,n.j+=e},i.yh=function(e){null==this.h?z("Sync attempted without sync time!"):(e=this.h-e-this.startTime,Math.abs(e)>=.001&&this.offset(e))},i.pe=function(e,t){this.u=e,this.F=void 0!==t&&t},i.Yb=function(e){var t=this.u;return(void 0===e||e)&&this.F&&(this.u=null),t},B("shaka.media.SegmentReference",Fo),Fo.prototype.getSegmentData=Fo.prototype.Yb,Fo.prototype.setSegmentData=Fo.prototype.pe,Fo.prototype.syncAgainst=Fo.prototype.yh,Fo.prototype.offset=Fo.prototype.offset,Fo.prototype.getThumbnailSprite=Fo.prototype.Xj,Fo.prototype.setThumbnailSprite=Fo.prototype.If,Fo.prototype.hasByterangeOptimization=Fo.prototype.gk,Fo.prototype.markAsByterangeOptimization=Fo.prototype.oi,Fo.prototype.isLastPartial=Fo.prototype.lk,Fo.prototype.markAsLastPartial=Fo.prototype.pi,Fo.prototype.isPartial=Fo.prototype.nk,Fo.prototype.markAsPartial=Fo.prototype.ri,Fo.prototype.isIndependent=Fo.prototype.kk,Fo.prototype.markAsNonIndependent=Fo.prototype.wd,Fo.prototype.isPreload=Fo.prototype.isPreload,Fo.prototype.markAsPreload=Fo.prototype.Qg,Fo.prototype.markAsUnavailable=Fo.prototype.xk,Fo.prototype.getStatus=Fo.prototype.Jc,Fo.prototype.getTileDuration=Fo.prototype.Zj,Fo.prototype.getTilesLayout=Fo.prototype.$j,Fo.prototype.getEndByte=Fo.prototype.Gc,Fo.prototype.getStartByte=Fo.prototype.Ic,Fo.prototype.getEndTime=Fo.prototype.Ej,Fo.prototype.getStartTime=Fo.prototype.getStartTime,Fo.prototype.getUris=Fo.prototype.P;var Vo=0,qo=1;function Go(e){return 1==e.length&&e.end(0)-e.start(0)<1e-4}function zo(e){return!e||Go(e)?null:1==e.length&&e.start(0)<0?0:e.length?e.start(0):null}function $o(e){return!e||Go(e)?null:e.length?e.end(e.length-1):null}function Ko(e,t){return!(!e||!e.length||Go(e)||t>e.end(e.length-1))&&t>=e.start(0)}function Wo(e,t){if(!e||!e.length||Go(e))return 0;for(var n=0,i=(e=p(Xo(e))).next();!i.done;i=e.next()){var r=i.value;i=r.start,(r=r.end)>t&&(n+=r-Math.max(i,t))}return n}function Xo(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function Yo(){}function Jo(e,t){var n=document.createElement("source");return n.src=e,n.type=void 0===t?"":t,n}function Qo(e){for(var t=!1,n=e.getElementsByTagName("source"),i=n.length-1;i>=0;--i)e.removeChild(n[i]),t=!0;return e.src&&(e.removeAttribute("src"),t=!0),t}function Zo(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function es(){return ns||(ts||(ts=new Si((function(){ns=null}))),(ns=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(ns=document.createElement("video")),ts.ia(1),ns)}Fo.Status={ql:Vo,xm:qo,Tl:2},B("shaka.util.Dom",Yo),Yo.removeAllChildren=Zo,Yo.clearSourceFromVideo=Qo;var ts=null,ns=null;function is(){}function rs(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function as(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function os(e,t){var n=(127&e[t])<<21;return n|=(127&e[t+1])<<14,(n|=(127&e[t+2])<<7)|127&e[t+3]}function ss(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if("APIC"===e.type){if(e.size<2||3!==e.data[0])return null;var n=e.data.subarray(1).indexOf(0);if(-1===n)return null;var i=He(Le(e.data,1,n)),r=e.data[2+n],a=e.data.subarray(3+n).indexOf(0);if(-1===a)return null;var o,s=He(Le(e.data,3+n,a));return o="--\x3e"===i?He(Le(e.data,4+n+a)):De(e.data.subarray(4+n+a)),t.mimeType=i,t.pictureType=r,t.description=s,t.data=o,t}return"TXXX"===e.type||"WXXX"===e.type?e.size<2||3!==e.data[0]||-1===(i=e.data.subarray(1).indexOf(0))?null:(n=He(Le(e.data,1,i)),e=He(Le(e.data,2+i)).replace(/\0*$/,""),t.description=n,t.data=e,t):"PRIV"===e.type?e.size<2||-1===(n=e.data.indexOf(0))?null:(n=He(Le(e.data,0,n)),t.description=n,"com.apple.streaming.transportStreamTimestamp"==n?(n=e.data.subarray(n.length+1),e=1&n[3],n=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7],n/=45,e&&(n+=47721858.84),t.data=n):(e=De(e.data.subarray(n.length+1)),t.data=e),t):"T"===e.type[0]?e.size<2||3!==e.data[0]?null:(e=He(e.data.subarray(1)).replace(/\0*$/,""),t.data=e,t):"W"===e.type[0]?(e=He(e.data).replace(/\0*$/,""),t.data=e,t):e.data?(t.data=De(e.data),t):null}function us(e){for(var t=0,n=[];rs(e,t);){var i=os(e,t+6);for(e[t+5]>>6&1&&(t+=10),i=(t+=10)+i;t+10<i;){var r=e.subarray(t),a=os(r,4);(a=ss(r={type:String.fromCharCode(r[0],r[1],r[2],r[3]),size:a,data:r.subarray(10,10+a)}))&&n.push(a),t+=r.size+10}as(e,t)&&(t+=10)}return n}function ls(e,t){for(var n=t=void 0===t?0:t,i=0;rs(e,t);)e[t+5]>>6&1&&(i+=10),i+=10,i+=os(e,t+6),as(e,t+10)&&(i+=10),t+=i;return i>0?e.subarray(n,n+i):new Uint8Array([])}function cs(e){return new Date(Date.UTC(1900,0,1,0,0,0,0)+e).getTime()}function ds(e,t){if(this.j=e,void 0!==t&&t){t=new Uint8Array(e.byteLength);for(var n=0,i=0;i<e.byteLength;i++)i>=2&&3==e[i]&&0==e[i-1]&&0==e[i-2]||(t[n]=e[i],n++);this.j=Le(t,0,n)}this.i=this.j.byteLength,this.g=this.h=0}function hs(e){var t=e.j.byteLength-e.i,n=new Uint8Array(4),i=Math.min(4,e.i);0!==i&&(n.set(e.j.subarray(t,t+i)),e.h=new ta(n,0).U(),e.g=8*i,e.i-=i)}function fs(e,t){if(e.g<=t){t-=e.g;var n=Math.floor(t/8);t-=8*n,e.g-=n,hs(e)}e.h<<=t,e.g-=t}function ps(e,t){var n=Math.min(e.g,t),i=e.h>>>32-n;return e.g-=n,e.g>0?e.h<<=n:e.i>0&&hs(e),(n=t-n)>0?i<<n|ps(e,n):i}function gs(e){var t;for(t=0;t<e.g;++t)if(e.h&2147483648>>>t)return e.h<<=t,e.g-=t,t;return hs(e),t+gs(e)}function ms(e){fs(e,1+gs(e))}function vs(e){return ps(e,gs(e)+1)-1}function ys(e){return 1&(e=vs(e))?1+e>>>1:-1*(e>>>1)}function bs(e){return 1===ps(e,1)}function ws(e){return ps(e,8)}function _s(e,t){for(var n=8,i=8,r=0;r<t;r++)0!==i&&(i=(n+(i=ys(e))+256)%256),n=0===i?n:i}function Ss(e){return ws(e),vs(e),vs(e)}function Ts(){this.I=null,this.J=!1,this.m=this.K=null,this.j=[],this.g=[],this.C=this.F=null,this.i=[],this.h=[],this.G=null,this.l=[],this.B=this.H=this.o=this.u=null}function xs(e,t){if(1!=(t[0]<<16|t[1]<<8|t[2]))return null;var n={data:new Uint8Array(0),packetLength:t[4]<<8|t[5],pts:null,dts:null,nalus:[]};if(n.packetLength&&n.packetLength>t.byteLength-6)return null;var i=t[7];if(192&i){var r=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2;null==e.u&&(e.u=r),n.pts=As(r,e.u),e.u=n.pts,n.dts=n.pts,64&i&&(i=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,null==e.o&&(e.o=i),n.dts=n.pts!=r?As(i,e.o):i),e.o=n.dts}return e=t[8]+9,t.byteLength<=e?null:(n.data=t.subarray(e),n)}function ks(e){var t=e.ud();return t.length>1&&(e=t[0].pts,t=t[1].pts,!isNaN(t-e))?String(Math.abs(1/(t-e)*9e4)):null}function As(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e}function Es(e){return!(Is(e)<0)}function Is(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71==e[n]&&71==e[n+188]&&71==e[n+376])return n;n++}return-1}B("shaka.util.Id3Utils",is),is.getID3Data=ls,is.getID3Frames=us,B("shaka.util.ExpGolomb",ds),(i=Ts.prototype).clearData=function(){this.j=[],this.g=[],this.i=[],this.h=[],this.l=[]},i.Gf=function(e){null!=this.B&&this.B!=e&&(this.o=this.u=null),this.B=e},i.parse=function(e){if(e.length<564)return this;for(var t=Math.max(0,Is(e)),n=e.length-(e.length+t)%188,i=!1,r=t;r<n;r+=188)if(71==e[r]){var a=!!(64&e[r+1]),o=((31&e[r+1])<<8)+e[r+2];if((48&e[r+3])>>4>1){var s=r+5+e[r+4];if(s==r+188)continue}else s=r+4;switch(o){case 0:a&&(s+=e[s]+1),this.I=(31&e[s+10])<<8|e[s+11];break;case 17:case 8191:break;case this.I:a&&(s+=e[s]+1),o={audio:-1,video:-1,bf:-1,audioCodec:"",videoCodec:""};var u=s+3+((15&(a=e)[s+1])<<8|a[s+2])-4;for(s+=12+((15&a[s+10])<<8|a[s+11]);s<u;){var l=(31&a[s+1])<<8|a[s+2],c=(15&a[s+3])<<8|a[s+4];switch(a[s]){case 6:if(c>0)for(var d=s+5,h=c;h>2;){var f=a[d+1]+2;switch(a[d]){case 5:var p=$e(a.subarray(d+2,d+f));-1==o.audio&&"Opus"===p?(o.audio=l,o.audioCodec="opus"):-1==o.video&&"AV01"===p&&(o.video=l,o.videoCodec="av1");break;case 106:-1==o.audio&&(o.audio=l,o.audioCodec="ac3");break;case 122:-1==o.audio&&(o.audio=l,o.audioCodec="ec3");break;case 124:-1==o.audio&&(o.audio=l,o.audioCodec="aac");break;case 127:"opus"==o.audioCodec&&(p=null,128===a[d+2]&&(p=a[d+3]),null!=p&&(this.H={channelCount:15&p?15&p:2,nj:p,sampleRate:48e3}))}d+=f,h-=f}break;case 15:-1==o.audio&&(o.audio=l,o.audioCodec="aac");break;case 17:-1==o.audio&&(o.audio=l,o.audioCodec="aac-loas");break;case 21:-1==o.bf&&(o.bf=l);break;case 27:-1==o.video&&(o.video=l,o.videoCodec="avc");break;case 3:case 4:-1==o.audio&&(o.audio=l,o.audioCodec="mp3");break;case 36:-1==o.video&&(o.video=l,o.videoCodec="hvc");break;case 129:-1==o.audio&&(o.audio=l,o.audioCodec="ac3");break;case 132:case 135:-1==o.audio&&(o.audio=l,o.audioCodec="ec3")}s+=c+5}-1!=(a=o).video&&(this.K=a.video,this.m=a.videoCodec),-1!=a.audio&&(this.F=a.audio,this.C=a.audioCodec),-1!=a.bf&&(this.G=a.bf),i&&!this.J&&(i=!1,r=t-188),this.J=!0;break;case this.K:s=e.subarray(s,r+188),a?this.j.push([s]):this.j.length&&this.j[this.j.length-1]&&this.j[this.j.length-1].push(s);break;case this.F:s=e.subarray(s,r+188),a?this.i.push([s]):this.i.length&&this.i[this.i.length-1]&&this.i[this.i.length-1].push(s);break;case this.G:s=e.subarray(s,r+188),a?this.l.push([s]):this.l.length&&this.l[this.l.length-1]&&this.l[this.l.length-1].push(s);break;default:i=!0}}return this},i.Ek=function(e){return ce("TsParser.parseAvcNalus","Please use parseNalus function instead."),this.Wg(e,{ge:null,state:null})},i.Wg=function(e,t){var n=e.pts?e.pts/9e4:null,i=(e=e.data).byteLength,r=1;"hvc"==this.m&&(r=2);var a=t.state||0,o=a,s=0,u=[],l=-1,c=0;for(-1==a&&(l=0,c="hvc"==this.m?e[0]>>1&63:31&e[0],a=0,s=1);s<i;){var d=e[s++];a?1===a?a=d?0:2:d?1==d?(d=s-a-1,l>=0?u.push({data:e.subarray(l+r,d),fullData:e.subarray(l,d),type:c,time:n,state:null}):(a=u.length?u[u.length-1]:t.ge)&&(o&&s<=4-o&&a.state&&(a.data=a.data.subarray(0,a.data.byteLength-o),a.fullData=a.fullData.subarray(0,a.fullData.byteLength-o)),d>0&&(d=e.subarray(0,d),a.data=tt(a.data,d),a.fullData=tt(a.fullData,d),a.state=0)),s<i?(c="hvc"==this.m?e[s]>>1&63:31&e[s],l=s,a=0):a=-1):a=0:a=3:a=d?0:1}return l>=0&&a>=0&&u.push({data:e.subarray(l+r,i),fullData:e.subarray(l,i),type:c,time:n,state:a}),!u.length&&t.ge&&(n=u.length?u[u.length-1]:t.ge)&&(n.data=tt(n.data,e),n.fullData=tt(n.fullData,e)),t.state=a,u},i.getMetadata=function(){for(var e=[],t=p(this.l),n=t.next();!n.done;n=t.next())(n=xs(this,n=tt.apply(Xe,g(n.value))))&&e.push({cueTime:n.pts?n.pts/9e4:null,data:n.data,frames:us(n.data),dts:n.dts,pts:n.pts});return e},i.ub=function(){if(this.i.length&&!this.h.length)for(var e=p(this.i),t=e.next();!t.done;t=e.next()){var n=tt.apply(Xe,g(t.value)),i=xs(this,n);t=this.h.length?this.h[this.h.length-1]:null,i&&null!=i.pts&&null!=i.dts&&(!t||t.pts!=i.pts&&t.dts!=i.dts)?this.h.push(i):this.h.length&&(n=i?i.data:n)&&((t=this.h.pop()).data=tt(t.data,n),this.h.push(t))}return this.h},i.ud=function(e){if(e=void 0===e||e,this.j.length&&!this.g.length){for(var t=p(this.j),n=t.next();!n.done;n=t.next()){var i=tt.apply(Xe,g(n.value)),r=xs(this,i);n=this.g.length?this.g[this.g.length-1]:null,r&&null!=r.pts&&null!=r.dts&&(!n||n.pts!=r.pts&&n.dts!=r.dts)?this.g.push(r):this.g.length&&(i=r?r.data:i)&&((n=this.g.pop()).data=tt(n.data,i),this.g.push(n))}if(e){for(t={ge:null,state:null},n=[],r=(i=p(this.g)).next();!r.done;r=i.next())(r=r.value).nalus=this.Wg(r,t),r.nalus.length&&(n.push(r),t.ge=r.nalus[r.nalus.length-1]);this.g=n}}return e?this.g:(e=this.g,this.g=[],e)},i.getStartTime=function(e){if("audio"==e){e=null;var t=this.ub();return t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e}return"video"==e?(e=null,(t=this.ud(!1)).length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e):null},i.Vd=function(){return{audio:this.C,video:this.m}},i.$e=function(){for(var e=[],t=p(this.ud()),n=t.next();!n.done;n=t.next())e.push.apply(e,g(n.value.nalus));return e},i.dk=function(){ce("TsParser.getVideoResolution","Please use getVideoInfo function instead.");var e=this.Jg();return{height:e.height,width:e.width}},i.Jg=function(){return"hvc"==this.m?function(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.$e();if(!n.length)return t;if(!(n=n.find((function(e){return 33==e.type}))))return t;var i=new ds(n.fullData,!0);ws(i),ws(i),ps(i,4);var r=ps(i,3);bs(i);var a=ps(i,2),o=ps(i,1),s=ps(i,5),u=ps(i,32);n=ws(i);for(var l=ws(i),c=ws(i),d=ws(i),h=ws(i),f=ws(i),p=ws(i),g=[],m=[],v=0;v<r;v++)g.push(bs(i)),m.push(bs(i));if(r>0)for(v=r;v<8;v++)ps(i,2);for(v=0;v<r;v++)g[v]&&ps(i,88),m[v]&&ws(i);vs(i),3==(r=vs(i))&&ps(i,1),g=vs(i),m=vs(i);var y=v=0,b=0,w=0;return bs(i)&&(v+=vs(i),y+=vs(i),b+=vs(i),w+=vs(i)),t.width=String(g-(v+y)*(1===r||2===r?2:1)),t.height=String(m-(b+w)*(1===r?2:1)),i=function(e){for(var t=0,n=0;n<32;n++)t|=(e>>n&1)<<31-n;return t>>>0}(u),o=1==o?"H":"L",a="hvc1."+["","A","B","C"][a]+s,a+="."+i.toString(16).toUpperCase(),a+="."+o+p,f&&(a+="."+f.toString(16).toUpperCase()),h&&(a+="."+h.toString(16).toUpperCase()),d&&(a+="."+d.toString(16).toUpperCase()),c&&(a+="."+c.toString(16).toUpperCase()),l&&(a+="."+l.toString(16).toUpperCase()),n&&(a+="."+n.toString(16).toUpperCase()),t.codec=a,t.frameRate=ks(e),t}(this):function(e){var t={height:null,width:null,codec:null,frameRate:null},n=e.$e();if(!n.length)return t;if(!(n=n.find((function(e){return 7==e.type}))))return t;var i=ws(n=new ds(n.data)),r=ws(n),a=ws(n);if(ms(n),Cs.includes(i)){var o=vs(n);if(3===o&&fs(n,1),ms(n),ms(n),fs(n,1),bs(n)){o=3!==o?8:12;for(var s=0;s<o;s++)bs(n)&&_s(n,s<6?16:64)}}if(ms(n),0===(o=vs(n)))vs(n);else if(1===o)for(fs(n,1),ms(n),ms(n),o=vs(n),s=0;s<o;s++)ms(n);ms(n),fs(n,1),o=vs(n),s=vs(n);var u=ps(n,1);0===u&&fs(n,1),fs(n,1);var l=0,c=0,d=0,h=0;return bs(n)&&(l=vs(n),c=vs(n),d=vs(n),h=vs(n)),t.height=String((2-u)*(s+1)*16-2*d-2*h),t.width=String(16*(o+1)-2*l-2*c),t.codec="avc1."+("0"+i.toString(16).toUpperCase()).slice(-2)+("0"+r.toString(16).toUpperCase()).slice(-2)+("0"+a.toString(16).toUpperCase()).slice(-2),t.frameRate=ks(e),t}(this)},B("shaka.util.TsParser",Ts),Ts.syncOffset=Is,Ts.probe=Es,Ts.prototype.getVideoInfo=Ts.prototype.Jg,Ts.prototype.getVideoResolution=Ts.prototype.dk,Ts.prototype.getVideoNalus=Ts.prototype.$e,Ts.prototype.getCodecs=Ts.prototype.Vd,Ts.prototype.getStartTime=Ts.prototype.getStartTime,Ts.prototype.getVideoData=Ts.prototype.ud,Ts.prototype.getAudioData=Ts.prototype.ub,Ts.prototype.getMetadata=Ts.prototype.getMetadata,Ts.prototype.parseNalus=Ts.prototype.Wg,Ts.prototype.parseAvcNalus=Ts.prototype.Ek,Ts.prototype.parse=Ts.prototype.parse,Ts.prototype.setDiscontinuitySequence=Ts.prototype.Gf,Ts.prototype.clearData=Ts.prototype.clearData,Ts.Timescale=9e4;var Cs=[100,110,122,244,44,83,86,118,128,138,139,134];function Ms(e,t,n,i,r){var a=this;this.g=e,this.O=n,this.B=i,this.aa=t,this.l=new Map,this.G=new Map,this.Sa=new Map,this.h=null,this.Fa=!1,this.C=r||null,this.o=new Map,this.u=new te,this.j=new Map,this.J=null,this.M=new Ar,this.Da="",this.ob=!1,this.ya=!0,this.N=!1,this.F=this.R=null,this.i=Ps(this,this.M),this.ab=this.H=!1,this.K=new Yr((function(){return function(e){var t,n,i,r,a,o,s,u,l,c,d,h,f;return R((function(g){if(1==g.g){for(t=[],n=p(e.o),i=n.next();!i.done;i=n.next())for(r=i.value,a=p(r),o=a.next().value,s=a.next().value,u=s[0],l=o,e.o.set(l,s.slice(0,1)),u&&t.push(u.p.catch(xi)),c=p(s.slice(1)),d=c.next();!d.done;d=c.next())d.value.p.reject(new Ue(2,7,7003,void 0));return e.h&&t.push(e.h.destroy()),w(g,Promise.all(t),2)}for(h=p(e.j.values()),f=h.next();!f.done;f=h.next())f.value.destroy();e.u&&(e.u.release(),e.u=null),e.g&&e.F&&e.g.removeChild(e.F),e.g&&e.R&&(e.g.removeChild(e.R),e.g.load(),e.g.disableRemotePlayback=!1),e.g=null,e.R=null,e.F=null,e.B=null,e.i=null,e.h=null,e.aa=null,e.l.clear(),e.Sa.clear(),e.j.clear(),e.J=null,e.o.clear(),e.C=null,e.$.clear(),e.O=null,_(g)}))}(a)})),this.I=!1,this.X="UNKNOWN",this.ib=this.kb=!1,this.Ta=new Ar,this.m=!1,this.xa=null,this.$=new Map,this.oa=this.T=this.va=this.V=null,this.ma=new Ar,this.g.remote&&(this.N="disconnected"!=this.g.remote.state,this.u.D(this.g.remote,"connect",(function(){a.N="disconnected"!=a.g.remote.state})),this.u.D(this.g.remote,"connecting",(function(){a.N="disconnected"!=a.g.remote.state})),this.u.D(this.g.remote,"disconnect",(function(){a.N="disconnected"!=a.g.remote.state})))}function Ps(t,n){if(t.ya=!0,e.ManagedMediaSource){t.F||(t.g.disableRemotePlayback=!0);var i=new ManagedMediaSource;t.u.D(i,"startstreaming",(function(){t.ya=!0})),t.u.D(i,"endstreaming",(function(){t.ya=!1}))}else i=new MediaSource;return t.u.Ba(i,"sourceopen",(function(){URL.revokeObjectURL(t.Da),n.resolve()})),t.u.Ba(t.g,"playing",(function(){t.ob=!0})),t.Da=nu(i),t.B.useSourceElements?(t.g.removeAttribute("src"),t.R&&t.g.removeChild(t.R),t.F&&t.g.removeChild(t.F),t.R=Jo(t.Da),t.g.appendChild(t.R),t.F&&t.g.appendChild(t.F),t.g.load()):t.g.src=t.Da,i}function Rs(e,t,n,i){"audio"==t&&i&&(i=$i(i,n.mimeType));var r=ni(n.mimeType,i);if(t==ut)Ls(e,r,e.I,n.external);else{var a=e.B.forceTransmux;(!mt(r)||!e.I&&hi.includes(r))&&(a=!0);var o=ii(n.mimeType,i);if(a){if(a=ot("audio",(i||"").split(",")),i=ot("video",(i||"").split(",")),a&&i)return e.m=!0,Rs(e,"audio",n,a),void Rs(e,"video",n,i);(i=Xn(o))&&(r=i(),e.j.set(t,r),r=r.convertCodecs(t,o))}o=r+e.B.addExtraFeaturesToSourceBuffer(r),Jr(e.K);try{var s=e.i.addSourceBuffer(o)}catch(t){throw new Ue(2,3,3015,t,"The mediaSource_ status was "+e.i.readyState+" expected 'open'",null)}e.I&&(s.mode=iu),e.u.D(s,"error",(function(){var n=e.o.get(t)[0];n.p.reject(new Ue(2,3,3014,e.g.error?e.g.error.code:0,n.uri))})),e.u.D(s,"updateend",(function(){return Ws(e,t)})),e.l.set(t,s),e.G.set(t,r),e.Sa.set(t,!!n.drmInfos.length)}}function Ds(e){return e.ya&&!e.N&&!e.H}function Ls(e,t,n,i){e.h||(e.h=new fi(e.aa),e.h&&(e.h.B=e.B.modifyCueCallback));var r=e.h;i=i||e.Fa,e=e.X,"application/cea-608"==t||"application/cea-708"==t?r.i=null:(r.i=wi.get(t)(),r.i.setSequenceMode?r.i.setSequenceMode(n):ce("Text parsers w/ setSequenceMode",'Text parsers should have a "setSequenceMode" method!'),r.i.setManifestType?r.i.setManifestType(e):ce("Text parsers w/ setManifestType",'Text parsers should have a "setManifestType" method!'),r.C=i)}function Ns(e){return!e.H&&(!e.i||"ended"==e.i.readyState)}function Os(e){return!e.H&&(!e.i||"closed"==e.i.readyState)}function js(e,t){return e.l.size?t==ut?e.h.g:zo(Fs(e,t)):null}function Us(e,t){return e.l.size?t==ut?e.h.h:$o(Fs(e,t)):null}function Fs(e,t){if(e.H||e.N)return null;try{return e.l.get(t).buffered}catch(n){return e.l.has(t),null}}function Bs(e,t,n,i,r,a,o,s,u,l,c){var d,h,f,m,v,y,b,S,T,x,k,A,E,I,C,M,P,D,L;return o=void 0!==o&&o,s=void 0!==s&&s,u=void 0!==u&&u,l=void 0!==l&&l,R((function(N){switch(N.g){case 1:if(t!=(d=lt).Na){N.A(2);break}if("HLS"!=e.X){N.A(3);break}return w(N,e.Ta,4);case 4:h=N.h,e.h.u=h;case 3:return w(N,function(e,t,n,i,r){var a,o,s,u,l,c,d;return R((function(h){if(1==h.g)return w(h,Promise.resolve(),2);if(!e.i||!e.l)return h.return();if(null==n||null==i)return e.i.parseInit(Le(t)),h.return();for(a=e.C?n:e.u,o={periodStart:e.u,segmentStart:n,segmentEnd:i,vttOffset:a},s=e.i.parseMedia(Le(t),o,r,[]),u=p(s),l=u.next();!l.done;l=u.next())c=l.value,e.B(c,r||null,o);d=s.filter((function(t){return t.startTime>=e.m&&t.startTime<e.o})),e.l.append(d),null==e.g&&(e.g=Math.max(n,e.m)),e.h=Math.min(i,e.o),_(h)}))}(e.h,n,i?i.startTime:null,i?i.endTime:null,i?i.P()[0]:null),5);case 5:return N.return();case 2:if(l||!e.m){N.A(6);break}return w(N,Bs(e,d.ka,n,i,r,a,o,s,u,!0),7);case 7:return w(N,Bs(e,d.Aa,n,i,r,a,o,s,u,!0),8);case 8:return N.return();case 6:if(!e.l.has(t))return N.return();if(f=e.l.get(t).timestampOffset,m=e.G.get(t),e.j.has(t)&&(m=e.j.get(t).getOriginalMimeType()),i&&(v=function(e,t,n,i,r,a,o){o=void 0!==o&&o;var s=null,u=[],l=Le(n);if(hi.includes(a))(n=us(l)).length&&i&&((o=n.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&"number"==typeof o.data&&(s=Math.round(o.data)/1e3),e.O.onMetadata([{cueTime:i.startTime,data:l,frames:n,dts:i.startTime,pts:i.startTime}],0,i.endTime));else if(a.includes("/mp4")&&i&&i.ba){l=new ra;var c=null!=r.emsgSchemeIdUris&&r.emsgSchemeIdUris.length>0||e.B.dispatchAllEmsgBoxes;c&&l.S("emsg",(function(t){var n=r.emsgSchemeIdUris;if(0===t.version)var a=t.reader.Yc(),o=t.reader.Yc(),s=t.reader.U(),u=t.reader.U(),l=t.reader.U(),c=t.reader.U(),d=i.startTime+u/s;else s=t.reader.U(),u=(d=t.reader.Dd()/s+i.timestampOffset)-i.startTime,l=t.reader.U(),c=t.reader.U(),a=t.reader.Yc(),o=t.reader.Yc();t=t.reader.Tb(t.reader.getLength()-t.reader.Oa(),!0),(n&&n.includes(a)||e.B.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==a?e.O.Dk():(n=d+l/s,e.O.Bk({startTime:d,endTime:n,schemeIdUri:a,value:o,timescale:s,presentationTimeDelta:u,eventDuration:l,id:c,messageData:t}),("https://aomedia.org/emsg/ID3"==a||"https://developer.apple.com/streaming/emsg-id3"==a)&&(s=us(t)).length&&e.O.onMetadata([{cueTime:d,data:t,frames:s,dts:d,pts:d}],0,n)))}));var d=i.ba.timescale;t=d&&!isNaN(d);var h=0,f=!1;t&&l.S("prft",(function(t){var n=t.reader,i=t.version;n.U(),t=1e3*(t=n.U())+n.U()/4294967296*1e3,0===i?n=n.U():(i=n.U(),n=4294967296*i+(n=n.U())),t=cs(t),n=new Dr("prft",n=(new Map).set("detail",{wallClockTime:t,programStartDate:new Date(t-n/d*1e3)})),e.O.onEvent(n)})).box("moof",aa).box("traf",aa).S("tfdt",(function(e){f||(h=to(e.reader,e.version).baseMediaDecodeTime/d,f=!0,c||e.parser.stop())})),(c||t)&&l.parse(n,!1,o),f&&0==i.timestampOffset&&(s=h)}else a.includes("/mp4")||a.includes("/webm")||!Es(l)||(e.$.has(t)||e.$.set(t,new Ts),(u=e.$.get(t)).clearData(),u.Gf(i.i),u.parse(l),null!=(l=u.getStartTime(t))&&(s=l),u=u.getMetadata());return{timestamp:s,metadata:u}}(e,t,n,i,r,m,u),y=v.timestamp,b=v.metadata,null!=y&&(null==e.V&&t==d.Aa&&(e.V=y,e.va=i.startTime,null!=e.T&&(S=0,e.va==e.oa&&(S=e.V-e.T),e.ma.resolve(S))),null==e.T&&t==d.ka&&(e.T=y,e.oa=i.startTime,null!=e.V&&(T=0,e.va==e.oa&&(T=e.V-e.T),e.ma.resolve(T))),x=y,k=hi,!e.I&&k.includes(e.G.get(t))&&(x=0),A=i.startTime-x,(Math.abs(f-A)>=.001||o||s)&&(!u||A>0||!f)&&(f=A,e.ib&&(Xs(e,t,(function(){return zs(e,t)}),null),Xs(e,t,(function(){return $s(e,t,f)}),null))),(t==d.Aa||!e.l.has(d.Aa))&&e.Ta.resolve(f)),b.length)&&e.O.onMetadata(b,f,i?i.endTime:null),a&&t==d.Aa&&(e.h||Ls(e,"application/cea-608",e.I,!1),e.J||(E=m.split(";",1)[0],e.J=new Tt(E)),i?(I=e.J.xf(n)).length&&function(e,t,n){for(var i=new Map,r=(t=p(t)).next();!r.done;r=t.next()){var a=r.value;r=a.stream,a=a.cue,i.has(r)||i.set(r,[]),yi(e,a,n),a.startTime>=e.m&&a.startTime<e.o&&(i.get(r).push(a),r==e.F&&e.l.append([a]))}for(t=(n=p(i.keys())).next();!t.done;t=n.next())for(t=t.value,e.j.has(t)||e.j.set(t,[]),a=(r=p(i.get(t))).next();!a.done;a=r.next())a=a.value,e.j.get(t).push(a);bi(e)}(e.h,I,f):e.J.init(n,s,c)),!e.j.has(t)){N.A(9);break}return w(N,e.j.get(t).transmux(n,r,i,e.i.duration,t),10);case 10:C=N.h,ArrayBuffer.isView(C)?n=C:(null!=(M=C).init&&(P=M.init,Xs(e,t,(function(){e.C&&ft(e.C,P,f,r),e.l.get(t).appendBuffer(P)}),i?i.P()[0]:null)),n=M.data);case 9:if(n=function(e,t,n,i,r){if("mp4"!=ai(e.G.get(r)))return n;var a=null===i,o=e.Sa.get(r),s=e.O.Jj(),u=!1;i&&i.ba&&(u=i.ba.encrypted),i=i?i.P()[0]:null;var l=ae();return e.B.correctEc3Enca&&a&&"audio"===r&&(n=function(e){e=Le(e);var t=null;return(new ra).box("moov",aa).box("trak",aa).box("mdia",aa).box("minf",aa).box("stbl",aa).S("stsd",oa).box("enca",(function(e){return t=e.reader.h,ua(e)})).box("sinf",aa).box("frma",(function(e){e.parser.stop(),"ec-3"===ao(e.reader).codec&&t&&2!==t.getUint16(16)&&t.setUint16(16,2)})).parse(e),e}(n)),e.B.insertFakeEncryptionInInit&&o&&l.Ed(s,r)&&(a?n=function(e,t,n){function i(e){d.push({box:e,wi:1701733217})}function r(e){d.push({box:e,wi:1701733238})}function a(e){l=!0,e.parser.stop()}function o(e){c.push(e),aa(e)}var s,u=t=Le(t),l=!1,c=[],d=[];if((new ra).box("moov",o).box("trak",o).box("mdia",o).box("minf",o).box("stbl",o).S("stsd",(function(e){s=e,c.push(e),oa(e)})).S("encv",a).S("enca",a).S("dvav",r).S("dva1",r).S("dvh1",r).S("dvhe",r).S("dvc1",r).S("dvi1",r).S("hev1",r).S("hvc1",r).S("avc1",r).S("avc3",r).S("ac-3",i).S("ec-3",i).S("ac-4",i).S("Opus",i).S("fLaC",i).S("mp4a",i).parse(t),l)return t;if(0==d.length||!s)throw et(t),new Ue(2,3,3019,n);d.reverse();for(var h=(n=p(d)).next();!h.done;h=n.next())h=h.value,u=No(e,u,s,h.box,c,h.wi);return ae().Gi()?((e=new Uint8Array(t.byteLength+u.byteLength)).set(u),e.set(t,u.byteLength),e):u}(t,n,i):!u&&l.Hi(r)&&(n=function(e){e=Le(e);var t=[];(new ra).box("mdat",(function(e){t.push(e)})).parse(e);for(var n=[],i=0;i<t.length;i++){var r=t[i-1],a=t[i];n.push(Lo(e.subarray(r?r.start+r.size:0,a.start+a.size)))}return tt.apply(Xe,g(n))}(n))),a&&l.oe()&&(n=function(e){function t(e){i.push({start:e.start,size:e.size}),aa(e)}var n=Le(e),i=[];return(new ra).box("moov",t).box("trak",t).box("mdia",t).box("minf",t).box("stbl",t).box("stsd",(function(e){i.push({start:e.start,size:e.size});for(var t=Oe(n,e.start),r=0;r<e.size-3;r++){var a=t.getUint32(r);1633889587==a?t.setUint32(r,1700998451):1684103987==a&&t.setUint32(r,1684366131)}})).parse(n),n}(n)),n}(e,r,n,i,t),!i||!e.I||t==d.Na){N.A(11);break}if(!o&&!s){N.A(11);break}if(D=i.startTime,"HLS"!=e.X||e.m||t!=d.ka||!e.l.has(d.Aa)){N.A(13);break}return w(N,e.ma,14);case 14:L=N.h,Math.abs(L)>.15&&(D-=L);case 13:Xs(e,t,(function(){return zs(e,t)}),null),Xs(e,t,(function(){return $s(e,t,D)}),null);case 11:return w(N,Xs(e,t,(function(){var i=n;e.C&&ft(e.C,i,f,r),e.l.get(t).appendBuffer(i)}),i?i.P()[0]:null),15);case 15:_(N)}}))}function Hs(e,t){var n;return R((function(i){return 1==i.g?t==(n=lt).Na?e.h?w(i,e.h.remove(0,1/0),0):i.return():t===n.Aa&&e.J&&e.h?w(i,e.h.remove(0,1/0,!0),4):i.A(4):6!=i.g?w(i,Xs(e,t,(function(){return Gs(e,t,0,e.i.duration)}),null),6):e.m?w(i,Xs(e,n.ka,(function(){return Gs(e,n.ka,0,e.i.duration)}),null),0):i.A(0)}))}function Vs(e,t,n,i,r,a,o,s,u){var l,c;return R((function(d){return 1==d.g?t==(l=lt).Na?(a||(e.h.u=n),function(e,t,n){e.m=t,e.o=n}(e.h,i,r),d.return()):(c=[],w(d,function(e,t,n,i,r){var a,o,s,u,l,c;return R((function(d){return 1==d.g?(a=lt,o=tu(e,t,n,i,r),s=o.type,u=o.dc,l=o.rf,(c=r.get(a.ka))&&(e.m=c.isAudioMuxedInVideo),s==ru?(e.j.has(t)&&!u?(e.j.get(t).destroy(),e.j.delete(t)):!e.j.has(t)&&u?e.j.set(t,u):u&&(e.j.has(t)&&e.j.get(t).transmux!==u.transmux?(e.j.get(t).destroy(),e.j.set(t,u)):u.destroy()),d.return(!1)):s==ou?w(d,function(e,t,n,i){return Xs(e,t,(function(){if(t!==ut){if(e.G.get(t),vt()){e.j.has(t)&&(e.j.get(t).destroy(),e.j.delete(t)),i&&e.j.set(t,i);var r=n+e.B.addExtraFeaturesToSourceBuffer(n);e.l.get(t).changeType(r),e.G.set(t,n)}Ws(e,t)}}),null)}(e,t,l,u),3):s!=au?d.A(3):(u&&u.destroy(),w(d,Zs(e,r),3))):d.return(!0)}))}(e,t,o,s,u),2)):(d.h||(c.push(Xs(e,t,(function(){return zs(e,t)}),null)),e.m&&c.push(Xs(e,l.ka,(function(){return zs(e,l.ka)}),null))),a||(c.push(Xs(e,t,(function(){return $s(e,t,n)}),null)),e.m&&c.push(Xs(e,l.ka,(function(){return $s(e,l.ka,n)}),null))),0==i&&r==1/0||(c.push(Xs(e,t,(function(){return Ks(e,t,i,r)}),null)),e.m&&c.push(Xs(e,l.ka,(function(){return Ks(e,l.ka,i,r)}),null))),c.length?w(d,Promise.all(c),0):d.A(0))}))}function qs(e){R((function(t){return e.K.g||e.g.error||e.N||e.H||Ns(e)||Os(e)?t.return():w(t,Ys(e,(function(){Ns(e)||Os(e)||e.i.clearLiveSeekableRange()})),0)}))}function Gs(e,t,n,i){if(i<=n)Ws(e,t);else{if(e.C){var r=e.C;"video"===t&&r.g&&r.g.flushBuffer(n,i)}e.l.get(t).remove(n,i)}}function zs(e,t){var n=e.l.get(t),i=n.appendWindowStart,r=n.appendWindowEnd;n.abort(),n.appendWindowStart=i,n.appendWindowEnd=r,Ws(e,t)}function $s(e,t,n){n<0&&(n+=.001),e.l.get(t).timestampOffset=n,Ws(e,t)}function Ks(e,t,n,i){var r=e.l.get(t);r.appendWindowEnd===i&&r.appendWindowStart===n||(r.appendWindowStart=0,r.appendWindowEnd=i,r.appendWindowStart=n),Ws(e,t)}function Ws(e,t){if(e.H||e.K.g){var n=e.o.get(t);n&&n.length&&((n=n[0])&&n.p&&n.p.resolve(),e.o.set(t,[]))}else(n=e.o.get(t)[0])&&(n.p.resolve(),Js(e,t))}function Xs(e,t,n,i){return Jr(e.K),n={start:n,p:new Ar,uri:i},e.o.get(t).push(n),1==e.o.get(t).length&&Qs(e,t),n.p}function Ys(e,t){var n,i,r,a,o,s,u,l,c,d,h;return R((function(f){switch(f.g){case 1:for(Jr(e.K),n=[],i=Array.from(e.l.keys()),r=p(i),a=r.next(),o={};!a.done;o={ready:void 0},a=r.next())s=a.value,o.ready=new Ar,u={start:function(e){return function(){return e.ready.resolve()}}(o),p:o.ready,uri:null},(l=e.o.get(s)).push(u),n.push(o.ready),1==l.length&&u.start();return S(f,2),w(f,Promise.all(n),4);case 4:x(f,3);break;case 2:throw k(f);case 3:return S(f,5,6),w(f,t(),6);case 6:for(A(f),c=p(i),d=c.next();!d.done;d=c.next())h=d.value,Js(e,h);E(f,0);break;case 5:throw new Ue(2,3,3015,k(f),e.g.error||"No error in the media element",null)}}))}function Js(e,t){e.o.get(t).shift(),Qs(e,t)}function Qs(e,t){var n=e.o.get(t)[0];if(n)try{n.start()}catch(i){"QuotaExceededError"==i.name?n.p.reject(new Ue(2,3,3017,t)):Ds(e)?n.p.reject(new Ue(2,3,3015,i,e.g.error||"No error in the media element",n.uri)):n.p.reject(new Ue(2,3,3024,t)),Js(e,t)}}function Zs(e,t){return Ys(e,(function(){return function(e,t){var n,i,r,a,o,s,u,l,c,d,h,f,g,m,v,y,b,_,S;return R((function(x){if(1==x.g){if(e.H||e.N)return x.return();for(n=lt,e.H=!0,e.m=!1,i=e.g.currentTime,r=e.g.autoplay,e.g.paused||(e.ab=!0),e.ob&&(e.g.autoplay=!1),T(x,2),e.u.Pa(),a=p(e.j.values()),o=a.next();!o.done;o=a.next())o.value.destroy();for(s=p(e.l.values()),u=s.next();!u.done;u=s.next()){l=u.value;try{e.i.removeSourceBuffer(l)}catch(e){}}return e.j.clear(),e.l.clear(),c=e.i.duration,e.M=new Ar,e.i=Ps(e,e.M),w(x,e.M,4)}if(2!=x.g){for(!isNaN(c)&&c?e.i.duration=c:!isNaN(e.xa)&&e.xa&&(e.i.duration=e.xa),d=new Ar,h=e.i.sourceBuffers,f=t.size,g=0,m=function(){++g===f&&(d.resolve(),e.u.Ma(h,"addsourcebuffer",m))},e.u.D(h,"addsourcebuffer",m),v=p(t.keys()),y=v.next();!y.done;y=v.next())b=y.value,_=t.get(b),Rs(e,b,_,_.codecs);return(S=t.get(n.ka))&&S.isAudioMuxedInVideo&&(e.m=!0),e.m&&!e.o.has(n.ka)&&e.o.set(n.ka,[]),e.g.currentTime=i,w(x,d,2)}return A(x),e.H=!1,Jr(e.K),e.u.Ba(e.g,"canplaythrough",(function(){e.K.g||(e.g.autoplay=r,e.ab&&(e.ab=!1,e.g.play()))})),E(x,0)}))}(e,t)}))}function eu(e,t,n,i){var r=!1,a=ot("audio",(i||"").split(",")),o=ot("video",(i||"").split(",")),s=o;"audio"==t&&(s=a),s||(s=i),i=ni(n,s);var u=ui(e.G.get(t)),l=e.B.forceTransmux;if(!mt(i)||!e.I&&hi.includes(i)?l=!0:l||n==u||(l=!ae().Jf()&&hi.includes(n)),l&&(n=Xn(e=ii(n,s)))){var c=n();a&&o&&(r=!0),i=c.convertCodecs(t,e)}return t=oi(li(i)),{dc:c,fl:r,Nh:ui(i),codec:t,mimeType:i}}function tu(e,t,n,i,r){if(t==ut)return{type:ru,rf:n,dc:null};var a=oi(li(e.G.get(t))),o=ui(e.G.get(t)),s=eu(e,t,n,i),u=s.dc,l=s.fl,c=s.Nh,d=s.codec;s=s.mimeType;var h=!0;return l&&e.G.has("audio")&&(n=eu(e,"audio",n,i),i=oi(li(e.G.get("audio"))),h=ui(e.G.get("audio")),h=i==n.codec&&h==n.Nh,n.dc&&n.dc.destroy()),a===d&&o===c&&h?{type:ru,rf:s,dc:u}:(a=!0,(e.m&&!r.has("audio")||l&&u&&!e.j.has(t))&&(a=!1),a&&"smooth"===e.B.codecSwitchingStrategy&&vt()?{type:ou,rf:s,dc:u}:(u&&u.destroy(),{type:au,rf:s,dc:null}))}(i=Ms.prototype).destroy=function(){return this.K.destroy()},i.init=function(e,t,n,i){t=void 0!==t&&t,n=void 0===n?"UNKNOWN":n,i=void 0!==i&&i;var r,a,o,s,u,l,c=this;return R((function(d){if(1==d.g)return r=lt,w(d,c.M,2);if(3!=d.g)return Ns(c)||Os(c)?(z("Expected MediaSource to be open during init(); reopening the media source."),c.M=new Ar,c.i=Ps(c,c.M),w(d,c.M,3)):d.A(3);for(c.I=t,c.X=n,c.kb=i,c.ib=!c.I&&"HLS"==c.X&&!c.kb,c.$.clear(),c.V=null,c.va=null,c.T=null,c.oa=null,c.ma=new Ar,a=p(e.keys()),o=a.next();!o.done;o=a.next())s=o.value,u=e.get(s),Rs(c,s,u,u.codecs),c.m?(c.o.set(r.ka,[]),c.o.set(r.Aa,[])):c.o.set(s,[]);(l=e.get(r.ka))&&l.isAudioMuxedInVideo&&(c.m=!0),_(d)}))},i.configure=function(e){this.B=e,this.h&&(this.h.B=e.modifyCueCallback)},i.Fc=function(){var e={total:this.H?[]:Xo(this.g.buffered),audio:Xo(Fs(this,"audio")),video:Xo(Fs(this,"video")),text:[]};if(this.h){var t=this.h.g,n=this.h.h;null!=t&&null!=n&&e.text.push({start:t,end:n})}return e},i.remove=function(e,t,n,i){var r,a,o=this;return R((function(s){return 1==s.g?(e==(r=lt).Aa&&o.J&&(o.J.remove(i),a=o.h.g||0,o.h.remove(a,n,!0)),e==r.Na?w(s,o.h.remove(t,n),0):n>t?w(s,Xs(o,e,(function(){return Gs(o,e,t,n)}),null),5):s.A(0)):o.m?w(s,Xs(o,r.ka,(function(){return Gs(o,r.ka,t,n)}),null),0):s.A(0)}))},i.flush=function(e){var t,n=this;return R((function(i){return 1==i.g?e==(t=lt).Na?i.return():w(i,Xs(n,e,(function(){n.g.currentTime-=.001,Ws(n,e)}),null),2):n.m?w(i,Xs(n,t.ka,(function(){var e=t.ka;n.g.currentTime-=.001,Ws(n,e)}),null),0):i.A(0)}))},i.endOfStream=function(e){var t=this;return R((function(n){return w(n,Ys(t,(function(){Ns(t)||Os(t)||(e?t.i.endOfStream(e):t.i.endOfStream())})),0)}))},i.Ab=function(e){var t=this;return R((function(n){return w(n,Ys(t,(function(){if(t.B.durationReductionEmitsUpdateEnd&&e<t.i.duration)for(var n=p(t.l.keys()),i=n.next();!i.done;i=n.next()){i=i.value;var r={start:function(){},p:new Ar,uri:null};t.o.get(i).unshift(r)}t.i.duration=e,t.xa=e})),0)}))},i.getDuration=function(){return this.i.duration};var nu=e.URL.createObjectURL,iu="sequence",ru="none",au="reset",ou="changeType";function su(e,t,n){this.i=e,this.F=t,this.u=this.l=1/0,this.h=1,this.g=this.j=null,this.B=0,this.C=!0,this.J=!1,this.I=0,this.G=void 0===n||n,this.H=0,this.o=!1,this.m=e}function uu(e,t,n,i){var r=this;this.u=i,this.g=e,this.F=t,this.h=n,this.j=new te,this.m=!1,this.l=0,this.C=!1,this.H=this.G=0,this.o=function(e){if(!e.h.stallEnabled)return null;var t=e.h.stallThreshold,n=e.h.stallSkip;return new cu(new du(e.g),t,(function(){return R((function(t){if(1==t.g)return Xo(e.g.buffered).length?n?(e.g.currentTime+=n,t.A(2)):w(t,e.g.play(),3):t.return();if(2!=t.g){if(!e.g)return t.return();e.g.pause(),e.g.play()}e.H++,e.u(new Dr("stalldetected")),_(t)}))}))}(this),this.B=!1,this.j.D(e,"waiting",(function(){return lu(r)})),this.i=new Si((function(){lu(r)})).Ea(this.h.gapJumpTimerTime)}function lu(e){if(0!=e.g.readyState){if(e.g.seeking){if(!e.m)return}else e.m=!1;if(!e.g.paused||e.g.currentTime==e.l&&(e.g.autoplay||e.g.currentTime!=e.l)){var t;if(!(t=!e.o)){var n=(t=e.o).h,i=hu(n),r=n.g.currentTime,a=Date.now()/1e3;t.g==r&&t.m==i||(t.l=a,t.g=r,t.m=i,t.i=!1),(i=(r=a-t.l)>=t.o&&i&&!t.i)&&(t.j&&t.j(t.g,r),t.i=!0,t.g=n.g.currentTime),t=!i}t&&(t=e.g.currentTime,i=function(e,t,n){return e&&e.length&&!Go(e)&&(e=Xo(e).findIndex((function(e,i,r){return e.start>t&&(0==i||r[i-1].end-t<=n)})))>=0?e:null}(n=e.g.buffered,t,e.h.gapDetectionThreshold),null==i||0==i&&!e.B||(r=n.start(i),(a=e.h.gapPadding)&&(r=Math.ceil(100*(r+a))/100),r>=e.F.Gb()||r-t<.001||(0!=i&&n.end(i-1),function(e,t){e.C=!0,e.j.Ba(e.g,"seeked",(function(){e.C=!1})),e.g.currentTime=t}(e,r),t==e.l&&(e.l=r),e.G++,e.u(new Dr("gapjumped")))))}}}function cu(e,t,n){this.h=e,this.m=hu(e),this.g=e.g.currentTime,this.l=Date.now()/1e3,this.i=!1,this.o=t,this.j=n}function du(e){var t=this;this.g=e,this.h=new te,this.i=!1,this.h.D(this.g,"audiofocuspaused",(function(){t.i=!0})),this.h.D(this.g,"audiofocusgranted",(function(){t.i=!1})),this.h.D(this.g,"audiofocuslost",(function(){t.i=!0}))}function hu(e){if(e.g.paused||0==e.g.playbackRate||e.i||0==e.g.buffered.length)var t=!1;else e:{t=e.g.currentTime;for(var n=(e=p(Xo(e.g.buffered))).next();!n.done;n=e.next())if(!(t<(n=n.value).start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}function fu(e,t,n,i){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?i():(t=pu.value().get(t),n.Ba(e,t,i))}(i=su.prototype).getDuration=function(){return this.l},i.Mj=function(){return this.h},i.Qi=function(e){this.i=e},i.Ab=function(e){this.l=e},i.Sj=function(){return this.i},i.Pi=function(e){this.B=e},i.cd=function(e){e&&!this.C&&(this.J=!0),this.C=e},i.Hf=function(e){this.u=e},i.Ze=function(){return this.u},i.nh=function(e){this.F=e},i.Dj=function(){return this.F},i.Ai=function(e,t){if(0!=e.length){var n=(Date.now()+this.B)/1e3;if(0!=(e=e.filter((function(e){return e.start+t<n}))).length){var i=e[e.length-1].end+t;this.tf(e[0].start+t),this.h=e.reduce((function(e,t){return Math.max(e,t.end-t.start)}),this.h),this.g=Math.max(this.g,i),null!=this.i&&this.G&&!this.o&&(this.i=n-this.g-this.h)}}},i.ie=function(e){if(0!=e.length){for(var t=e[0].startTime,n=e[0].endTime,i=(Date.now()+this.B)/1e3,r=(e=p(e)).next();!r.done;r=e.next())i<(r=r.value).startTime||(t=Math.min(t,r.startTime),n=Math.max(n,r.endTime),this.h=Math.max(this.h,r.endTime-r.startTime));this.tf(t),this.g=Math.max(this.g,n),null!=this.i&&this.G&&!this.o&&(this.i=i-this.g-this.h)}},i.zi=function(e,t){this.tf(e),t==1/0||this.W()||(this.g=Math.max(this.g,t))},i.Nj=function(){return this.g},i.lf=function(){this.o=!0},i.pk=function(){return this.o},i.oh=function(e){this.m=e},i.Ij=function(){return this.m},i.tf=function(e){null==this.j?this.j=e:this.J||(this.j=Math.min(this.j,e))},i.Sg=function(e){this.h=Math.max(this.h,e)},i.offset=function(e){null!=this.j&&(this.j+=e),null!=this.g&&(this.g+=e)},i.W=function(){return this.l==1/0&&!this.C},i.Vc=function(){return this.l!=1/0&&!this.C},i.Hb=function(){return Math.max(this.I,this.Hc()-this.u)},i.Si=function(e){this.I=e},i.Hc=function(){return this.W()||this.Vc()?Math.min(Math.max(0,(Date.now()+this.B)/1e3-this.h-this.i)+this.H,this.l):this.g?Math.min(this.g,this.l):this.l},i.Xd=function(e){var t=Math.max(this.j,this.I);return this.u==1/0?Math.ceil(1e3*t)/1e3:Math.max(t,Math.min(this.Hc()-this.u+e,this.Gb()))},i.Xb=function(){return this.Xd(0)},i.Gb=function(){return Math.max(0,this.Hc()-(this.W()||this.Vc()?this.F:0))},i.ej=function(){return!(null==this.i||null!=this.g&&this.G)},i.Oi=function(e){this.H=e},i.yj=function(){return this.H},B("shaka.media.PresentationTimeline",su),su.prototype.getAvailabilityTimeOffset=su.prototype.yj,su.prototype.setAvailabilityTimeOffset=su.prototype.Oi,su.prototype.usingPresentationStartTime=su.prototype.ej,su.prototype.getSeekRangeEnd=su.prototype.Gb,su.prototype.getSeekRangeStart=su.prototype.Xb,su.prototype.getSafeSeekRangeStart=su.prototype.Xd,su.prototype.getSegmentAvailabilityEnd=su.prototype.Hc,su.prototype.setUserSeekStart=su.prototype.Si,su.prototype.getSegmentAvailabilityStart=su.prototype.Hb,su.prototype.isInProgress=su.prototype.Vc,su.prototype.isLive=su.prototype.W,su.prototype.offset=su.prototype.offset,su.prototype.notifyMaxSegmentDuration=su.prototype.Sg,su.prototype.notifyMinSegmentStartTime=su.prototype.tf,su.prototype.getInitialProgramDateTime=su.prototype.Ij,su.prototype.setInitialProgramDateTime=su.prototype.oh,su.prototype.isStartTimeLocked=su.prototype.pk,su.prototype.lockStartTime=su.prototype.lf,su.prototype.getMaxSegmentEndTime=su.prototype.Nj,su.prototype.notifyPeriodDuration=su.prototype.zi,su.prototype.notifySegments=su.prototype.ie,su.prototype.notifyTimeRange=su.prototype.Ai,su.prototype.getDelay=su.prototype.Dj,su.prototype.setDelay=su.prototype.nh,su.prototype.getSegmentAvailabilityDuration=su.prototype.Ze,su.prototype.setSegmentAvailabilityDuration=su.prototype.Hf,su.prototype.setStatic=su.prototype.cd,su.prototype.setClockOffset=su.prototype.Pi,su.prototype.getPresentationStartTime=su.prototype.Sj,su.prototype.setDuration=su.prototype.Ab,su.prototype.setPresentationStartTime=su.prototype.Qi,su.prototype.getMaxSegmentDuration=su.prototype.Mj,su.prototype.getDuration=su.prototype.getDuration,uu.prototype.release=function(){this.j&&(this.j.release(),this.j=null),null!=this.i&&(this.i.stop(),this.i=null),this.o&&(this.o.release(),this.o=null),this.g=this.F=this.u=null},uu.prototype.wf=function(){this.B=!0,this.i&&this.i.Ea(this.h.gapJumpTimerTime),lu(this)},cu.prototype.release=function(){this.h&&this.h.release(),this.j=this.h=null},du.prototype.release=function(){this.h&&this.h.release(),this.h=null};var pu=new re((function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])}));function gu(e,t,n,i){var r=this;this.g=e,this.m=t,this.u=n,this.l=null,this.j=function(){return null==r.l&&(r.l=i()),r.l},this.o=!1,this.h=new te,this.i=new wu(e),fu(this.g,HTMLMediaElement.HAVE_METADATA,this.h,(function(){yu(r,r.j())}))}function mu(e){return e.o?e.g.currentTime:e.j()}function vu(e,t){e.g.readyState>0?_u(e.i,t):fu(e.g,HTMLMediaElement.HAVE_METADATA,e.h,(function(){yu(e,e.j())}))}function yu(e,t){Math.abs(e.g.currentTime-t)<.001?bu(e):(e.h.Ba(e.g,"seeking",(function(){bu(e)})),_u(e.i,e.g.currentTime&&0!=e.g.currentTime?e.g.currentTime:t))}function bu(e){e.o=!0,e.h.D(e.g,"seeking",(function(){return e.m()})),e.u(e.g.currentTime)}function wu(e){var t=this;this.g=e,this.m=10,this.j=this.l=this.i=0,this.h=new Si((function(){t.i<=0||t.g.currentTime!=t.l||t.g.currentTime===t.j?t.h.stop():(t.g.currentTime=t.j,t.i--)}))}function _u(e,t){e.l=e.g.currentTime,e.j=t,e.i=e.m,e.g.currentTime=t,e.h.Ea(.1)}function Su(e){this.g=e,this.i=!1,this.h=null,this.j=new te}function Tu(e){return e.g.getStartDate&&(e=e.g.getStartDate().getTime(),!isNaN(e))?e/1e3:null}function xu(e,t){return(e=e.g.seekable).length>0&&(t=Math.max(e.start(0),t),t=Math.min(e.end(e.length-1),t)),t}function ku(e,t,n,i,r,a){var o=this;this.h=e,this.g=t.presentationTimeline,this.l=n,this.u=r,this.o=null,this.i=new uu(e,t.presentationTimeline,n,a),this.j=new gu(e,(function(){e:{var e=o.i;e.m=!0,e.B=!1,e.i&&e.i.Ea(e.h.gapJumpTimerTime),lu(e);var t=mu(o.j);if(e=Iu(o,t),!yt()&&Math.abs(e-t)>.001){t=!1;var n=ae().Mi();if(n){var i=Date.now()/1e3;(!o.o||o.o<i-n)&&(o.o=i,t=!0)}else t=!0;if(t){vu(o.j,e),e=void 0;break e}}o.u(),e=void 0}return e}),(function(e){var t=o.i;t.g.seeking&&!t.m&&(t.m=!0,t.l=e),t.i&&t.i.Ea(t.h.gapJumpTimerTime),lu(t)}),(function(){return Au(o,i)})),this.m=new Si((function(){if(0!=o.h.readyState&&!o.h.paused){var e=mu(o.j),t=o.g.Xb(),n=o.g.Gb();n-t<3&&(t=n-3),e<t&&(e=Iu(o,e),o.h.currentTime=e)}}))}function Au(e,t){return null==t?t=e.g.getDuration()<1/0?e.g.Xb():e.g.Gb():t instanceof Date?t=t.getTime()/1e3-(e.g.m||e.g.i):t<0&&(t=e.g.Gb()+t),Eu(e,Cu(e,t))}function Eu(e,t){var n=e.g.getDuration();return t>=n?n-e.l.durationBackoff:t}function Iu(e,t){var n=e.l.rebufferingGoal,i=e.l.safeSeekOffset,r=e.g.Xb(),a=e.g.Gb(),o=e.g.getDuration();a-r<3&&(r=a-3);var s=e.g.Xd(n),u=e.g.Xd(i);return n=e.g.Xd(n+i),t>=o?Eu(e,t):t>a?a-e.l.safeSeekEndOffset:t<r?e.g.W()&&e.l.returnToEndOfLiveWindowWhenOutside?a-e.l.safeSeekEndOffset:Ko(e.h.buffered,u)?u:n:t>=s||Ko(e.h.buffered,t)?t:n}function Cu(e,t){var n=e.g.Xb();return t<n?n:t>(e=e.g.Gb())?e:t}function Mu(e){this.g=e,this.m=null,this.i=0,this.o=!1}function Pu(e){return e.g[0]||null}function Ru(e,t,n){return new Mu([e=new Fo(e,e+t,(function(){return n}),0,null,null,e,e,e+t)])}function Du(e,t,n,i){this.i=e,this.h=t,this.g=n,this.reverse=i}function Lu(){Mu.call(this,[]),this.h=[]}function Nu(e){var t=this;this.g=e,this.j=!1,this.i=this.g.Ye(),this.h=new Si((function(){t.g.ui(.25*t.i)}))}function Ou(e){e.h.stop();var t=e.j?0:e.i;if(t>=0)try{return void(e.g.Ye()!=t&&e.g.ph(t))}catch(e){}e.h.Ea(.25),0!=e.g.Ye()&&e.g.ph(0)}function ju(e){var t=this;this.j=e,this.h=new te,this.g=new Set,this.i=new Si((function(){Uu(t,!1)})).Jb(),e.paused||this.i.Ea(.25),this.h.D(e,"playing",(function(){t.i.Jb().Ea(.25)})),this.h.D(e,"pause",(function(){t.i.stop()}))}function Uu(e,t){for(var n=e.j.currentTime,i=(e=p(e.g)).next();!i.done;i=e.next())i.value.j(n,t)}function Fu(e){Or.call(this),this.g=new Map,this.h=e}function Bu(e,t,n){return!!((e=e.h()[n])&&e.length>0&&(n=e[e.length-1].end,t>=e[0].start&&t<n))}function Hu(e){var t={bandwidth:e.bandwidth||0,audioSamplingRate:null,codecs:e.codecs,contentType:e.type,frameRate:null,height:null,mimeType:e.mimeType,channelsCount:null,pixelAspectRatio:null,width:null,label:null,roles:e.roles,language:null};return"video"==e.type&&(t.frameRate=e.frameRate||null,t.height=e.height||null,t.pixelAspectRatio=e.pixelAspectRatio||null,t.width=e.width||null),"audio"==e.type&&(t.audioSamplingRate=e.audioSamplingRate,t.channelsCount=e.channelsCount,t.label=e.label||null,t.language=e.language),t}function Vu(e){Or.call(this),this.h=new Map,this.i=e,this.g=null}function qu(e,t){var n=t.schemeIdUri+"_"+t.id+"_"+t.startTime.toFixed(1)+"_"+t.endTime.toFixed(1);e.h.has(n)||(e.h.set(n,t),t=new Dr("regionadd",new Map([["region",t]])),e.dispatchEvent(t),function(e){e.g||(e.g=new Si((function(){for(var t=e.i(),n=p(e.h),i=n.next();!i.done;i=n.next()){var r=p(i.value);i=r.next().value,(r=r.next().value).endTime<t.start&&(e.h.delete(i),i=new Dr("regionremove",new Map([["region",r]])),e.dispatchEvent(i))}!e.h.size&&e.g&&(e.g.stop(),e.g=null)})).Ea(2))}(e))}function Gu(e,t,n,i,r){this.m=e,this.i=t,this.l=n,this.g=new Map,this.j=new Map,this.h=null,this.o=i,this.u=r||function(e,t){return!(t.fastSwitching&&e.Xc&&e.ee)}}function zu(e,t){e.l=t;for(var n=(e=p(e.g.values())).next();!n.done;n=e.next())n.value.g=t}function $u(e,t,n){if(n=void 0!==n&&n,!e.i.segmentIndex)return Promise.resolve();if(e.h||(e.h=e.i.segmentIndex.Vb(t,!0,e.o)),!e.h)return Promise.resolve();for(n&&e.h.next(),t=[];e.g.size<e.m&&(n=e.h.next().value);){var i=!0;if(n.isPreload()&&null!=n.endByte&&(i=!1),2==n.Jc()&&(i=!1),n.Yb(!1)&&(i=!1),i&&n.ba&&t.push(Ku(e,n.ba)),i&&!e.g.has(n)&&(i=new Zu(e.l),t.push(el(i,n,e.i)),e.g.set(n,i)),!e.u(n,e.i))break}return Yu(e),Promise.all(t)}function Ku(e,t){if(!e.i.segmentIndex||t.Yb()||Array.from(e.j.keys()).some((function(e){return Uo(e,t)})))return Promise.resolve();var n=new Zu(e.l),i=el(n,t,e.i);return e.j.set(t,n),i}function Wu(e,t){for(var n=(t=p(t.keys())).next();!n.done;n=t.next())(n=n.value)&&Qu(e,n)}function Xu(e){Wu(e,e.g),Wu(e,e.j),e.h=null}function Yu(e){if(e.g.size)for(var t=Array.from(e.g.keys()),n=p(e.j.keys()),i=n.next(),r={};!i.done;r={Mg:void 0},i=n.next())r.Mg=i.value,t.some(function(e){return function(t){return Uo(t.ba,e.Mg)}}(r))||Qu(e,r.Mg)}function Ju(e,t){e.m=t;for(var n=Array.from(e.g.keys());n.length>t;){var i=n.pop();i&&Qu(e,i)}Yu(e)}function Qu(e,t){var n=e.g;t instanceof jo&&(n=e.j),e=n.get(t),n.delete(t),e&&e.abort()}function Zu(e){this.g=e,this.je=this.wh=null}function el(e,t,n){var i=new Uint8Array(0);return e.je=e.g(t,n,(function(t){return R((function(n){if(1==n.g)return i=i.byteLength>0?tt(i,t):t,e.wh?w(n,e.wh(i),3):n.A(0);i=new Uint8Array(0),_(n)}))})),e.je.promise.catch((function(e){return e instanceof Ue&&7001==e.code?Promise.resolve():Promise.reject(e)}))}function tl(e){var t=ui(e);return{type:t.split("/")[0],mimeType:t,codecs:e=li(e),language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map,ve:null,colorGamut:null,frameRate:null}}function nl(e,t,n){function i(e){o=e.name;var t=e.reader;t.skip(24);var n=t.Ca(),i=t.Ca();t.skip(50),f=String(n),h=String(i),e.reader.Ia()&&aa(e)}function r(e){var t=ro(e.reader);g=t.channelCount,m=t.sampleRate,a(e.name)}function a(e){switch(e=e.toLowerCase()){case"avc1":case"avc3":u.push(e+".42E01E"),c=!0;break;case"hev1":case"hvc1":u.push(e+".1.6.L93.90"),c=!0;break;case"dvh1":case"dvhe":u.push(e+".05.04"),c=!0;break;case"vp09":u.push(e+".00.10.08"),c=!0;break;case"av01":u.push(e+".0.01M.08"),c=!0;break;case"mp4a":s.push("mp4a.40.2"),l=!0;break;case"ac-3":case"ec-3":case"ac-4":case"opus":case"flac":s.push(e),l=!0;break;case"apac":s.push("apac.31.00"),l=!0}}var o,s=[],u=[],l=!1,c=!1,d=null,h=null,f=null,g=null,m=null,v=null,y=null;if((new ra).box("moov",aa).box("trak",aa).box("mdia",aa).S("mdhd",(function(e){d=no(e.reader,e.version).language})).box("minf",aa).box("stbl",aa).S("stsd",oa).box("mp4a",(function(e){var t=ro(e.reader);g=t.channelCount,m=t.sampleRate,e.reader.Ia()?aa(e):a(e.name)})).box("esds",(function(e){e=e.reader;for(var t,n,i="mp4a";e.Ia();){t=e.Y();for(var r=e.Y();128&r;)r=e.Y();if(3==t)e.Ca(),128&(r=e.Y())&&e.Ca(),64&r&&e.skip(e.Y()),32&r&&e.Ca();else if(4==t)n=e.Y(),e.skip(12);else if(5==t)break}n&&(i+="."+oo(n),5==t&&e.Ia()&&(31===(n=(248&(t=e.Y()))>>3)&&e.Ia()&&(n=32+((7&t)<<3)+((224&e.Y())>>5)),i+="."+n)),s.push(i),l=!0})).box("ac-3",r).box("ec-3",r).box("ac-4",r).box("Opus",r).box("fLaC",r).box("apac",r).box("avc1",i).box("avc3",i).box("hev1",i).box("hvc1",i).box("dva1",i).box("dvav",i).box("dvh1",i).box("dvhe",i).box("vp09",i).box("av01",i).box("avcC",(function(e){var t=o||"";switch(o){case"dvav":t="avc3";break;case"dva1":t="avc1"}(e=e.reader).skip(1),e=t+"."+oo(e.Y())+oo(e.Y())+oo(e.Y()),u.push(e),c=!0})).box("hvcC",(function(e){var t=o||"";switch(o){case"dvh1":t="hvc1";break;case"dvhe":t="hev1"}var n=e.reader;n.skip(1);var i=["","A","B","C"][(e=n.Y())>>6],r=31&e,a=n.U(),s=(32&e)>>5?"H":"L";e=[n.Y(),n.Y(),n.Y(),n.Y(),n.Y(),n.Y()],n=n.Y();for(var l=0,d=0;d<32&&(l|=1&a,31!=d);d++)l<<=1,a>>=1;for(t=t+"."+i+r+"."+oo(l,!0),t+="."+s+n,i="",r=e.length;r--;)((s=e[r])||i)&&(i="."+s.toString(16).toUpperCase()+i);t+=i,u.push(t),c=!0})).box("dvcC",(function(e){var t=o||"";switch(o){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.Y(),n=n.Y(),u.push(t+"."+so(e>>1&127)+"."+so(e<<5&32|n>>3&31)),c=!0})).box("dvvC",(function(e){var t=o||"";switch(o){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}var n=e.reader;n.skip(2),e=n.Y(),n=n.Y(),u.push(t+"."+so(e>>1&127)+"."+so(e<<5&32|n>>3&31)),c=!0})).S("vpcC",(function(e){var t=o||"",n=e.reader;e=n.Y();var i=n.Y();n=n.Y()>>4&15,u.push(t+"."+so(e)+"."+so(i)+"."+so(n)),c=!0})).box("av1C",(function(e){var t=o||"";if("dav1"===o)t="av01";var n=e.reader;n.skip(1);var i=(e=n.Y())>>>5,r=(64&(n=n.Y()))>>6;u.push(t+"."+i+"."+so(31&e)+(n>>>7?"H":"M")+"."+so(2===i&&r?(32&n)>>5?12:10:r?10:8)+"."+((16&n)>>4)+"."+((8&n)>>3)+((4&n)>>2)+(3&n)+"."+so(1)+"."+so(1)+"."+so(1)+".0"),c=!0})).box("enca",ua).box("encv",sa).box("sinf",aa).box("frma",(function(e){a(e=ao(e.reader).codec)})).box("colr",(function(e){u=u.map((function(t){if(t.startsWith("av01.")){var n=e.reader,i=n.Oa(),r=n.Tb(4,!1),a=String.fromCharCode(r[0]);if(a+=String.fromCharCode(r[1]),a+=String.fromCharCode(r[2]),"nclx"===(a+=String.fromCharCode(r[3]))){r=n.Ca(),a=n.Ca();var o=n.Ca(),s=n.Y()>>7,u=t.split(".");10==u.length&&(u[6]=so(r),u[7]=so(a),u[8]=so(o),u[9]=String(s),t=u.join("."))}n.seek(i)}return t}));var t=function(e){var t=null,n=null,i=e.Tb(4,!1),r=String.fromCharCode(i[0]);if(r+=String.fromCharCode(i[1]),r+=String.fromCharCode(i[2]),"nclx"===(r+=String.fromCharCode(i[3]))){switch(e.Ca()){case 1:case 5:case 6:case 7:t="srgb";break;case 9:t="rec2020";break;case 11:case 12:t="p3"}switch(i=e.Ca(),e.Ca(),i){case 1:case 6:case 13:case 14:case 15:n="SDR";break;case 16:n="PQ";break;case 18:n="HLG"}}return{colorGamut:t,ve:n}}(e.reader),n=t.colorGamut;v=t.ve,y=n})).parse(e||t,!0,!0),!s.length&&!u.length)return null;var b=l&&!c,w=new Map;if(c&&!n){n=new Tt("video/mp4"),e&&n.init(e);try{n.xf(t);for(var _=p(n.Vf()),S=_.next();!S.done;S=_.next()){var T=S.value;w.set(T,T)}}catch(e){}n.Nd()}return{type:b?"audio":"video",mimeType:b?"audio/mp4":"video/mp4",codecs:il(s.concat(u)).join(", "),language:d,height:h,width:f,channelCount:g,sampleRate:m,closedCaptions:w,ve:v,colorGamut:y,frameRate:null}}function il(e){for(var t=new Set,n=[],i=(e=p(e)).next();!i.done;i=e.next()){var r=si(i=i.value);t.has(r)||(n.push(i),t.add(r))}return t=st("audio",n),i=st("video",n),e=st(ut,n),i=function(e){if(e.length<=1)return e;var t=e.find((function(e){return e.startsWith("dvav.")||e.startsWith("dva1.")||e.startsWith("dvh1.")||e.startsWith("dvhe.")||e.startsWith("dav1.")||e.startsWith("dvc1.")||e.startsWith("dvi1.")}));return t?mt('video/mp4; codecs="'+t+'"')?[t]:e.filter((function(e){return e!=t})):e}(i),t=t.concat(i).concat(e),n.length&&!t.length?n:t}function rl(t,n,i){var r,a,o,s,u;return R((function(l){if(1==l.g)return(r=n).cryptoKey?l.A(2):w(l,r.fetchKey(),3);if(!(a=r.iv))for(a=Le(new ArrayBuffer(16)),o=r.firstMediaSequenceNumber+i,s=a.byteLength-1;s>=0;s--)a[s]=255&o,o>>=8;return u="CBC"==n.blockCipherMode?{name:"AES-CBC",iv:a}:{name:"AES-CTR",counter:a,length:64},l.return(e.crypto.subtle.decrypt(u,r.cryptoKey,t))}))}function al(e,t,n,i,r){return e=Vr(e,i,r),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function ol(e,t){var n=this;this.g=t,this.j=e,this.i=null,this.M=new Map,this.C=1,this.B=this.o=null,this.V=0,this.h=new Map,this.N=!1,this.X=null,this.F=!1,this.l=new Yr((function(){return function(e){var t,n,i,r,a,o;return R((function(s){if(1==s.g){for(e.u&&e.u.stop(),e.u=null,e.K&&e.K.stop(),e.K=null,e.G&&(e.G.release(),e.G=null),t=[],n=p(e.h.values()),i=n.next();!i.done;i=n.next())Al(r=i.value),t.push(El(r)),r.ha&&(Xu(r.ha),r.ha=null);for(a=p(e.m.values()),o=a.next();!o.done;o=a.next())Xu(o.value);return w(s,Promise.all(t),2)}e.h.clear(),e.m.clear(),e.g=null,e.j=null,e.i=null,e.I=null,_(s)}))}(n)})),this.R=Date.now()/1e3,this.m=new Map,this.T={projection:null,hfov:null},this.aa=0,this.$=1/0,this.H=null,this.O=[],this.u=new Si((function(){if(n.j&&n.g)if(n.j.presentationTimeline.W()){var e=n.j.presentationTimeline.Xb(),t=n.j.presentationTimeline.Gb();t-e>1?function(e,t,n){R((function(i){return e.K.g||e.g.error||e.N||e.H||Ns(e)||Os(e)?i.return():w(i,Ys(e,(function(){Ns(e)||Os(e)||e.i.setLiveSeekableRange(t,n)})),0)}))}(n.g.Z,e,t):qs(n.g.Z)}else qs(n.g.Z),n.u&&n.u.stop();else n.u&&n.u.stop()})),this.I=null,this.J=!1,this.K=new Si((function(){var e=n.g.video;!e.ended&&n.I&&(n.J=!0,e.currentTime=n.I,n.I=null)})),this.G=new te}function sl(e,t){for(var n=e.g.Ob()<0,i=p(e.h.values()),r=i.next();!r.done;r=i.next())(r=r.value).ua&&r.ua.Id(n),r.ha&&r.ha.Id(n);for(r=(i=p(e.m.values())).next();!r.done;r=i.next())r.value.Id(n);(n=e.h.get("video"))&&(i=n.stream)&&(t?(t=i.trickModeVideo)&&!n.Mc&&(cl(e,t,!1,0,!1),n.Mc=i):(t=n.Mc)&&(n.Mc=null,cl(e,t,!0,0,!1)))}function ul(e,t,n,i,r,a){n=void 0!==n&&n,i=void 0===i?0:i,r=void 0!==r&&r,a=void 0!==a&&a,e.o=t,e.N&&(t.video&&cl(e,t.video,n,i,r,a),t.audio&&cl(e,t.audio,n,i,r,a))}function ll(e,t){R((function(n){if(1==n.g)return e.H=null,e.B=t,e.N?t.segmentIndex?n.A(2):w(n,t.createSegmentIndex(),2):n.return();cl(e,t,!0,0,!1),_(n)}))}function cl(e,t,n,i,r,a){var o=e.h.get(t.type);o||t.type!=ut?o&&(o.Mc&&(t.trickModeVideo?(o.Mc=t,t=t.trickModeVideo):o.Mc=null),o.stream!=t||r)&&(e.m.has(t)?o.ha=e.m.get(t):o.ha&&function(e,t){t&&t!==e.i&&(Xu(e),e.i=t)}(o.ha,t),t.type==ut&&o.stream!=t&&(r=ni(t.mimeType,t.codecs),Ls(e.g.Z,r,e.j.sequenceMode,t.external)),!e.m.has(o.stream)&&o.stream.closeSegmentIndex&&(o.Ja?(r="("+o.type+":"+o.stream.id+")",e.M.has(r)||e.M.set(r,o.stream.closeSegmentIndex)):o.stream.closeSegmentIndex()),r=o.stream.isAudioMuxedInVideo!=t.isAudioMuxedInVideo,o.stream=t,o.ua=null,o.cg=!!a,t.dependencyStream?o.Ec=fl(e,t.dependencyStream):o.Ec=null,Rl(e),r&&(o.pb=null,o.qc=null,o.nc=null,t.isAudioMuxedInVideo&&(t=null,"video"===o.type?t=e.h.get("audio"):"audio"===o.type&&(t=e.h.get("video")),t&&(El(t).catch((function(){})),t.pb=null,t.qc=null,t.nc=null,hl(e,t),dl(e,t).catch((function(t){e.g&&e.g.onError(t)}))))),n?o.Ub?o.Kd=!0:o.Ja?(o.ec=!0,o.ld=i,o.Kd=!0):(Al(o),xl(e,o,!0,i).catch((function(t){e.g&&e.g.onError(t)}))):o.Ja||o.qb||kl(e,o,0),dl(e,o).catch((function(t){e.g&&e.g.onError(t)}))):function(e,t){var n,i,r,a,o;R((function(s){switch(s.g){case 1:return n=lt,e.V++,i=e.V,S(s,2),w(s,Hs(e.g.Z,n.Na),4);case 4:x(s,3);break;case 2:r=k(s),e.g&&e.g.onError(r);case 3:a=ni(t.mimeType,t.codecs),Ls(e.g.Z,a,e.j.sequenceMode,t.external),(e.g.Z.aa.isTextVisible()||e.i.alwaysStreamText)&&e.V==i&&(o=fl(e,t),e.h.set(n.Na,o),kl(e,o,0)),_(s)}}))}(e,t)}function dl(e,t){var n,i,r;return R((function(a){if(1==a.g)return t.Va?(n=t.stream,i=t.Va,n.segmentIndex?a.A(2):w(a,n.createSegmentIndex(),2)):a.return();if(4!=a.g)return!(r=n.dependencyStream)||r.segmentIndex?a.A(4):w(a,r.createSegmentIndex(),4);if(t.Va!=i||t.stream!=n)return a.return();var o=e.g.lc(),s=Us(e.g.Z,t.type),u=t.stream.segmentIndex.find(t.La?t.La.endTime:o),l=null==u?null:t.stream.segmentIndex.get(u);u=l?Bo(l):null,l&&!u&&(u=(l.endTime-l.getStartTime())*(t.stream.bandwidth||e.o.bandwidth)/8),u?((l=l.ba)&&(u+=(l.endByte?l.endByte+1-l.startByte:null)||0),o=8*u/(l=e.g.getBandwidthEstimate())<(s||0)-o-e.i.rebufferingGoal||t.Va.h.g>u):o=!0,o&&t.Va.abort(),_(a)}))}function hl(e,t){t.Ub||t.ec||(t.Ja?(t.ec=!0,t.ld=0):null==js(e.g.Z,t.type)?null==t.qb&&kl(e,t,0):(Al(t),xl(e,t,!1,0).catch((function(t){e.g&&e.g.onError(t)}))))}function fl(e,t){var n={stream:t,type:t.type,ua:null,ha:pl(e,t),La:null,pb:null,kf:null,qc:null,nc:null,hf:null,jf:null,Mc:null,endOfStream:!1,Ja:!1,qb:null,ec:!1,ld:0,Kd:!1,Ub:!1,bd:!0,cg:!1,ah:!1,Zd:!1,Va:null,Ec:null};return t.dependencyStream&&(n.Ec=fl(e,t.dependencyStream)),n}function pl(e,t){if("video"===t.type&&e.i.disableVideoPrefetch||"audio"===t.type&&e.i.disableAudioPrefetch||t.type===ut&&("application/cea-608"==t.mimeType||"application/cea-708"==t.mimeType)||t.type===ut&&e.i.disableTextPrefetch)return null;if(e.m.has(t))return e.m.get(t);var n=e.h.get(t.type);return(n=n&&n.ha)&&t===n.i?n:e.i.segmentPrefetchLimit>0?new Gu(e.i.segmentPrefetchLimit,t,(function(t,n,i){return Tl(t,n,i||null,e.i.retryParameters,e.g.tc)}),e.g.Ob()<0,e.g.al):null}function gl(t,n){var i,r,a,o,s,u,l,c,d;return R((function(h){switch(h.g){case 1:if(Jr(t.l),i=lt,n.Ja||null==n.qb||n.Ub)return h.return();if(n.qb=null,!n.ec){h.A(2);break}return w(h,xl(t,n,n.Kd,n.ld),3);case 3:return h.return();case 2:if(function(e,t){for(var n=p(e.M.entries()),i=n.next();!i.done;i=n.next()){var r=p(i.value);i=r.next().value,r=r.next().value,i.includes(t.type)&&(r(),e.M.delete(i))}}(t,n),n.stream.segmentIndex){h.A(4);break}return r=n.stream,S(h,5),w(h,n.stream.createSegmentIndex(),7);case 7:x(h,6);break;case 5:return a=k(h),w(h,Il(t,n,a),8);case 8:return h.return();case 6:if(r!=n.stream)return r.closeSegmentIndex&&r.closeSegmentIndex(),n.Ja||n.qb||kl(t,n,0),h.return();case 4:if(!n.Ec){h.A(9);break}if(n.Ec.stream.segmentIndex){h.A(9);break}return S(h,11),w(h,n.Ec.stream.createSegmentIndex(),13);case 13:x(h,9);break;case 11:k(h);case 9:S(h,14),o=function(t,n){if(_l(n))return function(e,t){var n=Us(e,"video")||0;vi(e.h,t,n)}(t.g.Z,n.stream.originalId||""),null;if(n.type==ut&&function(e){e.h&&vi(e.h,"",0)}(t.g.Z),n.stream.isAudioMuxedInVideo&&"audio"==n.type)return null;if(n.type!=ut&&Os(t.g.Z))return Ml(t,!0),null;var i=t.i.updateIntervalSeconds/Math.max(1,Math.abs(t.g.Ob()));if(!Ds(t.g.Z)&&n.type!=ut)return i/2;var r=t.g.lc();if("audio"===n.type)for(var a=p(t.m.keys()),o=a.next();!o.done;o=a.next())(o=t.m.get(o.value)).Ya(r,!0),$u(o,r);a=n.La?n.La.endTime:r;var s=function(e,t,n){return t==ut?null==(e=e.h).h||e.h<n?0:e.h-Math.max(n,e.g):Wo(e=Fs(e,t),n)}(t.g.Z,n.type,r);o=Math.max(1,Math.max(t.i.rebufferingGoal,t.i.bufferingGoal)*t.C);var u=t.j.presentationTimeline.getDuration()-a,l=Us(t.g.Z,n.type);if(u<1e-6&&l)return n.endOfStream=!0,"video"==n.type&&(t=t.h.get(ut))&&_l(t)&&(t.endOfStream=!0),null;if(n.endOfStream=!1,s>=o)return i/2;if(u=!n.ua,l=ml(t,n,r,l),!l)return i;s=n.pb;var c=l.ba;s&&c&&Uo(c,s)&&(s.g=c.g),s=!1,u&&n.cg&&(s=!0,n.cg=!1),u=1/0;for(var d=(c=p(c=Array.from(t.h.values()))).next();!d.done;d=c.next())_l(d=d.value)||d.ua&&!d.ua.current()||(u=Math.min(u,d.La?d.La.endTime:r));return a>=u+t.j.presentationTimeline.h?i:(n.ha&&n.ua&&!t.m.has(n.stream)&&(n.ha.Ya(l.startTime+.001),$u(n.ha,l.startTime).catch((function(){}))),Pl(t)&&function(e,t,n){if(t.type===ut)return!1;var i=t.pb;if(!i)return!1;var r=n.ba;if(n=i.g!==r.g,"reset_to_encrypted"===e.i.crossBoundaryStrategy&&(i.encrypted||r.encrypted||(n=!1),i.encrypted&&(e.i.crossBoundaryStrategy="keep")),"RESET_ON_ENCRYPTION_CHANGE"===e.i.crossBoundaryStrategy&&i.encrypted==r.encrypted&&(n=!1),"keep"===e.i.crossBoundaryStrategy&&i.mimeType&&r.mimeType){var a=oi(li(i.mimeType)),o=oi(li(i.mimeType));i.mimeType==r.mimeType&&a==o&&(n=!1)}return n&&(e.J||t.bd)&&(e.J=!1,Ml(e,!0).then((function(){var t=(new Map).set("oldEncrypted",i.encrypted).set("newEncrypted",r.encrypted);e.g.onEvent(new Dr("boundarycrossed",t))}))),n}(t,n,l)||(function(t,n,i,r,a){var o,s,u,l,c,d,h,f,g,m,v,y,b,T,A,E;return R((function(I){switch(I.g){case 1:if(o=lt,s=n.stream,u=n.ua,n.Ja=!0,S(I,2),2==r.Jc())throw new Ue(1,1,1011);return w(I,function(e,t,n,i){var r,a,o,s,u,l,c,d,h,f,g,m,v,y,b,_;return R((function(T){switch(T.g){case 1:if(r=lt,a=null==t.La,o=[],s=Math.max(0,Math.max(n.appendWindowStart,e.aa)-.1),u=Math.min(n.appendWindowEnd,e.$)+.1,l=n.codecs||t.stream.codecs,c=si(l),d=ui(n.mimeType||t.stream.mimeType),(h=n.timestampOffset)==t.kf&&s==t.qc&&u==t.nc&&c==t.hf&&d==t.jf){T.A(2);break}if(f=t.hf&&t.jf&&function(e,t,n,i,r){return(e=tu(e,t,n,i,r)).dc&&e.dc.destroy(),e.type==au}(e.g.Z,t.type,d,l,Ll(e)),!f){T.A(3);break}if(g=null,t.type===r.Aa?g=e.h.get(r.ka):t.type===r.ka&&(g=e.h.get(r.Aa)),!g){T.A(3);break}return w(T,El(g).catch((function(){})),5);case 5:g.pb=null,g.qc=null,g.nc=null,hl(e,g);case 3:return w(T,yl(e,t,h,s,u,n,c,d),2);case 2:return Uo(n.ba,t.pb)||(t.pb=n.ba,n.l&&n.ba&&(m=Sl(e,t,n.ba),v=function(){var a,o,s,u,l,c,d,h,f,g,v;return R((function(y){switch(y.g){case 1:return S(y,2),w(y,m,4);case 4:return a=y.h,Jr(e.l),o=null,s=new Map,u={projection:null,hfov:null},t.stream&&(l=t.stream.videoLayout)&&((c=l.split("/")).includes("PROJ-RECT")?u.projection="rect":c.includes("PROJ-EQUI")?u.projection="equi":c.includes("PROJ-HEQU")?u.projection="hequ":c.includes("PROJ-PRIM")?u.projection="prim":c.includes("PROJ-AIV")&&(u.projection="hequ")),(d=new ra).box("moov",aa).box("trak",aa).box("mdia",aa).S("mdhd",(function(e){o=no(e.reader,e.version).timescale})).box("hdlr",(function(e){switch((e=e.reader).skip(8),e.Yc()){case"soun":s.set(r.ka,o);break;case"vide":s.set(r.Aa,o)}o=null})),t.type!==r.Aa||u.projection||d.box("minf",aa).box("stbl",aa).S("stsd",oa).box("encv",sa).box("avc1",sa).box("avc3",sa).box("hev1",sa).box("hvc1",sa).box("dvav",sa).box("dva1",sa).box("dvh1",sa).box("dvhe",sa).box("dvc1",sa).box("dvi1",sa).box("vexu",aa).box("proj",aa).S("prji",(function(e){e=e.reader.Yc(),u.projection=e})).box("hfov",(function(e){e=e.reader.U()/1e3,u.hfov=e})),d.parse(a,!0,!0),t.type===r.Aa&&function(e,t){if(e.T.projection!=t.projection||e.T.hfov!=t.hfov){if(null!=t.projection||null!=t.hfov){var n=(new Map).set("detail",t);n=new Dr("spatialvideoinfo",n)}else n=new Dr("nospatialvideoinfo");n.cancelable=!0,e.g.onEvent(n),e.T=t}}(e,u),s.has(t.type)?n.ba.timescale=s.get(t.type):null!=o&&(n.ba.timescale=o),(h=t.stream.segmentIndex)instanceof Lu&&(f=function(e,t){for(var n=(e=p(e.h)).next();!n.done;n=e.next())if(null!=(n=n.value).find(t))return n.Te();return-1}(h,n.startTime)),g=t.stream.closedCaptions&&t.stream.closedCaptions.size>0,w(y,e.g.Oh(t.type,a),5);case 5:return w(y,Bs(e.g.Z,t.type,a,null,t.stream,g,t.bd,i,!1,!1,f),6);case 6:x(y,0);break;case 2:throw v=k(y),t.pb=null,v}}))},y=n.startTime,a&&(null!=(b=Us(e.g.Z,t.type))&&(y=b)),e.g.Ck(y,n.ba),o.push(v()))),_=t.La?t.La.i:-1,n.i!=_&&o.push(function(e,t,n){var i,r;return R((function(a){return 1==a.g?t==(i=lt).Na?a.return():(t==i.Aa&&(e.Ta=new Ar),!e.I||(r=Us(e,t))&&Math.abs(r-n)<.15?a.return():(Xs(e,t,(function(){return zs(e,t)}),null),e.m&&Xs(e,i.ka,(function(){return zs(e,i.ka)}),null),w(a,Xs(e,t,(function(){return $s(e,t,n)}),null),2))):e.m?w(a,Xs(e,i.ka,(function(){return $s(e,i.ka,n)}),null),0):a.A(0)}))}(e.g.Z,t.type,n.startTime)),w(T,Promise.all(o),0)}}))}(t,n,r,a),4);case 4:return Jr(t.l),t.F?I.return():(l="video/mp4"==s.mimeType||"audio/mp4"==s.mimeType,c=e.ReadableStream,t.i.lowLatencyMode&&t.j.isLowLatency&&c&&l&&("HLS"!=t.j.type||r.o)?(h=new Uint8Array(0),g=f=!1,v=function(e){var o,u,l;return R((function(c){switch(c.g){case 1:if(f)return c.return();if(g=!0,Jr(t.l),t.F)return c.return();if(S(c,2),h=tt(h,e),o=!1,u=0,(new ra).box("mdat",(function(e){u=e.size+e.start,o=!0})).parse(h,!1,!0),!o){c.A(4);break}return l=h.subarray(0,u),h=h.subarray(u),w(c,bl(t,n,i,s,r,l,!0,a),5);case 5:n.ha&&n.ua&&$u(n.ha,r.startTime,!0);case 4:x(c,0);break;case 2:m=k(c),_(c)}}))},w(I,Sl(t,n,r,v),9)):w(I,Sl(t,n,r),7));case 7:return d=I.h,Jr(t.l),t.F?I.return():(Jr(t.l),n.ec?(n.Ja=!1,kl(t,n,0),I.return()):w(I,bl(t,n,i,s,r,d,!1,a),6));case 9:if(y=I.h,m)throw m;if(g){I.A(10);break}return f=!0,Jr(t.l),t.F?I.return():n.ec?(n.Ja=!1,kl(t,n,0),I.return()):w(I,bl(t,n,i,s,r,y,!1,a),10);case 10:n.ha&&n.ua&&$u(n.ha,r.startTime,!0);case 6:if(Jr(t.l),t.F)return I.return();n.La=r,u.next(),n.Ja=!1,n.ah=!1,b=t.g.Z.Fc(),T=b[n.type],JSON.stringify(T),n.ec||(A=null,n.type===o.Aa?A=t.h.get(o.ka):n.type===o.ka&&(A=t.h.get(o.Aa)),A&&A.type==o.ka?t.g.wf(r,n.stream,A.stream.isAudioMuxedInVideo):t.g.wf(r,n.stream,n.stream.codecs.includes(","))),Al(n),kl(t,n,0),x(I,0);break;case 2:if(E=k(I),Jr(t.l,E),t.F)return I.return();if(n.Ja=!1,7001==E.code)n.Ja=!1,Al(n),kl(t,n,0),I.A(0);else{if(n.type!=o.Na||!t.i.ignoreTextStreamFailures)return 3017==E.code?w(I,function(e,t,n){var i,r,a,o,s,u;return R((function(l){switch(l.g){case 1:if(i=Array.from(e.h.values()),i.some((function(e){return e!=t&&e.ah}))){l.A(2);break}if(e.i.avoidEvictionOnQuotaExceededError)return r=Cl(e,n),e.g.disableStream(t.stream,r)||kl(e,t,4),l.return();if((a=Math.round(100*e.C))>20){e.C-=.2,l.A(3);break}if(a>4){e.C-=.04,l.A(3);break}if(o=Cl(e,n),!e.g.disableStream(t.stream,o)){t.Zd=!0,e.F=!0,e.g.onError(n),l.A(5);break}return e.C=1,s=e.g.lc(),w(l,wl(e,t,s),5);case 5:return l.return();case 3:return t.ah=!0,u=e.g.lc(),w(l,wl(e,t,u),2);case 2:kl(e,t,4),_(l)}}))}(t,n,E),0):(n.Zd=!0,1==E.category&&n.ha&&Qu(n.ha,r),E.severity=2,w(I,Il(t,n,E),0));t.h.delete(o.Na),I.A(0)}}}))}(t,n,r,l,s).catch((function(){})),n.Ec&&vl(t,n.Ec,r,o)),null)}(t,n),null!=o&&(kl(t,n,o),n.Zd=!1),x(h,15);break;case 14:return s=k(h),w(h,Il(t,n,s),16);case 16:return h.return();case 15:if(n.type===i.Na)return h.return();if(u=[],n.stream&&!n.stream.isAudioMuxedInVideo&&u.push(n),l=n.type===i.ka?i.Aa:i.ka,(c=t.h.get(l))&&c.stream&&!c.stream.isAudioMuxedInVideo&&u.push(c),!t.N||!u.every((function(e){return e.endOfStream}))){h.A(0);break}return w(h,t.g.Z.endOfStream(),18);case 18:Jr(t.l),0!=(d=t.g.Z.getDuration())&&d<t.j.presentationTimeline.getDuration()&&t.j.presentationTimeline.Ab(d),_(h)}}))}function ml(e,t,n,i){if(t.ua)return(n=t.ua.current())&&t.La&&Math.abs(t.La.startTime-n.startTime)<.001&&(n=t.ua.next().value),n;if(t.La||i)return n=t.La?t.La.endTime:i,e=e.g.Ob()<0,t.stream.segmentIndex&&(t.ua=t.stream.segmentIndex.Vb(n,!1,e)),t.ua&&t.ua.next().value;i=e.j.sequenceMode||Pl(e)?0:e.i.inaccurateManifestTolerance;var r=Math.max(n-i,0);e=e.g.Ob()<0;var a=null;return i&&(t.stream.segmentIndex&&(t.ua=t.stream.segmentIndex.Vb(r,!1,e)),a=t.ua&&t.ua.next().value),a||(t.stream.segmentIndex&&(t.ua=t.stream.segmentIndex.Vb(n,!1,e)),a=t.ua&&t.ua.next().value),a}function vl(e,t,n,i){var r,a,o,s,u,l,c,d,h,f;return R((function(p){switch(p.g){case 1:for(r=t.stream,s=(o=(a=r.segmentIndex)&&a.Vb(n))&&o.next().value;s&&e.O.includes(s.startTime);)s=o&&o.next().value;if(!s){p.A(0);break}if(!(u=s.ba)||Uo(u,t.pb)){p.A(3);break}return t.pb=u,S(p,4),w(p,Sl(e,t,u),6);case 6:l=p.h;var m=e.g.Z;m.C&&ft(m.C,l,0,r),e.O=[],x(p,3);break;case 4:throw c=k(p),t.pb=null,c;case 3:if(t.La&&t.La==s){p.A(0);break}return t.La=s,S(p,8),w(p,Sl(e,t,s),10);case 10:d=p.h,(m=e.g.Z).C&&ft(m.C,d,0,r),e.O.push(s.startTime),x(p,9);break;case 8:throw h=k(p),t.La=null,h;case 9:if(f=Math.max.apply(Math,[0].concat(g(e.O))),e.g.lc()+i>f)return w(p,vl(e,t,s.startTime,i),0);p.A(0)}}))}function yl(e,t,n,i,r,a,o,s){var u,l,c,d,h;return R((function(f){switch(f.g){case 1:if(u=lt,l=Ll(e),S(f,2),t.qc=i,t.nc=r,o&&(t.hf=o),s&&(t.jf=s),t.kf=n,c=e.j.sequenceMode||"HLS"==e.j.type,d=null,t.type===u.Aa?d=e.h.get(u.ka):t.type===u.ka&&(d=e.h.get(u.Aa)),!(d&&d.stream&&d.stream.isAudioMuxedInVideo)){f.A(4);break}return w(f,Vs(e.g.Z,d.type,n,i,r,c,d.stream.mimeType,d.stream.codecs,l),4);case 4:return w(f,Vs(e.g.Z,t.type,n,i,r,c,a.mimeType||t.stream.mimeType,a.codecs||t.stream.codecs,l),6);case 6:x(f,0);break;case 2:throw h=k(f),t.qc=null,t.nc=null,t.hf=null,t.jf=null,t.kf=null,h}}))}function bl(e,t,n,i,r,a,o,s){var u,l,c,d;return o=void 0!==o&&o,s=void 0!==s&&s,R((function(h){switch(h.g){case 1:return u=i.closedCaptions&&i.closedCaptions.size>0,e.i.shouldFixTimestampOffset&&(l="video/mp4"==i.mimeType||"audio/mp4"==i.mimeType,c=null,r.ba&&(c=r.ba.timescale),l&&c&&"video"===i.type&&"DASH"==e.j.type&&(new ra).box("moof",aa).box("traf",aa).S("tfdt",(function(n){var i,a,o,s,u;return R((function(l){return i=to(n.reader,n.version),(a=i.baseMediaDecodeTime)?(o=-a/c,(Number(t.kf)||0)<o?(s=t.qc,u=t.nc,w(l,yl(e,t,o,s,u,r),0)):l.A(0)):l.return()}))})).parse(a,!1,o)),w(h,wl(e,t,n),2);case 2:return Jr(e.l),d=t.bd,t.bd=!1,w(h,e.g.Oh(t.type,a),3);case 3:return w(h,Bs(e.g.Z,t.type,a,r,i,u,d,s,o),4);case 4:Jr(e.l),_(h)}}))}function wl(e,t,n){var i,r,a,o,s,u,l,c,d;return R((function(h){return 1==h.g?((i=t.stream.segmentIndex)instanceof Lu&&(i.Ya(e.j.presentationTimeline.Hb()),r=[],function(e,t){for(var n=(e=p(e.h)).next();!n.done;n=e.next())t(n.value)}(i,(function(e){r.push(e.Te())}))),a=Math.max(e.i.bufferBehind*e.C,e.j.presentationTimeline.h),null==(o=js(e.g.Z,t.type))?(e.H==t&&(e.H=null),h.return()):(s=n-o,u=e.i.evictionGoal,l=e.j.presentationTimeline.Xb(),c=e.j.presentationTimeline.Gb(),d=s-a,c-l>u&&(d=Math.max(s-a,l-u-o)),d<=u?h.return():w(h,e.g.Z.remove(t.type,o,o+d,r),2))):4!=h.g?(Jr(e.l),e.H?w(h,wl(e,e.H,n),4):h.A(0)):(Jr(e.l),void _(h))}))}function _l(e){return e&&e.type==ut&&("application/cea-608"==e.stream.mimeType||"application/cea-708"==e.stream.mimeType)}function Sl(e,t,n,i){var r,a,o,s,u;return R((function(l){switch(l.g){case 1:if(r=n.Yb())return l.return(r);if(a=null,t.ha){var c=t.ha,d=c.g;n instanceof jo&&(d=c.j),d.has(n)?(c=d.get(n),i&&(c.wh=i),a=c.je):a=null}return a||(a=Tl(n,t.stream,i||null,e.i.retryParameters,e.g.tc)),o=0,t.ua&&(o=t.ua.h),t.Va=a,w(l,a.promise,2);case 2:if(s=l.h,t.Va=null,u=s.data,!n.aesKey){l.A(3);break}return w(l,rl(u,n.aesKey,o),4);case 4:u=l.h;case 3:return l.return(u)}}))}function Tl(e,t,n,i,r,a){a=void 0!==a&&a;var o=e instanceof Fo?e:void 0,s=o?1:0;return(e=al(e.P(),e.startByte,e.endByte,i,n)).contentType=t.type,r.request(Kr,e,{type:s,stream:t,segment:o,isPreload:a})}function xl(e,t,n,i){var r,a;return R((function(o){return 1==o.g?(t.ec=!1,t.Kd=!1,t.ld=0,t.Ub=!0,t.La=null,t.ua=null,t.ha&&!e.m.has(t.stream)&&Xu(t.ha),i?(r=e.g.lc(),a=e.g.Z.getDuration(),w(o,e.g.Z.remove(t.type,r+i,a),3)):w(o,Hs(e.g.Z,t.type),4)):3!=o.g?(Jr(e.l),n?w(o,e.g.Z.flush(t.type),3):o.A(3)):(Jr(e.l),t.Ub=!1,t.endOfStream=!1,t.Ja||t.qb||kl(e,t,0),void _(o))}))}function kl(e,t,n){var i=t.type;(i!=ut||e.h.has(i))&&(t.qb=new _i((function(){var n;return R((function(i){return 1==i.g?(S(i,2),w(i,gl(e,t),4)):2!=i.g?x(i,0):(n=k(i),e.g&&e.g.onError(n),void _(i))}))})).ia(n))}function Al(e){null!=e.qb&&(e.qb.stop(),e.qb=null)}function El(e){return R((function(t){return e.Va?w(t,e.Va.abort(),0):t.A(0)}))}function Il(e,t,n){var i;return R((function(r){if(1==r.g)return 3024==n.code?(t.Ja=!1,Al(t),kl(e,t,0),r.return()):w(r,kr(e.X),2);if(Jr(e.l),1===n.category&&1003!=n.code){if(t.Mc)return sl(e,!1),r.return();i=Cl(e,n),n.handled=e.g.disableStream(t.stream,i),n.handled&&(n.severity=1)}n.handled&&1011==n.code||e.g.onError(n),n.handled||e.i.failureCallback(n),_(r)}))}function Cl(e,t){return 0===e.i.maxDisabledTime&&1011==t.code?1:e.i.maxDisabledTime}function Ml(e,t){var n,i,r,a,o,s;return t=void 0!==t&&t,R((function(u){if(1==u.g){if(n=Date.now()/1e3,i=e.i.minTimeBetweenRecoveries,!t){if(!e.i.allowMediaSourceRecoveries||n-e.R<i)return u.return(!1);e.R=n}return r=lt,(a=e.h.get(r.ka))&&(Al(a),a.Va&&(a.Va.abort(),a.Va=null),a.pb=null,a.qc=null,a.nc=null,a.Ja=!1,a.ec=!1,a.ld=0,a.Kd=!1,a.Ub=!1,a.ua&&a.ua.eh()),(o=e.h.get(r.Aa))&&(Al(o),o.Va&&(o.Va.abort(),o.Va=null),o.pb=null,o.qc=null,o.nc=null,o.Ja=!1,o.ec=!1,o.ld=0,o.Kd=!1,o.Ub=!1,o.ua&&o.ua.eh()),s=e.g.video.paused,w(u,Zs(e.g.Z,Ll(e)),2)}return!o||o.Ub||o.Ja||o.qb||kl(e,o,0),!a||a.Ub||a.Ja||a.qb||kl(e,a,0),s||e.g.video.play(),u.return(!0)}))}function Pl(e){if("keep"!==e.i.crossBoundaryStrategy)return!0;var t=ae();if(vt()&&t.Pc()){if(!t.Jf())for(n=(t=p(e.h.keys())).next();!n.done;n=t.next())if((n=e.h.get(n.value)).type!==lt.Na&&(n=n.stream)&&n.fullMimeTypes&&n.fullMimeTypes.size>1){for(e=new Set,n=(t=p(n.fullMimeTypes)).next();!n.done;n=t.next())e.add(ai(n.value));return e.size>1}}else for(var n=(t=p(e.h.keys())).next();!n.done;n=t.next())if((n=e.h.get(n.value)).type!==lt.Na&&(n=n.stream)&&n.fullMimeTypes&&n.fullMimeTypes.size>1)return!0;return!1}function Rl(e){e.G.Pa(),Pl(e)&&(e.G.D(e.g.video,"waiting",(function(){return Dl(e)})),e.G.D(e.g.video,"timeupdate",(function(){return Dl(e)})))}function Dl(e){if(Pl(e)){e.K.stop();var t=e.g.lc(),n=e.h.get("video")||e.h.get("audio");n&&(n=n.pb)&&null!==n.g&&((t=n.g-t)<0||t>1||(e.I=n.g+.1,e.K.ia(t)))}}function Ll(e,t){function n(t){if(t.fullMimeTypes&&t.fullMimeTypes.size>1&&e.h.has(t.type)){var n=e.h.get(t.type),i=Us(e.g.Z,n.type),r=e.g.lc();(n=ml(e,n,r,i))&&n.codecs&&n.mimeType&&(t.codecs=n.codecs,t.mimeType=n.mimeType)}}t=void 0!==t&&t;var i=new Map,r=e.o.audio;return r&&(n(r),i.set("audio",r)),(r=e.o.video)&&(n(r),i.set("video",r)),t&&e.B&&i.set(ut,e.B),i}function Nl(){}function Ol(e,t,n,i,r){var a,o=r in i,s=o?n.constructor==Object&&0==Object.keys(i).length:n.constructor==Object&&0==Object.keys(n).length,u=o||s,l=!0;for(a in t){var c=r+"."+a,d=o?i[r]:n[a];u||a in n?void 0===t[a]?void 0===d||u?delete e[a]:e[a]=Ft(d):s?e[a]=t[a]:d.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=Ft(d)),c=Ol(e[a],t[a],d,i,c),l=l&&c):typeof t[a]!=typeof d||null==t[a]||"function"!=typeof t[a]&&t[a].constructor!=d.constructor?(z("Invalid config, wrong type for "+c),l=!1):"function"==typeof n[a]&&n[a].length!=t[a].length?($("Unexpected number of arguments for "+c),e[a]=t[a]):e[a]=Array.isArray(e[a])?t[a].slice():t[a]:(z("Invalid config, unrecognized key "+c),l=!1)}return l}function jl(e,t){for(var n={},i=n,r=0,a=0;!((r=e.indexOf(".",r))<0);)0!=r&&"\\"==e[r-1]||(i[a=e.substring(a,r).replace(/\\\./g,".")]={},i=i[a],a=r+1),r+=1;return i[e.substring(a).replace(/\\\./g,".")]=t,n}function Ul(e,t){return e&&t}function Fl(e,t){function n(e){return e&&"object"==typeof e&&!Array.isArray(e)}return e=function e(t,i){return Object.keys(t).reduce((function(r,a){var o=t[a];return i.hasOwnProperty(a)?o instanceof HTMLElement&&i[a]instanceof HTMLElement?o.isEqualNode(i[a])||(r[a]=o):n(o)&&n(i[a])?(o=e(o,i[a]),(Object.keys(o).length>0||!n(o))&&(r[a]=o)):Array.isArray(o)&&Array.isArray(i[a])?Q(o,i[a])||(r[a]=o):Number.isNaN(o)&&Number.isNaN(i[a])||o!==i[a]&&(r[a]=o):r[a]=o,r}),{})}(e,t),function e(t){for(var i=p(Object.keys(t)),r=i.next();!r.done;r=i.next())if(!(t[r=r.value]instanceof HTMLElement))if(n(t[r])&&0===Object.keys(t[r]).length)delete t[r];else{var a=t[r];Array.isArray(a)&&0===a.length||"function"==typeof t[r]?delete t[r]:n(t[r])&&(e(t[r]),0===Object.keys(t[r]).length&&delete t[r])}}(e),e}function Bl(){}function Hl(e){return new ge(e=qe(e)).Db}function Vl(e,t,n){function i(e){Oe(a).setUint32(o,e.byteLength,!0),o+=4,a.set(Le(e),o),o+=e.byteLength}if(!n||!n.byteLength)throw new Ue(2,6,6015);var r;r="string"==typeof t?ze(t,!0):t,e=ze(e=qe(e),!0);var a=new Uint8Array(12+e.byteLength+r.byteLength+n.byteLength),o=0;return i(e),i(r),i(n),a}function ql(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,Vl(e,n=qe(e).split("skd://").pop(),t))}function Gl(e,t){2===e&&(e=t.drmInfo)&&wr(e.keySystem)&&(t.headers["Content-Type"]="application/octet-stream")}function zl(e,t,n){for(n=void 0===n||n,this.h=e,this.g=new Set([e]),t=(e=p(t=t||[])).next();!t.done;t=e.next())this.add(t.value,n)}function $l(e,t){if(e.mimeType!=t.mimeType)return!1;if(e=e.codecs.split(",").map((function(e){return si(e)})),t=t.codecs.split(",").map((function(e){return si(e)})),e.length!=t.length)return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function Kl(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;for(var n=(e=p(e)).next();!n.done;n=e.next())if(!t.has(n.value))return!1;return!0}function Wl(){this.h=this.g=null}function Xl(e,t){return e.filter((function(e){return!(e.audio&&e.audio.channelsCount&&e.audio.channelsCount>t)})).sort((function(e,t){return e.audio||t.audio?e.audio?t.audio?(t.audio.channelsCount||0)-(e.audio.channelsCount||0):1:-1:0}))}function Yl(e,t){return e.filter((function(e){return!e.audio||e.audio.codecs==t}))}function Jl(){}function Ql(){var t=1/0,n=ae();navigator.connection&&navigator.connection.saveData&&(t=360);var i={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(t,n,i){return"apple"===e.shakaMediaKeysPolyfill&&"skd"==n&&(n=i.serverCertificate,t=Vl(t,i=Hl(t),n)),t},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:!1,minHdcpVersion:"",ignoreDuplicateInitData:!0,defaultAudioRobustnessForWidevine:"SW_SECURE_CRYPTO",defaultVideoRobustnessForWidevine:"SW_SECURE_DECODE"},r="reload";vt()&&n.Pc()&&(r="smooth");var a={trackSelectionCallback:function(e){return R((function(t){return t.return(e)}))},downloadSizeCallback:function(e){var t;return R((function(n){return 1==n.g?navigator.storage&&navigator.storage.estimate?w(n,navigator.storage.estimate(),3):n.return(!0):(t=n.h,n.return(t.usage+e<.95*t.quota))}))},progressCallback:function(e,t){return Ul([e,t])},usePersistentLicense:!0,numberOfParallelDownloads:5},o={drm:i,manifest:{retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,disableIFrames:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,continueLoadingWhenPaused:!0,ignoreSupplementalCodecs:!1,updatePeriod:-1,ignoreDrmInfo:!1,enableAudioGroups:!0,dash:{clockSyncUri:"",disableXlinkProcessing:!0,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:94ce86fb-07ff-4f43-adb8-93d2fa968ca2":"com.apple.fps","urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c":"com.huawei.wiseplay"},manifestPreprocessor:tc,manifestPreprocessorTXml:nc,sequenceMode:!1,useStreamOnceInPeriodFlattening:!1,enableFastSwitching:!0},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,ignoreManifestProgramDateTimeForTypes:[],mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',liveSegmentsDelay:3,sequenceMode:n.fd(),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,disableClosedCaptionsDetection:!1,allowLowLatencyByteRangeOptimization:!0,allowRangeRequestsToGuessMimeType:!1},mss:{manifestPreprocessor:tc,manifestPreprocessorTXml:nc,sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}},streaming:{retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},failureCallback:function(e){return Ul([e])},rebufferingGoal:0,bufferingGoal:10,bufferBehind:30,evictionGoal:1,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapPadding:0,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,safeSeekEndOffset:0,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsForFairPlay:!0,inaccurateManifestTolerance:2,lowLatencyMode:!0,preferNativeDash:!1,preferNativeHls:!1,updateIntervalSeconds:1,observeQualityChanges:!1,maxDisabledTime:30,segmentPrefetchLimit:1,prefetchAudioLanguages:[],disableAudioPrefetch:!1,disableTextPrefetch:!1,disableVideoPrefetch:!1,liveSync:{enabled:!1,targetLatency:.5,targetLatencyTolerance:.5,maxPlaybackRate:1.1,minPlaybackRate:.95,panicMode:!1,panicThreshold:60,dynamicTargetLatency:{enabled:!1,stabilityThreshold:60,rebufferIncrement:.5,maxAttempts:10,maxLatency:4,minLatency:1}},allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5,vodDynamicPlaybackRate:!1,vodDynamicPlaybackRateLowBufferRate:.95,vodDynamicPlaybackRateBufferRatio:.5,preloadNextUrlWindow:30,loadTimeout:30,clearDecodingCache:!1,dontChooseCodecs:!1,shouldFixTimestampOffset:!1,avoidEvictionOnQuotaExceededError:!1,crossBoundaryStrategy:"keep",returnToEndOfLiveWindowWhenOutside:!1},networking:{forceHTTP:!1,forceHTTPS:!1,minBytesForProgressEvents:16e3},mediaSource:{codecSwitchingStrategy:r,addExtraFeaturesToSourceBuffer:function(e){return Ul([e],"")},forceTransmux:!1,insertFakeEncryptionInInit:!0,correctEc3Enca:!1,modifyCueCallback:function(e,t){return Ul([e,t])},dispatchAllEmsgBoxes:!1,useSourceElements:!0,durationReductionEmitsUpdateEnd:!0},offline:a,abrFactory:function(){return new fr},adaptationSetCriteriaFactory:function(){return new(Function.prototype.bind.apply(Wl,[null].concat(g(D.apply(0,arguments)))))},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0,cacheLoadThreshold:5,minTimeToSwitch:0,preferNetworkInformationBandwidth:!1,removeLatencyFromFirstPacketTime:!0},autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredAudioRole:"",preferredVideoRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferredTextFormats:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayer:{captionsUpdatePeriod:.25,fontScaleFactor:1},textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",rtpSafetyFactor:5,useHeaders:!1,includeKeys:[],version:1,targets:[]},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1,poster:!0},ads:{customPlayheadTracker:!1,skipPlayDetection:!1,supportsMultipleMediaElements:!0,disableHLSInterstitial:!1,disableDASHInterstitial:!1,allowPreloadOnDomElements:!0,allowStartInMiddleOfInterstitial:!0},ignoreHardwareResolution:!1,queue:{preloadNextUrlWindow:1/0,preloadPrevItem:!0,repeatMode:0}};return a.trackSelectionCallback=function(e){return R((function(t){return t.return(function(e,t,n){var i=n;"AUTO"==i&&(n=e.some((function(e){return!(!e.hdr||"HLG"!=e.hdr)})),i=ae().sd(n));var r=e.filter((function(e){return!("variant"!=e.type||e.hdr&&e.hdr!=i)}));n=[];var a=Ni(t,r.map((function(e){return e.language})));a&&(n=r.filter((function(e){return Pi(e.language)==a}))),0==n.length&&(n=r.filter((function(e){return e.primary}))),0==n.length&&(r.map((function(e){return e.language})),n=r);var o=n.filter((function(e){return e.height&&e.height<=480}));for(o.length&&(o.sort((function(e,t){return t.height-e.height})),n=o.filter((function(e){return e.height==o[0].height}))),t=[],n.length&&(r=Math.floor(n.length/2),n.sort((function(e,t){return e.bandwidth-t.bandwidth})),t.push(n[r])),e=p(e),n=e.next();!n.done;n=e.next())(n=n.value).type!=ut&&"image"!=n.type||t.push(n);return t}(e,o.preferredAudioLanguage,o.preferredVideoHdrLevel))}))},n.Wa(o)}function Zl(){return{streaming:{inaccurateManifestTolerance:0,segmentPrefetchLimit:2,updateIntervalSeconds:.1,maxDisabledTime:1,retryParameters:{baseDelay:100}},manifest:{dash:{autoCorrectDrift:!1},retryParameters:{baseDelay:100}},drm:{retryParameters:{baseDelay:100}}}}function ec(e,t,n){var i={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:[],audioRobustness:[],sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:"",headers:{}}};return Ol(e,t,n||Ql(),i,"")}function tc(e){return Ul([e],e)}function nc(e){return Ul([e],e)}function ic(){this.g=null,this.h=[]}function rc(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration);for(var i=(e=p(e.h)).next();!i.done;i=e.next())n+=(i=i.value).state==t?i.duration:0;return n}function ac(){this.i=this.h=null,this.g=[]}function oc(e,t,n){e.i!=t&&(e.i=t,e.g.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function sc(){this.C=this.X=NaN,this.l="",this.j=this.ni=this.u=this.B=this.K=this.F=this.o=this.m=this.J=this.G=this.i=this.T=this.V=this.N=this.O=this.R=NaN,this.M=0,this.H=this.I=NaN,this.g=new ic,this.h=new ac}function uc(e,t,n){e.X=t,e.C=n}function lc(e,t){e.j=isNaN(e.j)?t:e.j+t}function cc(e){for(var t=e.X,n=e.C,i=e.l,r=e.B,a=e.O,o=e.R,s=e.N,u=e.V,l=e.T,c=e.u,d=e.i,h=e.G,f=e.J,g=e.m,m=rc(e.g,"playing"),v=rc(e.g,"paused"),y=rc(e.g,"buffering"),b=e.o,w=e.F,_=e.K,S=e.ni,T=e.j,x=e.M,k=e.I,A=e.H,E=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],i=p(e.h),r=i.next();!r.done;r=i.next())n.push(t(r.value));return e.g&&n.push(t(e.g)),n}(e.g),I=[],C=(e=p(e.h.g)).next();!C.done;C=e.next())C=C.value,I.push({timestamp:C.timestamp,id:C.id,type:C.type,fromAdaptation:C.fromAdaptation,bandwidth:C.bandwidth});return{width:t,height:n,currentCodecs:i,streamBandwidth:r,decodedFrames:a,droppedFrames:o,corruptedFrames:s,stallsDetected:u,gapsJumped:l,estimatedBandwidth:c,completionPercent:d,loadLatency:h,manifestTimeSeconds:f,drmTimeSeconds:g,playTime:m,pauseTime:v,bufferingTime:y,licenseTime:b,liveLatency:w,maxSegmentDuration:_,manifestSizeBytes:S,bytesDownloaded:T,nonFatalErrorCount:x,manifestPeriodCount:k,manifestGapCount:A,stateHistory:E,switchHistory:I}}function dc(e,t,n,i){Or.call(this),this.N=e,this.V=t,this.Da=i.networkingEngine,this.m=n,this.C=null,this.ya=0,this.Sa=i.md,this.G=i.vk,this.Ta=i.wk,this.g=i.config,this.l=this.H=this.h=null,this.oa=!1,this.I=i.Hk,this.va=!1,this.i=null,this.aa=!1,this.u=null,this.M=new Map,this.xa=!1,this.Fa=i.Gk,this.X=new sc,this.ma=new Ar,this.B=new Ar,this.O=null,this.j=!1,this.$=i.ij,this.T=this.o=null,this.R=!1,this.K=[],this.J=[],this.F=!0}function hc(e,t,n){(e=t?e.J:e.K)?e.push(n):n()}function fc(e,t){if(e.O=t,e.R=!0,e.K)for(var n=(t=p(e.K)).next();!n.done;n=t.next())(n=n.value)();e.K=null}function pc(e){if(e.j)throw new Ue(2,7,7003)}function gc(e,t){e.dispatchEvent(new Dr("onstatechange",(new Map).set("state",t)))}function mc(e,t){var n,i,r;return R((function(a){switch(a.g){case 1:return!e.h||e.i?a.return():(gc(e,"drm-engine"),e.ya=Date.now()/1e3,e.i=e.Sa(),e.G.h=e.i,e.i.configure(e.g.drm,(function(){return e.F})),n=tr(e.h.variants),i=!0,e.h&&e.h.presentationTimeline&&(i=e.h.presentationTimeline.W()),w(a,ya(e.i,n,e.h.offlineSessionIds,i),2));case 2:if(pc(e),!t){a.A(3);break}return w(a,e.i.fc(t),4);case 4:pc(e);case 3:return w(a,Ga(e.G,e.h),5);case 5:if(!a.h){a.A(0);break}return r=new Dr("trackschanged",void 0),w(a,Promise.resolve(),7);case 7:e.dispatchEvent(r),_(a)}}))}function vc(e){if(!e.u){var t=e.g.abrFactory;e.u=t(),e.u.configure(e.g.abr)}return t=tr(e.h.variants),t=e.C.create(t),e.u.setVariants(Array.from(t.values())),e.u.chooseVariant(!0)}function yc(e,t,n){var i,r,a,o,s;return R((function(u){return 1==u.g?(i=e.g.streaming.segmentPrefetchLimit||2,r=new Gu(i,t,(function(t,n,i){return Tl(t,n,i||null,e.g.streaming.retryParameters,e.Da,e.F)}),!1),e.M.set(t.id,r),t.segmentIndex?u.A(2):w(u,t.createSegmentIndex(),2)):(a="number"==typeof e.m?e.m:0,o=t.segmentIndex.Vb(a),s=null,o&&((s=o.current())||(s=o.next().value)),s||(s=Pu(t.segmentIndex)),s?n?s.ba?w(u,Ku(r,s.ba),0):u.A(0):w(u,$u(r,s.startTime),0):u.A(0))}))}function bc(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}function wc(e,t){Or.call(this);var n=this;this.i=e,this.l=t,this.g=new Map,this.m=[{kd:null,jd:Tc,Uc:function(e,t){return _c(n,"enter",e,t)}},{kd:Sc,jd:Tc,Uc:function(e,t){return _c(n,"enter",e,t)}},{kd:xc,jd:Tc,Uc:function(e,t){return _c(n,"enter",e,t)}},{kd:Tc,jd:Sc,Uc:function(e,t){return _c(n,"exit",e,t)}},{kd:Tc,jd:xc,Uc:function(e,t){return _c(n,"exit",e,t)}},{kd:Sc,jd:xc,Uc:function(e,t){t?_c(n,"skip",e,t):(_c(n,"enter",e,t),_c(n,"exit",e,t))}},{kd:xc,jd:Sc,Uc:function(e,t){return _c(n,"skip",e,t)}}],this.h=new te,this.h.D(this.i,"regionremove",(function(e){n.g.delete(e.region)}))}function _c(e,t,n,i){t=new Dr(t,new Map([["region",n],["seeking",i]])),e.dispatchEvent(t)}gu.prototype.release=function(){this.h&&(this.h.release(),this.h=null),null!=this.i&&(this.i.release(),this.i=null),this.m=function(){},this.g=null},wu.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null},(i=Su.prototype).ready=function(){var e=this;fu(this.g,HTMLMediaElement.HAVE_FUTURE_DATA,this.j,(function(){!function(){if(null==e.h||0==e.h&&e.g.duration!=1/0)e.i=!0;else{var t=e.g.currentTime,n=null;if("number"==typeof e.h)n=e.h;else if(e.h instanceof Date){var i=Tu(e);null!==i&&(n=e.h.getTime()/1e3-i,n=xu(e,n))}null==n?e.i=!0:(n<0&&(n=Math.max(0,t+n)),t!=n?(e.j.Ba(e.g,"seeking",(function(){e.i=!0})),e.g.currentTime=n):e.i=!0)}}()}))},i.release=function(){this.j&&(this.j.release(),this.j=null),this.g=null},i.Wf=function(e){this.h=this.i?this.h:e},i.He=function(){var e=this.i?this.g.currentTime:this.h;return e instanceof Date&&(e=xu(this,e=e.getTime()/1e3-(Tu(this)||0))),e||0},i.Ih=function(){return 0},i.Gh=function(){return 0},i.Hh=function(){return!1},i.xi=function(){},i.ki=function(){var e=$o(this.g.buffered);return null!=e&&e>=this.g.duration-1},(i=ku.prototype).ready=function(){this.m.Ea(.25)},i.release=function(){this.j&&(this.j.release(),this.j=null),this.i&&(this.i.release(),this.i=null),this.m&&(this.m.stop(),this.m=null),this.h=this.j=this.g=this.l=null,this.u=function(){}},i.Wf=function(e){vu(this.j,Au(this,e))},i.He=function(){var e=mu(this.j);return this.h.readyState>0&&!this.h.paused?Cu(this,e):e},i.Ih=function(){return this.i.H},i.Gh=function(){return this.i.G},i.Hh=function(){return this.i.C},i.xi=function(){this.i.wf()},i.ki=function(){if(this.g.W()){var e=this.g.Hc(),t=$o(this.h.buffered);if(null!=t&&t>=e)return!0}return!1},(i=Mu.prototype).getNumReferences=function(){return this.g.length},i.getNumEvicted=function(){return this.i},i.release=function(){this.o||(this.g=[],this.m&&this.m.stop(),this.m=null)},i.yk=function(){this.o=!0},i.Fb=function(e){for(var t=p(this.g),n=t.next();!n.done;n=t.next())e(n.value)},i.find=function(e){for(var t=this.g.length-1,n=t;n>=0;--n){var i=this.g[n],r=n<t?this.g[n+1].startTime:i.endTime;if(e>=i.startTime&&e<r)return n+this.i}return this.g.length&&e<this.g[0].startTime?this.i:null},i.get=function(e){return 0==this.g.length||(e-=this.i)<0||e>=this.g.length?null:this.g[e]},i.offset=function(e){if(!this.o)for(var t=p(this.g),n=t.next();!n.done;n=t.next())n.value.offset(e)},i.nf=function(e){if(!this.o&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.g=this.g.filter((function(e){return Math.round(1e3*e.startTime)/1e3<t})),this.g.push.apply(this.g,g(e))}},i.fe=function(e,t){var n=this;e=e.filter((function(e){return e.endTime>t&&(0==n.g.length||e.endTime>n.g[0].startTime)})),this.nf(e),this.Ya(t)},i.Ya=function(e){if(!this.o){var t=this.g.length;this.g=this.g.filter((function(t){return t.endTime>e})),this.i+=t-this.g.length}},i.pd=function(e,t,n){if(n=void 0!==n&&n,!this.o){for(;this.g.length&&this.g[this.g.length-1].startTime>=t;)this.g.pop();for(;this.g.length&&this.g[0].endTime<=e;)this.g.shift(),n||this.i++;0!=this.g.length&&((t=new Fo((e=this.g[this.g.length-1]).startTime,t,e.C,e.startByte,e.endByte,e.ba,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.g,e.tilesLayout,e.B,e.h,e.status,e.aesKey)).mimeType=e.mimeType,t.codecs=e.codecs,t.i=e.i,this.g[this.g.length-1]=t)}},i.Nf=function(e,t){var n=this;this.o||(this.m&&this.m.stop(),this.m=new Si((function(){var e=t();e?n.g.push.apply(n.g,g(e)):(n.m.stop(),n.m=null)})),this.m.Ea(e))},Mu.prototype[Symbol.iterator]=function(){return this.Vb(0)},Mu.prototype.Vb=function(e,t,n){t=void 0!==t&&t,n=void 0!==n&&n;var i=this.find(e);if(null==i)return null;var r=this.get(i);n?i++:i--;var a=-1;if(r&&r.g.length>0)for(var o=r.g.length-1;o>=0;--o){var s=r.g[o];if(e>=s.startTime&&e<s.endTime){if(!t){for(;o&&!s.l;)o--,s=r.g[o];if(!s.l)return z("No independent partial segment found!"),null}n?i--:i++,a=o-1;break}}return new Du(this,i,a,n)},Mu.prototype.Te=function(){return-1},B("shaka.media.SegmentIndex",Mu),Mu.forSingleSegment=Ru,Mu.prototype.getIteratorForTime=Mu.prototype.Vb,Mu.prototype.updateEvery=Mu.prototype.Nf,Mu.prototype.fit=Mu.prototype.pd,Mu.prototype.evict=Mu.prototype.Ya,Mu.prototype.mergeAndEvict=Mu.prototype.fe,Mu.prototype.offset=Mu.prototype.offset,Mu.prototype.get=Mu.prototype.get,Mu.prototype.find=Mu.prototype.find,Mu.prototype.markImmutable=Mu.prototype.yk,Mu.prototype.release=Mu.prototype.release,Mu.prototype.getNumEvicted=Mu.prototype.getNumEvicted,Mu.prototype.getNumReferences=Mu.prototype.getNumReferences,(i=Du.prototype).Id=function(e){this.reverse=e},i.tj=function(){return this.h},i.current=function(){var e=this.i.get(this.h);return e&&e.g.length>0&&e.m&&this.g>=e.g.length&&(this.h++,this.g=0,e=this.i.get(this.h)),e&&e.g.length>0?e.g[this.g]:e},i.next=function(){var e=this.i.get(this.h);return this.reverse?e&&e.g.length>0?(this.g--,this.g<0&&(this.h--,this.g=(e=this.i.get(this.h))&&e.g.length>0?e.g.length-1:0)):(this.h--,this.g=0):e&&e.g.length>0?(this.g++,e.m&&this.g==e.g.length&&(this.h++,this.g=0)):(this.h++,this.g=0),{value:e=this.current(),done:!e}},i.eh=function(){var e=this.current();if(e&&e.Xc&&!e.l&&(e=this.i.get(this.h))&&e.g.length>0)for(var t=e.g[this.g];t.l&&!(this.g<=0);)this.g--,t=e.g[this.g]},B("shaka.media.SegmentIterator",Du),Du.prototype.resetToLastIndependent=Du.prototype.eh,Du.prototype.next=Du.prototype.next,Du.prototype.current=Du.prototype.current,Du.prototype.currentPosition=Du.prototype.tj,Du.prototype.setReverse=Du.prototype.Id,h(Lu,Mu),(i=Lu.prototype).clone=function(){var e=new Lu;return e.h=this.h.slice(),e.i=this.i,e},i.release=function(){this.h=[]},i.Fb=function(e){for(var t=p(this.h),n=t.next();!n.done;n=t.next())n.value.Fb(e)},i.find=function(e){for(var t=this.i,n=p(this.h),i=n.next();!i.done;i=n.next()){var r=(i=i.value).find(e);if(null!=r)return r+t;t+=i.getNumEvicted()+i.getNumReferences()}return null},i.get=function(e){for(var t=this.i,n=p(this.h),i=n.next();!i.done;i=n.next()){var r=(i=i.value).get(e-t);if(r)return r;r=i.getNumReferences(),t+=i.getNumEvicted()+r}return null},i.offset=function(){},i.nf=function(){},i.Ya=function(e){if(this.h.length){var t=this.h[0];t.Ya(e),0==t.getNumReferences()&&(this.h.shift(),this.i+=t.getNumEvicted(),t.release(),this.Ya(e))}},i.fe=function(){},i.pd=function(){},i.Nf=function(){},B("shaka.media.MetaSegmentIndex",Lu),Lu.prototype.updateEvery=Lu.prototype.Nf,Lu.prototype.fit=Lu.prototype.pd,Lu.prototype.mergeAndEvict=Lu.prototype.fe,Lu.prototype.evict=Lu.prototype.Ya,Lu.prototype.merge=Lu.prototype.nf,Lu.prototype.offset=Lu.prototype.offset,Lu.prototype.get=Lu.prototype.get,Lu.prototype.find=Lu.prototype.find,Lu.prototype.forEachTopLevelReference=Lu.prototype.Fb,Lu.prototype.release=Lu.prototype.release,Nu.prototype.release=function(){this.set(this.Tc()),this.h&&(this.h.stop(),this.h=null),this.g=null},Nu.prototype.set=function(e){this.i=e,Ou(this)},Nu.prototype.Tc=function(){return this.g.Tc()},ju.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.i.stop();for(var e=p(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()},h(Fu,Or),Fu.prototype.release=function(){this.g.clear(),Or.prototype.release.call(this)},Fu.prototype.j=function(e){for(var t=p(this.g.values()),n=t.next();!n.done;n=t.next()){var i=(n=n.value).lg;e:{for(var r=n.me,a=r.length-1;a>=0;a--){var o=r[a];if(o.position<=e){r=o.xd;break e}}r=null}a=r&&!(i===r||i&&r&&i.bandwidth==r.bandwidth&&i.audioSamplingRate==r.audioSamplingRate&&i.codecs==r.codecs&&i.contentType==r.contentType&&i.frameRate==r.frameRate&&i.height==r.height&&i.mimeType==r.mimeType&&i.channelsCount==r.channelsCount&&i.pixelAspectRatio==r.pixelAspectRatio&&i.width==r.width),o=r&&i&&r.label&&i.label&&i.label!==r.label;var s=r&&i&&r.language&&i.language&&i.language!==r.language;i=r&&i&&r.roles&&i.roles&&!Z(i.roles,r.roles),(o||s||i)&&Bu(this,e,r.contentType)&&(n.lg=r,i=new Dr("audiotrackchange",new Map([["quality",r],["position",e]])),this.dispatchEvent(i)),a&&Bu(this,e,r.contentType)&&(n.lg=r,JSON.stringify(r),n=new Dr("qualitychange",new Map([["quality",r],["position",e]])),this.dispatchEvent(n))}},h(Vu,Or),Vu.prototype.release=function(){this.h.clear(),this.g&&(this.g.stop(),this.g=null),Or.prototype.release.call(this)},Gu.prototype.Ya=function(e,t){t=void 0!==t&&t;for(var n=p(this.g.keys()),i=n.next();!i.done;i=n.next())e>(i=i.value).endTime&&Qu(this,i);t&&Yu(this)},Gu.prototype.Id=function(e){this.o=e,this.h&&this.h.Id(e)},Zu.prototype.abort=function(){this.je&&this.je.abort()},B("shaka.config.CrossBoundaryStrategy",{KEEP:"keep",RESET:"reset",RESET_TO_ENCRYPTED:"reset_to_encrypted",RESET_ON_ENCRYPTION_CHANGE:"RESET_ON_ENCRYPTION_CHANGE"}),(i=ol.prototype).destroy=function(){return this.l.destroy()},i.configure=function(e){if(this.i=e,this.X=new xr({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0),e.disableAudioPrefetch){var t=this.h.get("audio");t&&t.ha&&(Xu(t.ha),t.ha=null);for(var n=(t=p(this.m.keys())).next();!n.done;n=t.next())n=n.value,Xu(this.m.get(n)),this.m.delete(n)}for(e.disableTextPrefetch&&(t=this.h.get(ut))&&t.ha&&(Xu(t.ha),t.ha=null),e.disableVideoPrefetch&&(t=this.h.get("video"))&&t.ha&&(Xu(t.ha),t.ha=null),n=(t=p(this.h.keys())).next();!n.done;n=t.next())(n=this.h.get(n.value)).ha?(Ju(n.ha,e.segmentPrefetchLimit),e.segmentPrefetchLimit>0||(Xu(n.ha),n.ha=null)):e.segmentPrefetchLimit>0&&(n.ha=pl(this,n.stream));e.disableAudioPrefetch||function(e){for(var t=e.i.segmentPrefetchLimit,n=e.i.prefetchAudioLanguages,i=p(e.j.variants),r=i.next(),a={};!r.done;a={Mb:void 0},r=i.next())if(a.Mb=r.value,a.Mb.audio)if(e.m.has(a.Mb.audio)){if(Ju(r=e.m.get(a.Mb.audio),t),!(t>0&&n.some(function(e){return function(t){return Ii(e.Mb.audio.language,t)}}(a)))){var o=e.h.get(a.Mb.audio.type);r!==(o&&o.ha)&&Xu(r),e.m.delete(a.Mb.audio)}}else t<=0||!n.some(function(e){return function(t){return Ii(e.Mb.audio.language,t)}}(a))||!(r=pl(e,a.Mb.audio))||(a.Mb.audio.segmentIndex||a.Mb.audio.createSegmentIndex(),e.m.set(a.Mb.audio,r))}(this)},i.start=function(e){var t=this;return R((function(n){if(1==n.g)return w(n,function(e,t){var n,i,r,a,o,s,u;return R((function(l){if(1==l.g){if(!e.o)throw new Ue(2,5,5006);return n=Ll(e,!0),w(l,e.g.Z.init(n,e.j.sequenceMode,e.j.type,e.j.ignoreManifestTimestampsInSegmentsMode),2)}for(Jr(e.l),e.updateDuration(),i=p(n.keys()),r=i.next();!r.done;r=i.next())a=r.value,o=n.get(a),e.h.has(a)||(s=fl(e,o),t.has(o.id)&&(zu(u=t.get(o.id),(function(t,n,i){return Tl(t,n,i||null,e.i.retryParameters,e.g.tc)})),s.ha=u),e.h.set(a,s),kl(e,s,0));Rl(e),_(l)}))}(t,e||new Map),2);Jr(t.l),t.N=!0,_(n)}))},i.bd=function(){if(this.g){for(var e=this.g.lc(),t=p(this.h.keys()),n=t.next();!n.done;n=t.next()){var i,r=n.value;if(n=this.h.get(r),(i=!this.J)&&(i=this.g.Z,r==ut?i=null!=(i=i.h).g&&null!=i.h&&(e>=i.g&&e<i.h):i=Ko(i=Fs(i,r),e),i=!i),i){if(this.R=0,n.ha&&(n.ha.h=null),"audio"===n.type)for(var a=(i=p(this.m.values())).next();!a.done;a=i.next())a.value.h=null;n.ua=null,(null!=Us(this.g.Z,r)||n.Ja)&&hl(this,n),n.Va&&(n.Va.abort(),n.Va=null),r===ut&&((r=this.g.Z).J&&r.J.Nd()),n.bd=!0}!this.J||n.Ub||n.Ja||n.qb||kl(this,n,0)}Pl(this)&&Dl(this)}},i.updateDuration=function(){var e=yt(),t=this.j.presentationTimeline.getDuration();t<1/0?(e&&(this.u&&this.u.stop(),qs(this.g.Z)),this.g.Z.Ab(t)):e?(this.u&&this.u.Ea(.5),this.g.Z.Ab(1/0)):this.g.Z.Ab(4294967296)},B("shaka.util.ConfigUtils",Nl),Nl.getDifferenceFromConfigObjects=Fl,Nl.convertToConfigObject=jl,Nl.mergeConfigObjects=Ol,B("shaka.config.RepeatMode",{OFF:0,ALL:1,SINGLE:2}),B("shaka.drm.FairPlay",Bl),Bl.commonFairPlayResponse=function(e,t){if(2===e&&(e=t.originalRequest.drmInfo)&&wr(e.keySystem)){try{var n=He(t.data)}catch(e){return}if(e=!1,"<ckc>"===(n=n.trim()).substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6),e=!0),!e)try{var i=JSON.parse(n);i.ckc&&(n=i.ckc,e=!0),i.CkcMessage&&(n=i.CkcMessage,e=!0),i.License&&(n=i.License,e=!0)}catch(e){}e&&(t.data=De(Qe(n)))}},Bl.muxFairPlayRequest=function(e,t){Gl(e,t)},Bl.expressplayFairPlayRequest=function(e,t){if(2===e){var n=t.drmInfo;n&&wr(n.keySystem)&&Gl(e,t)}},Bl.conaxFairPlayRequest=function(e,t){Gl(e,t)},Bl.ezdrmFairPlayRequest=function(e,t){Gl(e,t)},Bl.verimatrixFairPlayRequest=function(e,t){2===e&&(e=t.drmInfo)&&wr(e.keySystem)&&(e=Je(e=Le(t.body)),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=Ge("spc="+e))},Bl.muxInitDataTransform=function(e,t,n){return ql(e,t,n)},Bl.expressplayInitDataTransform=function(e,t,n){return ql(e,t,n)},Bl.conaxInitDataTransform=function(t,n,i){if("skd"!==n)return t;n=i.serverCertificate,i=qe(t).split("skd://").pop().split("?").shift(),i=e.atob(i);var r=new ArrayBuffer(2*i.length);r=Ne(r);for(var a=0,o=i.length;a<o;a++)r[a]=i.charCodeAt(a);return Vl(t,r,n)},Bl.ezdrmInitDataTransform=function(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,Vl(e,n=qe(e).split(";").pop(),t))},Bl.verimatrixInitDataTransform=function(e,t,n){return ql(e,t,n)},Bl.initDataTransform=Vl,Bl.defaultGetContentId=Hl,Bl.isFairPlaySupported=function(){var e;return R((function(t){return 1==t.g?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},S(t,2),w(t,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):2!=t.g?t.return(!0):(k(t),t.return(!1))}))},zl.prototype.add=function(e,t){var n,i=this.h;if(t=void 0===t||t,!(n=!!i.audio!=!!e.audio||!!i.video!=!!e.video||i.language!=e.language)&&(n=i.audio&&e.audio)){n=i.audio;var r=e.audio;n=!(!((!n.channelsCount||!r.channelsCount||n.channelsCount>2||r.channelsCount>2)&&n.channelsCount!=r.channelsCount||n.spatialAudio!==r.spatialAudio||t&&!$l(n,r))&&Kl(n.roles,r.roles)&&n.groupId===r.groupId)}return!n&&(n=i.video&&e.video)&&(i=i.video,n=e.video,n=!((!t||$l(i,n))&&Kl(i.roles,n.roles))),!n&&(this.g.add(e),!0)},zl.prototype.values=function(){return this.g.values()},B("shaka.media.AdaptationSet",zl),Wl.prototype.configure=function(e){this.g=e},Wl.prototype.getConfiguration=function(){return this.g},Wl.prototype.create=function(e){var t;if(this.g.language){var n=function(e,t){t=Pi(t);var n=Ni(t,e.map((function(e){return Li(e)})));return n?e.filter((function(e){return n==Li(e)})):[]}(e,this.g.language);n.length&&(t=n)}t||(t=(t=e.filter((function(e){return e.primary}))).length?t:e),e=function(e,t){return e.filter((function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)}))}(t,this.g.role),e.length&&(t=e),e=function(e,t){return e.filter((function(e){return!!e.video&&(t?e.video.roles.includes(t):0==e.video.roles.length)}))}(t,this.g.videoRole),e.length&&(t=e),this.g.videoLayout&&(e=function(e,t){return e.filter((function(e){return!e.video||!e.video.videoLayout||e.video.videoLayout==t}))}(t,this.g.videoLayout),e.length&&(t=e)),this.g.hdrLevel&&(e=function(e,t){if("AUTO"==t){var n=e.some((function(e){return!(!e.video||!e.video.hdr||"HLG"!=e.video.hdr)}));t=ae().sd(n)}return e.filter((function(e){return!e.video||!e.video.hdr||e.video.hdr==t}))}(t,this.g.hdrLevel),e.length&&(t=e));var i=[this.g.channelCount,this.g.preferredAudioChannelCount];if((e=i.filter((function(e,t){return e&&i.indexOf(e)===t}))).length)for(n=(e=p(e)).next();!n.done;n=e.next())if((n=Xl(t,n.value)).length){t=n;break}this.g.audioLabel&&(e=function(e,t){return e.filter((function(e){return!(!e.audio||!e.audio.label)&&e.audio.label.toLowerCase()==t.toLowerCase()}))}(t,this.g.audioLabel),e.length&&(t=e)),this.g.videoLabel&&(e=function(e,t){return e.filter((function(e){return!(!e.video||!e.video.label)&&e.video.label.toLowerCase()==t.toLowerCase()}))}(t,this.g.videoLabel),e.length&&(t=e)),e=function(e,t){return e.filter((function(e){return!e.audio||e.audio.spatialAudio==t}))}(t,this.g.spatialAudio),e.length&&(t=e);var r=[this.g.audioCodec,this.g.activeAudioCodec].concat(g(this.g.preferredAudioCodecs));if((e=r.filter((function(e,t){return e&&r.indexOf(e)===t}))).length)for(n=(e=p(e)).next();!n.done;n=e.next())if((n=Yl(t,n.value)).length){t=n;break}return this.h=new zl(t[0],t,!("smooth"==this.g.codecSwitchingStrategy&&vt()))},Wl.prototype.getLastAdaptationSet=function(){return this.h},B("shaka.util.PlayerConfiguration",Jl),Jl.mergeConfigObjects=ec,Jl.createDefaultForLL=Zl,Jl.createDefault=Ql,h(dc,Or),(i=dc.prototype).getStartTime=function(){return this.m},i.rd=function(){return this.N},i.Hg=function(){return this.h},i.getStats=function(){return this.X},i.Rj=function(){return this.o?Wi(this.o):null},i.Qj=function(){return this.T?Xi(this.T):null},i.start=function(){var t,n=this;R((function(i){switch(i.g){case 1:return w(i,Promise.resolve(),2);case 2:return S(i,3),w(i,function(e){var t,n,i,r,a;return R((function(o){switch(o.g){case 1:if(gc(e,"manifest-parser"),e.l||(e.H=Qa(e.N,e.V),e.l=e.H(),e.l.configure(e.g.manifest,(function(){return e.F}))),t=Date.now()/1e3,gc(e,"manifest"),e.h){o.A(2);break}return w(o,e.l.start(e.N,e.Ta),3);case 3:return e.h=o.h,bc(e.h),w(o,function(e){var t,n,i,r,a;return R((function(o){if(e.C||(e.C=e.g.adaptationSetCriteriaFactory(),e.C.configure({language:e.g.preferredAudioLanguage,role:e.g.preferredAudioRole,videoRole:e.g.preferredVideoRole,channelCount:e.g.preferredAudioChannelCount,hdrLevel:e.g.preferredVideoHdrLevel,spatialAudio:e.g.preferSpatialAudio,videoLayout:e.g.preferredVideoLayout,audioLabel:e.g.preferredAudioLabel,videoLabel:e.g.preferredVideoLabel,codecSwitchingStrategy:e.g.mediaSource.codecSwitchingStrategy,audioCodec:"",activeAudioCodec:"",activeAudioChannelCount:0,preferredAudioCodecs:e.g.preferredAudioCodecs,preferredAudioChannelCount:e.g.preferredAudioChannelCount})),1!=e.h.variants.length&&"HLS"!=e.h.type)return o.A(0);if(!(t=vc(e)))return o.A(0);for(n=[],i=p([t.video,t.audio]),r=i.next();!r.done;r=i.next())(a=r.value)&&!a.segmentIndex&&n.push(a.createSegmentIndex());return n.length>0?w(o,Promise.all(n),0):o.A(0)}))}(e),2);case 2:return e.ma.resolve(),n=new Dr("manifestparsed",void 0),w(o,Promise.resolve(),5);case 5:if(e.dispatchEvent(n),0==e.h.variants.length)throw new Ue(2,4,4036);if(bc(e.h),!za(e.G,e.h)){o.A(6);break}return i=new Dr("trackschanged",void 0),w(o,Promise.resolve(),7);case 7:pc(e),e.dispatchEvent(i);case 6:r=Date.now()/1e3,a=r-t,e.X.J=a,_(o)}}))}(n),5);case 5:if(pc(n),"webkit"===e.shakaMediaKeysPolyfill){i.A(6);break}return w(i,mc(n),7);case 7:pc(n);case 6:if(!n.$){i.A(8);break}return w(i,function(e){var t,n,i,r,a;return R((function(o){return!e.o&&(t=vc(e))&&(e.o=t),e.o?(n=e.h.presentationTimeline.W(),i=[],(r=e.o).video&&i.push(yc(e,r.video,n)),r.audio&&i.push(yc(e,r.audio,n)),(a=nr(e.h.textStreams,e.g.preferredTextLanguage,e.g.preferredTextRole,e.g.preferForcedSubs)[0]||null)&&sr(r.audio,a,e.g)&&(i.push(yc(e,a,n)),e.T=a),w(o,Promise.all(i),0)):o.A(0)}))}(n),9);case 9:pc(n);case 8:if(!n.$||!n.i){i.A(10);break}return w(i,function(e){return R((function(t){return 1==t.g?e.K?w(t,e.m,3):t.A(0):w(t,Promise.all(e.X.map((function(e){return e.promise}))),0)}))}(n.i),11);case 11:pc(n);case 10:n.B.resolve(),x(i,0);break;case 3:(t=k(i))instanceof Ue&&(7001==t.code||7003==t.code)||n.B.reject(t),_(i)}}))},i.dispatchEvent=function(e){return this.O?this.O.dispatchEvent(e):Or.prototype.dispatchEvent.call(this,e)},i.onError=function(e){2===e.severity&&(this.B.reject(e),this.destroy());var t=(new Map).set("detail",e);t=new Dr("error",t),this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)},i.configure=function(e,t){e=jl(e,t),ec(this.g,e)},i.getConfiguration=function(){return Ft(this.g)},i.ll=function(){return this.B},i.destroy=function(){var e,t,n=this;return R((function(i){if(1==i.g)return n.j=!0,!n.l||n.oa?i.A(2):w(i,n.l.stop(),2);if(4!=i.g)return n.u&&n.u.release(),n.I&&!n.va&&n.I.release(),!n.i||n.aa?i.A(4):w(i,n.i.destroy(),4);if(n.M.size>0&&!n.xa)for(e=p(n.M.values()),t=e.next();!t.done;t=e.next())Xu(t.value);_(i)}))},B("shaka.media.PreloadManager",dc),dc.prototype.destroy=dc.prototype.destroy,dc.prototype.waitForFinish=dc.prototype.ll,dc.prototype.getPrefetchedTextTrack=dc.prototype.Qj,dc.prototype.getPrefetchedVariantTrack=dc.prototype.Rj,h(wc,Or),wc.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,Or.prototype.release.call(this)},wc.prototype.j=function(e,t){if(!this.l||0!=e){this.l=!1;for(var n=p(this.i.h.values()),i=n.next();!i.done;i=n.next()){i=i.value;var r=this.g.get(i),a=e<i.startTime?Sc:e>i.endTime?xc:Tc;this.g.set(i,a);for(var o=p(this.m),s=o.next();!s.done;s=o.next())(s=s.value).kd==r&&s.jd==a&&s.Uc(i,t)}}};var Sc=1,Tc=2,xc=3;function kc(e,t,n){var i,r,a,o,s,u,l;return R((function(c){switch(c.g){case 1:return i=Ac(e),(r=Ec.get(i))?c.return(r):(a=0,o=Vr([e],n),S(c,2),o.method="HEAD",w(c,t.request(a,o).promise,4));case 4:s=c.h,r=s.headers["content-type"],x(c,3);break;case 2:if(!(u=k(c))||1002!=u.code&&1001!=u.code){c.A(3);break}return o.method="GET",w(c,t.request(a,o).promise,6);case 6:l=c.h,r=l.headers["content-type"];case 3:return c.return(r?r.toLowerCase().split(";").shift():"")}}))}function Ac(e){return 1==(e=new ge(e).Sb.split("/").pop().split(".")).length?"":e.pop().toLowerCase()}for(var Ec=(new Map).set("mp4","video/mp4").set("m4v","video/mp4").set("m4a","audio/mp4").set("webm","video/webm").set("weba","audio/webm").set("mkv","video/webm").set("ts","video/mp2t").set("ogv","video/ogg").set("ogg","audio/ogg").set("mpg","video/mpeg").set("mpeg","video/mpeg").set("mov","video/quicktime").set("m3u8","application/x-mpegurl").set("mpd","application/dash+xml").set("ism","application/vnd.ms-sstr+xml").set("mp3","audio/mpeg").set("aac","audio/aac").set("flac","audio/flac").set("wav","audio/wav").set("sbv","text/x-subviewer").set("srt","text/srt").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml").set("lrc","application/x-subtitle-lrc").set("ssa","text/x-ssa").set("ass","text/x-ssa").set("jpeg","image/jpeg").set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif").set("html","text/html").set("htm","text/html"),Ic={ach:"Lwo",ady:"Адыгэбзэ",af:"Afrikaans","af-NA":"Afrikaans (Namibia)","af-ZA":"Afrikaans (South Africa)",ak:"Tɕɥi",ar:"العربية","ar-AR":"العربية","ar-MA":"العربية","ar-SA":"العربية (السعودية)","ay-BO":"Aymar aru",az:"Azərbaycan dili","az-AZ":"Azərbaycan dili","be-BY":"Беларуская",bg:"Български","bg-BG":"Български",bn:"বাংলা","bn-IN":"বাংলা (ভারত)","bn-BD":"বাংলা(বাংলাদেশ)","bs-BA":"Bosanski",ca:"Català","ca-ES":"Català",cak:"Maya Kaqchikel","ck-US":"ᏣᎳᎩ (tsalagi)",cs:"Čeština","cs-CZ":"Čeština",cy:"Cymraeg","cy-GB":"Cymraeg",da:"Dansk","da-DK":"Dansk",de:"Deutsch","de-AT":"Deutsch (Österreich)","de-DE":"Deutsch (Deutschland)","de-CH":"Deutsch (Schweiz)",dsb:"Dolnoserbšćina",el:"Ελληνικά","el-GR":"Ελληνικά",en:"English","en-GB":"English (UK)","en-AU":"English (Australia)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-IN":"English (India)","en-PI":"English (Pirate)","en-UD":"English (Upside Down)","en-US":"English (US)","en-ZA":"English (South Africa)","en@pirate":"English (Pirate)",eo:"Esperanto","eo-EO":"Esperanto",es:"Español","es-AR":"Español (Argentine)","es-419":"Español (Latinoamérica)","es-CL":"Español (Chile)","es-CO":"Español (Colombia)","es-EC":"Español (Ecuador)","es-ES":"Español (España)","es-LA":"Español (Latinoamérica)","es-NI":"Español (Nicaragua)","es-MX":"Español (México)","es-US":"Español (Estados Unidos)","es-VE":"Español (Venezuela)",et:"eesti keel","et-EE":"Eesti (Estonia)",eu:"Euskara","eu-ES":"Euskara",fa:"فارسی","fa-IR":"فارسی","fb-LT":"Leet Speak",ff:"Fulah",fi:"Suomi","fi-FI":"Suomi","fo-FO":"Føroyskt",fr:"Français","fr-CA":"Français (Canada)","fr-FR":"Français (France)","fr-BE":"Français (Belgique)","fr-CH":"Français (Suisse)","fy-NL":"Frysk",ga:"Gaeilge","ga-IE":"Gaeilge (Gaelic)",gl:"Galego","gl-ES":"Galego","gn-PY":"Avañe'ẽ","gu-IN":"ગુજરાતી","gx-GR":"Ἑλληνική ἀρχαία",he:"עברית‏","he-IL":"עברית‏",hi:"हिन्दी","hi-IN":"हिन्दी",hr:"Hrvatski","hr-HR":"Hrvatski",hsb:"Hornjoserbšćina",ht:"Kreyòl",hu:"Magyar","hu-HU":"Magyar","hy-AM":"Հայերեն",id:"Bahasa Indonesia","id-ID":"Bahasa Indonesia",is:"Íslenska","is-IS":"Íslenska (Iceland)",it:"Italiano","it-IT":"Italiano",ja:"日本語","ja-JP":"日本語","jv-ID":"Basa Jawa","ka-GE":"ქართული","kk-KZ":"Қазақша",km:"ភាសាខ្មែរ","km-KH":"ភាសាខ្មែរ",kab:"Taqbaylit",kn:"ಕನ್ನಡ","kn-IN":"ಕನ್ನಡ (India)",ko:"한국어","ko-KR":"한국어 (韩国)",ku:"Kurdî","ku-TR":"Kurdî",la:"Latin","la-VA":"Latin",lb:"Lëtzebuergesch","li-NL":"Lèmbörgs",lt:"Lietuvių","lt-LT":"Lietuvių",lv:"Latviešu","lv-LV":"Latviešu",mai:"मैथिली, মৈথিলী","mg-MG":"Malagasy",mk:"Македонски","mk-MK":"Македонски (Македонски)",ml:"മലയാളം","ml-IN":"മലയാളം","mn-MN":"Монгол",mr:"मराठी","mr-IN":"मराठी",ms:"Bahasa Melayu","ms-MY":"Bahasa Melayu",mt:"Malti","mt-MT":"Malti",my:"ဗမာစကာ",nb:"Norsk (bokmål)","nb-NO":"Norsk (bokmål)",ne:"नेपाली","ne-NP":"नेपाली",nl:"Nederlands","nl-BE":"Nederlands (België)","nl-NL":"Nederlands (Nederland)","nn-NO":"Norsk (nynorsk)",no:"Norsk",oc:"Occitan","or-IN":"ଓଡ଼ିଆ",pa:"ਪੰਜਾਬੀ","pa-IN":"ਪੰਜਾਬੀ (ਭਾਰਤ ਨੂੰ)",pl:"Polski","pl-PL":"Polski","ps-AF":"پښتو",pt:"Português","pt-BR":"Português (Brasil)","pt-PT":"Português (Portugal)","qu-PE":"Qhichwa","rm-CH":"Rumantsch",ro:"Română","ro-RO":"Română",ru:"Русский","ru-RU":"Русский","sa-IN":"संस्कृतम्","se-NO":"Davvisámegiella","si-LK":"පළාත",sk:"Slovenčina","sk-SK":"Slovenčina (Slovakia)",sl:"Slovenščina","sl-SI":"Slovenščina","so-SO":"Soomaaliga",sq:"Shqip","sq-AL":"Shqip",sr:"Српски","sr-RS":"Српски (Serbia)",su:"Basa Sunda",sv:"Svenska","sv-SE":"Svenska",sw:"Kiswahili","sw-KE":"Kiswahili",ta:"தமிழ்","ta-IN":"தமிழ்",te:"తెలుగు","te-IN":"తెలుగు",tg:"забо́ни тоҷикӣ́","tg-TJ":"тоҷикӣ",th:"ภาษาไทย","th-TH":"ภาษาไทย (ประเทศไทย)",tl:"Filipino","tl-PH":"Filipino",tlh:"tlhIngan-Hol",tr:"Türkçe","tr-TR":"Türkçe","tt-RU":"татарча",uk:"Українська","uk-UA":"Українська",ur:"اردو","ur-PK":"اردو",uz:"O'zbek","uz-UZ":"O'zbek",vi:"Tiếng Việt","vi-VN":"Tiếng Việt","xh-ZA":"isiXhosa",yi:"ייִדיש","yi-DE":"ייִדיש (German)",zh:"中文","zh-HANS":"中文简体","zh-HANT":"中文繁體","zh-CN":"中文（中国）","zh-HK":"中文（香港）","zh-SG":"中文（新加坡）","zh-TW":"中文（台灣）","zu-ZA":"isiZulu"},Cc=p(Object.keys(Ic)),Mc=Cc.next();!Mc.done;Mc=Cc.next()){var Pc=Mc.value;Ic[Pc.toLowerCase()]=Ic[Pc]}function Rc(e,t){if(e.lineBreak)return"\n";if(e.nestedCues.length)return e.nestedCues.map((function(t){return Rc(t,e)})).join("");if(!e.payload)return e.payload;var n=[],i=e.fontWeight>=Hn,r=e.fontStyle==qn,a=e.textDecoration.includes(zn);return i&&n.push(["b"]),r&&n.push(["i"]),a&&n.push(["u"]),""==(r=e.color)&&t&&(r=t.color),i="",(r=Dc(r))&&(i+="."+r),""==(r=e.backgroundColor)&&t&&(r=t.backgroundColor),(t=Dc(r))&&(i+=".bg_"+t),i&&n.push(["c",i]),n.reduceRight((function(e,t){var n=p(t);return"<"+(t=n.next().value)+(void 0===(n=n.next().value)?"":n)+">"+e+"</"+t+">"}),e.payload)}function Dc(e){var t=(e=e.toLowerCase()).replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(256|parseInt(t[1],10)).toString(16).slice(1)+(256|parseInt(t[2],10)).toString(16).slice(1)+(256|parseInt(t[3],10)).toString(16).slice(1):e.startsWith("#")&&e.length>7&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null}function Lc(e,t){for(var n=[],i=(e=p(Nc(e))).next();!i.done;i=e.next())if((i=i.value).isContainer)n.push.apply(n,g(Lc(i.nestedCues,i)));else{var r=i.clone();r.nestedCues=[],r.payload=Rc(i,t),n.push(r)}return n}function Nc(e){for(var t=[],n=(e=p(e)).next(),i={};!n.done;i={ig:void 0},n=e.next())i.ig=n.value,t.some(function(e){return function(t){return Tn(e.ig,t)}}(i))||t.push(i.ig);return t}function Oc(e){function t(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()}if(e.startTime>=e.endTime)return null;var n=new VTTCue(e.startTime,e.endTime,e.payload);n.id=t(e.startTime.toString())+t(e.endTime.toString())+t(e.payload),n.lineAlign=e.lineAlign,n.positionAlign=e.positionAlign,e.size&&(n.size=e.size);try{n.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=n.align&&(n.align="middle"),"vertical-lr"==e.writingMode?n.vertical="lr":"vertical-rl"==e.writingMode&&(n.vertical="rl"),1==e.lineInterpretation&&(n.snapToLines=!1),null!=e.line&&(n.line=e.line),null!=e.position&&(n.position=e.position),n}function jc(e,t){var n=Lc(t),i=[];t=e.cues?Array.from(e.cues):[];for(var r=(n=p(n)).next(),a={};!r.done;a={vd:void 0},r=n.next())a.vd=r.value,!t.some(function(e){return function(t){return t.startTime==e.vd.startTime&&t.endTime==e.vd.endTime&&t.text==e.vd.payload}}(a))&&a.vd.payload&&(r=Oc(a.vd))&&i.push(r);for(n=(t=p(t=i.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?i.indexOf(t)-i.indexOf(e):i.indexOf(e)-i.indexOf(t)})))).next();!n.done;n=t.next())e.addCue(n.value)}function Uc(e,t){var n=!1;"disabled"===e.mode&&(n=!0,e.mode="hidden");for(var i=0;i<e.cues.length;){var r=e.cues[i];t(r)?e.removeCue(r):i++}n&&(e.mode="disabled")}function Fc(e){var t=this;this.i=e,this.l=new te,this.j=null,this.h=new Map,this.g=-1,this.u=!1,this.o=null,this.C=function(){t.l.Ma(t.i,"textchanged",t.m),t.l.Ma(t.j.textTracks,"change",t.B);for(var e=p(t.h.values()),n=e.next();!n.done;n=e.next())n.value.remove();t.h.clear(),t.g=-1,t.j=null},this.m=function(){for(var e=new Map,n=t.i.Kc(),i=(n=p(n)).next();!i.done;i=n.next()){if(i=i.value,t.h.has(i.id)){var r=t.h.get(i.id);i.active||"disabled"===r.track.mode||(r.track.mode="disabled"),t.h.delete(i.id)}else{(r=t.j.ownerDocument.createElement("track")).kind=Bc(i);var a=r,o=void 0;if(i.label)o=i.label;else if(i.language)if(i.language in Ic)o=Ic[i.language];else{var s=Di(i.language);s in Ic&&(o=Ic[s]+" ("+i.language+")")}o||(o=i.originalTextId,i.language&&i.language!==i.originalTextId&&(o+=" ("+i.language+")")),a.label=o,i.language in Ic&&(r.srclang=i.language),r.src="data:,WEBVTT",r.track.mode="disabled",t.j.appendChild(r)}e.set(i.id,r),i.active&&(t.g=i.id)}for(i=(n=p(t.h.values())).next();!i.done;i=n.next())i.value.remove();t.g>-1&&(e.has(t.g)?"disabled"===(n=e.get(t.g).track).mode&&(n.mode=t.u?"showing":"hidden"):t.g=-1),t.h=e},this.B=function(){if(!t.o){var e=t.j;t.o=new Si((function(){if(t.o=null,t.j===e){var n=-1,i=!1;if(t.h.has(t.g)){var r=t.h.get(t.g);"showing"===r.track.mode?(n=t.g,i=!0):"hidden"===r.track.mode&&(n=t.g)}if(!i)for(r=(i=p(t.h)).next();!r.done;r=i.next()){var a=p(r.value);if(r=a.next().value,"showing"===(a=a.next().value).track.mode){n=r;break}n<0&&"hidden"===a.track.mode&&(n=r)}for(r=(i=p(t.h)).next();!r.done;r=i.next())r=(a=p(r.value)).next().value,a=a.next().value,r!==n&&"disabled"!==a.track.mode&&(a.track.mode="disabled");t.g!==n&&(t.g=n,n>-1&&t.i.kh({id:n})),t.i.qh(n>-1&&"showing"===t.h.get(n).track.mode)}})).ia(0)}},this.l.D(e,"loaded",(function(){return t.enableTextDisplayer()})),this.enableTextDisplayer()}function Bc(e){var t=ae();return e.forced&&"WEBKIT"===t.Ha()?"forced":"caption"===e.kind||e.roles&&e.roles.some((function(e){return e.includes("transcribes-spoken-dialog")}))&&e.roles.some((function(e){return e.includes("describes-music-and-sound")}))?"captions":"subtitles"}function Hc(e,t){for(ce("SimpleTextDisplayer","Please migrate to NativeTextDisplayer"),this.h=e,this.i=t,this.g=null,t=(e=p(Array.from(this.h.textTracks))).next();!t.done;t=e.next())"metadata"!==(t=t.value).kind&&"chapters"!==t.kind&&(t.mode="disabled",t.label==this.i&&(this.g=t));this.g&&(this.g.mode="hidden")}function Vc(e){e.h&&!e.g&&(e.g=e.h.addTextTrack("subtitles",e.i),e.g.mode="hidden")}function qc(){}function Gc(t,n){var i=this;this.m=!1,this.h=[],this.j=t,this.o=n,this.C=this.u=null,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.B=new Si((function(){i.j.paused||Wc(i)})),zc(this),this.l=new Map,this.i=new te,this.i.D(document,"fullscreenchange",(function(){Wc(i,!0)})),this.i.D(this.j,"seeking",(function(){Wc(i,!0)})),this.i.D(this.j,"ratechange",(function(){zc(i)})),this.i.D(this.j,"resize",(function(){var e=i.j,t=e.videoWidth;e=e.videoHeight,i.u=t&&e?t/e:null})),this.F=null,"ResizeObserver"in e&&(this.F=new ResizeObserver((function(){Wc(i,!0)})),this.F.observe(this.g)),this.G=new Map}function zc(e){e.B&&(e.h.length?e.B.Ea((e.C?e.C.captionsUpdatePeriod:.25)/Math.max(1,Math.abs(e.j.playbackRate))):e.B.stop())}function $c(e,t){for(;null!=t;){if(t==e.g)return!0;t=t.parentElement}return!1}function Kc(e,t,n,i,r){for(var a=!1,o=[],s=[],u=(t=p(t)).next();!u.done;u=t.next()){u=u.value,r.push(u);var l=e.l.get(u),c=u.startTime<=i&&u.endTime>i,d=l?l.gj:null;l&&(o.push(l.kg),l.$c&&o.push(l.$c),c||(a=!0,e.l.delete(u),l=null)),c&&(s.push(u),l?$c(e,d)||(a=!0):(Xc(e,u,r),d=(l=e.l.get(u)).gj,a=!0)),u.nestedCues.length>0&&d&&Kc(e,u.nestedCues,d,i,r),r.pop()}if(a){for(r=(i=p(o)).next();!r.done;r=i.next())(r=r.value).parentElement&&r.parentElement.removeChild(r);for(s.sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime})),i=(s=p(s)).next();!i.done;i=s.next())(i=e.l.get(i.value)).$c?(i.$c.contains(n)&&i.$c.removeChild(n),n.appendChild(i.$c),i.$c.appendChild(i.kg)):n.appendChild(i.kg)}}function Wc(e,t){if(e.g){var n=e.j.currentTime;if(!e.m||void 0!==t&&t){for(var i=(t=p(e.G.values())).next();!i.done;i=t.next())Zo(i.value);Zo(e.g),e.l.clear(),e.G.clear()}e.m&&Kc(e,e.h,e.g,n,[])}}function Xc(e,t,n){var i=n.length>1,r=i?"span":"div";t.lineBreak&&(r="br"),t.rubyTag&&(r=t.rubyTag),i=!i&&t.nestedCues.length>0;var a=document.createElement(r);if("br"!=r&&function(e,t,n,i,r){var a=t.style,o=0==n.nestedCues.length,s=i.length>1;a.whiteSpace="pre-wrap";var u=n.payload.replace(/\s+$/g,(function(e){return" ".repeat(e.length)}));if(a.webkitTextStrokeColor=n.textStrokeColor,a.webkitTextStrokeWidth=n.textStrokeWidth,a.color=n.color,a.direction=n.direction,a.opacity=n.opacity,a.paddingLeft=Yc(n.linePadding,n,e.o),a.paddingRight=Yc(n.linePadding,n,e.o),a.textCombineUpright=n.textCombineUpright,a.textShadow=n.textShadow,n.backgroundImage)a.backgroundImage="url('"+n.backgroundImage+"')",a.backgroundRepeat="no-repeat",a.backgroundSize="contain",a.backgroundPosition="center",n.backgroundColor&&(a.backgroundColor=n.backgroundColor),a.width="100%",a.height="100%";else{if(n.nestedCues.length)var l=t;else l=document.createElement("span"),t.appendChild(l);n.border&&(l.style.border=n.border),r||((t=function(e,t){for(var n=e.length-1;n>=0;n--){var i=t(e[n]);if(i||0===i)return i}return null}(i,(function(e){return e.backgroundColor})))?l.style.backgroundColor=t:u&&(l.style.backgroundColor="rgba(0, 0, 0, 0.8)")),u&&(l.setAttribute("translate","no"),l.textContent=u)}s&&!i[i.length-1].isContainer?a.display="inline":(a.display="flex",a.flexDirection="column",a.alignItems="center","left"==n.textAlign||"start"==n.textAlign?(a.width="100%",a.alignItems="start"):"right"!=n.textAlign&&"end"!=n.textAlign||(a.width="100%",a.alignItems="end"),a.justifyContent="before"==n.displayAlign?"flex-start":"center"==n.displayAlign?"center":"flex-end");o||(a.margin="0"),a.fontFamily=n.fontFamily,a.fontWeight=n.fontWeight.toString(),a.fontStyle=n.fontStyle,a.letterSpacing=n.letterSpacing,i=e.C?e.C.fontScaleFactor:1,(1!==i||n.fontSize)&&(a.fontSize=Yc(n.fontSize||"1em",n,e.o,i));i=n.line,null!=i&&(o=n.lineInterpretation,o==Nn&&(o=1,s=16,e.u&&e.u<1&&(s=32),i=i<0?100+i/s*100:i/s*100),1==o&&(a.position="absolute",n.writingMode==Ln?(a.width="100%",n.lineAlign==On?a.top=i+"%":"end"==n.lineAlign&&(a.bottom=100-i+"%")):"vertical-lr"==n.writingMode?(a.height="100%",n.lineAlign==On?a.left=i+"%":"end"==n.lineAlign&&(a.right=100-i+"%")):(a.height="100%",n.lineAlign==On?a.right=i+"%":"end"==n.lineAlign&&(a.left=100-i+"%")))),a.lineHeight=n.lineHeight,e=function(e){var t=e.direction,n=e.positionAlign;return e=e.textAlign,n!==In?n:"left"===e||"start"===e&&t===Dn||"end"===e&&"rtl"===t?"line-left":"right"===e||"start"===e&&"rtl"===t||"end"===e&&t===Dn?"line-right":"center"}(n),"line-left"==e?(a.cssFloat="left",null!==n.position&&(a.position="absolute",n.writingMode==Ln?(a.left=n.position+"%",a.width="auto"):a.top=n.position+"%")):"line-right"==e?(a.cssFloat="right",null!==n.position&&(a.position="absolute",n.writingMode==Ln?(a.right=100-n.position+"%",a.width="auto"):a.bottom=n.position+"%")):null!==n.position&&50!=n.position&&(a.position="absolute",n.writingMode==Ln?(a.left=n.position+"%",a.width="auto"):a.top=n.position+"%",n.size&&(a.transform="translateX(-50%)")),a.textAlign=n.textAlign,a.textDecoration=n.textDecoration.join(" "),a.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&a.writingMode==n.writingMode||(a.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==Ln?a.width=n.size+"%":a.height=n.size+"%")}(e,a,t,n,i),n=null,t.region&&t.region.id){var o=t.region,s=e.u===4/3?2.5:1.9;if(n=o.id+"_"+o.width+"x"+o.height+(o.heightUnits==Ct?"%":"px")+"-"+o.viewportAnchorX+"x"+o.viewportAnchorY+(o.viewportAnchorUnits==Ct?"%":"px"),e.G.has(n))n=e.G.get(n);else{r=document.createElement("span");var u=o.heightUnits==Ct?"%":"px",l=o.widthUnits==Ct?"%":"px",c=o.viewportAnchorUnits==Ct?"%":"px";r.id="shaka-text-region---"+n,r.classList.add("shaka-text-region"),r.style.position="absolute";var d=o.height,h=o.width;2===o.heightUnits&&(d=5.33*o.height,u="%"),2===o.widthUnits&&(h=o.width*s,l="%"),r.style.height=d+u,r.style.width=h+l,2===o.viewportAnchorUnits?(s=o.viewportAnchorY/75*100,u=o.viewportAnchorX/(e.u===4/3?160:210)*100,s-=o.regionAnchorY*d/100,u-=o.regionAnchorX*h/100,r.style.top=s+"%",r.style.left=u+"%"):(r.style.top=o.viewportAnchorY-o.regionAnchorY*d/100+c,r.style.left=o.viewportAnchorX-o.regionAnchorX*h/100+c),0!==o.heightUnits&&0!==o.widthUnits&&0!==o.viewportAnchorUnits&&(o=Math.max(0,Math.min(100-(parseInt(r.style.width.slice(0,-1),10)||0),parseInt(r.style.left.slice(0,-1),10)||0)),r.style.top=Math.max(0,Math.min(100-(parseInt(r.style.height.slice(0,-1),10)||0),parseInt(r.style.top.slice(0,-1),10)||0))+"%",r.style.left=o+"%"),r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="center",r.style.justifyContent="before"==t.displayAlign?"flex-start":"center"==t.displayAlign?"center":"flex-end",e.G.set(n,r),n=r}}r=a,i&&((r=document.createElement("span")).classList.add("shaka-text-wrapper"),r.style.backgroundColor=t.backgroundColor,r.style.lineHeight="normal",a.appendChild(r)),e.l.set(t,{kg:a,gj:r,$c:n})}function Yc(e,t,n,i){i=void 0===i?1:i;var r=(r=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(r[1]),unit:r[2]}:null;if(!r)return e;switch(e=r.unit,i*=r.value,e){case"%":return i/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*i/t.cellResolution.rows+"px";default:return i+e}}function Jc(e,t){this.g=t,this.j=e,this.F=new Map,this.l=void 0,this.C=!1,this.J=!0,this.o=this.I=!1,this.B=this.u=void 0,this.H=0,this.K={request:!1,response:!1,event:!1},this.m={},this.i=new te,this.G=[],this.h=null}function Qc(e){if(e.G)for(var t=p(e.G),n=t.next();!n.done;n=t.next())n.value.stop();e.G=[]}function Zc(e){return(e=e.g.targets)?e.filter((function(e){return e.mode===Bd&&e.enabled})):[]}function ed(e){return(e=e.g.targets)?e.filter((function(e){return e.mode===Fd&&!0===e.enabled})):[]}function td(t){return t.g.sessionId||(t.g.sessionId=e.crypto.randomUUID()),{v:t.g.version,sf:t.l,sid:t.g.sessionId,cid:t.g.contentId,mtp:t.j.getBandwidthEstimate()/1e3}}function nd(e,t,n){if(n=void 0===n?{}:n,t=cd(e,t=Object.assign({e:t,ts:Date.now()},n),Bd),n=e.g.targets,!(e.g.version<_d)&&n){var i=Zc(e);n=Array.from(new Set([].concat(g(Cd),g(Rd))));for(var r=(i=p(i)).next();!r.done;r=i.next()){var a=ad((r=r.value).includeKeys||[],n);a.includes(Od)||a.push(Od),a=od(t,a);var o=r.events||[],s=a.e,u=a.sta;s&&(!Dd.includes(s)||!("ps"!==s||u&&Ld.includes(u))||o&&o.length>0&&!o.includes(s))||rd(e,a,r)}}}function id(e,t,n){if(e.g.enabled){n=cd(e,n,Ud);var i=sd({mode:Ud,useHeaders:e.g.useHeaders,includeKeys:e.g.includeKeys||[]});e.m[i]||(e.m[i]={request:1,response:1}),n.sn=e.m[i].request++,function(e,t,n){if(n)e=hd(e),Object.keys(e).length&&Object.assign(t.headers,e);else{var i=dd(e);i&&(t.uris=t.uris.map((function(e){return fd(e,i)})))}}(n=od(n,i=ad(i=e.g.includeKeys||[],e.g.version==_d?Array.from(new Set([].concat(g(Cd),g(Md)))):Id)),t,e.g.useHeaders)}}function rd(e,t,n,i){var r={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},a=n.url;if(n.useHeaders){if(t=hd(t),!Object.keys(t).length)return;i&&Object.assign(i.headers,t),i=Vr([a],r),Object.assign(i.headers,t)}else{if(!(t=dd(t)))return;a=fd(a,t),i&&(i.uri=a),i=Vr([a],r)}e.j.Wb().request(9,i)}function ad(e,t){if(!e||0===e.length)return t;for(var n=p(e),i=n.next();!i.done;i=n.next())t.includes(i.value);return e.filter((function(e){return t.includes(e)}))}function od(e,t){return Object.keys(e).reduce((function(n,i){return t.includes(i)&&(n[i]=e[i]),n}),{})}function sd(e){var t=Object.keys(e).sort().reduce((function(t,n){return"enabled"!==n&&(t[n]=e[n]),t}),{});return JSON.stringify(t)}function ud(e,t){if(!(t=e.j.Fc()[t]).length)return 0;var n=e.h?e.h.currentTime:0;return(e=t.find((function(e){return e.start<=n&&e.end>=n})))?1e3*(e.end-n):0}function ld(e,t,n){var i=t.segment,r=0;i&&(r=i.endTime-i.startTime),(r={d:1e3*r,st:e.j.W()?Td:Sd}).ot=function(e){if(0===e.type)return yd;if(e=e.stream){var t=e.type;if("video"==t)return e.codecs&&e.codecs.includes(",")?vd:md;if("audio"==t)return gd;if("text"==t)return"application/mp4"===e.mimeType?wd:bd}}(t);var a=r.ot===md||r.ot===gd||r.ot===vd||r.ot===wd;if(t=t.stream){var o=e.j.Ob();if(a&&(r.bl=function(e,t){if(!(t=e.j.Fc()[t]).length)return NaN;var n=e.h?e.h.currentTime:0;return(e=t.find((function(e){return e.start<=n&&e.end>=n})))?1e3*(e.end-n):NaN}(e,t.type),r.ot!==wd)){var s=ud(e,t.type);r.dl=o?s/Math.abs(o):s}if(t.bandwidth&&(r.br=t.bandwidth/1e3),t.segmentIndex&&i){if((o=t.segmentIndex.Vb(i.endTime,!0,o<0))&&(o=o.next().value)&&o!=i){if(n&&!Z(i.P(),o.P())){var u=o.P()[0];s=new URL(u);var l=new URL(n);if(s.origin!==l.origin)n=u;else{n=s.pathname.split("/").slice(1),u=l.pathname.split("/").slice(1,-1),l=Math.min(n.length,u.length);for(var c=0;c<l&&n[c]===u[c];c++)n.shift(),u.shift();for(;u.length;)u.shift(),n.unshift("..");n=n.join("/")+s.search+s.hash}r.nor=n}!o.startByte&&!o.endByte||i.startByte==o.startByte&&i.endByte==o.endByte||(n=o.startByte+"-",o.endByte&&(n+=o.endByte),r.nrr=n)}o=e.j.Ob()||1,n=ud(e,t.type)||500,i=(t=t.bandwidth)?t*(i.endTime-i.startTime)/1e3/(n/o/1e3)*e.g.rtpSafetyFactor:NaN,isNaN(i)||(r.rtp=i)}}return a&&r.ot!==wd&&(r.tb=function(e,t){var n=e.j.mc();if(!n.length)return NaN;e=n[0];for(var i=(n=p(n)).next();!i.done;i=n.next())"variant"===(i=i.value).type&&i.bandwidth>e.bandwidth&&(e=i);switch(t){case md:return e.videoBandwidth||NaN;case gd:return e.audioBandwidth||NaN;default:return e.bandwidth}}(e,r.ot)/1e3),r}function cd(e,t,n){Object.assign(t,td(e)),t.pr=e.j.Ob();var i=t.ot===md||t.ot===vd;return e.I&&i&&(t.bs=!0,t.su=!0,e.I=!1),null==t.su&&(t.su=e.J),e.j.W()&&(i=wh(e.j),t.ltc=i||void 0),document.hidden&&(t.bg=!0),null==(i=e.B&&e.u?e.B-(e.H||e.u):void 0)||e.K[n]||(t.msd=i,e.K[n]=!0),t}function dd(e){function t(e){return 100*n(e/100)}function n(e){return Math.round(e)}for(var i,r=[],a={br:n,d:n,bl:t,dl:t,mtp:t,nor:function(e){return encodeURIComponent(e)},rtp:t,tb:n,ttfb:n,ttlb:n},o=Object.keys(e||{}).sort(),s=(o=p(o)).next();!s.done;s=o.next()){var u=e[s=s.value];if(!(i=u,Number.isNaN(i)||null==i||""===i||!1===i||"v"===s&&1===u||"pr"==s&&1===u)){var l=a[s];l&&(u=l(u));var c;c="string"===(l=typeof u)&&"ot"!==s&&"sf"!==s&&"st"!==s?s+"="+JSON.stringify(u):"boolean"===l?s:"symbol"===l?s+"="+u.description:s+"="+u,r.push(c)}}return r.join(",")}function hd(e){for(var t=Object.keys(e),n={},i=["Object","Request","Session","Status"],r=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,url:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,ltc:1,ttfb:1,ttlb:1,ts:1,rc:1,cmsdd:1,cmsds:1,sn:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,msd:2,bs:3,rtp:3,bg:3},o=(t=p(t)).next();!o.done;o=t.next())r[null!=a[o=o.value]?a[o]:1][o]=e[o];for(e=0;e<r.length;e++)(a=dd(r[e]))&&(n["CMCD-"+i[e]]=a);return n}function fd(e,t){return!t||e.includes("offline:")?e:((e=new ge(e)).g.set("CMCD",t),e.toString())}(i=Fc.prototype).configure=function(){},i.remove=function(e,t){return!!this.i&&(this.h.has(this.g)&&Uc(this.h.get(this.g).track,(function(n){return n.startTime<t&&n.endTime>e})),!0)},i.append=function(e){this.h.has(this.g)&&jc(this.h.get(this.g).track,e)},i.destroy=function(){return this.i&&(this.j&&this.C(),this.i=null),this.l&&(this.l.release(),this.l=null),Promise.resolve()},i.isTextVisible=function(){return this.u},i.setTextVisibility=function(e){if(this.u=e,this.h.has(this.g)){var t=this.h.get(this.g).track;"disabled"!==t.mode&&(e=e?"showing":"hidden",t.mode!==e&&(t.mode=e))}else if(this.i&&3===this.i.m)if(t=Array.from(this.i.h.textTracks).filter((function(e){return["captions","subtitles","forced"].includes(e.kind)})),e){e=null;for(var n=(t=p(t)).next();!n.done;n=t.next()){if("showing"===(n=n.value).mode){e=null;break}e||"hidden"!==n.mode||(e=n)}e&&(e.mode="showing")}else for(t=(e=p(t)).next();!t.done;t=e.next())"showing"===(t=t.value).mode&&(t.mode="hidden")},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){!this.j&&this.i&&2===this.i.m&&(this.j=this.i.h,this.l.Ba(this.i,"unloading",this.C),this.l.D(this.i,"textchanged",this.m),this.l.D(this.j.textTracks,"change",this.B),this.m())},B("shaka.text.NativeTextDisplayer",Fc),Fc.prototype.enableTextDisplayer=Fc.prototype.enableTextDisplayer,Fc.prototype.setTextLanguage=Fc.prototype.setTextLanguage,Fc.prototype.setTextVisibility=Fc.prototype.setTextVisibility,Fc.prototype.isTextVisible=Fc.prototype.isTextVisible,Fc.prototype.destroy=Fc.prototype.destroy,Fc.prototype.append=Fc.prototype.append,Fc.prototype.remove=Fc.prototype.remove,Fc.prototype.configure=Fc.prototype.configure,(i=Hc.prototype).configure=function(){},i.remove=function(e,t){return!!this.g&&(Uc(this.g,(function(n){return n.startTime<t&&n.endTime>e})),!0)},i.append=function(e){this.g&&jc(this.g,e)},i.destroy=function(){return this.g&&(Uc(this.g,(function(){return!0})),this.g.mode="disabled"),this.g=this.h=null,Promise.resolve()},i.isTextVisible=function(){return!!this.g&&"showing"==this.g.mode},i.setTextVisibility=function(e){e&&!this.g&&Vc(this),this.g&&(this.g.mode=e?"showing":"hidden")},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){Vc(this)},B("shaka.text.SimpleTextDisplayer",Hc),Hc.prototype.enableTextDisplayer=Hc.prototype.enableTextDisplayer,Hc.prototype.setTextLanguage=Hc.prototype.setTextLanguage,Hc.prototype.setTextVisibility=Hc.prototype.setTextVisibility,Hc.prototype.isTextVisible=Hc.prototype.isTextVisible,Hc.prototype.destroy=Hc.prototype.destroy,Hc.prototype.append=Hc.prototype.append,Hc.prototype.remove=Hc.prototype.remove,Hc.prototype.configure=Hc.prototype.configure,(i=qc.prototype).configure=function(){},i.remove=function(){},i.append=function(){},i.destroy=function(){},i.isTextVisible=function(){return!1},i.setTextVisibility=function(){},i.setTextLanguage=function(){},i.enableTextDisplayer=function(){},B("shaka.text.StubTextDisplayer",qc),qc.prototype.enableTextDisplayer=qc.prototype.enableTextDisplayer,qc.prototype.setTextLanguage=qc.prototype.setTextLanguage,qc.prototype.setTextVisibility=qc.prototype.setTextVisibility,qc.prototype.isTextVisible=qc.prototype.isTextVisible,qc.prototype.destroy=qc.prototype.destroy,qc.prototype.append=qc.prototype.append,qc.prototype.remove=qc.prototype.remove,qc.prototype.configure=qc.prototype.configure,(i=Gc.prototype).configure=function(e){this.C=e,zc(this),Wc(this,!0)},i.append=function(e){for(var t=[].concat(g(this.h)),n=(e=p(Nc(e))).next(),i={};!n.done;i={jg:void 0},n=e.next())i.jg=n.value,t.some(function(e){return function(t){return Tn(t,e.jg)}}(i))||this.h.push(i.jg);this.h.length&&zc(this),Wc(this)},i.destroy=function(){return this.g?(this.g.parentElement&&this.o.removeChild(this.g),this.g=null,this.m=!1,this.h=[],this.B&&(this.B.stop(),this.B=null),this.l.clear(),this.i&&(this.i.release(),this.i=null),this.F&&(this.F.disconnect(),this.F=null),Promise.resolve()):Promise.resolve()},i.remove=function(e,t){if(!this.g)return!1;var n=this.h.length;return this.h=this.h.filter((function(n){return n.startTime<e||n.endTime>=t})),Wc(this,n>this.h.length),this.h.length||zc(this),!0},i.isTextVisible=function(){return this.m},i.setTextVisibility=function(e){(this.m=e)?(this.g.parentElement||this.o.appendChild(this.g),Wc(this,!0)):this.g.parentElement&&this.o.removeChild(this.g)},i.setTextLanguage=function(e){e&&"und"!=e?this.g.setAttribute("lang",e):this.g.setAttribute("lang","")},i.enableTextDisplayer=function(){},B("shaka.text.UITextDisplayer",Gc),Gc.prototype.enableTextDisplayer=Gc.prototype.enableTextDisplayer,Gc.prototype.setTextLanguage=Gc.prototype.setTextLanguage,Gc.prototype.setTextVisibility=Gc.prototype.setTextVisibility,Gc.prototype.isTextVisible=Gc.prototype.isTextVisible,Gc.prototype.remove=Gc.prototype.remove,Gc.prototype.destroy=Gc.prototype.destroy,Gc.prototype.append=Gc.prototype.append,Gc.prototype.configure=Gc.prototype.configure,B("shaka.text.WebVttGenerator",(function(){})),Jc.prototype.setMediaElement=function(t){this.h=t,function(t){t.i.D(t.h,"playing",(function(){t.B||(t.B=Date.now()),nd(t,"ps",{dd:"p"})})),t.i.D(t.h,"volumechange",(function(){nd(t,t.h.muted?"m":"um")})),t.i.D(t.h,"play",(function(){t.u||(t.u=Date.now(),nd(t,"ps",{dd:"s"}))})),t.i.D(t.h,"pause",(function(){nd(t,"ps",{dd:"a"})})),t.i.D(t.j,"buffering",(function(){nd(t,"ps",{dd:"w"})})),t.i.D(t.h,"seeking",(function(){return nd(t,"ps",{dd:"k"})})),t.i.D(document,"fullscreenchange",(function(){nd(t,document.fullscreenElement?"pe":"pc")}));var n=t.h;(n.webkitPresentationMode||n.webkitSupportsFullscreen)&&t.i.D(n,"webkitpresentationmodechanged",(function(){n.webkitPresentationMode?nd(t,"inline"!==n.webkitPresentationMode?"pe":"pc"):n.webkitSupportsFullscreen&&nd(t,n.webkitDisplayingFullscreen?"pe":"pc")})),t.i.D(t.h,"enterpictureinpicture",(function(){nd(t,"pe")})),t.i.D(t.h,"leavepictureinpicture",(function(){nd(t,"pc")})),"documentPictureInPicture"in e&&t.i.D(e.documentPictureInPicture,"enter",(function(e){nd(t,"pe"),t.i.Ba(e.window,"pagehide",(function(){nd(t,"pc")}))})),t.i.D(document,"visibilitychange",(function(){document.hidden?nd(t,"b",{bg:!0}):nd(t,"b")})),t.i.D(t.j,"complete",(function(){nd(t,"ps",{dd:"e"})}))}(this)},Jc.prototype.configure=function(e){this.g=e,function(e){Qc(e);for(var t=Zc(e),n=(t=p(t)).next();!n.done;n=t.next())if(void 0===(n=n.value.timeInterval)&&(n=Nd),n>=1){var i=new Si((function(){return nd(e,jd)}));i.Ea(n),e.G.push(i)}}(this)};var pd="m",gd="a",md="v",vd="av",yd="i",bd="c",wd="tt",_d=2,Sd="v",Td="l",xd="d",kd="ld",Ad="h",Ed="lh";B("shaka.util.CmcdManager.StreamingFormat",{DASH:xd,Pl:kd,HLS:Ad,Ql:Ed,fm:"s",OTHER:"o"});var Id="br bl bs cid d dl mtp nor nrr ot pr rtp sf sid st su tb v".split(" "),Cd="br ab bl tbl bs cdn cid ltc mtp pr sf sid bg sta st ts tpb tb lb tab lab pt ec msd v sn".split(" "),Md="ab bl tbl bs cdn cid d dl ltc mtp nor ot pr rtp sf sid bg sta st su ts tpb tb lb tab lab pt ec msd v".split(" "),Pd="d dl nor ot rtp rc su ttfb ttfbb ttlb url cmsdd cmsds".split(" "),Rd=["e","sta"],Dd="ps e t c b m um pe pc".split(" "),Ld="spawkrfeqd".split(""),Nd=10,Od="ts",jd="t",Ud="request",Fd="response",Bd="event";function Hd(e){this.h=e,this.g=null}function Vd(e){return!e||"false"!==e.toLowerCase()&&(/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""))}(i=Hd.prototype).configure=function(e){this.h=e},i.bi=function(){return this.h.enabled&&this.h.applyMaximumSuggestedBitrate&&this.g&&this.g.has(Gd)?1e3*this.g.get(Gd):null},i.$h=function(){return this.h.enabled&&this.g&&this.g.has(qd)?1e3*this.g.get(qd):null},i.Tj=function(){return this.h.enabled&&this.g&&this.g.has(zd)?this.g.get(zd):null},i.Uj=function(){return this.h.enabled&&this.g&&this.g.has($d)?this.g.get($d):null},i.getBandwidthEstimate=function(e){var t=this.$h();if(!t)return e;var n=this.h.estimatedThroughputWeightRatio;return n>0&&n<=1?e*(1-n)+t*n:e},B("shaka.util.CmsdManager",Hd),Hd.prototype.getBandwidthEstimate=Hd.prototype.getBandwidthEstimate,Hd.prototype.getRoundTripTime=Hd.prototype.Uj,Hd.prototype.getResponseDelay=Hd.prototype.Tj,Hd.prototype.getEstimatedThroughput=Hd.prototype.$h,Hd.prototype.getMaxBitrate=Hd.prototype.bi;var qd="etp",Gd="mb",zd="rd",$d="rtt";function Kd(){this.g=null,this.h=[]}function Wd(e,t){return R((function(n){if(1==n.g)return e.g?w(n,new Promise((function(t){return e.h.push(t)})),2):n.A(2);e.g=t,_(n)}))}function Xd(t,n,i){n=void 0===n?null:n,Or.call(this);var r=this;this.m=ef,this.h=null,this.xe=n,this.$=!1,this.Ie=new te,this.ye=new te,this.j=new te,this.ac=new te,this.yc=new te,this.G=this.H=this.F=this.J=null,this.Je=0,this.ma=new Kd,this.O=this.aa=this.X=this.i=this.xc=this.I=this.l=this.ue=this.T=this.Kh=this.va=this.M=this.ib=this.ya=this.we=this.R=this.Fa=this.N=this.ob=null,this.Sa=!1,this.Ce=this.o=null,this.Be=1e9,this.Ge=[],this.uc=new Map,this.kb=[],this.Xf=-1,this.g=xh(this),this.Zf={streaming:{inaccurateManifestTolerance:0,segmentPrefetchLimit:2,updateIntervalSeconds:.1,maxDisabledTime:1,retryParameters:{baseDelay:100}},manifest:{dash:{autoCorrectDrift:!1},retryParameters:{baseDelay:100}},drm:{retryParameters:{baseDelay:100}}},this.V=null,this.Ke=-1,this.Zb=null,this.xa={width:1/0,height:1/0},this.Ae=new qa(this.g,this.xa,null),this.Ee=[],this.B=null,this.K=this.g.adaptationSetCriteriaFactory(),this.K.configure({language:this.g.preferredAudioLanguage,role:this.g.preferredAudioRole,videoRole:this.g.preferredVideoRole,channelCount:0,hdrLevel:this.g.preferredVideoHdrLevel,spatialAudio:this.g.preferSpatialAudio,videoLayout:this.g.preferredVideoLayout,audioLabel:this.g.preferredAudioLabel,videoLabel:this.g.preferredVideoLabel,codecSwitchingStrategy:this.g.mediaSource.codecSwitchingStrategy,audioCodec:"",activeAudioCodec:"",activeAudioChannelCount:0,preferredAudioCodecs:this.g.preferredAudioCodecs,preferredAudioChannelCount:this.g.preferredAudioChannelCount}),this.Fd=this.g.preferredTextLanguage,this.Md=this.g.preferredTextRole,this.Ld=this.g.preferForcedSubs,this.ze=[],i&&i(this),this.M=new Jc(this,this.g.cmcd),this.va=new Hd(this.g.cmsd),this.J=ch(this),this.Jd=this.oa=this.Da=this.C=null,this.ag=!1,this.Yf=[],this.$f=new Si((function(){return R((function(e){return 1==e.g?r.oa?w(e,r.fc(r.Jd,!0),3):e.A(0):4!=e.g?w(e,r.load(r.oa),4):(r.ag?r.Jd.pause():r.Jd.play(),r.oa=null,r.ag=!1,void _(e))}))})),of&&(this.C=of(),this.C.configure(this.g.ads),this.yc.D(this.C,"ad-content-pause-requested",(function(e){var t;return R((function(n){if(1==n.g)return r.$f.stop(),r.oa?n.A(0):(r.Jd=r.h,r.ag=r.be(),t=e.saveLivePosition||!1,w(n,r.Uh(!0,t),3));r.oa=n.h,_(n)}))})),this.yc.D(this.C,"ad-content-resume-requested",(function(e){if(e=e.offset||0,r.oa){var t=r.oa;t.m&&e&&("number"==typeof t.m?t.m+=e:t.m.setTime(t.m.getTime()+1e3*e))}r.$f.ia(.1)})),this.yc.D(this.C,"ad-content-attach-requested",(function(){return R((function(e){return r.h||!r.Jd?e.A(0):w(e,r.fc(r.Jd,!0),0)}))}))),sf&&(this.Da=sf(this),this.Da.configure(this.g.queue)),this.Ie.D(e,"online",(function(){Gh(r),r.fh()})),this.De=new Si((function(){for(var e=Date.now()/1e3,t=!1,n=!0,i=p(r.i.variants),a=i.next();!a.done;a=i.next())(a=a.value).disabledUntilTime>0&&a.disabledUntilTime<=e&&(a.disabledUntilTime=0,t=!0),a.disabledUntilTime>0&&(n=!1);n&&r.De.stop(),t&&Rh(r,!1,void 0,!1,!1)})),this.Ta=null,t&&(ce("Player w/ mediaElement","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.fc(t,!0)),this.u=null}function Yd(e){null!=e.T&&(pt(e.T),e.T.release(),e.T=null)}function Jd(e,t){return new Dr(e,t)}function Qd(e,t){af.set(e,t)}function Zd(e,t){e.dispatchEvent(Jd("onstatechange",(new Map).set("state",t)))}function eh(e,t){var n;return R((function(i){return 1==i.g?(n=++e.Je,w(i,Wd(e.ma,t),2)):n!=e.Je?(e.ma.release(),i.return(!0)):i.return(!1)}))}function th(e,t){var n,i,r;return t=void 0!==t&&t,R((function(a){if(1==a.g)return n=null,e.i&&e.I&&e.xc&&e.X&&e.g?(i=e.h.currentTime,e.W()&&!t&&(i=null),w(a,ih(e,e.X,i,e.aa,e.g,!0,!1),3)):a.A(2);if(2!=a.g){n=a.h,e.Ee.push(n),e.I&&e.I.setMediaElement&&e.I.setMediaElement(null),(r=e.l?e.l.o:null)&&(n.o=r);var o=n,s=e.I,u=e.xc;o.h=e.i,o.l=s,o.H=u,n.C=e.K,n.start(),e.i=null,e.I=null,e.xc=null,e.o=null,e.Ce=null}return a.return(n)}))}function nh(e,t,n,i,r,a){var o,s,u;return r=void 0!==r&&r,R((function(l){return 1==l.g?i?l.A(2):w(l,rh(e,t),3):(2!=l.g&&(i=l.h),function(e,t){if(!Xv(ae()))return!0;if(t){if(""==(e.h||es()).canPlayType(t))return!1;if(!Xv(ae())||!Za.has(t))return!0;if(ci(t))return"WEBKIT"===ae().Ha()&&(e.g.drm.servers["com.apple.fps"]||e.g.drm.servers["com.apple.fps.1_0"])?e.g.streaming.useNativeHlsForFairPlay:e.g.streaming.preferNativeHls;if("application/dash+xml"===t||"video/vnd.mpeg.dash.mpd"===t)return e.g.streaming.preferNativeDash}return!1}(e,i)?l.return(null):(o=a||e.g,s=!1,r&&e.h&&"AUDIO"===e.h.nodeName&&(s=!0),u=ih(e,t,n,i||null,o,!r,s),u=r?u.then((function(e){return e.F=!1,e})):u.then((function(t){return e.Ee.push(t),t})),l.return(u)))}))}function ih(e,t,n,i,r,a,o){var s,u,l,c,d,h,f,g,m,v,y,b;return a=void 0===a||a,o=void 0!==o&&o,R((function(S){return 1==S.g?(s=null,u=Ft(r),o&&(u.manifest.disableVideo=!0),l=function(){return s.R&&s.j?null:s},c=function(){return l()?l().getConfiguration():e.g},e.xa.width!=1/0||e.xa.height!=1/0||e.g.ignoreHardwareResolution?S.A(2):w(S,ae().jc(),3)):(2!=S.g&&(d=S.h,e.xa.width=d.width,e.xa.height=d.height),h=new qa(u,e.xa,null),f={networkingEngine:e.J,filter:function(e){var t;return R((function(n){return 1==n.g?w(n,Ga(h,e),2):4!=n.g?n.h?(t=Jd("trackschanged"),w(n,Promise.resolve(),4)):n.A(0):(s.dispatchEvent(t),void _(n))}))},makeTextStreamsForClosedCaptions:function(t){return function(e,t){for(var n=new Set,i=p(t.textStreams),r=i.next();!r.done;r=i.next())"application/cea-608"!=(r=r.value).mimeType&&"application/cea-708"!=r.mimeType||n.add(r.originalId);for(i=p(t.variants),r=i.next();!r.done;r=i.next())if((r=r.value.video)&&r.closedCaptions)for(var a=p(r.closedCaptions.keys()),o=a.next();!o.done;o=a.next())if(o=o.value,!n.has(o)){var s=o.startsWith("CC")?"application/cea-608":"application/cea-708",u=new Lu,l=r.closedCaptions.get(o);s={id:e.Be++,originalId:o,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:u,mimeType:s,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:l,originalLanguage:l,label:null,type:ut,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:r.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set([ni(s,"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},t.textStreams.push(s),n.add(o)}}(e,t)},onTimelineRegionAdded:function(e){qu(s.I,e)},onEvent:function(e){return s.dispatchEvent(e)},onError:function(e){return s.onError(e)},isLowLatencyMode:function(){return c().streaming.lowLatencyMode},updateDuration:function(){e.l&&s.R&&e.l.updateDuration()},newDrmInfo:function(e){var t=s.i,n=t?t.g:null;n&&t.B&&Ka(h,n.keySystem,e)},onManifestUpdated:function(){var t=(new Map).set("isLive",e.W());s.dispatchEvent(Jd("manifestupdated",t)),hc(s,!1,(function(){e.C&&e.C.onManifestUpdated(e.W())}))},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},onMetadata:function(t,n,i,r){var a=t;"com.apple.hls.interstitial"!=t&&"com.apple.hls.overlay"!=t||(a="com.apple.quicktime.HLS",t={startTime:n,endTime:i,values:r},e.C&&e.C.onHLSInterstitialMetadata(e,e.h,t)),t=(r=p(r)).next();for(var o={};!t.done;o={Yg:void 0},t=r.next())o.Yg=t.value,"ID"!=o.Yg.name&&hc(s,!1,function(t){return function(){lh(e,n,i,a,t.Yg)}}(o))},disableStream:function(t){return e.disableStream(t,e.g.streaming.maxDisabledTime)},addFont:function(t,n){return e.addFont(t,n)}},(g=new Vu((function(){return e.Qa()}))).addEventListener("regionadd",(function(t){var n=t.region;$h(e,"timelineregionadded",n,s),hc(s,!1,(function(){e.C&&(e.C.onDashTimedMetadata(n),e.C.onDASHInterstitialMetadata(e,e.h,n))}))})),m=null,u.streaming.observeQualityChanges&&((m=new Fu((function(){return e.Fc()}))).addEventListener("qualitychange",(function(t){Kh(e,t.quality,t.position)})),m.addEventListener("audiotrackchange",(function(t){Kh(e,t.quality,t.position,!0)}))),v=!0,y={tc:e.J,onError:function(e){return s.onError(e)},vf:function(t){hc(s,!0,(function(){e.F&&function(e,t){var n=Jd("keystatuschanged");e.dispatchEvent(n);var i=Object.keys(t);1==i.length&&""==i[0]&&(i=["00"],t={"00":t[""]});var r=1==i.length&&"00"==i[0];if(n=!1,i.length){i=e.keySystem();for(var a=Zr(e.g.drm.clearKeys),o=function(n,i){n.allowedByKeySystem=!0;for(var a=(i=p(i)).next();!a.done;a=i.next())a=a.value,((a=t[r?"00":a])||e.F.H)&&(n.allowedByKeySystem=n.allowedByKeySystem&&!!a&&!Xa.includes(a))},s=p(e.i.variants),u=s.next();!u.done;u=s.next())for(var l=rr(u=u.value),c=(l=p(l)).next();!c.done;c=l.next()){c=c.value;var d=u.allowedByKeySystem;if(c.keyIds.size)if(c.drmInfos.length&&!a.size&&"HLS"==e.i.type)for(var h=p(c.drmInfos),f=h.next();!f.done;f=h.next())(f=f.value).keySystem==i&&(f.keyIds.size?o(u,f.keyIds):o(u,c.keyIds));else o(u,c.keyIds);d!=u.allowedByKeySystem&&(n=!0)}}if(n&&(Oh(e),!Mh(e)))return;(n=e.l.o)&&!n.allowedByKeySystem&&Rh(e)}(e,t)}))},onExpirationUpdated:function(e,t){var n=Jd("expirationupdated");s.dispatchEvent(n),(n=s.l)&&n.onExpirationUpdated&&n.onExpirationUpdated(e,t)},onEvent:function(t){s.dispatchEvent(t),"drmsessionupdate"==t.type&&v&&(v=!1,t=Date.now()/1e3-s.ya,(e.B||s.getStats()).m=t,e.T&&pt(e.T))}},b=ch(e,l),Hr(e.J,b),s=new dc(t,i,n,{config:u,wk:f,Hk:g,Gk:m,md:function(){return e.md(y)},vk:h,networkingEngine:b,ij:a}),S.return(s))}))}function rh(e,t){var n,i;return R((function(r){return 1==r.g?(n=e.g.manifest.retryParameters,w(r,kc(t,e.J,n),2)):("application/x-mpegurl"==(i=r.h)&&("WEBKIT"===ae().Ha()&&(i="application/vnd.apple.mpegurl")),"video/quicktime"==i&&("CHROMIUM"===ae().Ha()&&(i="video/mp4")),r.return(i))}))}function ah(e,t){var n=e.g.textDisplayFactory;e.Jh!==n||void 0!==t&&t?(t=e.u,e.u=n(),e.u.configure?e.u.configure(e.g.textDisplayer):ce("Text displayer w/ configure",'Text displayer should have a "configure" method!'),e.u.setTextLanguage||ce("Text displayer w/ setTextLanguage",'Text displayer should have a "setTextLanguage" method!'),t?(e.u.setTextVisibility(t.isTextVisible()),t.destroy().catch((function(){}))):e.u.setTextVisibility(e.$),e.H&&function(e,t){e.aa=t,e.h&&(e.h.l=t)}(e.H,e.u),e.Jh=n,e.l&&function(e){var t=e.h.get(ut);t&&cl(e,t.stream,!0,0,!0)}(e.l)):e.u&&e.u.configure&&e.u.configure(e.g.textDisplayer)}function oh(e){var t,n,i;return R((function(r){if(1==r.g)return ae(),Zd(e,"media-source"),e.g.mediaSource.useSourceElements&&Qo(e.h),ah(e),t=function(e,t,n,i,r){return new Ms(e,t,n,r,i)}(e.h,e.u,{Jj:function(){return e.keySystem()},onMetadata:function(t,n,i){for(var r=(t=p(t)).next();!r.done;r=t.next())if((r=r.value).data&&"number"==typeof r.cueTime&&r.frames){var a=r.cueTime+n,o=i;o&&a>o&&(o=a);for(var s=p(r.frames),u=s.next();!u.done;u=s.next())lh(e,a,o,"org.id3",u.value);e.C&&e.C.onHlsTimedMetadata(r,a)}},Bk:function(t){e.ib&&qu(e.ib,{schemeIdUri:t.schemeIdUri,startTime:t.startTime,endTime:t.endTime,id:String(t.id),emsg:t})},onEvent:function(t){return e.dispatchEvent(t)},Dk:function(){e.I&&e.I.update&&e.I.update()}},e.T,e.g.mediaSource),n=e.g.manifest,i=n.segmentRelativeVttTiming,t.Fa=i,w(r,t.M,2);e.H=t,_(r)}))}function sh(e,t,n){function i(){return Eh(e)}if(e.j.D(t,"playing",i),e.j.D(t,"pause",i),e.j.D(t,"ended",i),e.j.D(t,"ratechange",(function(){var t=e.h.playbackRate;0!=t&&(e.N&&(e.N.set(t),e.m==tf&&e.o.playbackRateChanged(t),Ah(e,t)),t=Jd("ratechange"),e.dispatchEvent(t))})),t.remote&&(e.j.D(t.remote,"connect",(function(){e.l&&"connected"==t.remote.state&&Bh(e),Oh(e)})),e.j.D(t.remote,"connecting",(function(){return Oh(e)})),e.j.D(t.remote,"disconnect",(function(){return R((function(n){if(1==n.g)return e.l&&"disconnected"==t.remote.state?w(n,Ml(e.l),3):n.A(2);2!=n.g&&Bh(e),Oh(e),_(n)}))}))),t.audioTracks&&(e.j.D(t.audioTracks,"addtrack",(function(){return Oh(e)})),e.j.D(t.audioTracks,"removetrack",(function(){return Oh(e)})),e.j.D(t.audioTracks,"change",(function(){return Oh(e)}))),t.videoTracks&&(e.j.D(t.videoTracks,"addtrack",(function(){return Oh(e)})),e.j.D(t.videoTracks,"removetrack",(function(){return Oh(e)})),e.j.D(t.videoTracks,"change",(function(){return Oh(e)}))),(t.webkitPresentationMode||t.webkitSupportsFullscreen)&&e.j.D(t,"webkitpresentationmodechanged",(function(){e.xe&&ah(e,!0)})),t.textTracks){var r=function(){e.m===nf&&e.u instanceof Fc&&Bh(e),Oh(e)};e.j.D(t.textTracks,"addtrack",(function(t){if(t.track)switch(t=t.track,t.kind){case"metadata":!function(e,t){if("metadata"==t.kind){t.mode="hidden",e.j.D(t,"cuechange",(function(){if(t.activeCues)for(var n=p(t.activeCues),i=n.next();!i.done;i=n.next())i=i.value,lh(e,i.startTime,i.endTime,i.type,i.value),e.C&&e.C.onCueMetadataChange(i.value);if(t.cues){n=[];for(var r=(i=p(t.cues)).next(),a={};!r.done;a={Dc:void 0},r=i.next())a.Dc=r.value,"com.apple.quicktime.HLS"==a.Dc.type&&null!=a.Dc.startTime&&(r=n.find(function(e){return function(t){return t.startTime==e.Dc.startTime&&t.endTime==e.Dc.endTime}}(a)),r||(r={startTime:a.Dc.startTime,endTime:a.Dc.endTime,values:[]},n.push(r)),r.values.push(a.Dc.value));for(i=(n=p(n)).next();!i.done;i=n.next())(i=i.value).values.some((function(e){return"X-ASSET-URI"==e.key||"X-ASSET-LIST"==e.key}))&&e.C&&(i.values.push({key:"CUE",description:"",data:0!=i.startTime||e.W()?"ONCE":"ONCE,PRE",mimeType:null,pictureType:null}),e.C.onHLSInterstitialMetadata(e,e.h,i))}}));var n=new Si((function(){for(var t=function(e){return Array.from(e.h.textTracks).filter((function(e){return"metadata"==e.kind}))}(e),n=(t=p(t)).next();!n.done;n=t.next())n.value.mode="hidden"})).Jb().ia(.5);e.ze.push((function(){n.stop()}))}}(e,t);break;case"chapters":!function(e,t){if(t&&"chapters"==t.kind){t.mode="hidden";var n=new Si((function(){t.mode="hidden"})).Jb().ia(.5);e.ze.push((function(){n.stop()}))}}(e,t);break;default:r()}})),e.j.D(t.textTracks,"removetrack",r),e.j.D(t.textTracks,"change",r)}"none"!=t.preload&&e.j.Ba(t,"loadedmetadata",(function(){e.B.G=Date.now()/1e3-n}))}function uh(e,t,n){t=(new Map).set("startTime",t.startTime).set("endTime",t.endTime).set("metadataType",t.schemeIdUri).set("payload",t.payload),e.dispatchEvent(Jd(n,t))}function lh(e,t,n,i,r){e.ya&&((t={schemeIdUri:i,startTime:t,endTime:n||1/0,id:"",payload:r}).id=JSON.stringify(t),qu(e.ya,t))}function ch(e,t){function n(n){t()?t().dispatchEvent(n):e.dispatchEvent(n)}function i(e){t()?hc(t(),!0,e):e()}t||(t=function(){return null});var r=new Fr((function(t,n,r,a,o){i((function(){e.o&&e.o.segmentDownloaded(t,n,r,a,o)}))}),(function(t,r,a){n(Jd("downloadheadersreceived",r=(new Map).set("headers",t).set("request",r).set("requestType",a))),i((function(){if(e.va){var n=e.va;if(n.h.enabled){var i=t["cmsd-static"];if(i)try{var r=new Map,a=i.split(",");for(i=0;i<a.length;i++){var o=a[i].split("=");r.set(o[0],Vd(o[1]))}}catch(e){}if(r=t["cmsd-dynamic"]){e:{try{var s=new Map,u=r.split(";");for(r=1;r<u.length;r++){var l=u[r].split("=");s.set(l[0],Vd(l[1]))}var c=s;break e}catch(e){c=null;break e}c=void 0}c&&(n.g=c)}}}}))}),(function(e,t){n(Jd("downloadcompleted",e=(new Map).set("request",e).set("response",t)))}),(function(e,t,i,r){n(Jd("downloadfailed",e=(new Map).set("request",e).set("error",t).set("httpResponseCode",i).set("aborted",r)))}),(function(t,n,r){i((function(){if(e.M){var i=e.M,a=r;if(a=void 0===a?{}:a,i.g.enabled)if("HEAD"===n.method)id(i,n,{});else switch(t){case 0:try{if(i.g.enabled){if(a.type){e:{switch(a.type){case 4:var o=i.o?kd:xd;break e;case 3:case 2:o=i.o?Ed:Ad;break e;case 5:o="s";break e}o=void 0}i.l=o}id(i,n,{ot:pd,su:!i.C})}}catch(e){K("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",e)}break;case Kr:try{if(i.g.enabled){var s=ld(i,a,n.uris[0]);s.ts=Date.now(),i.F.set(n,s.ts),id(i,n,s)}}catch(e){K("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",e)}break;case 2:case 5:case 6:id(i,n,{ot:"k"});break;case 4:id(i,n,{ot:"o"})}}}))}),(function(n,i,r,a){(n=t()?t().l:e.I)&&n.banLocation&&n.banLocation(a)}),(function(n,i,r){if(i.data){var a=i.data.byteLength,o=t()?t().getStats():e.B;if(o&&(lc(o,a),0===n&&(o.ni=a)),r=void 0===r?{}:r,0!==ed(a=e.M).length&&n===Kr)try{var s=ld(a,r,i.uri);i.originalRequest&&null!=i.originalRequest.timeToFirstByte&&(s.ttfb=i.originalRequest.timeToFirstByte),null!=i.timeMs&&(s.ttlb=i.timeMs);var u=i.originalUri||i.uri;if(u.includes("CMCD="))try{var l=new URL(u);l.searchParams.delete("CMCD");var c=l.toString()}catch(e){c=u}else c=u;s.url=c,a.F.has(i.originalRequest)?(s.ts=a.F.get(i.originalRequest),a.F.delete(i.originalRequest)):s.ts||(s.ts=Date.now());var d=ed(a);if(0!==d.length){var h=a.g.version==_d?Array.from(new Set([].concat(g(Cd),g(Pd)))):Id;s.rc=i.status||0;var f=cd(a,s,Fd);i.headers&&i.headers["CMSD-Static"]&&(f.cmsds=btoa(i.headers["CMSD-Static"])),i.headers&&i.headers["CMSD-Dynamic"]&&(f.cmsdd=btoa(i.headers["CMSD-Dynamic"]));for(var m=p(d),v=m.next();!v.done;v=m.next()){var y=v.value,b=ad(y.includeKeys||[],h),w=sd(y);a.m[w]||(a.m[w]={request:1,response:1}),f.sn=a.m[w].response++,rd(a,od(f,b),y,i)}}}catch(e){K("CMCD_SEGMENT_ERROR","Could not generate response segment CMCD data.",e)}}}));return r.configure(e.g.networking),r}function dh(e,t,n){e.R=new Fa,Ba(e.R,Ha),hh(e),kh(e),e.Fa=new Si((function(){fh(e)})),e.g.streaming.rebufferingGoal&&e.Fa.Ea(.25),e.j.D(t,"waiting",(function(){return fh(e,"waiting")})),e.j.D(t,"canplaythrough",(function(){return fh(e,"canplaythrough")})),e.j.D(t,"playing",(function(){return fh(e,"playing")})),e.j.D(t,"seeked",(function(){return fh(e,"seeked")})),n&&(e.j.D(t,"stalled",(function(){return fh(e,"stalled")})),e.j.D(t,"progress",(function(){return fh(e,"progress")})),e.j.D(t,"timeupdate",(function(){return fh(e,"timeupdate")})))}function hh(e){var t=e.g.streaming.rebufferingGoal;e.R.i.set(Va,Math.min(.5,t/2)).set(Ha,t)}function fh(e,t){if(e.g.streaming.rebufferingGoal){t=!!e.H&&Ns(e.H),t=e.be()||t||e.G.ki();var n=Wo(e.h.buffered,e.h.currentTime),i=e.R,r=i.i.get(i.g);Ba(i,t||n>=r&&n>0?Va:Ha)&&kh(e)}else if(t){switch(n=void 0,t){case"seeking":case"waiting":n=Ha;break;case"canplaythrough":case"playing":case"seeked":n=Va}void 0!==n&&Ba(e.R,n)&&kh(e)}}function ph(e,t){if(e.Ae=new qa(e.g,e.xa,e.F),e.I){var n=Ft(e.g.manifest);e.h&&"AUDIO"===e.h.nodeName&&(n.disableVideo=!0),e.I.configure(n)}if(e.F&&e.F.configure(e.g.drm),e.l){e.l.configure(e.g.streaming);try{e.m!=Zh&&$a(e.Ae,e.i)&&Oh(e)}catch(t){zh(e,t)}e.o&&Mh(e),!(n=e.l.o)||n.allowedByApplication&&n.allowedByKeySystem||Rh(e)}if(e.J&&e.J.configure(e.g.networking),e.H&&(e.H.configure(e.g.mediaSource),e.H.Fa=e.g.manifest.segmentRelativeVttTiming),e.u&&ah(e),e.o&&(e.o.configure(e.g.abr),e.g.abr.enabled?e.o.enable():e.o.disable(),Vh(e)),e.R&&hh(e),e.Fa&&(e.g.streaming.rebufferingGoal?e.Fa.Ea(.25):e.Fa.stop()),e.i&&Xh(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.C&&e.C.configure(e.g.ads),e.M&&e.M.configure(e.g.cmcd),e.va&&e.va.configure(e.g.cmsd),e.Da&&e.Da.configure(e.g.queue),e.m==tf&&e.K.getConfiguration){n=e.K.getConfiguration();var i=!1;t.preferredVideoHdrLevel!=e.g.preferredVideoHdrLevel&&n.hdrLevel!=e.g.preferredVideoHdrLevel&&(n.hdrLevel=e.g.preferredVideoHdrLevel,i=!0),t.preferredVideoLayout!=e.g.preferredVideoLayout&&n.videoLayout!=e.g.preferredVideoLayout&&(n.videoLayout=e.g.preferredVideoLayout,i=!0),t.preferSpatialAudio!=e.g.preferSpatialAudio&&n.spatialAudio!=e.g.preferSpatialAudio&&(n.spatialAudio=e.g.preferSpatialAudio,i=!0),t.preferredVideoRole!=e.g.preferredVideoRole&&n.videoRole!=e.g.preferredVideoRole&&(n.videoRole=e.g.preferredVideoRole,i=!0),i&&(e.K.configure(n),Rh(e))}}function gh(e){return e&&(e=/(\d+)x(\d+)/.exec(e))?{columns:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}function mh(e,t){var n,i;return R((function(r){return 1==r.g?e.m!=tf&&e.m!=nf?r.return(null):(n=e.Ge,e.i&&(n=e.i.imageStreams),(i=n[0])?(null!=t&&(i=n.find((function(e){return e.id==t}))),i?i.segmentIndex?r.A(2):w(r,i.createSegmentIndex(),2):r.return(null)):r.return(null)):r.return(i)}))}function vh(e,t,n,i){var r=t.width||0,a=t.height||0,o=r/i.columns,s=a/i.rows,u=i.columns*i.rows,l=e.j-e.startTime;l=e.B||l/u;var c=e.startTime,d=0,h=0;return u>1&&(h=Math.floor((n-e.startTime)/l),c=e.startTime+h*l,d=h%i.columns*o,h=Math.floor(h/i.columns)*s),i=!1,(n=e.thumbnailSprite)&&(i=!0,s=n.height,d=n.positionX,h=n.positionY,o=n.width),{segment:e,imageHeight:a,imageWidth:r,height:s,positionX:d,positionY:h,startTime:c,duration:l,uris:e.P(),startByte:e.Ic(),endByte:e.Gc(),width:o,sprite:i,mimeType:e.mimeType||t.mimeType,codecs:e.codecs||t.codecs}}function yh(e,t){e.j.D(t,"cuechange",(function(){e.u.remove(0,Math.max(0,e.h.currentTime-e.g.streaming.bufferBehind));for(var n={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},i=[],r=Array.from(t.activeCues||[]),a=(r=p(r)).next();!a.done;a=r.next()){if((a=a.value).endTime===1/0||a.endTime<a.startTime)a=null;else{var o=new _n(a.startTime,a.endTime,a.text);o.line="number"==typeof a.line?a.line:null,a.lineAlign&&(o.lineAlign=a.lineAlign),o.lineInterpretation=a.snapToLines?Nn:1,o.position="number"==typeof a.position?a.position:null,a.positionAlign&&(o.positionAlign=a.positionAlign),o.size=a.size,o.textAlign=a.align,"lr"===a.vertical?o.writingMode="vertical-lr":"rl"===a.vertical&&(o.writingMode="vertical-rl"),a.region&&(o.region.id=a.region.id,o.region.height=a.region.lines,o.region.heightUnits=2,o.region.regionAnchorX=a.region.regionAnchorX,o.region.regionAnchorY=a.region.regionAnchorY,o.region.scroll=a.region.scroll,o.region.viewportAnchorX=a.region.viewportAnchorX,o.region.viewportAnchorY=a.region.viewportAnchorY,o.region.viewportAnchorUnits=Ct,o.region.width=a.region.width,o.region.widthUnits=Ct),xn(o),a=o}a&&((o=e.g.mediaSource.modifyCueCallback)&&o(a,null,n),i.push(a))}e.u.append(i)})),t.mode=document.pictureInPictureElement?"showing":"hidden"}function bh(e){return Array.from(e.h.textTracks).filter((function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label}))}function wh(e){if(!e.h||!e.h.currentTime)return null;var t=e.di();return t?Math.floor(Date.now()-(t.getTime()+1e3*e.h.currentTime)):null}function _h(e,t){var n;return R((function(i){switch(i.g){case 1:return S(i,2),w(i,kc(t,e.J,e.g.streaming.retryParameters),4);case 4:n=i.h,x(i,3);break;case 2:k(i);case 3:if(n)return i.return(n);throw new Ue(1,2,2011,t)}}))}function Sh(e,t,n,i){var r,a,o;return R((function(s){if(1==s.g){r=Kr,(a=Vr([t],i)).method="GET";var u=e.M;try{u.g.enabled&&id(u,a,{ot:bd,su:!0})}catch(e){K("CMCD_TEXT_ERROR","Could not generate text CMCD data.",e)}return w(s,n.request(r,a).promise,2)}return o=s.h,s.return(o.data)}))}function Th(e,t,n,i){var r=gi(n);if(r)return n=r(),e={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},t=Le(t),function(e,t){function n(e){for(var n=e,i=p(t),r=i.next();!r.done;r=i.next())(r=r.value).end&&r.start<e&&(n+=r.end-r.start);return((e=Math.floor(n/3600))<10?"0":"")+e+":"+((i=Math.floor(n/60%60))<10?"0":"")+i+":"+((r=Math.floor(n%60))<10?"0":"")+r+"."+((n=Math.floor(1e3*n%1e3))<100?n<10?"00":"0":"")+n}var i=Lc(e);e="WEBVTT\n\n";for(var r=(i=p(i)).next();!r.done;r=i.next())e+=n((r=r.value).startTime)+" --\x3e "+n(r.endTime)+function(e){var t=[];switch(e.textAlign){case"left":t.push("align:left");break;case"right":t.push("align:right");break;case Cn:t.push("align:middle");break;case"start":t.push("align:start");break;case"end":t.push("align:end")}switch(e.writingMode){case"vertical-lr":t.push("vertical:lr");break;case"vertical-rl":t.push("vertical:rl")}return t.length?" "+t.join(" "):""}(r)+"\n",e+=r.payload+"\n\n";return e}(t=n.parseMedia(t,e,null,[]),i);throw new Ue(2,2,2014,n)}function xh(e){var t=Ql();return t.streaming.failureCallback=function(t){if(e.W()){var n=null;1001==t.code||1002==t.code?(n=1,e.g.streaming.lowLatencyMode&&(n=.1)):1003==t.code&&(n=.1),null!=n&&(t.severity=1,e.fh(n))}},t.textDisplayFactory=function(){if(e.xe){var t=e.h;t=!(t.webkitDisplayingFullscreen||t.webkitPresentationMode&&"inline"!=t.webkitPresentationMode)}else t=!1;return t?new Gc(e.h,e.xe):"track"in document.createElement("track")?new Fc(e):new qc},t}function kh(e){var t=e.Ng();if(e.B&&e.R&&e.G){if(0==e.g.streaming.rebufferingGoal){var n=e.N;n.j=!1,Ou(n)}else(n=e.N).j=t,Ou(n);if(e.M&&(n=e.M,t||n.C||(n.C=!0),n.C&&t&&(n.I=!0,nd(n,"ps",{dd:"r"})),n.J=t),Eh(e),n=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts,e.g.streaming.liveSync.dynamicTargetLatency.enabled&&t&&e.Ke<n){n=e.g.streaming.liveSync.dynamicTargetLatency.maxLatency;var i=e.g.streaming.liveSync.targetLatencyTolerance,r=e.g.streaming.liveSync.dynamicTargetLatency.rebufferIncrement;e.V&&(e.V=Math.min(e.V+ ++e.Ke*r,n-i))}}t=(new Map).set("buffering",t),e.dispatchEvent(Jd("buffering",t))}function Ah(e,t){e.ac.Pa(),e.ac.D(e.h,"timeupdate",(function(){var n=e.h.currentTime,i=e.Qa(),r=e.W(),a=r?e.g.streaming.safeSeekOffset:0;t>0?(!r||t>=1)&&Math.floor(n)>=Math.floor(i.end)&&e.Pd():Math.floor(n)<=Math.floor(i.start+a)&&e.Pd()}))}function Eh(e){if(e.B&&e.R){var t=e.B.g,n="playing";e.R.g==Ha?n="buffering":e.be()?n="ended":e.h.paused&&(n="paused");var i=n;if(null==t.g)t.g={timestamp:Date.now()/1e3,state:i,duration:0},t=!0;else{var r=Date.now()/1e3;t.g.duration=r-t.g.timestamp,t.g.state==i?t=!1:(t.h.push(t.g),t.g={timestamp:r,state:i,duration:0},t=!0)}t&&(n=(new Map).set("newstate",n),e.dispatchEvent(Jd("statechanged",n)))}}function Ih(e){var t=e.h.playbackRate,n=e.W();if(e.g.streaming.vodDynamicPlaybackRate&&!n){var i=e.g.streaming.vodDynamicPlaybackRateLowBufferRate,r=e.Zh();r<=e.g.streaming.vodDynamicPlaybackRateBufferRatio?t!=i&&e.se(i,!1):1==r&&t!==e.N.Tc()&&e.Pd()}if(n&&(n=e.Qa(),Number.isFinite(n.end)&&!(e.h.currentTime<n.start||e.h.paused))){i=e.g.streaming.liveSync.targetLatencyTolerance,r=e.g.streaming.liveSync.dynamicTargetLatency.enabled;var a=e.g.streaming.liveSync.dynamicTargetLatency.stabilityThreshold;if(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled)var o=e.g.streaming.liveSync.targetLatency,s=o+i,u=Math.max(0,o-i),l=e.g.streaming.liveSync.maxPlaybackRate,c=e.g.streaming.liveSync.minPlaybackRate;else e.i&&e.i.serviceDescription&&(o=e.i.serviceDescription.targetLatency,null!=e.i.serviceDescription.targetLatency?s=e.i.serviceDescription.targetLatency+i:null!=e.i.serviceDescription.maxLatency&&(s=e.i.serviceDescription.maxLatency),null!=e.i.serviceDescription.targetLatency?u=Math.max(0,e.i.serviceDescription.targetLatency-i):null!=e.i.serviceDescription.minLatency&&(u=e.i.serviceDescription.minLatency),l=e.i.serviceDescription.maxPlaybackRate||e.g.streaming.liveSync.maxPlaybackRate,c=e.i.serviceDescription.minPlaybackRate||e.g.streaming.liveSync.minPlaybackRate);e.V||"number"!=typeof o||(e.V=o);var d=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts;r&&e.Zb&&null!==e.V&&"number"==typeof o&&e.Ke<d&&Date.now()-e.Zb>1e3*a&&(a=e.g.streaming.liveSync.dynamicTargetLatency.minLatency,e.V=Math.max(e.V-(o-a)/2,a+i),e.Zb=Date.now()),r&&null!==e.V&&(s=e.V+i,u=e.V-i),o=n.end-e.h.currentTime,i=0,e.m==nf&&((r=e.h.buffered).length>0&&(i=r.end(r.length-1),i=Math.max(l,i-n.end))),n=e.g.streaming.liveSync.panicMode,r=1e3*e.g.streaming.liveSync.panicThreshold,a=Date.now()-e.R.h,n&&!c&&(c=e.g.streaming.liveSync.minPlaybackRate),n&&c&&a<=r?t!=c&&e.se(c,!1):null!=s&&l&&o-i>s?(t!=l&&e.se(l,!1),e.Zb=null):null!=u&&c&&o-i<u?(t!=c&&e.se(c,!1),e.Zb=null):t!==e.N.Tc()&&(e.Pd(),e.Zb=Date.now())}}function Ch(e){if(e.h){var t=function(t,n){var i=void 0===i?Number.EPSILON:i;if(t===n)i=!0;else{var r=Math.abs(t-n);i=r<=i||i!==Number.EPSILON&&Math.abs(r-i)<=Number.EPSILON}return!!((i||n>t)&&e.Xf<t)&&(e.Xf=t,!0)},n=e.Qa();if(n=(n=n.end-n.start)>0?e.h.currentTime/n:0,!isNaN(n)){if(t(0,n*=100))var i=Jd("started");else t(25,n)?i=Jd("firstquartile"):t(50,n)?i=Jd("midpoint"):t(75,n)?i=Jd("thirdquartile"):((t(100,n)||n>100)&&(i=Jd("complete")),e.g&&e.g.playRangeEnd!=1/0&&e.be()&&e.h.pause());i&&e.dispatchEvent(i)}}}function Mh(e){try{Wa(e.Ae,e.i)}catch(t){return zh(e,t),!1}var t=tr(e.i.variants);return t=e.K.create(t),"boolean"!=typeof(e=e.o.setVariants(Array.from(t.values())))||e}function Ph(e,t){if(t=void 0!==t&&t,Mh(e)){if(!e.g.abr.enabled){var n=e.K;if("function"!=typeof n.getLastAdaptationSet&&(ce("AdaptationSetCriteria w/o getLastAdaptationSet","Please use an AdaptationSetCriteria with getLastAdaptationSet."),n.getLastAdaptationSet=function(){return null}),(n=n.getLastAdaptationSet())&&(n=Array.from(n.values())).length){var i=e.l.o;if(i&&i.video&&(n=n.find((function(e){return e.video==i.video}))))return n}}return e.o.chooseVariant(t)}return null}function Rh(e,t,n,i,r){t=void 0===t||t,n=void 0===n?0:n,i=void 0!==i&&i,r=void 0===r||r;var a=Ph(e);a&&Dh(e,a,r,t,n,i)}function Dh(e,t,n,i,r,a){a=void 0!==a&&a;var o=e.l.o;if(t==o)i&&ul(e.l,t,i,r,!0);else{var s=e.B.h;if(s.h!=t&&(s.h=t,s.g.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})),ul(e.l,t,i,r,a,n),i=null,o&&(i=Wi(o)),(o=Wi(t)).active=!0,e.T&&(r=e.T,t=t.video)){switch(t.dependencyStream&&(t=t.dependencyStream),a=0,s=-1,t.mimeType){case"video/webm":a=1;break;case"video/mp4":a=2}switch(e.ai()){case"DASH":s=1;break;case"HLS":s=0}r.g&&(r.g.setLevelSwitching(t.id,!0),r.g.setContainerFormat(a),r.j||r.g.setStreamingFormat(s))}n?Yh(e,n=Jd("adaptation",n=(new Map).set("oldTrack",i).set("newTrack",o))):jh(e,i,o),Uh(e,i,o)}}function Lh(e,t){var n=Array.from(e.h.audioTracks).find((function(e){return e.enabled}));if(t.enabled=!0,n){t.id!==n.id&&(n.enabled=!1);var i=Nh(e);jh(e,n=Zi(n,i),t=Zi(t,i)),Uh(e,n,t)}}function Nh(e){return e.h&&e.h.videoTracks?Array.from(e.h.videoTracks).find((function(e){return e.selected})):null}function Oh(e){Yh(e,Jd("trackschanged")),Fh(e)}function jh(e,t,n){Yh(e,t=Jd("variantchanged",t=(new Map).set("oldTrack",t).set("newTrack",n)))}function Uh(e,t,n){var i=!1;t&&t.audioId==n.audioId&&t.audioGroupId==n.audioGroupId||(i=!0),i&&Fh(e)}function Fh(e){Yh(e,Jd("audiotrackschanged"))}function Bh(e){Yh(e,Jd("textchanged"))}function Hh(e){Yh(e,Jd("texttrackvisibility"))}function Vh(e){e.g.abr.enabled||Gh(e),Yh(e,Jd("abrstatuschanged",(new Map).set("newStatus",e.g.abr.enabled)))}function qh(e){var t=e.Kc().find((function(e){return e.active}));t&&e.u&&e.u.setTextLanguage&&e.u.setTextLanguage(t.language)}function Gh(e,t){if(t=void 0===t||t,e.m==tf){e.De.stop();for(var n=p(e.i.variants),i=n.next();!i.done;i=n.next())i.value.disabledUntilTime=0;t&&Mh(e)}}function zh(e,t){var n,i,r,a;return R((function(o){switch(o.g){case 1:if(e.m==Zh)return o.return();if(1===t.severity&&e.B.M++,n=!0,!(e.Sa&&e.i&&e.l)||3016!=t.code&&3014!=t.code&&3015!=t.code&&3024!=t.code&&3018!=t.code){o.A(2);break}return"WEBKIT"===ae().Ha()&&3016==t.code?o.return():(S(o,3),w(o,Ml(e.l),5));case 5:i=o.h,n=!i,i&&(r=Jd("mediasourcerecovered"),e.dispatchEvent(r)),x(o,2);break;case 3:k(o),n=!0;case 2:if(!n)return o.return();2===t.severity&&Gh(e,!1),a=Jd("error",(new Map).set("detail",t)),e.dispatchEvent(a),a.defaultPrevented&&(t.handled=!0),_(o)}}))}function $h(e,t,n,i){i=void 0===i?e:i,e=(new Map).set("detail",{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,timescale:n.timescale,eventElement:n.eventElement,eventNode:n.eventNode}),i.dispatchEvent(Jd(t,e))}function Kh(e,t,n,i){i=void 0!==i&&i,t=(new Map).set("mediaQuality",{bandwidth:t.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate,height:t.height,mimeType:t.mimeType,channelsCount:t.channelsCount,pixelAspectRatio:t.pixelAspectRatio,width:t.width,label:t.label,roles:t.roles,language:t.language}).set("position",n),e.dispatchEvent(Jd(i?"audiotrackchanged":"mediaqualitychanged",t))}function Wh(e,t){if(t=void 0===t||t,!e.h.error)return t?new Ue(2,3,3016):null;var n=e.h.error.code;return t||1!=n?((t=e.h.error.msExtendedCode)&&(t<0&&(t+=4294967296),t=t.toString(16)),new Ue(2,3,3016,n,t,e.h.error.message)):null}function Xh(e,t,n){t>0&&(e.W()||e.Si(t)),n<(t=e.getDuration())&&(e.W()||e.Ab(n))}function Yh(e,t){R((function(n){if(1==n.g)return w(n,Promise.resolve(),2);e.m!=Zh&&e.dispatchEvent(t),_(n)}))}function Jh(e){for(var t=new Set,n=(e=p(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(Pi(n.language)):t.add("und");return t}function Qh(e){for(var t=new Map,n=new Map,i=0;i<e.length;i++){var r=e[i],a="und",o=[];r.language&&(a=Pi(r.language)),(o="variant"==r.type?r.audioRoles:r.roles)&&o.length||(o=[""]),t.has(a)||t.set(a,new Set);for(var s=(o=p(o)).next();!s.done;s=o.next())s=s.value,t.get(a).add(s),r.label&&(n.has(a)||n.set(a,new Map),n.get(a).set(s,r.label))}var u=[];return t.forEach((function(e,t){for(var i=(e=p(e)).next();!i.done;i=e.next()){i=i.value;var r=null;n.has(t)&&n.get(t).has(i)&&(r=n.get(t).get(i)),u.push({language:t,role:i,label:r})}})),u}Kd.prototype.release=function(){this.h.length>0?this.h.shift()():this.g=null},h(Xd,Or),(i=Xd.prototype).destroy=function(){var e,t=this;return R((function(n){switch(n.g){case 1:return t.m==Zh?n.return():(Yd(t),e=t.detach(),t.m=Zh,w(n,e,2));case 2:return w(n,t.ng(),3);case 3:if(t.Ie&&(t.Ie.release(),t.Ie=null),t.ye&&(t.ye.release(),t.ye=null),t.j&&(t.j.release(),t.j=null),t.ac&&(t.ac.release(),t.ac=null),t.yc&&(t.yc.release(),t.yc=null),t.Ce=null,t.g=null,t.B=null,t.xe=null,t.M=null,t.va=null,!t.J){n.A(4);break}return w(n,t.J.destroy(),5);case 5:t.J=null;case 4:t.o&&(t.o.release(),t.o=null),t.Da&&(t.Da.destroy(),t.Da=null),Or.prototype.release.call(t),_(n)}}))},i.fc=function(e,t){t=void 0===t||t;var n,i,r,a=this;return R((function(o){switch(o.g){case 1:if(a.m==Zh)throw new Ue(2,7,7e3);if(n=a.h&&a.h==e,!a.h||a.h==e){o.A(2);break}return w(o,a.detach(),2);case 2:return w(o,eh(a,"attach"),4);case 4:if(o.h)return o.return();if(S(o,5,6),n||(Zd(a,"attach"),i=function(){var e=Wh(a,!1);e&&zh(a,e)},a.ye.D(e,"error",i),a.h=e,a.M&&a.M.setMediaElement(e)),ae(),!t||!Xv()||a.H){o.A(6);break}return w(o,oh(a),6);case 6:A(o),a.ma.release(),E(o,0);break;case 5:return r=k(o),w(o,a.detach(),10);case 10:throw r}}))},i.jj=function(e){this.Kh=e},i.detach=function(e){e=void 0!==e&&e;var t=this;return R((function(n){if(1==n.g){if(t.m==Zh)throw new Ue(2,7,7e3);return w(n,t.Bc(!1,e),2)}if(3!=n.g)return w(n,eh(t,"detach"),3);if(n.h)return n.return();try{t.h&&(t.ye.Pa(),t.h=null),Zd(t,"detach"),t.C&&!e&&t.C.release()}finally{t.ma.release()}_(n)}))},i.Bc=function(t,n){t=void 0===t||t,n=void 0!==n&&n;var i,r,a,o,s,u,l,c,d,h,f,g,m,v,y,b=this;return R((function(_){switch(_.g){case 1:return b.m!=Zh&&(b.m=ef),w(_,eh(b,"unload"),2);case 2:return _.h?_.return():(T(_,3),b.Sa=!1,Zd(b,"unload"),Yd(b),i=b.ze.map((function(e){return e()})),b.ze=[],w(_,Promise.all(i),5));case 5:if(b.dispatchEvent(Jd("unloading")),b.we&&(b.we.release(),b.we=null),b.ya&&(b.ya.release(),b.ya=null),b.ib&&(b.ib.release(),b.ib=null),b.h&&(b.j.Pa(),b.ac.Pa()),b.De.stop(),b.ob&&(b.ob.release(),b.ob=null),b.Fa&&(b.Fa.stop(),b.Fa=null),!b.I){_.A(6);break}return w(_,b.I.stop(),7);case 7:b.I=null,b.xc=null;case 6:if(b.o&&b.o.stop(),!b.l){_.A(8);break}return w(_,b.l.destroy(),9);case 9:b.l=null;case 8:if(b.N&&(b.N.release(),b.N=null),b.G&&(b.G.release(),b.G=null),"webkit"!==e.shakaMediaKeysPolyfill||!b.F){_.A(10);break}return w(_,b.F.destroy(),11);case 11:b.F=null;case 10:if(!b.H){_.A(12);break}return w(_,b.H.destroy(),13);case 13:b.H=null;case 12:if(b.C&&!n&&b.C.onAssetUnload(),b.oa&&!n&&(b.oa.destroy(),b.oa=null),n||b.$f.stop(),b.M&&function(e){e.F.clear(),e.C=!1,e.J=!0,e.I=!1,e.o=!1,e.u=0,e.B=0,e.H=0,e.K={request:!1,response:!1,event:!1},Qc(e),e.m={},e.h=null,e.i.Pa()}(b.M),b.va&&(b.va.g=null),!b.u){_.A(14);break}return w(_,b.u.destroy(),15);case 15:b.u=null;case 14:if(b.$=!1,b.h){for(r=p(b.Yf),a=r.next();!a.done;a=r.next())(o=a.value).src.startsWith("blob:")&&URL.revokeObjectURL(o.src),o.remove();b.Yf=[],Qo(b.h)&&b.h.load()}if(!b.F){_.A(16);break}return w(_,b.F.destroy(),17);case 17:b.F=null;case 16:if(b.Ta&&b.X!=b.Ta.rd()&&(b.Ta.j||b.Ta.destroy(),b.Ta=null),b.X=null,b.aa=null,b.R=null,b.i){for(s=p(b.i.variants),u=s.next();!u.done;u=s.next())for(l=u.value,c=p([l.audio,l.video]),d=c.next();!d.done;d=c.next())(h=d.value)&&h.segmentIndex&&h.segmentIndex.release();for(f=p(b.i.textStreams),g=f.next();!g.done;g=f.next())(m=g.value).segmentIndex&&m.segmentIndex.release()}for(b.g&&b.g.streaming.clearDecodingCache&&(lr.clear(),Tr.clear()),b.i=null,b.B=new sc,b.Jh=null,b.Zb=null,b.V=null,b.Ke=-1,b.Ge=[],v=p(b.uc.values()),y=v.next();!y.done;y=v.next())y.value.stop();b.uc.clear(),b.kb=[],b.Xf=-1,b.J&&b.J.Qh(),kh(b);case 3:A(_),b.ma.release(),E(_,4);break;case 4:if(ae(),t&&Xv()&&!b.H&&b.h)return w(_,oh(b),0);_.A(0)}}))},i.kl=function(e){this.O=e},i.load=function(t,n,i){n=void 0===n?null:n;var r,a,o,s,u,l,c,d,h,f,g,m,v,y,b=this;return R((function(x){switch(x.g){case 1:if(b.m==Zh)throw new Ue(2,7,7e3);if(r=null,a="",t instanceof dc){if(t.j)throw new Ue(2,7,7006);a=(r=t).rd()||""}else a=t||"";return w(x,Wd(b.ma,"load"),2);case 2:if(b.ma.release(),!b.h)throw new Ue(2,7,7002);if(!b.X){x.A(3);break}return b.X=a,w(x,b.Bc(!1),3);case 3:if(o=++b.Je,s=function(){return R((function(e){if(1==e.g)return b.Je==o?e.A(0):r?w(e,r.destroy(),3):e.A(3);throw new Ue(2,7,7e3)}))},u=function(e,t){return R((function(n){switch(n.g){case 1:return T(n,2),w(n,Wd(b.ma,t),4);case 4:return w(n,s(),5);case 5:return w(n,e(),6);case 6:return w(n,s(),7);case 7:r&&b.g&&(r.g=b.g);case 2:A(n),b.ma.release(),E(n,0)}}))},S(x,5,6),null==n&&r&&(n=r.getStartTime()),b.O=n,b.Sa=!1,b.dispatchEvent(Jd("loading")),r){i=r.V,x.A(8);break}if(i){x.A(8);break}return w(x,u((function(){return R((function(e){if(1==e.g)return w(e,rh(b,a),2);i=e.h,_(e)}))}),"guessMimeType_"),8);case 8:if(l=!!r,r){fc(r,b),b.B=r.getStats(),x.A(11);break}return w(x,nh(b,a,n,i,!0,b.g),12);case 12:(r=x.h)?(r.F=!1,fc(r,b),b.B=r.getStats(),r.start(),r.B.catch((function(){}))):b.B=new sc;case 11:return c=!r,d=Date.now()/1e3,b.B=r?r.getStats():new sc,b.X=a,b.aa=i||null,kh(b),h=function(){var e=b.h?b.h.buffered:null;return{start:zo(e)||0,end:$o(e)||0}},b.ya=new Vu(h),b.ya.addEventListener("regionadd",(function(e){uh(b,e.region,"metadataadded")})),c?w(x,u((function(){return R((function(e){return w(e,function(e,t){var n,i,r;return R((function(a){return 1==a.g?(n=Date.now()/1e3,i=!0,e.F=e.md({tc:e.J,onError:function(t){zh(e,t)},vf:function(){},onExpirationUpdated:function(){var t=Jd("expirationupdated");e.dispatchEvent(t)},onEvent:function(t){e.dispatchEvent(t),"drmsessionupdate"==t.type&&i&&(i=!1,e.B.m=Date.now()/1e3-n)}}),e.F.configure(e.g.drm),r=ur([t]),e.F.O=!0,w(a,ya(e.F,[r],[]),2)):w(a,e.F.fc(e.h),0)}))}(b,i),0)}))}),"initializeSrcEqualsDrmInner_"),23):(b.ib=new Vu(h),w(x,u((function(){return R((function(e){if(1==e.g)return w(e,Promise.race([r.ma,r.B]),2);b.xc=r.H;var t=r;t.oa=!0,b.I=t.l,b.i=r.Hg(),_(e)}))}),"waitForFinish"),15));case 15:if(b.H){x.A(16);break}return w(x,u((function(){return R((function(e){return w(e,oh(b),0)}))}),"initializeMediaSourceEngineInner_"),16);case 16:return b.i&&b.i.textStreams.length&&(b.u.enableTextDisplayer?b.u.enableTextDisplayer():ce("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method!')),w(x,u((function(){return R((function(e){return w(e,r.B,0)}))}),"waitForFinish"),18);case 18:if(b.g=r.getConfiguration(),b.Ae=r.G,b.I&&b.I.setMediaElement&&b.h&&b.I.setMediaElement(b.h),b.we=function(e){return e.va=!0,e.I}(r),b.ue=r.Fa,(f=r.C)&&(b.K=f),l&&b.h&&"AUDIO"===b.h.nodeName&&(function(e){for(var t=p(e.i.variants),n=t.next();!n.done;n=t.next())(n=n.value).video&&(n.video.closeSegmentIndex(),n.video=null),n.bandwidth=n.audio&&n.audio.bandwidth?n.audio.bandwidth:0;e.i.variants=e.i.variants.filter((function(e){return e.audio}))}(b),b.configure("manifest.disableVideo",!0)),r.i){x.A(19);break}return w(x,u((function(){return R((function(e){return w(e,mc(r,b.h),0)}))}),"drmEngine_.init"),19);case 19:return b.F=function(e){return e.aa=!0,e.i}(r),w(x,u((function(){return R((function(e){return w(e,b.F.fc(b.h),0)}))}),"drmEngine_.attach"),21);case 21:return g=b.g.abrFactory,b.o&&b.Ce==g||(b.Ce=g,b.o&&b.o.release(),b.o=g(),"function"!=typeof b.o.setMediaElement&&(ce("AbrManager w/o setMediaElement","Please use an AbrManager with setMediaElement function."),b.o.setMediaElement=function(){}),"function"!=typeof b.o.setCmsdManager&&(ce("AbrManager w/o setCmsdManager","Please use an AbrManager with setCmsdManager function."),b.o.setCmsdManager=function(){}),"function"!=typeof b.o.trySuggestStreams&&(ce("AbrManager w/o trySuggestStreams","Please use an AbrManager with trySuggestStreams function."),b.o.trySuggestStreams=function(){}),b.o.configure(b.g.abr)),m=function(e){return e.xa=!0,e.M}(r),v=r.o,w(x,u((function(){return R((function(t){return w(t,function(t,n,i,r){var a,o,s,u,l,c,d,h,f,g,m,v,y,b,S,T,x,k,A,E,I,C,M,P,D,L,N;return R((function(O){switch(O.g){case 1:Zd(t,"load"),a=t.h,t.N=new Nu({Ye:function(){return a.playbackRate},Tc:function(){return a.defaultPlaybackRate},ph:function(e){a.playbackRate=e},ui:function(e){a.currentTime+=e}}),sh(t,a,n),"onchange"in e.screen&&t.j.D(e.screen,"change",(function(){if(t.K.getConfiguration){var e=t.K.getConfiguration();"AUTO"==e.hdrLevel?Mh(t):"AUTO"==t.g.preferredVideoHdrLevel&&t.g.abr.enabled&&(e.hdrLevel="AUTO",t.K.configure(e),Mh(t))}})),o=!1,s=p(t.i.variants);for(u=s.next();!u.done;u=s.next())l=u.value,(c=l.video&&l.video.dependencyStream)&&(o=gt(c));!function(e,t,n){n||t.lcevc.enabled?(Yd(e),null==e.T&&(e.T=new ht(e.h,e.Kh,t.lcevc,n),e.H&&(e.H.C=e.T))):Yd(e)}(t,t.g,o),t.Fd=t.g.preferredTextLanguage,t.Md=t.g.preferredTextRole,t.Ld=t.g.preferForcedSubs,Xh(t.i.presentationTimeline,t.g.playRangeStart,t.g.playRangeEnd),t.o.init((function(e,n,i){t.i&&t.l&&e!=t.l.o&&Dh(t,e,!0,void 0!==n&&n,void 0===i?0:i)})),t.o.setMediaElement(a),t.o.setCmsdManager(t.va),t.l=function(e){return new ol(e.i,{lc:function(){return e.G?e.G.He():0},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},Ob:function(){return e.Ob()},video:e.h,Z:e.H,tc:e.J,onError:function(t){return zh(e,t)},onEvent:function(t){return e.dispatchEvent(t)},wf:function(t,n,i){var r=t.startTime,a=t.endTime,o=n.type;if(o!=ut){if(e.G){e.G.xi();var s=js(e.H,o);!e.W()&&e.h.paused&&!e.h.seeking&&null!=s&&s>0&&e.G.He()<s&&e.G.Wf(s)}fh(e)}i=(new Map).set("start",r).set("end",a).set("contentType",o).set("isMuxed",i),e.dispatchEvent(Jd("segmentappended",i)),e.o&&n.fastSwitching&&t.Xc&&t.ee&&e.o.trySuggestStreams()},Ck:function(t,n){(n=n.xd)&&e.ue&&function(e,t,n){var i=function(e,t){var n=e.g.get(t);return n||(n={me:[],lg:null,contentType:t},e.g.set(t,n)),n}(e,t.contentType);!function(e,t){if((e=e.h()[t.contentType])&&e.length>0){var n=e[0].start,i=e[e.length-1].end,r=t.me;t.me=r.filter((function(e,t){return!(e.position<=n&&t+1<r.length&&r[t+1].position<=n||e.position>=i)}))}else t.me=[]}(e,i),e={xd:t,position:n},(t=(i=i.me).findIndex((function(e){return e.position>=n})))>=0?i.splice(t,i[t].position==n?1:0,e):i.push(e)}(e.ue,n,t)},Oh:function(t,n){var i=e.F;if(i.h.parseInbandPsshEnabled&&!i.H&&["audio","video"].includes(t)){t=new ga(Le(n)),n=0;for(var r=p(t.data),a=r.next();!a.done;a=r.next())n+=a.value.length;if(0==n)i=Promise.resolve();else{for(n=new Uint8Array(n),r=0,a=(t=p(t.data)).next();!a.done;a=t.next())a=a.value,n.set(a,r),r+=a.length;Sa(i,"cenc",n),i=i.m}}else i=Promise.resolve();return i},disableStream:function(t,n){return e.disableStream(t,n)},al:function(t,n){return!(e.g.abr.enabled&&n.fastSwitching&&t.Xc&&t.ee)}})}(t),t.l.configure(t.g.streaming),t.m=tf,t.dispatchEvent(Jd("streaming")),d=i;case 2:for((f=t.l.o)||d||(d=Ph(t,!0)),g=[],m=p([(h=f||d).video,h.audio]),v=m.next();!v.done;v=m.next())(y=v.value)&&!y.segmentIndex&&(g.push(y.createSegmentIndex()),y.dependencyStream&&g.push(y.dependencyStream.createSegmentIndex()));if(!(g.length>0)){O.A(4);break}return w(O,Promise.all(g),4);case 4:if(!h||0!=h.disabledUntilTime){O.A(2);break}if(t.I&&t.I.onInitialVariantChosen&&t.I.onInitialVariantChosen(h),t.i.isLowLatency&&(t.g.streaming.lowLatencyMode?t.configure(t.Zf):$("Low-latency live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.")),t.M&&(function(e,t){e.o=t,e.o?e.l==xd?e.l=kd:e.l==Ad&&(e.l=Ed):e.l==kd?e.l=xd:e.l==Ed&&(e.l=Ad)}(t.M,t.i.isLowLatency&&t.g.streaming.lowLatencyMode),function(e,t){if(e.g&&e.g.enabled&&(nd(e,"ps",{dd:"d"}),e.h&&e.h.autoplay)){var n=e.h.play();n&&n.then((function(){e.H=t})).catch((function(){e.H=0}))}}(t.M,1e3*n)),Xh(t.i.presentationTimeline,t.g.playRangeStart,t.g.playRangeEnd),function(e,t,n){e.j.presentationTimeline.W()||(e.aa=t,e.$=n)}(t.l,t.g.playRangeStart,t.g.playRangeEnd),t.Sa=!0,t.dispatchEvent(Jd("canupdatestarttime")),b=function(e){t.G=function(e,t){return new ku(e.h,e.i,e.g.streaming,t,(function(){e.ob&&Uu(e.ob,!e.G.Hh()),e.l&&e.l.bd(),e.R&&fh(e,"seeking")}),(function(t){return e.dispatchEvent(t)}))}(t,e),t.ob=function(e,t){var n=e.W()||"number"==typeof t&&t>0;t=new wc(e.we,n),t.addEventListener("enter",(function(t){$h(e,"timelineregionenter",t.region)})),t.addEventListener("exit",(function(t){$h(e,"timelineregionexit",t.region)})),t.addEventListener("skip",(function(t){var n=t.region;t.seeking||($h(e,"timelineregionenter",n),$h(e,"timelineregionexit",n))}));var i=new wc(e.ya,n);i.addEventListener("enter",(function(t){uh(e,t.region,"metadata")})),n=new wc(e.ib,n),n.addEventListener("enter",(function(t){t=(new Map).set("detail",t.region.emsg),e.dispatchEvent(Jd("emsg",t))}));var r=new ju(e.h);return r.g.add(t),r.g.add(i),r.g.add(n),e.ue&&r.g.add(e.ue),r}(t,e),dh(t,a,!1)},t.g.streaming.startAtSegmentBoundary||(null==(S=t.O)&&t.i.startTime&&(S=t.i.startTime),b(S)),f){O.A(7);break}if(!t.g.streaming.startAtSegmentBoundary){O.A(8);break}return T=t.i.presentationTimeline,t.O instanceof Date&&(k=T.m||T.i,null!=(A=t.O.getTime()/1e3-k)&&(x=A)),null==x&&(x="number"==typeof t.O?t.O:t.h.currentTime),null==t.O&&t.i.startTime&&(x=t.i.startTime),E=T.Xb(),I=T.Gb(),x<E?x=E:x>I&&(x=I),w(O,function(e,t){var n,i,r,a,o;return R((function(s){return 1==s.g?(n=e.audio,i=e.video,r=function(e,t){var n,i,r;return R((function(a){return 1==a.g?e?e.segmentIndex?a.A(2):w(a,e.createSegmentIndex(),2):a.return(null):(i=(n=e.segmentIndex.Vb(t))?n.next().value:null)?(r=i.startTime,a.return(r)):a.return(null)}))},w(s,r(n,t),2)):3!=s.g?(a=s.h,w(s,r(i,t),3)):null!=(o=s.h)&&null!=a?s.return(Math.max(o,a)):null!=o?s.return(o):null!=a?s.return(a):s.return(t)}))}(d,x),9);case 9:C=O.h,b(C);case 8:Dh(t,d,!0,!1,0);case 7:return t.G.ready(),t.Kc().find((function(e){return e.active}))||((M=nr(t.i.textStreams,t.Fd,t.Md,t.Ld)[0]||null)&&oc(t.B.h,M,!0),d&&(M?(sr(d.audio,M,t.g)&&(t.$=!0),t.$&&t.u.setTextVisibility(!0)):(t.$=!1,t.u.setTextVisibility(!1)),Hh(t)),M&&(t.g.streaming.alwaysStreamText||t.Og())&&(ll(t.l,M),qh(t))),w(O,t.l.start(r),10);case 10:t.g.abr.enabled&&(t.o.enable(),Vh(t)),Oh(t),t.i.variants.some((function(e){return e.primary})),((P=t.W())&&(t.g.streaming.liveSync&&t.g.streaming.liveSync.enabled||t.i.serviceDescription||t.g.streaming.liveSync.panicMode)||t.g.streaming.vodDynamicPlaybackRate)&&(D=function(){return Ih(t)},t.j.D(a,"timeupdate",D)),P||(L=function(){return Ch(t)},t.j.D(a,"timeupdate",L),Ch(t),t.i.nextUrl&&(t.g.streaming.preloadNextUrlWindow>0&&(N=function(){var e;return R((function(n){if(1==n.g)return e=t.Qa().end-t.h.currentTime,!isNaN(e)&&e<=t.g.streaming.preloadNextUrlWindow?(t.j.Ma(a,"timeupdate",N),w(n,t.preload(t.i.nextUrl),4)):n.A(0);t.Ta=n.h,_(n)}))},t.j.D(a,"timeupdate",N)),t.j.D(a,"ended",(function(){t.load(t.Ta||t.i.nextUrl)})))),t.C&&t.C.onManifestUpdated(P),_(O)}}))}(b,d,v,m),0)}))}),"loadInner_"),22);case 22:!function(e){if(e.J)for(var t=p(e.J),n=t.next();!n.done;n=t.next())(n=n.value)();e.J=null}(r),b.aa&&ae().aj()&&ci(b.aa)&&function(t,n,i){t.g&&e.ManagedMediaSource&&t.i&&t.B.useSourceElements&&(t.F&&t.g.removeChild(t.F),t.F=Jo(n,i),t.g.appendChild(t.F),t.g.disableRemotePlayback=!1)}(b.H,b.X,b.aa),x.A(14);break;case 23:return w(x,u((function(){return R((function(e){return w(e,function(e,t,n){var i,r,a,o,s,u,l,c,d,h,f,g;return R((function(m){switch(m.g){case 1:if(Zd(e,"src-equals"),i=e.h,e.G=new Su(i),r=!1,e.ze.push((function(){r=!0})),e.dispatchEvent(Jd("canupdatestarttime")),null!=e.O&&e.G.Wf(e.O),e.ob=function(e,t){t=new wc(e.ya,t instanceof Date||t>0),t.addEventListener("enter",(function(t){uh(e,t.region,"metadata")}));var n=new ju(e.h);return n.g.add(t),n}(e,e.O||0),e.N=new Nu({Ye:function(){return i.playbackRate},Tc:function(){return i.defaultPlaybackRate},ph:function(e){i.playbackRate=e},ui:function(e){i.currentTime+=e}}),dh(e,i,!0),i.textTracks&&(ah(e),a=function(t){if(!(e.u instanceof Fc)){var n=bh(e).find((function(e){return"disabled"!==e.mode}));n&&(n.mode=t?"showing":"hidden"),e.u instanceof Hc&&(n=function(e){return Array.from(e.h.textTracks).find((function(e){return"Shaka Player TextTrack"==e.label}))}(e))&&(n.mode=!t&&e.u.isTextVisible()?"showing":"hidden")}},e.j.D(i,"enterpictureinpicture",(function(){return a(!0)})),e.j.D(i,"leavepictureinpicture",(function(){return a(!1)})),i.remote?(e.j.D(i.remote,"connect",(function(){return a(!1)})),e.j.D(i.remote,"connecting",(function(){return a(!1)})),e.j.D(i.remote,"disconnect",(function(){return a(!1)}))):"webkitCurrentPlaybackTargetIsWireless"in i&&e.j.D(i,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return a(!1)})),((o=i).webkitPresentationMode||o.webkitSupportsFullscreen)&&e.j.D(o,"webkitpresentationmodechanged",(function(){o.webkitPresentationMode?a("inline"!==o.webkitPresentationMode):o.webkitSupportsFullscreen&&a(o.webkitDisplayingFullscreen)}))),sh(e,i,t),s=function(e,t,n){try{if(!e.g.enabled)return t;var i=td(e);e:{switch(n.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":var r=gd;break e;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":r=vd;break e;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":r=pd;break e}r=void 0}return i.ot=r,i.su=!0,fd(t,dd(i))}catch(e){return K("CMCD_SRC_ERROR","Could not generate src CMCD data.",e),t}}(e.M,e.X,n),!s.includes("#t=")&&(e.g.playRangeStart>0||isFinite(e.g.playRangeEnd))&&(s+="#t=",e.g.playRangeStart>0&&(s+=e.g.playRangeStart),isFinite(e.g.playRangeEnd)&&(s+=","+e.g.playRangeEnd)),!e.H){m.A(2);break}return w(m,e.H.destroy(),3);case 3:e.H=null;case 2:return Qo(i),i.src=s,"TV"==(u=ae()).Ua()&&i.load(),"none"!=i.preload&&!i.autoplay&&ci(n)&&"WEBKIT"===u.Ha()&&i.load(),e.m=nf,e.dispatchEvent(Jd("streaming")),l=new Ar,fu(i,HTMLMediaElement.HAVE_METADATA,e.j,(function(){e.G.ready(),e.aa&&ci(e.aa)||l.resolve()})),c=function(){return new Promise((function(t){var n=new Si(t);e.j.D(i.textTracks,"change",(function(){return n.ia(.5)})),n.ia(.5)}))},fu(i,HTMLMediaElement.HAVE_CURRENT_DATA,e.j,(function(){var t,n,i,a,o;return R((function(s){if(1==s.g)return w(s,c(),2);if(r)return s.return();if(function(e){var t=e.g.preferredAudioLanguage;""!=t&&e.Ni(t,e.g.preferredAudioRole)}(e),(t=bh(e)).some((function(e){return"showing"===e.mode}))&&(e.$=!0,e.u.setTextVisibility(!0)),!(e.u instanceof Fc))for(t.length&&(e.u.enableTextDisplayer?e.u.enableTextDisplayer():ce("Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method')),n=!1,i=p(t),a=i.next();!a.done;a=i.next())"disabled"!==(o=a.value).mode&&(n?(o.mode="disabled",$("Found more than one enabled text track, disabling it",o)):(yh(e,o),n=!0));!function(e){var t=e.g.preferredTextLanguage;""!=t&&e.jh(t,e.g.preferredTextRole,e.g.preferForcedSubs)}(e),e.aa&&ci(e.aa)&&l.resolve(),_(s)}))})),i.error?l.reject(Wh(e)):"none"==i.preload&&($('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),l.resolve()),e.j.Ba(i,"error",(function(){l.reject(Wh(e))})),w(m,Ai(e.g.streaming.loadTimeout,l),4);case 4:((d=e.W())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(h=function(){return Ih(e)},e.j.D(i,"timeupdate",h)),d||(f=function(){return Ch(e)},e.j.D(i,"timeupdate",f),Ch(e)),e.C&&(e.C.onManifestUpdated(d),d&&(g=e.Qa().end,e.j.D(i,"progress",(function(){var t=e.Qa().end;g!=t&&(e.C.onManifestUpdated(e.W()),g=t)})))),e.Sa=!0,_(m)}}))}(b,d,i),0)}))}),"srcEqualsInner_"),14);case 14:b.dispatchEvent(Jd("loaded"));case 6:if(A(x),!r){x.A(25);break}return w(x,r.destroy(),25);case 25:b.Ta=null,E(x,0);break;case 5:if(!(y=k(x))||7e3==y.code){x.A(27);break}return w(x,b.Bc(!1),27);case 27:throw y}}))},i.dj=function(e,t){e=void 0===e||e,t=void 0!==t&&t;var n,i=this;return R((function(r){return 1==r.g?w(r,th(i),2):3!=r.g?(n=r.h,w(r,i.Bc(e,t),3)):r.return(n)}))},i.Uh=function(e,t){e=void 0!==e&&e,t=void 0!==t&&t;var n,i=this;return R((function(r){return 1==r.g?w(r,th(i,t),2):3!=r.g?(n=r.h,w(r,i.detach(e),3)):r.return(n)}))},i.preload=function(e,t,n,i){t=void 0===t?null:t;var r,a,o=this;return R((function(s){return 1==s.g?(ec(r=xh(o),i||o.g,xh(o)),w(s,nh(o,e,t,n,!1,r),2)):((a=s.h)?a.start():zh(o,new Ue(2,7,7005)),s.return(a))}))},i.ng=function(){var e,t,n,i,r=this;return R((function(a){for(e=[],t=p(r.Ee),n=t.next();!n.done;n=t.next())(i=n.value).j||e.push(i.destroy());return r.Ee=[],w(a,Promise.all(e),0)}))},i.Lk=function(){for(var e=this.ma;e.g;)e.release()},i.md=function(e){return new va(e)},i.configure=function(e,t){var n=this.getConfiguration();if(2==arguments.length&&"string"==typeof e&&(e=jl(e,t)),"preferredVariantRole"in e&&(ce("preferredVariantRole configuration","Please Use preferredAudioRole instead."),e.preferredAudioRole=e.preferredVariantRole,delete e.preferredVariantRole),e.streaming&&"forceTransmuxTS"in e.streaming&&(ce("streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(ce("streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&"useNativeHlsOnSafari"in e.streaming){ce("streaming.useNativeHlsOnSafari configuration","Please Use streaming.useNativeHlsForFairPlay or streaming.preferNativeHls instead.");var i=ae();e.streaming.preferNativeHls=e.streaming.useNativeHlsOnSafari&&"WEBKIT"===i.Ha(),delete e.streaming.useNativeHlsOnSafari}if(e.streaming&&"boolean"==typeof e.streaming.liveSync&&(ce("streaming.liveSync","Please Use streaming.liveSync.enabled instead."),i=e.streaming.liveSync,e.streaming.liveSync={},e.streaming.liveSync.enabled=i),e.streaming&&(!e.streaming.liveSync||!("targetLatency"in e.streaming.liveSync))&&("liveSyncMinLatency"in e.streaming||"liveSyncMaxLatency"in e.streaming)){i=e.streaming.liveSyncMinLatency||0;var r=Math.abs((e.streaming.liveSyncMaxLatency||1)-i)/2;e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=i+r,e.streaming.liveSync.targetLatencyTolerance=r}if(e.streaming&&"liveSyncMaxLatency"in e.streaming&&(ce("streaming.liveSyncMaxLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMaxLatency),e.streaming&&"liveSyncMinLatency"in e.streaming&&(ce("streaming.liveSyncMinLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMinLatency),e.streaming&&"liveSyncTargetLatency"in e.streaming&&(ce("streaming.liveSyncTargetLatency","Please Use streaming.liveSync.targetLatency instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=e.streaming.liveSyncTargetLatency,delete e.streaming.liveSyncTargetLatency),e.streaming&&"liveSyncTargetLatencyTolerance"in e.streaming&&(ce("streaming.liveSyncTargetLatencyTolerance","Please Use streaming.liveSync.targetLatencyTolerance instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatencyTolerance=e.streaming.liveSyncTargetLatencyTolerance,delete e.streaming.liveSyncTargetLatencyTolerance),e.streaming&&"liveSyncPlaybackRate"in e.streaming&&(ce("streaming.liveSyncPlaybackRate","Please Use streaming.liveSync.maxPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.maxPlaybackRate=e.streaming.liveSyncPlaybackRate,delete e.streaming.liveSyncPlaybackRate),e.streaming&&"liveSyncMinPlaybackRate"in e.streaming&&(ce("streaming.liveSyncMinPlaybackRate","Please Use streaming.liveSync.minPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.minPlaybackRate=e.streaming.liveSyncMinPlaybackRate,delete e.streaming.liveSyncMinPlaybackRate),e.streaming&&"liveSyncPanicMode"in e.streaming&&(ce("streaming.liveSyncPanicMode","Please Use streaming.liveSync.panicMode instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicMode=e.streaming.liveSyncPanicMode,delete e.streaming.liveSyncPanicMode),e.streaming&&"liveSyncPanicThreshold"in e.streaming&&(ce("streaming.liveSyncPanicThreshold","Please Use streaming.liveSync.panicThreshold instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicThreshold=e.streaming.liveSyncPanicThreshold,delete e.streaming.liveSyncPanicThreshold),e.mediaSource&&"sourceBufferExtraFeatures"in e.mediaSource){ce("mediaSource.sourceBufferExtraFeatures configuration","Please Use mediaSource.addExtraFeaturesToSourceBuffer() instead.");var a=e.mediaSource.sourceBufferExtraFeatures;e.mediaSource.addExtraFeaturesToSourceBuffer=function(){return a},delete e.mediaSource.sourceBufferExtraFeatures}if(e.manifest&&e.manifest.hls&&"useSafariBehaviorForLive"in e.manifest.hls&&(ce("manifest.hls.useSafariBehaviorForLive configuration","Please Use liveSync config to keep on live Edge instead."),delete e.manifest.hls.useSafariBehaviorForLive),e.streaming&&"parsePrftBox"in e.streaming&&(ce("streaming.parsePrftBox configuration","Now fired without needing a configuration."),delete e.streaming.parsePrftBox),e.manifest&&e.manifest.dash&&"enableAudioGroups"in e.manifest.dash&&(ce("manifest.dash.enableAudioGroups configuration","Please Use manifest.enableAudioGroups instead."),e.manifest.enableAudioGroups=e.manifest.dash.enableAudioGroups,delete e.manifest.dash.enableAudioGroups),e.streaming&&"dispatchAllEmsgBoxes"in e.streaming&&(ce("streaming.dispatchAllEmsgBoxes configuration","Please Use mediaSource.dispatchAllEmsgBoxes instead."),e.mediaSource=e.mediaSource||{},e.mediaSource.dispatchAllEmsgBoxes=e.streaming.dispatchAllEmsgBoxes,delete e.streaming.dispatchAllEmsgBoxes),e.streaming&&"autoLowLatencyMode"in e.streaming&&(ce("streaming.autoLowLatencyMode configuration","Please Use streaming.lowLatencyMode instead."),e.streaming.lowLatencyMode=e.streaming.autoLowLatencyMode,delete e.streaming.autoLowLatencyMode),e.manifest&&e.manifest.dash&&"ignoreSupplementalCodecs"in e.manifest.dash&&(ce("manifest.dash.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.dash.ignoreSupplementalCodecs,delete e.manifest.dash.ignoreSupplementalCodecs),e.manifest&&e.manifest.hls&&"ignoreSupplementalCodecs"in e.manifest.hls&&(ce("manifest.hls.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.hls.ignoreSupplementalCodecs,delete e.manifest.hls.ignoreSupplementalCodecs),e.manifest&&e.manifest.dash&&"updatePeriod"in e.manifest.dash&&(ce("manifest.dash.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.dash.updatePeriod,delete e.manifest.dash.updatePeriod),e.manifest&&e.manifest.hls&&"updatePeriod"in e.manifest.hls&&(ce("manifest.hls.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.hls.updatePeriod,delete e.manifest.hls.updatePeriod),e.manifest&&e.manifest.dash&&"ignoreDrmInfo"in e.manifest.dash&&(ce("manifest.dash.ignoreDrmInfo configuration","Please Use manifest.ignoreDrmInfo instead."),e.manifest.ignoreDrmInfo=e.manifest.dash.ignoreDrmInfo,delete e.manifest.dash.ignoreDrmInfo),e.drm&&e.drm.advanced){for(var o in i=!1,e.drm.advanced){var s=e.drm.advanced[o];r=s.videoRobustness,s=s.audioRobustness,"videoRobustness"in e.drm.advanced[o]&&!Array.isArray(e.drm.advanced[o].videoRobustness)&&(e.drm.advanced[o].videoRobustness=[r],i=!0),"audioRobustness"in e.drm.advanced[o]&&!Array.isArray(e.drm.advanced[o].audioRobustness)&&(e.drm.advanced[o].audioRobustness=[s],i=!0)}i&&ce("AdvancedDrmConfiguration's videoRobustness and audioRobustness","These properties are no longer strings but array of strings, please update your usage of these properties.")}return e.streaming&&"forceHTTP"in e.streaming&&(ce("streaming.forceHTTP configuration","Please Use networking.forceHTTP instead."),e.networking=e.networking||{},e.networking.forceHTTP=e.streaming.forceHTTP,delete e.streaming.forceHTTP),e.streaming&&"forceHTTPS"in e.streaming&&(ce("streaming.forceHTTPS configuration","Please Use networking.forceHTTP instead."),e.networking=e.networking||{},e.networking.forceHTTPS=e.streaming.forceHTTPS,delete e.streaming.forceHTTPS),e.streaming&&"minBytesForProgressEvents"in e.streaming&&(ce("streaming.minBytesForProgressEvents configuration","Please Use networking.minBytesForProgressEvents instead."),e.networking=e.networking||{},e.networking.minBytesForProgressEvents=e.streaming.minBytesForProgressEvents,delete e.streaming.minBytesForProgressEvents),o=ec(this.g,e,xh(this)),ph(this,n),o},i.sj=function(e){this.Zf=e},i.getConfiguration=function(){var e=xh(this);return ec(e,this.g,xh(this)),e},i.Cj=function(){return this.Zf},i.ci=function(){return ec(xh(this),this.g,xh(this)),Fl(this.g,xh(this))},i.Zh=function(){if(this.h){var e=this.h.buffered.length;e=e?this.h.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(e>=(t=Math.min(this.h.currentTime+t,this.Qa().end)))return 1;if(!(e<=this.h.currentTime)&&e<t)return(e-this.h.currentTime)/(t-this.h.currentTime)}return 0},i.Ii=function(){var e,t=this.getConfiguration();for(e in this.g)delete this.g[e];ec(this.g,xh(this),xh(this)),ph(this,t)},i.Kj=function(){return this.m},i.ai=function(){return this.i?this.i.type:null},i.Oj=function(){return this.h},i.Wb=function(){return this.J},i.rd=function(){return this.X},i.Yh=function(){return this.C?this.C:null},i.ei=function(){return this.Da?this.Da:null},i.W=function(){return this.i&&!this.wa()?this.i.presentationTimeline.W():!(!this.h||!this.h.src&&!this.wa())&&this.h.duration==1/0},i.Vc=function(){return!!this.i&&this.i.presentationTimeline.Vc()},i.hk=function(){if(this.i&&!this.wa()){var e=this.i.variants;return!!e.length&&!e[0].video}return!(!this.h||!this.h.src&&!this.wa())&&(this.h.videoTracks?0==this.h.videoTracks.length:0==this.h.videoHeight)},i.qk=function(){if(this.i&&!this.wa()){var e=this.i.variants;return!!e.length&&(!((e=e[0]).audio||!e.video)&&!e.video.codecs.includes(","))}return!(!this.h||!this.h.src&&!this.wa()||!this.h.audioTracks)&&0==this.h.audioTracks.length},i.Qa=function(){if(this.i&&!this.wa()){if(!this.Sa&&"HLS"==this.i.type)return{start:0,end:0};var e=this.i.presentationTimeline;return{start:e.Xb(),end:e.Gb()}}if(this.h&&(this.h.src||this.wa())&&(e=this.h.seekable)&&e.length){var t=this.g?this.g.playRangeStart:0;t=Math.max(e.start(0),t);var n=this.g?this.g.playRangeEnd:1/0;return{start:t,end:e=Math.min(e.end(e.length-1),n)}}return{start:0,end:0}},i.ek=function(){this.W()&&(this.h.currentTime=this.Qa().end)},i.ik=function(){return this.Sa},i.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},i.drmInfo=function(){return this.F?this.F.g:null},i.Wd=function(){return this.F?this.F.Wd():1/0},i.Gg=function(){return this.F?this.F.Gg():[]},i.Xe=function(){return this.F?this.F.Xe():{}},i.Ng=function(){return this.R?this.R.g==Ha:!!this.X},i.Ob=function(){return this.h?this.N?this.N.i:1:0},i.Fh=function(e){this.m==tf&&this.l&&sl(this.l,e)},i.se=function(e,t){t=void 0===t||t,0==e?$("A trick play rate of 0 is unsupported!"):(this.N.set(e),this.m==tf&&(this.o.playbackRateChanged(e),this.Fh(t&&1!=e)),Ah(this,e))},i.Pd=function(){var e=this.N.Tc();this.m==nf&&this.N.set(e),this.m==tf&&(this.N.set(e),this.o.playbackRateChanged(e),this.Fh(!1)),this.ac.Pa()},i.mc=function(){if(this.i&&!this.wa()){for(var e=this.l?this.l.o:null,t=[],n=0,i=p(this.i.variants),r=i.next();!r.done;r=i.next())if(er(r=r.value)){var a=Wi(r);a.active=r==e,a.active||1==n||null==e||r.video!=e.video||r.audio!=e.audio||(a.active=!0),a.active&&n++,t.push(a)}return t}if(this.h&&this.h.audioTracks){var o=Nh(this);return(e=Array.from(this.h.audioTracks)).length?e.map((function(e){return Zi(e,o)})):o?[Zi(null,o)]:[]}return[]},i.Kc=function(){if(this.i){if(this.wa())return[];for(var e=this.l?this.l.B:null,t=[],n=p(this.i.textStreams),i=n.next();!i.done;i=n.next()){var r=Xi(i=i.value);r.active=i==e,t.push(r)}return t}return this.h&&this.h.src&&this.h.textTracks?bh(this).map((function(e){return Qi(e)})):[]},i.Hj=function(){var e=this.Ge;return this.i&&(e=this.i.imageStreams),e.map((function(e){return Yi(e)}))},i.vj=function(e){var t,n,i=this;return R((function(r){return 1==r.g?w(r,mh(i,e),2):(t=r.h)?(n=[],t.segmentIndex.Fb((function(e){var i=gh(e.tilesLayout||t.tilesLayout);if(i)for(var r=i.rows*i.columns,a=e.j-e.startTime,o=0;o<r;o++){var s=vh(e,t,e.startTime+a*o/r,i);n.push(s)}})),t.closeSegmentIndex&&t.closeSegmentIndex(),r.return(n)):r.return(null)}))},i.Yj=function(e,t){var n,i,r,a,o,s=this;return R((function(u){return 1==u.g?w(u,mh(s,e),2):(n=u.h)?(n.closeSegmentIndex&&(s.uc.has(n)||(i=new Si((function(){n.closeSegmentIndex(),s.uc.delete(n)})),s.uc.set(n,i)),s.uc.get(n).ia(5)),null==(r=n.segmentIndex.find(t))?u.return(null):(a=n.segmentIndex.get(r),(o=gh(a.tilesLayout||n.tilesLayout))?u.return(vh(a,n,t,o)):u.return(null))):u.return(null)}))},i.kh=function(e){var t,n=this;this.i&&this.G&&((t=n.i.textStreams.find((function(t){return t.id==e.id})))&&t!=n.l.B&&(oc(n.B.h,t,!1),ll(n.l,t),Bh(n),qh(n),n.Fd=t.language),!this.wa())||function(){if(n.h&&n.h.textTracks){var t=bh(n),i=t.find((function(t){return Ji(t)===e.id}));if(i){if(n.u instanceof Fc)for(var r=(t=p(t)).next();!r.done;r=t.next()){var a=(r=r.value)===i?n.$?"showing":"hidden":"disabled";r.mode!==a&&(r.mode=a)}else(t=t.find((function(e){return"disabled"!==e.mode})))!==i&&(t&&(t.mode="disabled",n.j.Ma(t,"cuechange"),n.u.remove(0,1/0)),i&&yh(n,i));Bh(n),qh(n)}}}()},i.Ff=function(e,t,n){var i=this;t=void 0!==t&&t,n=void 0===n?0:n,this.i&&this.G&&(function(){var r=i.i.variants.find((function(t){return t.id==e.id}));if(r&&er(r)){var a=i.l.o;i.g.abr.enabled&&(a.video!=r.video||a.audio&&r.audio&&a.audio.language==r.audio.language&&a.audio.channelsCount==r.audio.channelsCount&&a.audio.label==r.audio.label)&&$("Changing tracks while abr manager is enabled will likely result in the selected track being overridden. Consider disabling abr before calling selectVariantTrack()."),i.wa()?Dh(i,r,!1,!1,0):Dh(i,r,!1,t||!1,n||0),i.K.configure({language:r.language,role:r.audio&&r.audio.roles&&r.audio.roles[0]||"",videoRole:r.video&&r.video.roles&&r.video.roles[0]||"",channelCount:r.audio&&r.audio.channelsCount?r.audio.channelsCount:0,hdrLevel:r.video&&r.video.hdr?r.video.hdr:"",spatialAudio:!(!r.audio||!r.audio.spatialAudio)&&r.audio.spatialAudio,videoLayout:r.video&&r.video.videoLayout?r.video.videoLayout:"",audioLabel:r.audio&&r.audio.label?r.audio.label:"",videoLabel:r.video&&r.video.label?r.video.label:"",codecSwitchingStrategy:i.g.mediaSource.codecSwitchingStrategy,audioCodec:r.audio&&r.audio.codecs?r.audio.codecs:"",activeAudioCodec:a.audio&&a.audio.codecs?a.audio.codecs:"",activeAudioChannelCount:a.audio&&a.audio.channelsCount?a.audio.channelsCount:0,preferredAudioCodecs:i.g.preferredAudioCodecs,preferredAudioChannelCount:i.g.preferredAudioChannelCount}),Mh(i)}}(),!this.wa())||function(){if(e.originalAudioId&&i.h&&i.h.audioTracks)for(var t=Array.from(i.h.audioTracks),n=(t=p(t)).next();!n.done;n=t.next())if(Ji(n=n.value)==e.id){Lh(i,n);break}}()},i.Tk=function(e,t){var n,i=this;(t=void 0===t?0:t,this.i&&this.G&&((n=i.K.getConfiguration()).audioCodec=e.codecs||"",n.audioLabel=e.label||"",n.channelCount=e.channelsCount||0,n.language=e.language,n.role=e.roles[0]||"",n.spatialAudio=e.spatialAudio,i.K.configure(n),Rh(i,!0,t,!1,!1),!this.wa()))||function(){if(i.h&&i.h.audioTracks){for(var t=Pi(e.language),n=Array.from(i.h.audioTracks),r=null,a=(n=p(n)).next();!a.done;a=n.next()){var o=(a=a.value).language||"und";if(a.label==e.label&&Pi(o)==t&&a.kind==e.roles[0]){r=a;break}}r&&Lh(i,r)}}()},i.getAudioTracks=function(){if(this.i&&!this.wa()){var e=this.mc();if(!e.length)return[];var t=e.find((function(e){return e.active}));if(!t)return[];var n=e;if(this.m!=tf||this.wa()||(n=e.filter((function(e){return e.originalVideoId===t.originalVideoId&&(e.audioCodec||hi.includes(e.audioMimeType||""))}))),!n.length)return[];e=new Map;for(var i=(n=p(n)).next();!i.done;i=n.next()){var r=(i=i.value).originalAudioId;r||null==i.audioId||(r=String(i.audioId)),!r&&i.codecs.includes(",")&&i.audioCodec&&(r="muxed-in-video"),r&&(r+=[i.language,i.label,i.channelsCount,i.spatialAudio].join("_"),e.set(r,{active:i.active,language:i.language,label:i.label,mimeType:i.audioMimeType,codecs:i.audioCodec,primary:i.primary,roles:i.audioRoles||[],accessibilityPurpose:i.accessibilityPurpose,channelsCount:i.channelsCount,audioSamplingRate:i.audioSamplingRate,spatialAudio:i.spatialAudio,originalLanguage:i.originalLanguage}))}return Array.from(e.values())}return this.h&&this.h.audioTracks?Array.from(this.h.audioTracks).map((function(e){var t=e.language;return t={active:e.enabled,language:Pi(t||"und"),label:e.label,mimeType:null,codecs:null,primary:"main"==e.kind,roles:[],accessibilityPurpose:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,originalLanguage:t},e.kind&&t.roles.push(e.kind),e.configuration&&(e.configuration.codec&&(t.codecs=e.configuration.codec),e.configuration.sampleRate&&(t.audioSamplingRate=e.configuration.sampleRate),e.configuration.numberOfChannels&&(t.channelsCount=e.configuration.numberOfChannels)),t})):[]},i.Vk=function(e,t,n){t=void 0!==t&&t,n=void 0===n?0:n;var i=this.mc();if(i.length){var r=i.find((function(e){return e.active}));r&&(i=i.find((function(t){return t.audioId===r.audioId&&(t.videoBandwidth||t.bandwidth)==e.bandwidth&&t.width==e.width&&t.height==e.height&&t.frameRate==e.frameRate&&t.pixelAspectRatio==e.pixelAspectRatio&&t.hdr==e.hdr&&t.colorGamut==e.colorGamut&&t.videoLayout==e.videoLayout&&t.videoMimeType==e.mimeType&&t.videoCodec==e.codecs&&Z(t.videoRoles,e.roles)&&t.videoLabel==e.label})))&&!i.active&&this.Ff(i,t,n)}},i.getVideoTracks=function(){if(this.m==nf||this.wa())return[];var e=this.mc();if(!e.length)return[];var t=e.find((function(e){return e.active}));if(!t)return[];var n=e.filter((function(e){return e.originalAudioId===t.originalAudioId&&e.audioId===t.audioId&&e.audioGroupId===t.audioGroupId&&e.videoCodec}));if(!n.length)return[];e=new Map;for(var i=(n=p(n)).next();!i.done;i=n.next()){var r=(i=i.value).originalVideoId;r||null==i.videoId||(r=String(i.videoId)),r&&e.set(r,{active:i.active,bandwidth:i.videoBandwidth||i.bandwidth,width:i.width,height:i.height,frameRate:i.frameRate,pixelAspectRatio:i.pixelAspectRatio,hdr:i.hdr,colorGamut:i.colorGamut,videoLayout:i.videoLayout,mimeType:i.videoMimeType,codecs:i.videoCodec,roles:i.videoRoles||[],label:i.videoLabel})}return Array.from(e.values())},i.xj=function(){return Qh(this.mc())},i.Wj=function(){return Qh(this.Kc())},i.wj=function(){return Array.from(Jh(this.mc()))},i.Vj=function(){return Array.from(Jh(this.Kc()))},i.Ni=function(e,t,n,i,r,a,o){var s=this;n=void 0===n?0:n,i=void 0===i?0:i,r=void 0===r?"":r,a=void 0!==a&&a,o=void 0===o?"":o,this.i&&this.G&&(function(){function u(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0}var l=s.l.o;s.K=s.g.adaptationSetCriteriaFactory(),s.K.configure({language:e,role:t||"",videoRole:l.video&&l.video.roles&&l.video.roles[0]||"",channelCount:n||0,hdrLevel:"",spatialAudio:a||!1,videoLayout:"",audioLabel:o||"",videoLabel:"",codecSwitchingStrategy:s.g.mediaSource.codecSwitchingStrategy,audioCodec:r||"",activeAudioCodec:l.audio&&l.audio.codecs?l.audio.codecs:"",activeAudioChannelCount:l.audio&&l.audio.channelsCount?l.audio.channelsCount:0,preferredAudioCodecs:s.g.preferredAudioCodecs,preferredAudioChannelCount:s.g.preferredAudioChannelCount});for(var c=s.K.create(s.i.variants),d=null,h=(c=p(c.values())).next();!h.done;h=c.next())er(h=h.value)&&(!d||u(d,l)>u(h,l))&&(d=h);d!=l&&(d?(l=Wi(d),s.Ff(l,!0,i||0)):Rh(s))}(),!this.wa())||function(){if(s.h&&s.h.audioTracks){var n=nr(s.mc(),e,t||"",!1)[0];n&&s.Ff(n)}}()},i.jh=function(e,t,n){var i,r=this;(n=void 0!==n&&n,this.i&&this.G&&(function(){r.Fd=e,r.Md=t||"",r.Ld=n||!1;var i=nr(r.i.textStreams,r.Fd,r.Md,r.Ld)[0]||null;i&&i!=r.l.B&&(oc(r.B.h,i,!1),r.g.streaming.alwaysStreamText||r.Og())&&(ll(r.l,i),Bh(r),qh(r))}(),!this.wa()))||(i=nr(r.Kc(),e,t||"",n||!1)[0])&&r.kh(i)},i.Uk=function(e,t,n){var i=this;t=void 0===t||t,n=void 0===n?0:n,this.i&&this.G&&(function(){for(var r=null,a=p(i.i.variants),o=a.next();!o.done;o=a.next())if((o=o.value).audio.label==e){r=o;break}null!=r&&(i.K=i.g.adaptationSetCriteriaFactory(),i.K.configure({language:r.language,role:"",videoRole:"",channelCount:0,hdrLevel:"",spatialAudio:!1,videoLayout:"",videoLabel:"",audioLabel:e,codecSwitchingStrategy:i.g.mediaSource.codecSwitchingStrategy,audioCodec:"",activeAudioCodec:"",activeAudioChannelCount:0,preferredAudioCodecs:i.g.preferredAudioCodecs,preferredAudioChannelCount:i.g.preferredAudioChannelCount}),Rh(i,t,n))}(),!this.wa())||function(){if(i.h&&i.h.audioTracks){for(var t=Array.from(i.h.audioTracks),n=null,r=(t=p(t)).next();!r.done;r=t.next())(r=r.value).label==e&&(n=r);n&&Lh(i,n)}}()},i.Og=function(){var e=this.$;return this.u?this.u.isTextVisible():e},i.Bj=function(){return this.kb.map((function(e){return Xi(e)}))},i.zj=function(e){if(ce("getChapters","Please use an getChaptersAsync."),!this.kb.length)return[];var t=Pi(e);if(!(e=this.kb.filter((function(e){return Pi(e.language)==t}))).length)return[];for(var n=[],i=new Set,r=(e=p(e)).next();!r.done;r=e.next())(r=r.value).segmentIndex&&r.segmentIndex.Fb((function(e){var t=e.P()[0],r=e.startTime+"-"+e.endTime+"-"+t;e={id:r,title:t,startTime:e.startTime,endTime:e.endTime},i.has(r)||(n.push(e),i.add(r))}));return n},i.Aj=function(e){var t,n,i,r,a,o,s,u=this;return R((function(l){switch(l.g){case 1:if(!u.kb.length)return l.return([]);if(t=Pi(e),!(n=u.kb.filter((function(e){return Pi(e.language)==t}))).length)return l.return([]);i=[],r=new Set,a=p(n),o=a.next();case 2:if(o.done){l.A(4);break}if((s=o.value).segmentIndex){l.A(5);break}return w(l,s.createSegmentIndex(),5);case 5:s.segmentIndex.Fb((function(e){var t=e.P()[0],n=e.startTime+"-"+e.endTime+"-"+t;e={id:n,title:t,startTime:e.startTime,endTime:e.endTime},r.has(n)||(i.push(e),r.add(n))})),o=a.next(),l.A(2);break;case 4:return l.return(i)}}))},i.qh=function(e){e=!!e,this.$!=e&&(this.$=e,this.m==tf?(this.u.setTextVisibility(e),this.g.streaming.alwaysStreamText||(e?this.l.B||(e=nr(this.i.textStreams,this.Fd,this.Md,this.Ld)).length>0&&(ll(this.l,e[0]),Bh(this),qh(this)):function(e){var t=e.h.get(ut);t&&(Al(t),El(t).catch((function(){})),e.H=e.h.get(ut),e.h.delete(ut),t.stream&&t.stream.closeSegmentIndex&&t.stream.closeSegmentIndex()),e.B=null}(this.l))):this.h&&this.h.src&&this.h.textTracks&&this.u.setTextVisibility(e),Hh(this))},i.Pj=function(){if(this.G)var e=this.G.He();else{if(null==this.O)return new Date;if(this.O instanceof Date)return this.O;e=this.O}if(this.i&&!this.wa()){var t=this.i.presentationTimeline;return new Date(1e3*((t.m||t.i)+e))}return this.h&&this.h.getStartDate?(t=this.h.getStartDate(),isNaN(t.getTime())?null:new Date(t.getTime()+1e3*e)):null},i.di=function(){if(this.i&&!this.wa()){var e=this.i.presentationTimeline;return null===(e=e.m||e.i)?null:new Date(1e3*e)}return this.h&&this.h.getStartDate?(e=this.h.getStartDate(),isNaN(e.getTime())?null:e):null},i.Ze=function(){return this.W()&&this.i?this.i.presentationTimeline.Ze():null},i.Fc=function(){if(this.m==tf)return this.H.Fc();var e={total:[],audio:[],video:[],text:[]};return this.m==nf&&(e.total=Xo(this.h.buffered)),e},i.getBandwidthEstimate=function(){return this.o?this.o.getBandwidthEstimate():NaN},i.getStats=function(){if(this.m!=tf&&this.m!=nf)return{width:NaN,height:NaN,currentCodecs:"",streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,manifestSizeBytes:NaN,bytesDownloaded:NaN,nonFatalErrorCount:NaN,manifestPeriodCount:NaN,manifestGapCount:NaN,switchHistory:[],stateHistory:[]};Eh(this);var e=this.h,t=e.currentTime/e.duration;if(isNaN(t)||this.W()||function(e,t){e.i=isNaN(e.i)?t:Math.max(e.i,t)}(this.B,Math.round(100*t)),this.G&&(this.B.T=this.G.Gh(),this.B.V=this.G.Ih()),e.getVideoPlaybackQuality&&(t=e.getVideoPlaybackQuality(),function(e,t,n){e.R=t,e.O=n}(this.B,Number(t.droppedVideoFrames),Number(t.totalVideoFrames)),this.B.N=Number(t.corruptedVideoFrames)),this.B.o=this.F?function(e){return e.J?e.J:NaN}(this.F):NaN,uc(this.B,e.videoWidth||NaN,e.videoHeight||NaN),this.B.l="",this.W()&&(null!=(e=wh(this))&&(this.B.F=e/1e3)),t=this.mc().find((function(e){return e.active})),e=this.Kc().find((function(e){return e.active})),t){if(t.bandwidth){var n=this.N?this.N.i:1,i=n*t.bandwidth;e&&e.bandwidth&&(i+=n*e.bandwidth),this.B.B=i}t.width&&t.height&&uc(this.B,t.width||NaN,t.height||NaN),t=t.codecs,e&&(t+=","+(e.codecs||e.mimeType)),t&&(this.B.l=t)}return this.m!=tf||this.wa()||(this.i&&(this.B.I=this.i.periodCount,this.B.H=this.i.gapCount,this.i.presentationTimeline&&(this.B.K=this.i.presentationTimeline.h)),e=this.o.getBandwidthEstimate(),this.B.u=e),this.m==nf&&lc(this.B,NaN),cc(this.B)},i.Od=function(e,t,n,i,r,a,o){o=void 0!==o&&o;var s,u,l,c,d,h,f,p,g,m,v,y=this;return R((function(b){switch(b.g){case 1:if(y.m!=tf&&y.m!=nf)throw new Ue(1,7,7004);if("subtitles"!=n&&"captions"!=n&&$("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),i){b.A(2);break}return w(b,_h(y,e),3);case 3:i=b.h;case 2:if(s=[],y.C&&(s=y.C.getCuePoints()),y.m!=nf){b.A(4);break}return u=ae(),o&&"WEBKIT"===u.Ha()&&(n="forced"),w(b,function(e,t,n,i,r,a,o){var s,u,l,c;return R((function(d){if(1==d.g)return"text/vtt"!=r||o.length?w(d,Sh(e,t,e.J,e.g.streaming.retryParameters),3):d.A(2);2!=d.g&&(s=d.h,u=Th(e,s,r,o),l=new Blob([u],{type:"text/vtt"}),t=nu(l),r="text/vtt"),c=document.createElement("track");e:{var h=e.M,f=t;try{if(!h.g.enabled){var p=f;break e}var g=td(h);g.ot=bd,g.su=!0,p=fd(f,dd(g));break e}catch(e){K("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",e),p=f;break e}p=void 0}return c.src=p,c.label=a,c.kind=i,c.srclang=n,e.h.getAttribute("crossorigin")||e.h.setAttribute("crossorigin","anonymous"),e.h.appendChild(c),e.Yf.push(c),d.return(c)}))}(y,e,t,n,i,a||"",s),5);case 5:if((l=b.h).track)return Oh(y),Bh(y),b.return(Qi(l.track));throw new Ue(1,2,2012);case 4:if(c=lt,d=y.Qa(),h=d.end-d.start,y.i&&(h=y.i.presentationTimeline.getDuration()),h==1/0)throw new Ue(1,4,4033);if(!s.length){b.A(6);break}return w(b,Sh(y,e,y.J,y.g.streaming.retryParameters),7);case 7:f=b.h,p=Th(y,f,i,s),g=new Blob([p],{type:"text/vtt"}),e=nu(g),i="text/vtt";case 6:if(m={id:y.Be++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:Ru(0,h,[e]),mimeType:i||"",codecs:r||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:a||null,type:c.Na,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!!o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([ni(i||"",r||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},v=ni(m.mimeType,m.codecs),!mi(v))throw new Ue(2,2,2014,i);return y.i.textStreams.push(m),Oh(y),Bh(y),b.return(Xi(m))}}))},i.Me=function(e,t){var n,i,r,a,o,s,u,l,c,d,h,f,g,m,v,y,b,_,S=this;return R((function(T){switch(T.g){case 1:if(S.m!=tf&&S.m!=nf)throw new Ue(1,7,7004);if(t){T.A(2);break}return w(T,_h(S,e),3);case 3:t=T.h;case 2:if("text/vtt"!=t)throw new Ue(1,2,2017,e);if(n=lt,i=S.Qa(),r=i.end-i.start,S.i&&(r=S.i.presentationTimeline.getDuration()),r==1/0)throw new Ue(1,4,4045);return w(T,Sh(S,e,S.J,S.g.streaming.retryParameters),4);case 4:if(a=T.h,!(o=gi(t)))throw new Ue(2,2,2014,t);for(s=o(),u={periodStart:0,segmentStart:0,segmentEnd:r,vttOffset:0},l=Le(a),c=s.parseMedia(l,u,e,[]),d=[],h=p(c),f=h.next(),g={};!f.done;g={Sf:void 0,nd:void 0},f=h.next())g.nd=f.value,g.Sf=null,m=function(t){return function(){return null==t.Sf&&(t.Sf=nt([e],[t.nd.payload])),t.Sf||[]}}(g),v=new Fo(g.nd.startTime,g.nd.endTime,m,0,null,null,0,0,1/0),g.nd.payload.includes("#xywh")&&(4===(y=g.nd.payload.split("#xywh=")[1].split(",")).length&&v.If({height:parseInt(y[3],10),positionX:parseInt(y[0],10),positionY:parseInt(y[1],10),width:parseInt(y[2],10)})),d.push(v);if(b=t,!d.length){T.A(5);break}return w(T,kc(d[0].P()[0],S.J,S.g.manifest.retryParameters),6);case 6:b=T.h;case 5:return _={id:S.Be++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Mu(d),mimeType:b||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.Uf,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([ni(b||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null},S.m==nf?S.Ge.push(_):S.i.imageStreams.push(_),Oh(S),T.return(Yi(_))}}))},i.Le=function(e,t,n){var i,r,a,o,s,u,l,c,d,h,f,g,m,v,y,b=this;return R((function(_){switch(_.g){case 1:if(b.m!=tf&&b.m!=nf)throw new Ue(1,7,7004);if(n){_.A(2);break}return w(_,_h(b,e),3);case 3:n=_.h;case 2:if(i=lt,r=b.Qa(),a=r.end-r.start,b.i&&(a=b.i.presentationTimeline.getDuration()),a==1/0)throw new Ue(1,4,4055);return w(_,Sh(b,e,b.J,b.g.streaming.retryParameters),4);case 4:if(o=_.h,!(s=gi(n)))throw new Ue(2,2,2014,n);for(u=s(),l={periodStart:0,segmentStart:0,segmentEnd:a,vttOffset:0},c=Le(o),d=u.parseMedia(c,l,e,[]),h=[],f=p(d),g=f.next(),m={};!g.done;m={Ue:void 0},g=f.next())m.Ue=g.value,v=new Fo(m.Ue.startTime,m.Ue.endTime,function(e){return function(){return[e.Ue.payload]}}(m),0,null,null,0,0,1/0),h.push(v);return y={id:b.Be++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Mu(h),mimeType:"text/plain",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:null,type:i.Na,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([ni("text/plain","")]),isAudioMuxedInVideo:!1,baseOriginalId:null},b.kb.push(y),Oh(b),_.return(Xi(y))}}))},i.$k=function(e,t){this.xa.width=e,this.xa.height=t},i.fh=function(e){if(this.m==tf){var t=this.l;if(e=void 0===e?.1:e,t.l.g)t=!1;else if(t.F)t=!1;else{for(var n=p(t.h.values()),i=n.next();!i.done;i=n.next())!(i=i.value).Zd||i.Ja||i.qb||(i.Zd=!1,kl(t,i,e));t=!0}}else t=!1;return t},i.Hg=function(){return $("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},i.Lj=function(){return this.xc},i.Fj=function(){var e={video:null,audio:null,text:null};if(this.m!=tf)return e;for(var t=this.l.o,n=this.h.currentTime,i=(t=p([t.video,t.audio,this.l.B])).next();!i.done;i=t.next())if((i=i.value)&&i.segmentIndex){var r=i.segmentIndex.find(n);r={codecs:(r=i.segmentIndex.get(r)).codecs||i.codecs,mimeType:r.mimeType||i.mimeType,bandwidth:r.bandwidth||i.bandwidth},"video"==i.type?(r.width=i.width,r.height=i.height,e.video=r):"audio"==i.type?e.audio=r:i.type==ut&&(e.text=r)}return e},i.Ti=function(e){this.xe=e},i.disableStream=function(e,t){if(!this.g.abr.enabled||this.m===Zh||!navigator.onLine||0==t||!this.i)return!1;if(this.i.variants.some((function(t){var n=t[e.type];return!(!n||n.id===e.id||t.disabledUntilTime)&&("audio"!=e.type||e.language===n.language)}))){for(var n=!1,i=!1,r=p(this.i.variants),a=r.next();!a.done;a=r.next()){var o=(a=a.value)[e.type];o&&(o.id===e.id?(a.disabledUntilTime=Date.now()/1e3+t,n=!0):o.trickModeVideo&&o.trickModeVideo.id==e.id&&(i=!0))}return!(!n&&i)&&(this.De.Ea(1),t=this.Fc().video.reduce((function(e,t){return e+t.end-t.start}),0),Rh(this,!1,t,!0,!1),!0)}return!1},i.addFont=function(t,n){return function(t,n){var i,r,a,o,s;return R((function(u){if(1==u.g)return"fonts"in document&&"FontFace"in e?w(u,document.fonts.ready,2):u.return();if(!("entries"in document.fonts))return u.return();for(i=function(e){for(var t=[],n=(e=e.entries()).next();!1===n.done;)t.push(n.value),n=e.next();return t},r=p(i(document.fonts)),a=r.next();!a.done;a=r.next())if((o=a.value).family===t&&"swap"===o.display)return u.return();s=new FontFace(t,"url("+n+")",{display:"swap"}),document.fonts.add(s),_(u)}))}(t,n)},i.wa=function(){return!(!this.h||!this.h.remote)&&"disconnected"!=this.h.remote.state},i.be=function(){return!(this.h&&!this.h.ended)||this.Sa&&!this.W()&&this.h.currentTime>=this.Qa().end},B("shaka.Player",Xd),Xd.prototype.isEnded=Xd.prototype.be,Xd.prototype.isRemotePlayback=Xd.prototype.wa,Xd.prototype.addFont=Xd.prototype.addFont,Xd.prototype.setVideoContainer=Xd.prototype.Ti,Xd.prototype.getFetchedPlaybackInfo=Xd.prototype.Fj,Xd.prototype.getManifestParserFactory=Xd.prototype.Lj,Xd.prototype.getManifest=Xd.prototype.Hg,Xd.prototype.retryStreaming=Xd.prototype.fh,Xd.prototype.setMaxHardwareResolution=Xd.prototype.$k,Xd.prototype.addChaptersTrack=Xd.prototype.Le,Xd.prototype.addThumbnailsTrack=Xd.prototype.Me,Xd.prototype.addTextTrackAsync=Xd.prototype.Od,Xd.prototype.getStats=Xd.prototype.getStats,Xd.prototype.getBufferedInfo=Xd.prototype.Fc,Xd.prototype.getSegmentAvailabilityDuration=Xd.prototype.Ze,Xd.prototype.getPresentationStartTimeAsDate=Xd.prototype.di,Xd.prototype.getPlayheadTimeAsDate=Xd.prototype.Pj,Xd.prototype.setTextTrackVisibility=Xd.prototype.qh,Xd.prototype.getChaptersAsync=Xd.prototype.Aj,Xd.prototype.getChapters=Xd.prototype.zj,Xd.prototype.getChaptersTracks=Xd.prototype.Bj,Xd.prototype.isTextTrackVisible=Xd.prototype.Og,Xd.prototype.selectVariantsByLabel=Xd.prototype.Uk,Xd.prototype.selectTextLanguage=Xd.prototype.jh,Xd.prototype.selectAudioLanguage=Xd.prototype.Ni,Xd.prototype.getTextLanguages=Xd.prototype.Vj,Xd.prototype.getAudioLanguages=Xd.prototype.wj,Xd.prototype.getTextLanguagesAndRoles=Xd.prototype.Wj,Xd.prototype.getAudioLanguagesAndRoles=Xd.prototype.xj,Xd.prototype.getVideoTracks=Xd.prototype.getVideoTracks,Xd.prototype.selectVideoTrack=Xd.prototype.Vk,Xd.prototype.getAudioTracks=Xd.prototype.getAudioTracks,Xd.prototype.selectAudioTrack=Xd.prototype.Tk,Xd.prototype.selectVariantTrack=Xd.prototype.Ff,Xd.prototype.selectTextTrack=Xd.prototype.kh,Xd.prototype.getThumbnails=Xd.prototype.Yj,Xd.prototype.getAllThumbnails=Xd.prototype.vj,Xd.prototype.getImageTracks=Xd.prototype.Hj,Xd.prototype.getTextTracks=Xd.prototype.Kc,Xd.prototype.getVariantTracks=Xd.prototype.mc,Xd.prototype.cancelTrickPlay=Xd.prototype.Pd,Xd.prototype.trickPlay=Xd.prototype.se,Xd.prototype.useTrickPlayTrackIfAvailable=Xd.prototype.Fh,Xd.prototype.getPlaybackRate=Xd.prototype.Ob,Xd.prototype.isBuffering=Xd.prototype.Ng,Xd.prototype.getKeyStatuses=Xd.prototype.Xe,Xd.prototype.getActiveSessionsMetadata=Xd.prototype.Gg,Xd.prototype.getExpiration=Xd.prototype.Wd,Xd.prototype.drmInfo=Xd.prototype.drmInfo,Xd.prototype.keySystem=Xd.prototype.keySystem,Xd.prototype.isFullyLoaded=Xd.prototype.ik,Xd.prototype.goToLive=Xd.prototype.ek,Xd.prototype.seekRange=Xd.prototype.Qa,Xd.prototype.isVideoOnly=Xd.prototype.qk,Xd.prototype.isAudioOnly=Xd.prototype.hk,Xd.prototype.isInProgress=Xd.prototype.Vc,Xd.prototype.isLive=Xd.prototype.W,Xd.prototype.getQueueManager=Xd.prototype.ei,Xd.prototype.getAdManager=Xd.prototype.Yh,Xd.prototype.getAssetUri=Xd.prototype.rd,Xd.prototype.getNetworkingEngine=Xd.prototype.Wb,Xd.prototype.getMediaElement=Xd.prototype.Oj,Xd.prototype.getManifestType=Xd.prototype.ai,Xd.prototype.getLoadMode=Xd.prototype.Kj,Xd.prototype.resetConfiguration=Xd.prototype.Ii,Xd.prototype.getBufferFullness=Xd.prototype.Zh,Xd.prototype.getNonDefaultConfiguration=Xd.prototype.ci,Xd.prototype.getConfigurationForLowLatency=Xd.prototype.Cj,Xd.prototype.getConfiguration=Xd.prototype.getConfiguration,Xd.prototype.configurationForLowLatency=Xd.prototype.sj,Xd.prototype.configure=Xd.prototype.configure,Xd.prototype.releaseAllMutexes=Xd.prototype.Lk,Xd.prototype.destroyAllPreloads=Xd.prototype.ng,Xd.prototype.preload=Xd.prototype.preload,Xd.prototype.detachAndSavePreload=Xd.prototype.Uh,Xd.prototype.unloadAndSavePreload=Xd.prototype.dj,Xd.prototype.load=Xd.prototype.load,Xd.prototype.updateStartTime=Xd.prototype.kl,Xd.prototype.unload=Xd.prototype.Bc,Xd.prototype.detach=Xd.prototype.detach,Xd.prototype.attachCanvas=Xd.prototype.jj,Xd.prototype.attach=Xd.prototype.fc,Xd.probeSupport=function(t){var n,i,r,a,o;return t=void 0===t||t,R((function(s){switch(s.g){case 1:if(n={},!t){s.A(2);break}return w(s,function(){var t,n,i,r,a,o,s,u,l,c,d,h,f,g,m,v,y,b,T,A,E,I,C,M,P,D,L,N,O;return R((function(j){if(1==j.g){if(t="org.w3.clearkey com.widevine.alpha com.widevine.alpha.experiment com.microsoft.playready com.microsoft.playready.hardware com.microsoft.playready.recommendation com.microsoft.playready.recommendation.3000 com.microsoft.playready.recommendation.3000.clearlead com.chromecast.playready com.apple.fps.1_0 com.apple.fps com.huawei.wiseplay".split(" "),!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration)){for(n={},i=p(t),r=i.next();!r.done;r=i.next())a=r.value,n[a]=null;return j.return(n)}for(o="1.0 1.1 1.2 1.3 1.4 2.0 2.1 2.2 2.3".split(" "),u={"com.widevine.alpha":s=["SW_SECURE_CRYPTO","SW_SECURE_DECODE","HW_SECURE_CRYPTO","HW_SECURE_DECODE","HW_SECURE_ALL"],"com.widevine.alpha.experiment":s,"com.microsoft.playready.recommendation":["150","2000","3000"]},l={videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"'},{contentType:'audio/webm; codecs="opus"'}],initDataTypes:["cenc","sinf","skd","keyids"]},c=[null,"cenc","cbcs"],d=new Map,h=ae(),f=function(e,t,n){var i,r,a,s,u,l,c,f,g,m,v,y;return R((function(b){switch(b.g){case 1:return S(b,2),w(b,t.createMediaKeys(),5);case 5:i=b.h;case 4:x(b,3);break;case 2:return k(b),b.return();case 3:if(a=!!(r=t.getConfiguration().sessionTypes)&&r.includes("persistent-license"),h.ti()&&(a=!1),s=t.getConfiguration().videoCapabilities,u=t.getConfiguration().audioCapabilities,l={persistentState:a,encryptionSchemes:[],videoRobustnessLevels:[],audioRobustnessLevels:[],minHdcpVersions:[]},d.get(e)?l=d.get(e):d.set(e,l),(c=s[0].encryptionScheme)&&!l.encryptionSchemes.includes(c)&&l.encryptionSchemes.push(c),(f=s[0].robustness)&&!l.videoRobustnessLevels.includes(f)&&l.videoRobustnessLevels.push(f),(g=u[0].robustness)&&!l.audioRobustnessLevels.includes(g)&&l.audioRobustnessLevels.push(g),!n||!("getStatusForPolicy"in i)){b.A(0);break}m=p(o),v=m.next();case 7:if(v.done){b.A(0);break}if(y=v.value,l.minHdcpVersions.includes(y)){b.A(8);break}return w(b,i.getStatusForPolicy({minHdcpVersion:y}),10);case 10:if("usable"!=b.h){b.A(0);break}l.minHdcpVersions.includes(y)||l.minHdcpVersions.push(y);case 8:v=m.next(),b.A(7)}}))},g=function(e,t,n,i,r){var a,o,s,u,c,d,h,g,m,v;return r=void 0!==r&&r,R((function(y){switch(y.g){case 1:for(S(y,2),a=Ft(l),o=p(a.videoCapabilities),s=o.next();!s.done;s=o.next())(u=s.value).encryptionScheme=t,u.robustness=n;for(c=p(a.audioCapabilities),d=c.next();!d.done;d=c.next())(h=d.value).encryptionScheme=t,h.robustness=i;return(g=Ft(a)).persistentState="required",g.sessionTypes=["persistent-license"],m=[g,a],"MOBILE"==ae().Ua()?w(y,Ai(5,navigator.requestMediaKeySystemAccess(e,m)),7):w(y,navigator.requestMediaKeySystemAccess(e,m),6);case 6:v=y.h,y.A(5);break;case 7:v=y.h;case 5:return w(y,f(e,v,r),8);case 8:x(y,0);break;case 2:k(y),_(y)}}))},m=p(t),v=m.next();!v.done;v=m.next())y=v.value,d.set(y,null);for(b=function(e){return"WEBKIT"!==ae().Ha()||"org.w3.clearkey"!==e},T=[],A=p(t),E=A.next();!E.done;E=A.next())if(I=E.value,b(I)){for(C=!0,M=p(c),P=M.next();!P.done;P=M.next())D=P.value,T.push(g(I,D,"","",C)),C=!1;for(L=p(u[I]||[]),N=L.next();!N.done;N=L.next())O=N.value,T.push(g(I,null,O,"")),T.push(g(I,null,"",O))}return w(j,Promise.all(T),2)}return j.return(ea(d))}))}(),3);case 3:n=s.h;case 2:return i=function(){var e={};if(ae(),Xv())for(var t=p(Za.keys()),n=t.next();!n.done;n=t.next())e[n.value]=!0;for(n=(t=p(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!n.done;n=t.next())e[n=n.value]=Xv()?Za.has(n):""!=es().canPlayType(n);return e}(),r=function(){var e='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.20000000.L153.B0",video/mp4; codecs="hvc1.2.4.L120.b0",video/mp4; codecs="hvc1.2.4.L123.b0",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.05.01",video/mp4; codecs="dvh1.08.01",video/mp4; codecs="dav1.10.01",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4.02.01.01",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",audio/mp4; codecs="apac.31.00",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(g(hi)),t={};ae();for(var n=(e=p(e)).next();!n.done;n=e.next()){if(mi(n=n.value))t[n]=!0;else if(Xv()){var i=ui(n);i=ni(i,$i(li(n),i)),t[n]=mt(i)||!!Xn(i)}else t[n]=""!=es().canPlayType(n);t[i=n.split(";")[0]]=t[i]||t[n]}return t}(),w(s,ae().jc(),4);case 4:return a=s.h,o={manifest:i,media:r,drm:n,hardwareResolution:a},af.forEach((function(e,t){o[t]=e()})),s.return(o)}}))},Xd.isBrowserSupported=function(){return e.Promise||$("A Promise implementation or polyfill is required"),!(!(e.Promise&&e.Uint8Array&&Array.prototype.forEach)||(navigator.userAgent||"").includes("Trident/"))&&(ae(),!!Xv()||""!=es().canPlayType("application/x-mpegurl"))},Xd.setQueueManagerFactory=function(e){sf=e},Xd.setAdManagerFactory=function(e){of=e},Xd.registerSupportPlugin=Qd,Xd.prototype.destroy=Xd.prototype.destroy;var Zh=0,ef=1,tf=2,nf=3;Xd.LoadMode={DESTROYED:Zh,NOT_LOADED:ef,MEDIA_SOURCE:tf,SRC_EQUALS:nf},Xd.version="v4.16.4";var rf=["4","16"];fe=new function(e){this.g=e,this.i=de,this.h=he}(new le(Number(rf[0]),Number(rf[1])));var af=new Map,of=null,sf=null;function uf(){this.g=[],this.i=this.m=this.l=this.j=this.h=0}function lf(e){return e.g.length?e.g.reduce((function(e,t){return e+t}),0)/e.g.length:0}function cf(e,t,n){var i=this;this.g=e,this.h=t,this.m=n,this.i=!1,this.j=this.h.getVolume(),this.l=new te,this.l.D(this.h,google.ima.AdEvent.Type.PAUSED,(function(){i.i=!0})),this.l.D(this.h,google.ima.AdEvent.Type.RESUMED,(function(){i.i=!1}))}function df(){}function hf(e,t){for(var n=[],i=(e=p(Kt(e,"Ad"))).next();!i.done;i=e.next())if((i=Jt(i.value,"InLine"))&&(i=Jt(i,"Creatives")))for(var r=(i=p(Kt(i,"Creative"))).next();!r.done;r=i.next()){var a=Jt(r=r.value,"Linear");if(a&&ff(n,t,a),r=Jt(r,"NonLinearAds"))for(var o=(r=p(r=Kt(r,"NonLinear"))).next();!o.done;o=r.next())e:{a=n;var s=t,u=o.value,l=Jt(u,"StaticResource");if(l)o=l.attributes.creativeType;else{if(!(l=Jt(u,"HTMLResource")))break e;o="text/html"}if(l=Xt(l)){"text/html"===o&&(l="data:text/html;charset=UTF-8,"+encodeURIComponent(l));var c=Zt(u,"width",sn)||Zt(u,"expandedWidth",sn),d=Zt(u,"height",sn)||Zt(u,"expandedHeight",sn);if(c||d){var h=null,f=Jt(u,"NonLinearClickThrough");f&&(f=Xt(f))&&(h=f),f=null,(u=u.attributes.minSuggestedDuration)&&(f=Ot(u)),u=0,null!=s&&(u=s),a.push({id:null,groupId:null,startTime:u,endTime:null,uri:l,mimeType:o,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:f,once:!0,pre:null==s,post:s==1/0,timelineRange:!1,loop:!1,overlay:{viewport:{x:0,y:0},topLeft:{x:0,y:0},size:{x:c||0,y:d||0}},displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:h})}}}}return n}function ff(e,t,n){var i=0;null!=t&&(i=t);var r=null;n.attributes.skipoffset&&(r=Ot(n.attributes.skipoffset),isNaN(r)&&(r=null));var a=Jt(n,"MediaFiles");if(a){var o=null;for((n=Jt(n,"VideoClicks"))&&(n=Jt(n,"ClickThrough"))&&(n=Xt(n))&&(o=n),a=n=Kt(a,"MediaFile"),n=n.filter((function(e){return"streaming"==e.attributes.delivery})),n.length&&(a=n),a=a.sort((function(e,t){return(parseInt(t.attributes.height,10)||0)-(parseInt(e.attributes.height,10)||0)})),n=(a=p(a)).next();!n.done;n=a.next())if(!(n=n.value).attributes.apiFramework){var s=Xt(n);if(s){e.push({id:null,groupId:null,startTime:i,endTime:null,uri:s,mimeType:n.attributes.type||null,isSkippable:null!=r,skipOffset:r,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:null,once:!0,pre:null==t,post:t==1/0,timelineRange:!1,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:o});break}}}}function pf(t,n,i,r,a){var o=this;this.u=t,this.i=n,this.G=!1,this.B=this.o=null,this.H=NaN,this.l=a,this.j=null,this.h=new te,google.ima.settings.setLocale(i),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.F=new google.ima.AdDisplayContainer(this.u,this.i),this.F.initialize(),this.m=new google.ima.AdsLoader(this.F),this.m.getSettings().setPlayerType("shaka-player"),this.m.getSettings().setPlayerVersion("v4.16.4"),this.g=null,this.C=r||new google.ima.AdsRenderingSettings,this.h.D(this.m,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(t){!function(t,n){if(t.l(new Dr("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-t.H))),t.o.customPlayheadTracker){var i={currentTime:t.i.currentTime};t.g=n.getAdsManager(i,t.C),t.i.muted?t.g.setVolume(0):t.g.setVolume(t.i.volume),t.h.D(t.i,"timeupdate",(function(){t.i.duration&&(i.currentTime=t.i.currentTime)})),t.h.D(t.i,"volumechange",(function(){t.j&&(t.j.setVolume(t.i.volume),t.i.muted&&t.j.setMuted(!0))}))}else t.g=n.getAdsManager(t.i,t.C);t.l(new Dr("ima-ad-manager-loaded",(new Map).set("imaAdManager",t.g)));var r=t.g.getCuePoints();if(r.length){n=[];for(var a=(r=p(r)).next();!a.done;a=r.next())n.push({start:a.value,end:null});t.l(new Dr("ad-cue-points-changed",(new Map).set("cuepoints",n)))}!function(e){function t(t,n){t=(new Map).set("originalEvent",t),e.l(new Dr(n,t))}e.h.D(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,(function(t){gf(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,(function(t){mf(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.STARTED,(function(t){mf(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,(function(e){t(e,"ad-first-quartile")})),e.h.D(e.g,google.ima.AdEvent.Type.MIDPOINT,(function(e){t(e,"ad-midpoint")})),e.h.D(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,(function(e){t(e,"ad-third-quartile")})),e.h.D(e.g,google.ima.AdEvent.Type.COMPLETE,(function(e){t(e,"ad-complete")})),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,(function(t){vf(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(t){vf(e,t)})),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPED,(function(e){t(e,"ad-skipped")})),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,(function(e){t(e,"ad-volume-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,(function(e){t(e,"ad-muted")})),e.h.D(e.g,google.ima.AdEvent.Type.PAUSED,(function(n){e.j&&(e.j.i=!0,t(n,"ad-paused"))})),e.h.D(e.g,google.ima.AdEvent.Type.RESUMED,(function(n){e.j&&(e.j.i=!1,t(n,"ad-resumed"))})),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,(function(n){e.j&&t(n,"ad-skip-state-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.CLICK,(function(e){t(e,"ad-clicked")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_PROGRESS,(function(e){t(e,"ad-progress")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_BUFFERING,(function(e){t(e,"ad-buffering")})),e.h.D(e.g,google.ima.AdEvent.Type.IMPRESSION,(function(e){t(e,"ad-impression")})),e.h.D(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,(function(e){t(e,"ad-duration-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.USER_CLOSE,(function(e){t(e,"ad-closed")})),e.h.D(e.g,google.ima.AdEvent.Type.LOADED,(function(e){t(e,"ad-loaded")})),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(e){t(e,"all-ads-completed")})),e.h.D(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,(function(e){t(e,"ad-linear-changed")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_METADATA,(function(e){t(e,"ad-metadata")})),e.h.D(e.g,google.ima.AdEvent.Type.LOG,(function(e){t(e,"ad-recoverable-error")})),e.h.D(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,(function(e){t(e,"ad-break-ready")})),e.h.D(e.g,google.ima.AdEvent.Type.INTERACTION,(function(e){t(e,"ad-interaction")}))}(t);try{t.g.init(t.i.offsetWidth,t.i.offsetHeight),t.h.D(t.i,"loadeddata",(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)})),"ResizeObserver"in e?(t.B=new ResizeObserver((function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)})),t.B.observe(t.i)):t.h.D(document,"fullscreenchange",(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight)})),t.G||t.o.skipPlayDetection?t.g.start():t.h.Ba(t.i,"play",(function(){t.G=!0,t.g.start()}))}catch(e){vf(t,null)}}(o,t)})),this.h.D(this.m,google.ima.AdErrorEvent.Type.AD_ERROR,(function(e){gf(o,e)})),this.h.D(this.i,"ended",(function(){o.m.contentComplete()})),this.h.Ba(this.i,"play",(function(){o.G=!0}))}function gf(e,t){t.getError(),t=(new Map).set("originalEvent",t),e.l(new Dr("ad-error",t)),vf(e,null),e.l(new Dr("ad-cue-points-changed",(new Map).set("cuepoints",[])))}function mf(e,t){var n=t.getAd();n?(e.j=new cf(n,e.g,e.i),t.type!=google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED||e.o.supportsMultipleMediaElements||e.l(new Dr("ad-content-pause-requested")),t=(new Map).set("ad",e.j).set("sdkAdObject",n).set("originalEvent",t),e.l(new Dr("ad-started",t)),e.j.isLinear()&&(e.u.setAttribute("ad-active","true"),e.o.customPlayheadTracker||e.i.pause(),e.i.muted?((t=e.j).j=e.i.volume,t.h.setVolume(0)):e.j.setVolume(e.i.volume))):$("The IMA SDK fired a "+t.type+" event with no associated ad. Unable to play ad!")}function vf(e,t){t&&t.type==google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED&&!e.o.supportsMultipleMediaElements&&e.l(new Dr("ad-content-resume-requested")),e.l(new Dr("ad-stopped",(new Map).set("originalEvent",t))),e.j&&e.j.isLinear()&&(e.u.removeAttribute("ad-active"),e.o.customPlayheadTracker||e.i.ended||e.i.play())}function yf(e,t,n,i,r,a){this.g=e,this.h=t,this.j=(this.i=t.isSkippable)?t.skipOffset||0:t.skipOffset,this.l=t.skipFor,this.B=n,this.o=i,this.m=r,this.u=a,this.C=t.overlay}function bf(e,t,n){this.g=e,this.j=t,this.h=n,this.i=null==e.overlay}function wf(e,t,n,i){var r=this;this.M=null,this.m=e,this.C=t,this.g=n,this.G=null,this.u=!0,this.h=this.g,this.va=i,this.ma=new Set,this.T=new Set,this.H=new Set,this.F=new Map,this.K=new Map,this.i=new Xd,Mf(this),this.I=new te,this.j=new te,this.J=!1,this.$=this.o=this.B=this.l=null,this.aa=!1,this.O=-1,this.X=function(){if(!r.J&&r.l&&!r.C.wa()){r.l=r.g.currentTime;var e=kf(r);e&&Af(r,e,1,1,Date.now())}},this.V=function(){if(!(r.J||r.l||r.C.wa())){r.l=r.g.currentTime;var e=kf(r,!0);e||(e=kf(r)),e&&Af(r,e,1,1,Date.now())}},this.oa=function(){if(!r.J&&r.l&&!r.C.wa()){var e=r.g.currentTime;r.B&&!r.B.pre&&!r.B.post&&e<(r.B.endTime||r.B.startTime)&&(r.B=null)}},this.R=new Si(this.X),this.N=new Si((function(){var e,t,n,i,a,o,s,u,l,c,d;return R((function(h){switch(h.g){case 1:if(!r.H.size||null==r.l){h.A(0);break}if((e=r.C.m)==Zh||e==ef)return h.return();t=!1,n=Array.from(r.H),i=r.C.Qa(),a=p(n),o=a.next();case 3:if(o.done){h.A(5);break}if((s=o.value)==r.B){h.A(4);break}if(u=s.endTime||s.startTime,!(i.start-u>=1)){(l=s.startTime-r.l)>0&&l<=10&&(!r.F.has(s)&&Rf(s)&&r.F.set(s,r.i.preload(s.uri,null,s.mimeType||void 0)),Lf(r,s)),h.A(4);break}if(!r.F.has(s)){h.A(7);break}return w(h,r.F.get(s),8);case 8:(c=h.h)&&c.destroy(),r.F.delete(s);case 7:Nf(r,s),d=s.id||JSON.stringify(s),r.T.has(d)&&r.T.delete(d),r.H.delete(s),_f(r),s.overlay||(t=!0);case 4:o=a.next(),h.A(3);break;case 5:t&&Cf(r),_(h)}}))})),this.configure(this.C.getConfiguration().ads)}function _f(e){e.aa&&!e.H.size&&(e.I.Ma(e.g,"playing",e.V),e.I.Ma(e.g,"timeupdate",e.V),e.I.Ma(e.g,"seeked",e.oa),e.I.Ma(e.g,"ended",e.X),-1!=e.O&&(e.g.cancelVideoFrameCallback(e.O),e.O=-1),e.R&&e.R.stop(),e.N&&e.N.stop(),e.aa=!1)}function Sf(e){if(e.m&&e.M){var t=e.M.supportsMultipleMediaElements,n=e.g;(n.webkitPresentationMode&&"inline"!==n.webkitPresentationMode||n.webkitDisplayingFullscreen)&&(t=!1),e.u==t&&(e.u=!t,e.u?(e.h=e.g,e.G&&(e.G.parentElement&&e.m.removeChild(e.G),e.G=null)):(e.G||((t=document.createElement(e.g.tagName)).autoplay=!0,t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.display="none",t.setAttribute("playsinline",""),e.G=t),e.h=e.G))}else e.u=!0}function Tf(e,t){var n,i,r;R((function(a){if(1==a.g){if(n=null,(i=t.values.find((function(e){return"ID"==e.key})))&&(n=i.data),n){if(e.ma.has(n))return a.return();e.ma.add(n)}return Mf(e),r=[],t&&t.values.find((function(e){return"X-OVERLAY-ID"==e.key}))?(r=function(e){var t=[];if(!e)return t;var n=e.values.find((function(e){return"X-ASSET-URI"==e.key}));if(!n)return t;if(n=n.data,!n)return t;var i=null,r=e.values.find((function(e){return"X-OVERLAY-ID"==e.key}));r&&(i=r.data),r=null==i?Math.floor(10*e.startTime)/10:e.startTime;var a=e.endTime;e.endTime&&e.endTime!=1/0&&"number"==typeof e.endTime&&(a=null==i?Math.floor(10*e.endTime)/10:e.endTime);var o=!1,s=!1,u=!1,l=e.values.find((function(e){return"CUE"==e.key}));l&&(u=l.data,o=u.includes("ONCE"),s=u.includes("PRE"),u=u.includes("POST")),l=null;var c=e.values.find((function(e){return"X-ASSET-MIMETYPE"==e.key}));c&&(l=c.data),c=!1;var d=e.values.find((function(e){return"X-LOOP"==e.key}));d&&(c="YES"==d.data),d=1;var h=e.values.find((function(e){return"X-DEPTH"==e.key}));h&&(d=parseFloat(h.data),isNaN(d)&&(d=1)),h=null;var f=e.values.find((function(e){return"X-BACKGROUND"==e.key}));f&&(h=f.data),f=1920;var p=1080,g=e.values.find((function(e){return"X-VIEWPORT"==e.key}));if(g){if(2!=(p=g.data.split("x")).length)return t;f=parseFloat(p[0]),p=parseFloat(p[1])}if(f={viewport:{x:f,y:p},topLeft:{x:0,y:0},size:{x:f,y:p}},p=e.values.find((function(e){return"X-OVERLAY-POSITION"==e.key}))){if(2!=(p=p.data.split("x")).length)return t;f.topLeft.x=parseFloat(p[0]),f.topLeft.y=parseFloat(p[1])}if(p=e.values.find((function(e){return"X-OVERLAY-SIZE"==e.key}))){if(2!=(p=p.data.split("x")).length)return t;f.size.x=parseFloat(p[0]),f.size.y=parseFloat(p[1])}if(p=null,(g=e.values.find((function(e){return"X-SQUEEZECURRENT"==e.key})))&&(p=parseFloat(g.data),isNaN(p)&&(p=1),p={viewport:{x:1920,y:1080},topLeft:{x:0,y:0},size:{x:1920*p,y:1080*p}},e=e.values.find((function(e){return"X-SQUEEZECURRENT-POSITION"==e.key})))){if(2!=(e=e.data.split("x")).length)return t;p.topLeft.x=parseFloat(e[0]),p.topLeft.y=parseFloat(e[1])}return t.push({id:i,groupId:null,startTime:r,endTime:a,uri:n,mimeType:l,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:null,playoutLimit:null,once:o,pre:s,post:u,timelineRange:!0,loop:c,overlay:f,displayOnBackground:-1==d,currentVideo:p,background:h,clickThroughUrl:null}),t}(t),a.A(2)):w(a,function(e,t){var n,i,r,a,o,s,u,l,c,d,h,f,p,g,m,v,y,b,_,T,A,E,I,C,M,P,D,L,N,O,j,U,F,B,H,V,q,G,z,$,K;return R((function(R){switch(R.g){case 1:if(n=[],!t)return R.return(n);if(i=t.values.find((function(e){return"X-ASSET-URI"==e.key})),r=t.values.find((function(e){return"X-ASSET-LIST"==e.key})),!i&&!r)return R.return(n);if(a=null,(o=t.values.find((function(e){return"ID"==e.key})))&&(a=o.data),s=null==a?Math.floor(10*t.startTime)/10:t.startTime,(u=t.endTime)&&t.endTime!=1/0&&"number"==typeof t.endTime&&(u=null==a?Math.floor(10*t.endTime)/10:t.endTime),l=t.values.find((function(e){return"X-RESTRICT"==e.key})),d=c=!0,l&&l.data&&(h=l.data,c=!h.includes("SKIP"),d=!h.includes("JUMP")),f=c?0:null,(p=t.values.find((function(e){return"X-ENABLE-SKIP-AFTER"==e.key})))&&(g=p.data,f=parseFloat(g),isNaN(f)&&(f=c?0:null)),m=null,(v=t.values.find((function(e){return"X-ENABLE-SKIP-FOR"==e.key})))&&(y=v.data,m=parseFloat(y),isNaN(f)&&(m=null)),b=null,(_=t.values.find((function(e){return"X-RESUME-OFFSET"==e.key})))&&(T=_.data,b=parseFloat(T),isNaN(b)&&(b=null)),A=null,(E=t.values.find((function(e){return"X-PLAYOUT-LIMIT"==e.key})))&&(I=E.data,A=parseFloat(I),isNaN(A)&&(A=null)),P=M=C=!1,(D=t.values.find((function(e){return"CUE"==e.key})))&&(L=D.data,C=L.includes("ONCE"),M=L.includes("PRE"),P=L.includes("POST")),N=!1,(O=t.values.find((function(e){return"X-TIMELINE-OCCUPIES"==e.key})))?(j=O.data,N=j.includes("RANGE")):!_&&e.C.W()&&(N=!M&&!P),i){if(!(U=i.data))return R.return(n);n.push({id:a,groupId:null,startTime:s,endTime:u,uri:U,mimeType:null,isSkippable:c,skipOffset:f,skipFor:m,canJump:d,resumeOffset:b,playoutLimit:A,once:C,pre:M,post:P,timelineRange:N,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:null}),R.A(2);break}if(!r){R.A(2);break}return(F=r.data)?(S(R,4),w(R,Pf(e,F,{type:11}),6)):R.return(n);case 6:for(B=R.h,H=He(B),V=JSON.parse(H),(q=V["SKIP-CONTROL"])&&("number"==typeof(G=q["ENABLE-SKIP-AFTER"])&&(f=parseFloat(G),isNaN(G)&&(f=c?0:null)),"number"==typeof(z=q["ENABLE-SKIP-FOR"])&&(m=parseFloat(z),isNaN(z)&&(m=null))),$=0;$<V.ASSETS.length;$++)(K=V.ASSETS[$]).URI&&n.push({id:a+"_shaka_asset_"+$,groupId:a,startTime:s,endTime:u,uri:K.URI,mimeType:null,isSkippable:c,skipOffset:f,skipFor:m,canJump:d,resumeOffset:b,playoutLimit:A,once:C,pre:M,post:P,timelineRange:N,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:null});x(R,2);break;case 4:k(R);case 2:return R.return(n)}}))}(e,t),3)}2!=a.g&&(r=a.h),r.length?xf(e,r):$("Unsupported HLS interstitial",t),_(a)}))}function xf(e,t){var n,i,r,a,o,s,u,l;R((function(c){switch(c.g){case 1:n=!1,i=p(t),r=i.next();case 2:if(r.done){c.A(4);break}if(!(a=r.value).uri){$("Missing URL in interstitial",a),c.A(3);break}if(a.mimeType){c.A(5);break}return S(c,6),o=e.i.Wb(),w(c,kc(a.uri,o,e.C.getConfiguration().streaming.retryParameters),8);case 8:a.mimeType=c.h,x(c,5);break;case 6:k(c);case 5:if(s=a.id||JSON.stringify(a),e.T.has(s)){c.A(3);break}a.loop&&!a.overlay&&$("Loop is only supported in overlay interstitials",a),a.overlay||(n=!0),e.T.add(s),e.H.add(a),u=!1,a.pre&&null==e.l?u=!0:0!=a.startTime||a.canJump?null!=e.l&&((l=a.startTime-e.l)>0&&l<=10&&(u=!0)):u=!0,u&&(!e.F.has(a)&&Rf(a)&&e.F.set(a,e.i.preload(a.uri,null,a.mimeType||void 0)),Lf(e,a));case 3:r=i.next(),c.A(2);break;case 4:n&&Cf(e),function(e){if(!e.aa&&e.H.size){if(e.I.D(e.g,"playing",e.V),e.I.D(e.g,"timeupdate",e.V),e.I.D(e.g,"seeked",e.oa),e.I.D(e.g,"ended",e.X),"requestVideoFrameCallback"in e.g&&!Df()){var t=e.g,n=function(){-1!=e.O&&(e.X(),-1!=e.O&&(e.O=t.requestVideoFrameCallback(n)))};e.O=t.requestVideoFrameCallback(n)}else e.R.Ea(.025);e.N&&e.N.Ea(1),e.aa=!0}}(e),_(c)}}))}function kf(e,t,n){t=void 0!==t&&t,n=void 0===n?null:n;var i=0,r=null;if(e.H.size&&null!=e.l){var a=e.g.ended,o=Array.from(e.H).sort((function(e,t){return t.startTime-e.startTime})),s=o;for(s=t?o.filter((function(e){return e.pre})):a?o.filter((function(e){return e.post})):o.filter((function(e){return!e.pre&&!e.post})),s=(o=p(s)).next();!s.done;s=o.next()){s=s.value;var u=!1;if(t)u=s.pre;else if(a)u=s.post;else if(!s.pre&&!s.post){var l=e.l-Math.round(1e3*s.startTime)/1e3,c=1;e.M.allowStartInMiddleOfInterstitial&&s.endTime&&s.endTime!=1/0&&(c=s.endTime-s.startTime),(l>0||0==l&&0==e.l)&&(l<=c||!s.canJump)&&(u=!(null==n&&e.B&&!e.B.pre&&!e.B.post&&e.B.startTime>=s.startTime))}u&&(!e.B||s.startTime>=e.B.startTime)&&(i==(n||0)?r=s:r&&!s.canJump&&Math.round(1e3*s.startTime)/1e3-Math.round(1e3*r.startTime)/1e3>.001&&(r=s,i=0),i++)}}return r}function Af(t,n,i,r,a,o){o=void 0===o?0:o,t.B=n,Sf(t),t.u||!t.m||t.h.parentElement||t.m.appendChild(t.h),1==r&&1==i&&(i=Array.from(t.H).filter((function(e){return n.pre?e.pre==n.pre:n.post?e.post==n.post:Math.abs(e.startTime-n.startTime)<.001})).length),n.once&&(o++,t.H.delete(n),_f(t),n.overlay||Cf(t)),n.mimeType&&(n.mimeType.startsWith("image/")||"text/html"===n.mimeType)?n.overlay?function(t,n,i,r,a){function o(){t.o&&(t.o.stop(),t.o=null),t.m.removeChild(l),If(t,n),Of(t,"ad-stopped"),t.j.Pa();var e=kf(t,n.pre,r-a);e?Af(t,e,i,++r,Date.now(),a):t.J=!1}t.J=!0;var s=n.overlay,u="text/html"==n.mimeType?"iframe":"img",l=document.createElement(u);l.style.objectFit="contain",l.style.position="absolute",l.style.border="none",Ef(t,n);var c=new bf(n,i,r);Of(t,"ad-impression"),Of(t,"ad-started",(new Map).set("ad",c)),"iframe"==u?l.src=n.uri:(l.src=n.uri,l.onerror=function(e){Of(t,"ad-error",(new Map).set("originalEvent",e)),o()}),c=s.viewport;var d=s.topLeft;s=s.size,0==c.x&&0==c.y?(l.width=n.overlay.size.x,l.height=n.overlay.size.y,l.style.bottom="10%",l.style.left="0",l.style.right="0",l.style.width="100%",n.overlay.size.y||"iframe"!=u||(l.style.height="auto")):(l.style.height=s.y/c.y*100+"%",l.style.left=d.x/c.x*100+"%",l.style.top=d.y/c.y*100+"%",l.style.width=s.x/c.x*100+"%"),t.m.appendChild(l);var h=Date.now();t.o&&t.o.stop(),t.o=new Si((function(){n.playoutLimit&&(Date.now()-h)/1e3>n.playoutLimit||n.endTime&&t.g.currentTime>n.endTime?(Of(t,"ad-complete"),o()):t.g.currentTime<n.startTime&&(Of(t,"ad-skipped"),o())})),n.playoutLimit&&!n.endTime?t.o.ia(n.playoutLimit):n.endTime&&t.o.Ea(.025),t.j.D(t.g,"seeked",(function(){var e=t.g.currentTime;(e<n.startTime||n.endTime&&e>n.endTime)&&(t.o&&t.o.stop(),Of(t,"ad-skipped"),o())})),n.clickThroughUrl&&t.j.D(l,"click",(function(){n.clickThroughUrl&&e.open(n.clickThroughUrl,"_blank")}))}(t,n,i,r,o):$("Unsupported interstitial",n):t.u&&n.overlay?$("Unsupported interstitial",n):function(t,n,i,r,a,o){var s,u,l,c,d,h,f,p,g,m,v,y,b,T,A,E,I,C,M,P,D;R((function(L){switch(L.g){case 1:if(s=Date.now(),t.J=!0,u=!1,l=function(){if(!t.u&&!n.overlay&&null==n.resumeOffset)if(n.timelineRange&&n.endTime&&n.endTime!=1/0)t.g.currentTime!=n.endTime&&(t.g.currentTime=n.endTime);else{var e=Date.now();t.g.currentTime+=(e-a)/1e3,a=e}},c=function(e){var s,u;return R((function(c){if(1==c.g){if(l(),s=kf(t,n.pre,r-o),e&&n.groupId)for(;s&&s.groupId==n.groupId;)r++,s=kf(t,n.pre,r-o);return t.o&&(!n.groupId||s&&s.groupId!=n.groupId)&&(t.o.stop(),t.o=null),If(t,n),s&&!s.overlay?c.A(2):(n.post&&(t.l=null,t.B=null),t.u?w(c,t.i.detach(),4):w(c,t.i.Bc(),4))}2!=c.g&&(t.u&&(null==(u=n.resumeOffset)&&(u=n.timelineRange&&n.endTime&&n.endTime!=1/0?n.endTime-(t.l||0):(Date.now()-a)/1e3),Of(t,"ad-content-resume-requested",(new Map).set("offset",u))),Of(t,"ad-stopped"),t.j.Pa(),t.J=!1,t.u?Cf(t):(t.h.style.display="none",l(),t.g.ended||t.g.play())),Sf(t),s&&(Of(t,"ad-stopped"),t.j.Pa(),Af(t,s,i,++r,a,o)),_(c)}))},d=function(e){return R((function(n){return u?n.return():(u=!0,Of(t,"ad-error",(new Map).set("originalEvent",e)),w(n,c(!1),0))}))},h=function(){return R((function(e){if(1==e.g)return u?e.return():(u=!0,w(e,c(!1),2));Of(t,"ad-complete"),_(e)}))},t.$=function(){return R((function(e){return u?e.return():(u=!0,Of(t,"ad-skipped"),w(e,c(!0),0))}))},f=new yf(t.h,n,t.$,i,r,!t.u),t.u||(f.setMuted(t.g.muted),f.setVolume(t.g.volume)),Of(t,"ad-started",(new Map).set("ad",f)),(p=f.canSkipNow())&&Of(t,"ad-skip-state-changed"),t.j.Ba(t.i,"error",d),t.j.D(t.h,"timeupdate",(function(){if(t.h.duration){var e=f.canSkipNow();p!=e&&f.getRemainingTime()>0&&f.getDuration()>0&&Of(t,"ad-skip-state-changed"),p=e,!t.u&&!n.overlay&&null==n.resumeOffset&&n.timelineRange&&n.endTime&&n.endTime!=1/0&&t.g.currentTime!=n.endTime&&t.C.Qa().end>=n.endTime&&(t.g.currentTime=n.endTime)}})),t.j.Ba(t.i,"firstquartile",(function(){l(),Of(t,"ad-first-quartile")})),t.j.Ba(t.i,"midpoint",(function(){l(),Of(t,"ad-midpoint")})),t.j.Ba(t.i,"thirdquartile",(function(){l(),Of(t,"ad-third-quartile")})),t.j.Ba(t.i,"complete",h),t.j.D(t.h,"play",(function(){Of(t,"ad-resumed")})),t.j.D(t.h,"pause",(function(){var e=t.i.getConfiguration();t.h.currentTime>=e.playRangeEnd?h():Of(t,"ad-paused")})),t.j.D(t.h,"volumechange",(function(){t.h.muted?Of(t,"ad-muted"):Of(t,"ad-volume-changed")})),n.clickThroughUrl&&(g=t.m||t.h,t.j.D(g,"click",(function(){n.clickThroughUrl&&(f.isPaused()||f.pause(),e.open(n.clickThroughUrl,"_blank"))}))),!t.u||1!=r){L.A(2);break}return Of(t,"ad-content-pause-requested",(new Map).set("saveLivePosition",!0)),m=new Ar,v=function(e){return R((function(n){if(1==n.g)return"detach"!=e.state?n.A(0):Df()?w(n,new Promise((function(e){return new Si(e).ia(.1)})),3):n.A(3);m.resolve(),t.j.Ma(t.C,"onstatechange",v),_(n)}))},t.j.D(t.C,"onstatechange",v),w(L,m,2);case 2:return Ef(t,n),t.u||(t.h.style.display="",n.overlay?(t.h.loop=n.loop,y=n.overlay.viewport,b=n.overlay.topLeft,T=n.overlay.size,t.h.style.height=T.y/y.y*100+"%",t.h.style.left=b.x/y.x*100+"%",t.h.style.top=b.y/y.y*100+"%",t.h.style.width=T.x/y.x*100+"%"):(t.g.pause(),null!=n.resumeOffset&&0!=n.resumeOffset&&(t.g.currentTime+=n.resumeOffset),t.h.loop=!1,t.h.style.height="100%",t.h.style.left="0",t.h.style.top="0",t.h.style.width="100%")),S(L,4),Mf(t),n.startTime&&n.endTime&&n.endTime!=1/0&&n.startTime!=n.endTime&&((A=n.endTime-n.startTime)>0&&t.i.configure("playRangeEnd",A)),n.playoutLimit&&!t.o&&(t.o=new Si((function(){t.$()})).ia(n.playoutLimit),t.i.configure("playRangeEnd",n.playoutLimit)),w(L,t.i.fc(t.h),6);case 6:return E=null,t.M.allowStartInMiddleOfInterstitial&&null!=t.l&&(I=t.l-n.startTime,Math.abs(I)>.25&&(E=I)),t.F.has(n)?w(L,t.F.get(n),10):w(L,t.i.load(n.uri,E,n.mimeType||void 0),8);case 10:return C=L.h,t.F.delete(n),w(L,C?t.i.load(C):t.i.load(n.uri,E,n.mimeType||void 0),8);case 8:n.overlay&&t.g.paused?t.h.pause():t.h.play(),M=(Date.now()-s)/1e3,Of(t,"ads-loaded",(new Map).set("loadTime",M)),t.u&&t.g.play(),n.overlay&&(n.pre||n.post||t.C.W()&&!(n.startTime>0)||(P=function(){var e=t.g.currentTime-n.startTime;Math.abs(e-t.h.currentTime)>.1&&(t.h.currentTime=e)},t.j.Ba(t.h,"playing",P),t.j.D(t.g,"seeking",P)),t.j.D(t.g,"seeked",(function(){var e=t.g.currentTime;(e<n.startTime||n.endTime&&e>n.endTime)&&t.$()}))),x(L,0);break;case 4:if(D=k(L),!t.J)return L.return();d(D),_(L)}}))}(t,n,i,r,a,o)}function Ef(e,t){if(t.displayOnBackground&&(e.g.style.zIndex="1"),null!=t.currentVideo){var n=t.currentVideo;e.g.style.transformOrigin="top left";var i=!0,r=[],a=n.topLeft.x/n.viewport.x*100;a>0&&a<=100&&(r.push("translateX("+a+"%)"),i=!1),(a=n.topLeft.y/n.viewport.y*100)>0&&a<=100&&(r.push("translateY("+a+"%)"),i=!1),(a=n.size.x/n.viewport.x)<1&&r.push("scaleX("+a+")"),n=n.size.y/n.viewport.y,a<1&&r.push("scaleY("+n+")"),r.length&&(e.g.style.transform=r.join(" ")),i&&(e.g.style.transition="transform 250ms")}e.m&&(t.clickThroughUrl?(e.m.setAttribute("ad-active","true"),e.m.style.pointerEvents=""):e.m.style.pointerEvents="none",t.background&&(e.m.style.background=t.background)),e.G&&(e.G.style.background=t.overlay?"":"rgb(0, 0, 0)")}function If(e,t){t&&!t.displayOnBackground||(e.g.style.zIndex=""),t&&null==t.currentVideo||(e.g.style.transformOrigin="",e.g.style.transition="",e.g.style.transform=""),e.m&&(e.m.removeAttribute("ad-active"),e.m.style.pointerEvents="",!t||t.background)&&(e.m.style.background=""),e.G&&(e.G.style.background="")}function Cf(e){for(var t=[],n=p(e.H),i=n.next(),r={};!i.done;r={Ac:void 0},i=n.next())(i=i.value).overlay||(r.Ac={start:i.startTime,end:null},i.pre?(r.Ac.start=0,r.Ac.end=null):i.post?(r.Ac.start=-1,r.Ac.end=null):i.timelineRange&&(r.Ac.end=i.endTime),t.find(function(e){return function(t){return e.Ac.start==t.start&&e.Ac.end==t.end}}(r))||t.push(r.Ac));Of(e,"ad-cue-points-changed",(new Map).set("cuepoints",t))}function Mf(e){e.i.configure(e.C.ci()),e.i.configure("ads.disableHLSInterstitial",!0),e.i.configure("ads.disableDASHInterstitial",!0),e.i.configure("playRangeEnd",1/0),Hr(e.C.Wb(),e.i.Wb())}function Pf(e,t,n){var i,r;return R((function(a){return 1==a.g?(i=Vr([t],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}),w(a,e.C.Wb().request(7,i,n).promise,2)):(r=a.h,a.return(r.data))}))}function Rf(e){return!(e=e.mimeType)||!e.startsWith("image/")&&"text/html"!==e}function Df(){var e=ae().Ua();return"TV"==e||"CONSOLE"==e||"CAST"==e}function Lf(e,t){if(!(e.K.has(t)||e.M&&!e.M.allowPreloadOnDomElements)){var n=function(e){var t=document.createElement("link");return t.rel="preload",t.href=e,t.as="image",document.head.appendChild(t),t},i=[];if(t.background){var r=t.background.match(/url\(('|")?([^'"()]+)('|")\)?/);r&&i.push(n(r[2]))}t.mimeType&&t.mimeType.startsWith("image/")&&i.push(n(t.uri)),e.K.set(t,i)}}function Nf(e,t){if(e.K.has(t)){for(var n=e.K.get(t),i=(n=p(n)).next();!i.done;i=n.next())(i=i.value).parentNode.removeChild(i);e.K.delete(t)}}function Of(e,t,n){e.va(new Dr(t,n))}function jf(e,t,n,i,r){this.h=e,this.j=Ot(this.h.skipOffset),this.g=r,this.i=t,this.l=n,this.o=i,this.m=!1}function Uf(e,t,n,i){this.C=e,this.K=t,this.h=n,this.l=null,this.R=NaN,this.i=i,this.J=!1,this.B=null,this.j=[],this.N=[],this.M=this.F=this.g=null,this.G=new Map,this.m=[],this.u=[],this.H="",this.O=!0,this.I="",this.o=new te}function Ff(e,t){var n,i,r,a,o,s,u,l;R((function(c){return 1==c.g?t.staticResource?(n=Bf(t),e.G.get(n)?c.return():(i={type:9},r=Vr([t.staticResource],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}),a=e.K.request(7,r,i),S(c,2),e.G.set(n,[]),w(c,a.promise,4))):c.return():2!=c.g?(o=c.h,s=He(o.data),u=JSON.parse(s),l=u.apps,e.G.set(n,l),x(c,0)):(k(c),e.G.delete(n),void _(c))}))}function Bf(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")}function Hf(e){var t=e.h.currentTime;if(0!=t&&null==e.B){for(var n,i,r=p(e.j),a=r.next();!a.done;a=r.next())for(var o=p((a=a.value).ads),s=o.next();!s.done;s=o.next())if(s=s.value,i){if(s.startTimeInSeconds<t&&s.startTimeInSeconds>i.startTimeInSeconds+i.durationInSeconds){i=s,n=a;break}}else s.startTimeInSeconds<t&&(i=s,n=a);n&&i&&!e.N.includes(i.adId)&&(e.B=t,e.h.currentTime=n.startTimeInSeconds)}}function Vf(e){if(e.h.duration&&(e.g||e.j.length)){var t=e.h.currentTime,n=!1;if(e.g){n=!0;var i=e.F,r=i.startTimeInSeconds+.5*i.durationInSeconds,a=i.startTimeInSeconds+.75*i.durationInSeconds;t>=i.startTimeInSeconds+.25*i.durationInSeconds&&!e.u.includes("firstQuartile")?(e.u.push("firstQuartile"),zf(e,"firstQuartile")):t>=r&&!e.u.includes("midpoint")?(e.u.push("midpoint"),zf(e,"midpoint")):t>=a&&!e.u.includes("thirdQuartile")&&(e.u.push("thirdQuartile"),zf(e,"thirdQuartile")),i=e.g.getRemainingTime(),r=e.g.getDuration(),e.g.canSkipNow()&&i>0&&r>0&&zf(e,"skipStateChanged"),r>0&&(i<=0||i>r)&&qf(e)}if(!e.g||!e.g.isLinear()){e:for(i=p(e.j),r=i.next();!r.done&&(r=r.value,!e.g||!e.g.isLinear());r=i.next())for(a=0;a<r.ads.length;a++){var o=r.ads[a],s=o.startTimeInSeconds+o.durationInSeconds;if(o.startTimeInSeconds<=t&&s>t){if(e.N.includes(o.adId)){if(e.h.ended)continue;e.h.currentTime=s;break e}qf(e),e.M=r,e.g=new jf(o,a+1,r.ads.length,!0,e.h),e.F=o,0===a&&zf(e,"breakStart"),Gf(e);break}}if(!e.g)for(r=(i=p(e.j)).next();!r.done&&(r=r.value,!e.g);r=i.next())for(a=0;a<r.nonLinearAdsList.length;a++)if((o=r.nonLinearAdsList[a]).nonLinearAdList.length){s=r.startTimeInSeconds;var u=e.G.get(Bf(o.nonLinearAdList[0]));if(s<=t&&u&&u.length){qf(e),s=e;for(var l=(u=p(u)).next();!l.done;l=u.next())if((l=l.value).data.source.length){var c=document.createElement("img");c.src=l.data.source[0].url,c.style.top=(l.placeholder.top||0)+"%",c.style.height=100-(l.placeholder.top||0)+"%",c.style.left=(l.placeholder.left||0)+"%",c.style.maxWidth=100-(l.placeholder.left||0)+"%",c.style.objectFit="contain",c.style.position="absolute",s.C.appendChild(c)}e.M=r,e.g=new jf(o,a+1,r.ads.length,!1,e.h),e.F=o,0===a&&zf(e,"breakStart"),Gf(e);break}}n&&!e.g&&(t=e.h.currentTime,e.B&&e.B>t&&(e.h.currentTime=e.B),e.B=null)}}}function qf(e){if(e.g){for(;e.C.lastChild;)e.C.removeChild(e.C.firstChild);e.J||e.N.push(e.F.adId);var t=e.g.m;zf(e,void 0!==t&&t?"skip":"complete");for(var n=(t=p(e.m)).next();!n.done;n=t.next())n=n.value,e.o.Ma(n.target,n.type,n.listener);e.m=[],e.u=[],(t=e.g.getPositionInSequence())===(n=e.g.getSequenceLength())&&zf(e,"breakEnd"),e.g=null,e.F=null,e.M=null}}function Gf(e){var t=!1;e.h.paused?t=!0:(zf(e,"impression"),zf(e,"start")),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted&&zf(e,"mute")}}),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted||zf(e,"unmute")}}),e.m.push({target:e.h,type:"play",listener:function(){t?(zf(e,"impression"),zf(e,"start"),t=!1):zf(e,"resume")}}),e.m.push({target:e.h,type:"pause",listener:function(){zf(e,"pause")}});for(var n=p(e.m),i=n.next();!i.done;i=n.next())i=i.value,e.o.D(i.target,i.type,i.listener)}function zf(e,t){var n=e.F.trackingEvents.find((function(e){return e.eventType==t}));if(n||(n=e.M.adBreakTrackingEvents.find((function(e){return e.eventType==t}))),n)for(var i={type:10},r=(n=p(n.beaconUrls)).next();!r.done;r=n.next())(r=r.value)&&""!=r&&((r=Vr([r],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4})).method="POST",e.K.request(7,r,i));switch(t){case"impression":e.i(new Dr("ad-impression"));break;case"start":e.i(new Dr("ad-started",(new Map).set("ad",e.g)));break;case"mute":e.i(new Dr("ad-muted"));break;case"unmute":e.i(new Dr("ad-volume-changed"));break;case"resume":e.i(new Dr("ad-resumed"));break;case"pause":e.i(new Dr("ad-paused"));break;case"firstQuartile":e.i(new Dr("ad-first-quartile"));break;case"midpoint":e.i(new Dr("ad-midpoint"));break;case"thirdQuartile":e.i(new Dr("ad-third-quartile"));break;case"complete":e.i(new Dr("ad-complete")),e.i(new Dr("ad-stopped"));break;case"skip":e.i(new Dr("ad-skipped")),e.i(new Dr("ad-stopped"));break;case"breakStart":e.C.setAttribute("ad-active","true");break;case"breakEnd":e.C.removeAttribute("ad-active");break;case"skipStateChanged":e.i(new Dr("ad-skip-state-changed"))}}function $f(e,t){this.g=e,this.i=null,this.h=t}function Kf(e,t,n,i){var r=this;this.u=e,this.l=t,this.j=null,this.G=NaN,this.i=i,this.H=!1,this.B=this.m=this.o=null,this.C="",this.F=[],this.h=new te,(e=new google.ima.dai.api.UiSettings).setLocale(n),this.g=new google.ima.dai.api.StreamManager(this.l,this.u,e),this.i(new Dr("ima-stream-manager-loaded",(new Map).set("imaStreamManager",this.g))),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,(function(e){!function(e,t){e.i(new Dr("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-e.G))),t=t.getStreamData().url,e.j.resolve(t),e.j=null,e.H||e.h.D(e.l,"seeked",(function(){var t=e.l.currentTime;if(0!=t){e.g.streamTimeForContentTime(t);var n=e.g.previousCuePointForStreamTime(t);n&&!n.played&&(e.o=t,e.l.currentTime=n.start)}}))}(r,e)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,(function(){r.C.length?r.j.resolve(r.C):r.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),r.j=null})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,(function(){})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,(function(e){e=e.getAd(),r.m=new $f(e,r.l),r.B&&(r.m.i=r.B),r.i(new Dr("ad-started",(new Map).set("ad",r.m))),r.u.setAttribute("ad-active","true")})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,(function(){r.u.removeAttribute("ad-active");var e=r.l.currentTime;r.o&&r.o>e&&(r.l.currentTime=r.o,r.o=null)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,(function(e){r.B=e.getStreamData().adProgressData,r.m&&(r.m.i=r.B)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,(function(){r.i(new Dr("ad-first-quartile"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,(function(){r.i(new Dr("ad-midpoint"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,(function(){r.i(new Dr("ad-third-quartile"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,(function(){r.i(new Dr("ad-complete")),r.i(new Dr("ad-stopped")),r.u.removeAttribute("ad-active"),r.m=null})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,(function(){r.i(new Dr("ad-skipped")),r.i(new Dr("ad-stopped"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,(function(e){var t=e.getStreamData();e=[];for(var n=(t=p(t.cuepoints)).next();!n.done;n=t.next())n=n.value,e.push({start:n.start,end:n.end});r.F=e,r.i(new Dr("ad-cue-points-changed",(new Map).set("cuepoints",e)))}))}function Wf(){Or.call(this),this.h=this.i=this.j=this.g=null,this.m=new uf,this.o=navigator.language,this.l=null}function Xf(e,t){if(t&&t.type)switch(t.type){case"ads-loaded":e.m.g.push(t.loadTime);break;case"ad-started":e.m.h++;var n=t.ad;n&&!n.isLinear()&&e.m.j++;break;case"ad-complete":e.m.l++;break;case"ad-skipped":e.m.m++;break;case"ad-error":e.m.i++}e.dispatchEvent(t)}function Yf(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Dr){var n={};for(i in t)(e=t[i])&&"object"==typeof e?"detail"==i&&(n[i]=e):i in Event||(n[i]=e);return n}if(t instanceof Error){var i=new Set(["name","message","stack"]);for(n in t)i.add(n);for(e=(n=p(Object.getOwnPropertyNames(t))).next();!e.done;e=n.next())i.add(e.value);for(n={},e=(i=p(i)).next();!e.done;e=i.next())n[e=e.value]=t[e];t={__type__:"Error",contents:n}}else if(t instanceof TimeRanges){for(i={__type__:"TimeRanges",length:t.length,start:[],end:[]},n=(t=p(Xo(t))).next();!n.done;n=t.next())e=(n=n.value).end,i.start.push(n.start),i.end.push(e);t=i}else t=ArrayBuffer.isView(t)&&1===t.BYTES_PER_ELEMENT?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:t<0?"-Infinity":"Infinity":t;return t}}))}function Jf(e){return JSON.parse(e,(function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t);else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){for(n in e=t.contents,t=Error(e.message),e)t[n]=e[n];n=t}else n=t;return n}))}(i=cf.prototype).needsSkipUI=function(){return!1},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return!0},i.isUsingAnotherMediaElement=function(){return!0},i.getDuration=function(){return this.g.getDuration()},i.getMinSuggestedDuration=function(){return this.g.getMinSuggestedDuration()},i.getRemainingTime=function(){return this.h.getRemainingTime()},i.isPaused=function(){return this.i},i.isSkippable=function(){return this.g.getSkipTimeOffset()>=0},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return this.h.getAdSkippableState()},i.skip=function(){return this.h.skip()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.resume()},i.getVolume=function(){return this.h.getVolume()},i.setVolume=function(e){return this.m.volume=e,this.h.setVolume(e)},i.isMuted=function(){return 0==this.h.getVolume()},i.isLinear=function(){return this.g.isLinear()},i.resize=function(e,t){this.h.resize(e,t)},i.setMuted=function(e){(this.m.muted=e)?(this.j=this.getVolume(),this.h.setVolume(0)):this.h.setVolume(this.j)},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return this.g.getVastMediaBitrate()},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getVastAdId=function(){return""},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return this.g.getMediaUrl()},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.g=null},B("shaka.ads.ClientSideAd",cf),cf.prototype.release=cf.prototype.release,cf.prototype.getPodIndex=cf.prototype.getPodIndex,cf.prototype.getTimeOffset=cf.prototype.getTimeOffset,cf.prototype.getMediaUrl=cf.prototype.getMediaUrl,cf.prototype.getAdvertiserName=cf.prototype.getAdvertiserName,cf.prototype.getCreativeAdId=cf.prototype.getCreativeAdId,cf.prototype.getAdId=cf.prototype.getAdId,cf.prototype.getVastAdId=cf.prototype.getVastAdId,cf.prototype.getVastMediaWidth=cf.prototype.getVastMediaWidth,cf.prototype.getVastMediaHeight=cf.prototype.getVastMediaHeight,cf.prototype.getVastMediaBitrate=cf.prototype.getVastMediaBitrate,cf.prototype.getDescription=cf.prototype.getDescription,cf.prototype.getTitle=cf.prototype.getTitle,cf.prototype.getPositionInSequence=cf.prototype.getPositionInSequence,cf.prototype.getSequenceLength=cf.prototype.getSequenceLength,cf.prototype.setMuted=cf.prototype.setMuted,cf.prototype.resize=cf.prototype.resize,cf.prototype.isLinear=cf.prototype.isLinear,cf.prototype.isMuted=cf.prototype.isMuted,cf.prototype.setVolume=cf.prototype.setVolume,cf.prototype.getVolume=cf.prototype.getVolume,cf.prototype.play=cf.prototype.play,cf.prototype.pause=cf.prototype.pause,cf.prototype.skip=cf.prototype.skip,cf.prototype.canSkipNow=cf.prototype.canSkipNow,cf.prototype.getTimeUntilSkippable=cf.prototype.getTimeUntilSkippable,cf.prototype.isSkippable=cf.prototype.isSkippable,cf.prototype.isPaused=cf.prototype.isPaused,cf.prototype.getRemainingTime=cf.prototype.getRemainingTime,cf.prototype.getMinSuggestedDuration=cf.prototype.getMinSuggestedDuration,cf.prototype.getDuration=cf.prototype.getDuration,cf.prototype.isUsingAnotherMediaElement=cf.prototype.isUsingAnotherMediaElement,cf.prototype.hasCustomClick=cf.prototype.hasCustomClick,cf.prototype.isClientRendering=cf.prototype.isClientRendering,cf.prototype.needsSkipUI=cf.prototype.needsSkipUI,B("shaka.ads.Utils",df),df.ADS_LOADED="ads-loaded",df.AD_STARTED="ad-started",df.AD_FIRST_QUARTILE="ad-first-quartile",df.AD_MIDPOINT="ad-midpoint",df.AD_THIRD_QUARTILE="ad-third-quartile",df.AD_COMPLETE="ad-complete",df.AD_STOPPED="ad-stopped",df.AD_SKIPPED="ad-skipped",df.AD_VOLUME_CHANGED="ad-volume-changed",df.AD_MUTED="ad-muted",df.AD_PAUSED="ad-paused",df.AD_RESUMED="ad-resumed",df.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",df.CUEPOINTS_CHANGED="ad-cue-points-changed",df.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",df.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",df.AD_CLICKED="ad-clicked",df.AD_PROGRESS="ad-progress",df.AD_BUFFERING="ad-buffering",df.AD_IMPRESSION="ad-impression",df.AD_DURATION_CHANGED="ad-duration-changed",df.AD_CLOSED="ad-closed",df.AD_LOADED="ad-loaded",df.ALL_ADS_COMPLETED="all-ads-completed",df.AD_LINEAR_CHANGED="ad-linear-changed",df.AD_METADATA="ad-metadata",df.AD_RECOVERABLE_ERROR="ad-recoverable-error",df.AD_ERROR="ad-error",df.AD_BREAK_READY="ad-break-ready",df.AD_INTERACTION="ad-interaction",df.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",df.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",df.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",pf.prototype.configure=function(e){this.o=e},pf.prototype.stop=function(){this.g&&this.g.stop(),this.u&&Zo(this.u)},pf.prototype.release=function(){this.stop(),this.B&&this.B.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.m.destroy(),this.F.destroy()},(i=yf.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return null!=this.h.clickThroughUrl},i.isUsingAnotherMediaElement=function(){return this.u},i.getDuration=function(){var e=this.g.duration;return isNaN(e)?-1:e},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){var e=this.g.duration;return isNaN(e)?-1:e-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return this.i&&null!=this.l?this.getDuration()-this.getRemainingTime()<this.j+this.l:this.i},i.getTimeUntilSkippable=function(){if(this.isSkippable()){var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)}return Math.max(this.getRemainingTime(),0)},i.canSkipNow=function(){return this.i&&0==this.getTimeUntilSkippable()},i.skip=function(){this.canSkipNow()&&this.B()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return null==this.C},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.o},i.getPositionInSequence=function(){return this.m},i.getTitle=function(){return""},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getVastAdId=function(){return""},i.getAdId=function(){return this.h.id||""},i.getCreativeAdId=function(){return""},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return this.h.uri},i.getTimeOffset=function(){return this.h.pre?0:this.h.post?-1:this.h.startTime},i.getPodIndex=function(){return 0},i.release=function(){this.g=null},B("shaka.ads.InterstitialAd",yf),yf.prototype.release=yf.prototype.release,yf.prototype.getPodIndex=yf.prototype.getPodIndex,yf.prototype.getTimeOffset=yf.prototype.getTimeOffset,yf.prototype.getMediaUrl=yf.prototype.getMediaUrl,yf.prototype.getAdvertiserName=yf.prototype.getAdvertiserName,yf.prototype.getCreativeAdId=yf.prototype.getCreativeAdId,yf.prototype.getAdId=yf.prototype.getAdId,yf.prototype.getVastAdId=yf.prototype.getVastAdId,yf.prototype.getVastMediaWidth=yf.prototype.getVastMediaWidth,yf.prototype.getVastMediaHeight=yf.prototype.getVastMediaHeight,yf.prototype.getVastMediaBitrate=yf.prototype.getVastMediaBitrate,yf.prototype.getDescription=yf.prototype.getDescription,yf.prototype.getTitle=yf.prototype.getTitle,yf.prototype.getPositionInSequence=yf.prototype.getPositionInSequence,yf.prototype.getSequenceLength=yf.prototype.getSequenceLength,yf.prototype.setMuted=yf.prototype.setMuted,yf.prototype.resize=yf.prototype.resize,yf.prototype.isLinear=yf.prototype.isLinear,yf.prototype.isMuted=yf.prototype.isMuted,yf.prototype.setVolume=yf.prototype.setVolume,yf.prototype.getVolume=yf.prototype.getVolume,yf.prototype.play=yf.prototype.play,yf.prototype.pause=yf.prototype.pause,yf.prototype.skip=yf.prototype.skip,yf.prototype.canSkipNow=yf.prototype.canSkipNow,yf.prototype.getTimeUntilSkippable=yf.prototype.getTimeUntilSkippable,yf.prototype.isSkippable=yf.prototype.isSkippable,yf.prototype.isPaused=yf.prototype.isPaused,yf.prototype.getRemainingTime=yf.prototype.getRemainingTime,yf.prototype.getMinSuggestedDuration=yf.prototype.getMinSuggestedDuration,yf.prototype.getDuration=yf.prototype.getDuration,yf.prototype.isUsingAnotherMediaElement=yf.prototype.isUsingAnotherMediaElement,yf.prototype.hasCustomClick=yf.prototype.hasCustomClick,yf.prototype.isClientRendering=yf.prototype.isClientRendering,yf.prototype.needsSkipUI=yf.prototype.needsSkipUI,(i=bf.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!0},i.hasCustomClick=function(){return null!=this.g.clickThroughUrl},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return-1},i.isPaused=function(){return!1},i.isSkippable=function(){return!1},i.getTimeUntilSkippable=function(){return 0},i.canSkipNow=function(){return!1},i.skip=function(){},i.pause=function(){},i.play=function(){},i.getVolume=function(){return 1},i.setVolume=function(){},i.isMuted=function(){return!1},i.isLinear=function(){return this.i},i.resize=function(){},i.setMuted=function(){},i.getSequenceLength=function(){return this.j},i.getPositionInSequence=function(){return this.h},i.getTitle=function(){return""},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getVastAdId=function(){return""},i.getAdId=function(){return this.g.id||""},i.getCreativeAdId=function(){return""},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return this.g.uri},i.getTimeOffset=function(){return this.g.pre?0:this.g.post?-1:this.g.startTime},i.getPodIndex=function(){return 0},i.release=function(){},B("shaka.ads.InterstitialStaticAd",bf),bf.prototype.release=bf.prototype.release,bf.prototype.getPodIndex=bf.prototype.getPodIndex,bf.prototype.getTimeOffset=bf.prototype.getTimeOffset,bf.prototype.getMediaUrl=bf.prototype.getMediaUrl,bf.prototype.getAdvertiserName=bf.prototype.getAdvertiserName,bf.prototype.getCreativeAdId=bf.prototype.getCreativeAdId,bf.prototype.getAdId=bf.prototype.getAdId,bf.prototype.getVastAdId=bf.prototype.getVastAdId,bf.prototype.getVastMediaWidth=bf.prototype.getVastMediaWidth,bf.prototype.getVastMediaHeight=bf.prototype.getVastMediaHeight,bf.prototype.getVastMediaBitrate=bf.prototype.getVastMediaBitrate,bf.prototype.getDescription=bf.prototype.getDescription,bf.prototype.getTitle=bf.prototype.getTitle,bf.prototype.getPositionInSequence=bf.prototype.getPositionInSequence,bf.prototype.getSequenceLength=bf.prototype.getSequenceLength,bf.prototype.setMuted=bf.prototype.setMuted,bf.prototype.resize=bf.prototype.resize,bf.prototype.isLinear=bf.prototype.isLinear,bf.prototype.isMuted=bf.prototype.isMuted,bf.prototype.setVolume=bf.prototype.setVolume,bf.prototype.getVolume=bf.prototype.getVolume,bf.prototype.play=bf.prototype.play,bf.prototype.pause=bf.prototype.pause,bf.prototype.skip=bf.prototype.skip,bf.prototype.canSkipNow=bf.prototype.canSkipNow,bf.prototype.getTimeUntilSkippable=bf.prototype.getTimeUntilSkippable,bf.prototype.isSkippable=bf.prototype.isSkippable,bf.prototype.isPaused=bf.prototype.isPaused,bf.prototype.getRemainingTime=bf.prototype.getRemainingTime,bf.prototype.getMinSuggestedDuration=bf.prototype.getMinSuggestedDuration,bf.prototype.getDuration=bf.prototype.getDuration,bf.prototype.isUsingAnotherMediaElement=bf.prototype.isUsingAnotherMediaElement,bf.prototype.hasCustomClick=bf.prototype.hasCustomClick,bf.prototype.isClientRendering=bf.prototype.isClientRendering,bf.prototype.needsSkipUI=bf.prototype.needsSkipUI,(i=wf.prototype).configure=function(e){this.M=e,Sf(this)},i.stop=function(){if(this.j&&this.j.Pa(),this.ma.clear(),this.T.clear(),this.H.clear(),this.i.ng(),this.F.size)for(var e=Array.from(this.F.values()),t=(e=p(e)).next();!t.done;t=e.next())(t=t.value)&&t.then((function(e){e&&e.destroy()}));if(this.F.clear(),this.K.size)for(t=(e=p(e=Array.from(this.K.keys()))).next();!t.done;t=e.next())Nf(this,t.value);this.K.clear(),this.i.detach(),this.J=!1,this.B=this.l=null,this.u=!0,this.h=this.g,this.G=null,If(this),_f(this),this.m&&Zo(this.m),this.o&&(this.o.stop(),this.o=null)},i.release=function(){this.stop(),this.I&&this.I.release(),this.j&&this.j.release(),this.R&&(this.R.stop(),this.R=null),this.N&&(this.N.stop(),this.N=null),this.i.destroy()},i.td=function(){return this.i},i.addAdUrlInterstitial=function(e){var t,n,i,r,a,o,s,u,l,c=this;return R((function(d){if(1==d.g)return w(d,Pf(c,e,t={type:12}),2);if(3!=d.g){if(n=d.h,!(i=Vt(n,"VAST,vmap:VMAP")))throw new Ue(2,10,10007);if(r=[],"VAST"==i.tagName)return r=hf(i,c.l),d.A(3);if("vmap:VMAP"!=i.tagName)return d.A(3);for(a=function(e){var n,i;return R((function(a){if(1==a.g)return w(a,Pf(c,e.uri,t),2);if(n=a.h,!(i=Vt(n,"VAST")))throw new Ue(2,10,10007);r.push.apply(r,g(hf(i,e.time))),_(a)}))},o=[],s=p(function(e){for(var t=[],n=(e=p(Kt(e,"vmap:AdBreak"))).next();!n.done;n=e.next()){var i=n.value,r=i.attributes.timeOffset;r&&(n=null,n="start"==r?null:"end"==r?1/0:Ot(r),(i=Jt(i,"vmap:AdSource"))&&(i=Jt(i,"vmap:AdTagURI"))&&(i=Wt(i))&&t.push({time:n,uri:i}))}return t}(i)),u=s.next();!u.done;u=s.next())l=u.value,o.push(a(l));return o.length?w(d,Promise.all(o),3):d.A(3)}xf(c,r),_(d)}))},(i=jf.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!1},i.hasCustomClick=function(){return!1},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return this.h.durationInSeconds},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.h.startTimeInSeconds+this.h.durationInSeconds-this.g.currentTime},i.isPaused=function(){return this.g.paused},i.isSkippable=function(){return"number"==typeof this.j},i.getTimeUntilSkippable=function(){if("number"!=typeof this.j)return this.getRemainingTime();var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.m=!0,this.g.currentTime+=this.getRemainingTime()},i.pause=function(){return this.g.pause()},i.play=function(){return this.g.play()},i.getVolume=function(){return this.g.volume},i.setVolume=function(e){this.g.volume=e},i.isMuted=function(){return this.g.muted},i.isLinear=function(){return this.o},i.resize=function(){},i.setMuted=function(e){this.g.muted=e},i.getSequenceLength=function(){return this.l?this.l:1},i.getPositionInSequence=function(){return this.i?this.i:1},i.getTitle=function(){return this.h.adTitle},i.getDescription=function(){return""},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return 0},i.getVastMediaWidth=function(){return 0},i.getVastAdId=function(){return this.h.vastAdId||""},i.getAdId=function(){return this.h.adId},i.getCreativeAdId=function(){return this.h.creativeId},i.getAdvertiserName=function(){return""},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){return 0},i.getPodIndex=function(){return 0},i.release=function(){this.l=this.i=this.g=this.h=null},B("shaka.ads.MediaTailorAd",jf),jf.prototype.release=jf.prototype.release,jf.prototype.getPodIndex=jf.prototype.getPodIndex,jf.prototype.getTimeOffset=jf.prototype.getTimeOffset,jf.prototype.getMediaUrl=jf.prototype.getMediaUrl,jf.prototype.getAdvertiserName=jf.prototype.getAdvertiserName,jf.prototype.getCreativeAdId=jf.prototype.getCreativeAdId,jf.prototype.getAdId=jf.prototype.getAdId,jf.prototype.getVastAdId=jf.prototype.getVastAdId,jf.prototype.getVastMediaWidth=jf.prototype.getVastMediaWidth,jf.prototype.getVastMediaHeight=jf.prototype.getVastMediaHeight,jf.prototype.getVastMediaBitrate=jf.prototype.getVastMediaBitrate,jf.prototype.getDescription=jf.prototype.getDescription,jf.prototype.getTitle=jf.prototype.getTitle,jf.prototype.getPositionInSequence=jf.prototype.getPositionInSequence,jf.prototype.getSequenceLength=jf.prototype.getSequenceLength,jf.prototype.setMuted=jf.prototype.setMuted,jf.prototype.resize=jf.prototype.resize,jf.prototype.isLinear=jf.prototype.isLinear,jf.prototype.isMuted=jf.prototype.isMuted,jf.prototype.setVolume=jf.prototype.setVolume,jf.prototype.getVolume=jf.prototype.getVolume,jf.prototype.play=jf.prototype.play,jf.prototype.pause=jf.prototype.pause,jf.prototype.skip=jf.prototype.skip,jf.prototype.canSkipNow=jf.prototype.canSkipNow,jf.prototype.getTimeUntilSkippable=jf.prototype.getTimeUntilSkippable,jf.prototype.isSkippable=jf.prototype.isSkippable,jf.prototype.isPaused=jf.prototype.isPaused,jf.prototype.getRemainingTime=jf.prototype.getRemainingTime,jf.prototype.getMinSuggestedDuration=jf.prototype.getMinSuggestedDuration,jf.prototype.getDuration=jf.prototype.getDuration,jf.prototype.isUsingAnotherMediaElement=jf.prototype.isUsingAnotherMediaElement,jf.prototype.hasCustomClick=jf.prototype.hasCustomClick,jf.prototype.isClientRendering=jf.prototype.isClientRendering,jf.prototype.needsSkipUI=jf.prototype.needsSkipUI,Uf.prototype.stop=function(){for(var e=p(this.m),t=e.next();!t.done;t=e.next())t=t.value,this.o.Ma(t.target,t.type,t.listener);qf(this),this.m=[],this.u=[],this.H="",this.O=!0,this.I="",this.B=null,this.j=[],this.N=[],this.G.clear()},Uf.prototype.release=function(){this.stop(),this.o&&this.o.release()},Uf.prototype.onManifestUpdated=function(e){this.J=e,""!=this.H&&(function(e,t,n){var i,r,a,o,s,u,l,c,d,h,f,g,m,v,y,b;R((function(T){if(1==T.g)return i={type:8},r=Vr([t],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}),a=e.K.request(7,r,i),S(T,2),w(T,a.promise,4);if(2!=T.g){if(o=T.h,s=[],u=He(o.data),(l=JSON.parse(u)).avails.length>0){if(JSON.stringify(e.j)!=JSON.stringify(l.avails)){for(e.j=l.avails,c=p(e.j),d=c.next();!d.done;d=c.next())for(h=d.value,f=p(h.nonLinearAdsList),g=f.next();!g.done;g=f.next())for(m=g.value,v=p(m.nonLinearAdList),y=v.next();!y.done;y=v.next())b=y.value,Ff(e,b);s=e.getCuePoints(),e.i(new Dr("ad-cue-points-changed",(new Map).set("cuepoints",s)))}}else e.j.length&&e.i(new Dr("ad-cue-points-changed",(new Map).set("cuepoints",s))),qf(e),e.j=[];return n&&(e.J||s.length>0)&&function(e){Vf(e),e.J||(Hf(e),e.o.D(e.h,"seeked",(function(){Hf(e)})),e.o.D(e.h,"ended",(function(){qf(e)}))),e.o.D(e.h,"timeupdate",(function(){Vf(e)}))}(e),x(T,0)}k(T),_(T)}))}(this,this.H,this.O),this.O=!1)},Uf.prototype.getCuePoints=function(){for(var e=[],t=p(this.j),n=t.next();!n.done;n=t.next())for(var i=(n=p(n.value.ads)).next();!i.done;i=n.next())i=i.value,e.push({start:i.startTimeInSeconds,end:i.startTimeInSeconds+i.durationInSeconds});return e},(i=$f.prototype).needsSkipUI=function(){return!0},i.isClientRendering=function(){return!1},i.hasCustomClick=function(){return!0},i.isUsingAnotherMediaElement=function(){return!1},i.getDuration=function(){return this.i?this.i.duration:-1},i.getMinSuggestedDuration=function(){return this.getDuration()},i.getRemainingTime=function(){return this.i?this.i.duration-this.i.currentTime:-1},i.isPaused=function(){return this.h.paused},i.isSkippable=function(){return this.g.isSkippable()},i.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},i.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},i.skip=function(){this.h.currentTime+=this.getRemainingTime()},i.pause=function(){return this.h.pause()},i.play=function(){return this.h.play()},i.getVolume=function(){return this.h.volume},i.setVolume=function(e){this.h.volume=e},i.isMuted=function(){return this.h.muted},i.isLinear=function(){return!0},i.resize=function(){},i.setMuted=function(e){this.h.muted=e},i.getSequenceLength=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getTotalAds()},i.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return null==e?1:e.getAdPosition()},i.getTitle=function(){return this.g.getTitle()},i.getDescription=function(){return this.g.getDescription()},i.getVastMediaBitrate=function(){return 0},i.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},i.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},i.getVastAdId=function(){return""},i.getAdId=function(){return this.g.getAdId()},i.getCreativeAdId=function(){return this.g.getCreativeAdId()},i.getAdvertiserName=function(){return this.g.getAdvertiserName()},i.getMediaUrl=function(){return null},i.getTimeOffset=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getTimeOffset()},i.getPodIndex=function(){var e=this.g.getAdPodInfo();return null==e?0:e.getPodIndex()},i.release=function(){this.h=this.i=this.g=null},B("shaka.ads.ServerSideAd",$f),$f.prototype.release=$f.prototype.release,$f.prototype.getPodIndex=$f.prototype.getPodIndex,$f.prototype.getTimeOffset=$f.prototype.getTimeOffset,$f.prototype.getMediaUrl=$f.prototype.getMediaUrl,$f.prototype.getAdvertiserName=$f.prototype.getAdvertiserName,$f.prototype.getCreativeAdId=$f.prototype.getCreativeAdId,$f.prototype.getAdId=$f.prototype.getAdId,$f.prototype.getVastAdId=$f.prototype.getVastAdId,$f.prototype.getVastMediaWidth=$f.prototype.getVastMediaWidth,$f.prototype.getVastMediaHeight=$f.prototype.getVastMediaHeight,$f.prototype.getVastMediaBitrate=$f.prototype.getVastMediaBitrate,$f.prototype.getDescription=$f.prototype.getDescription,$f.prototype.getTitle=$f.prototype.getTitle,$f.prototype.getPositionInSequence=$f.prototype.getPositionInSequence,$f.prototype.getSequenceLength=$f.prototype.getSequenceLength,$f.prototype.setMuted=$f.prototype.setMuted,$f.prototype.resize=$f.prototype.resize,$f.prototype.isLinear=$f.prototype.isLinear,$f.prototype.isMuted=$f.prototype.isMuted,$f.prototype.setVolume=$f.prototype.setVolume,$f.prototype.getVolume=$f.prototype.getVolume,$f.prototype.play=$f.prototype.play,$f.prototype.pause=$f.prototype.pause,$f.prototype.skip=$f.prototype.skip,$f.prototype.canSkipNow=$f.prototype.canSkipNow,$f.prototype.getTimeUntilSkippable=$f.prototype.getTimeUntilSkippable,$f.prototype.isSkippable=$f.prototype.isSkippable,$f.prototype.isPaused=$f.prototype.isPaused,$f.prototype.getRemainingTime=$f.prototype.getRemainingTime,$f.prototype.getMinSuggestedDuration=$f.prototype.getMinSuggestedDuration,$f.prototype.getDuration=$f.prototype.getDuration,$f.prototype.isUsingAnotherMediaElement=$f.prototype.isUsingAnotherMediaElement,$f.prototype.hasCustomClick=$f.prototype.hasCustomClick,$f.prototype.isClientRendering=$f.prototype.isClientRendering,$f.prototype.needsSkipUI=$f.prototype.needsSkipUI,(i=Kf.prototype).configure=function(){},i.stop=function(){this.C="",this.o=null,this.F=[]},i.release=function(){this.stop(),this.h&&this.h.release()},i.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.g.onTimedMetadata(t)}},i.getCuePoints=function(){return this.F},h(Wf,Or),(i=Wf.prototype).setLocale=function(e){this.o=e},i.configure=function(e){this.l=e,this.g&&this.g.configure(this.l),this.j&&this.j.configure(this.l),this.h&&this.h.configure(this.l)},i.initInterstitial=function(e,t,n){var i=this;this.g&&this.g.release(),this.g=new wf(e,t,n,(function(e){return Xf(i,e)})),this.g.configure(this.l)},i.initClientSide=function(t,n,i){var r=this;if(!e.google||!google.ima||!google.ima.AdsLoader)throw new Ue(2,10,1e4);this.j&&this.j.release(),this.j=new pf(t,n,this.o,i,(function(e){return Xf(r,e)})),this.j.configure(this.l)},i.release=function(){this.g&&(this.g.release(),this.g=null),this.j&&(this.j.release(),this.j=null),this.i&&(this.i.release(),this.i=null),this.h&&(this.h.release(),this.h=null),Or.prototype.release.call(this)},i.onAssetUnload=function(){this.g&&this.g.stop(),this.j&&this.j.stop(),this.i&&this.i.stop(),this.h&&this.h.stop(),this.dispatchEvent(new Dr("ad-stopped")),this.dispatchEvent(new Dr("ad-content-attach-requested")),this.m=new uf},i.requestClientSideAds=function(e){if(!this.j)throw new Ue(1,10,10001);var t=this.j;t.g&&t.g.destroy(),t.m&&t.m.contentComplete(),t.H=Date.now()/1e3,t.m.requestAds(e)},i.updateClientSideAdsRenderingSettings=function(e){if(!this.j)throw new Ue(1,10,10001);var t=this.j;t.C=e,t.g&&t.g.updateAdsRenderingSettings(t.C)},i.initMediaTailor=function(e,t,n){var i=this;this.i&&this.i.release(),this.i=new Uf(e,t,n,(function(e){return Xf(i,e)}))},i.requestMediaTailorStream=function(e,t,n){if(!this.i)throw new Ue(1,10,10005);var i=this.i;return n=void 0===n?"":n,i.l?e=Promise.reject(new Ue(1,10,10004)):(i.l=new Ar,function(e,t,n){var i,r,a,o,s,u,l,c,d,h,f,p;R((function(g){if(1==g.g)return i={type:7},(r=Vr([t],{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4})).method="POST",n&&(a=JSON.stringify(n),r.body=Ge(a)),o=e.K.request(7,r,i),S(g,2),w(g,o.promise,4);if(2!=g.g){if(s=g.h,u=He(s.data),!(l=JSON.parse(u)).manifestUrl||!l.trackingUrl)throw Error("Insufficient data from MediaTailor.");return c=new ge(t),d=new ge(l.trackingUrl),e.H=c.resolve(d).toString(),h=Date.now()/1e3,f=h-e.R,e.i(new Dr("ads-loaded",(new Map).set("loadTime",f))),p=new ge(l.manifestUrl),e.l.resolve(c.resolve(p).toString()),e.l=null,x(g,0)}if(k(g),!e.I.length)return e.l.reject("MediaTailor request returned an error and there was no backup asset uri provided."),e.l=null,g.return();e.l.resolve(e.I),e.l=null,_(g)}))}(i,e,t),i.I=n||"",i.R=Date.now()/1e3,e=i.l),e},i.addMediaTailorTrackingUrl=function(e){if(!this.i)throw new Ue(1,10,10005);var t=this.i;t.H=e,t.i(new Dr("ads-loaded",(new Map).set("loadTime",0)))},i.initServerSide=function(t,n){var i=this;if(!e.google||!google.ima||!google.ima.dai)throw new Ue(2,10,10002);this.h&&this.h.release(),this.h=new Kf(t,n,this.o,(function(e){return Xf(i,e)})),this.h.configure(this.l)},i.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.h)throw new Ue(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;return(n.mpt||n.mpv)&&$('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.16.4",(n=this.h).j?e=Promise.reject(new Ue(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.H=!0),n.j=new Ar,n.g.requestStream(e),n.C=t||"",n.G=Date.now()/1e3,e=n.j),e},i.replaceServerSideAdTagParameters=function(e){if(!this.h)throw new Ue(1,10,10003);(e.mpt||e.mpv)&&$('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.mpt="Shaka Player",e.mpv="v4.16.4",this.h.g.replaceAdTagParameters(e)},i.getServerSideCuePoints=function(){return ce("AdManager.getServerSideCuePoints","Please use getCuePoints function."),this.getCuePoints()},i.getCuePoints=function(){var e=[];return this.h&&(e=e.concat(this.h.getCuePoints())),this.i&&(e=e.concat(this.i.getCuePoints())),e},i.getStats=function(){var e=this.m;return{loadTimes:e.g,averageLoadTime:lf(e),started:e.h,overlayAds:e.j,playedCompletely:e.l,skipped:e.m,errors:e.i}},i.onManifestUpdated=function(e){this.i&&this.i.onManifestUpdated(e)},i.onDashTimedMetadata=function(e){this.h&&"urn:google:dai:2018"==e.schemeIdUri&&this.h.g.processMetadata(e.schemeIdUri,e.eventNode?e.eventNode.attributes.messageData:null,e.startTime)},i.onHlsTimedMetadata=function(e,t){this.h&&this.h.g.processMetadata("ID3",e.data,t)},i.onCueMetadataChange=function(e){this.h&&this.h.onCueMetadataChange(e)},i.onHLSInterstitialMetadata=function(e,t,n){this.l&&this.l.disableHLSInterstitial||(this.g||this.initInterstitial(null,e,t),this.g&&Tf(this.g,n))},i.onDASHInterstitialMetadata=function(e,t,n){if(!this.l||!this.l.disableDASHInterstitial){var i=n.schemeIdUri;if("urn:mpeg:dash:event:alternativeMPD:insert:2025"==i||"urn:mpeg:dash:event:alternativeMPD:replace:2025"==i){if(this.g||this.initInterstitial(null,e,t),this.g&&(e=this.g,t="urn:mpeg:dash:event:alternativeMPD:replace:2025"==n.schemeIdUri,i="urn:mpeg:dash:event:alternativeMPD:insert:2025"==n.schemeIdUri,t||i)){for(var r,a=n.startTime,o=n.endTime,s=null,u=0,l=p(n.eventNode.children),c=l.next();!c.done;c=l.next())if("AlternativeMPD"==(c=c.value).tagName){if(c=c.attributes.uri){r=c;break}}else if("InsertPresentation"==c.tagName||"ReplacePresentation"==c.tagName){var d=c.attributes.url;if(d){r=Ke(d),(l=Zt(c,"maxDuration",sn))&&(s=l/n.timescale),(l=Zt(c,"returnOffset",sn))&&(u=l/n.timescale),t&&u&&(o=a+u);break}}r&&xf(e,[{id:n.id,groupId:null,startTime:a,endTime:o,uri:r,mimeType:null,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:i?u:null,playoutLimit:s,once:!1,pre:!1,post:!1,timelineRange:t&&!i,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null,clickThroughUrl:null}])}}else("urn:mpeg:dash:event:2012"==i||"urn:scte:dash:scte214-events"==i)&&n.eventNode&&Jt(n.eventNode,"OverlayEvent")&&(this.g||this.initInterstitial(null,e,t),this.g&&function(e,t){var n=Jt(t.eventNode,"OverlayEvent"),i=n.attributes.uri,r=n.attributes.mimeType,a="true"==n.attributes.loop,o=Zt(n,"z",sn);if(i&&0!=o){var s=null,u=Jt(n,"Background");if(u){var l=u.attributes.uri;s=l?"center / contain no-repeat url('"+l+"')":Xt(u)}u=1920,l=1080;var c=Jt(n,"Viewport");if(c){if(null==(u=Zt(c,"x",sn)))return;if(null==(l=Zt(c,"y",sn)))return}var d={viewport:{x:u,y:l},topLeft:{x:0,y:0},size:{x:u,y:l}},h=Jt(n,"Overlay");if(c&&h){var f=Jt(h,"TopLeft"),p=Jt(h,"Size");if(f&&p){if(null==(h=Zt(f,"x",sn)))return;if(null==(f=Zt(f,"y",sn)))return;var g=Zt(p,"x",sn);if(null==g)return;if(null==(p=Zt(p,"y",sn)))return;d.topLeft.x=h,d.topLeft.y=f,d.size.x=g,d.size.y=p}}if(h=null,n=Jt(n,"Squeeze"),c&&n&&(p=Jt(n,"TopLeft"),n=Jt(n,"Size"),p&&n)){if(null==(c=Zt(p,"x",sn)))return;if(null==(h=Zt(p,"y",sn)))return;if(null==(p=Zt(n,"x",sn)))return;if(null==(n=Zt(n,"y",sn)))return;h={viewport:{x:u,y:l},topLeft:{x:c,y:h},size:{x:p,y:n}}}xf(e,[{id:t.id,groupId:null,startTime:t.startTime,endTime:t.endTime,uri:i,mimeType:r,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:null,playoutLimit:null,once:!1,pre:!1,post:!1,timelineRange:!0,loop:a,overlay:d,displayOnBackground:-1==o,currentVideo:h,background:s,clickThroughUrl:null}])}}(this.g,n))}},i.addCustomInterstitial=function(e){if(!this.g)throw new Ue(1,10,10006);xf(this.g,[e])},i.addAdUrlInterstitial=function(e){if(!this.g)throw new Ue(1,10,10006);return this.g.addAdUrlInterstitial(e)},i.getInterstitialPlayer=function(){if(!this.g)throw new Ue(1,10,10006);return this.g.td()},B("shaka.ads.AdManager",Wf),Wf.prototype.getInterstitialPlayer=Wf.prototype.getInterstitialPlayer,Wf.prototype.addAdUrlInterstitial=Wf.prototype.addAdUrlInterstitial,Wf.prototype.addCustomInterstitial=Wf.prototype.addCustomInterstitial,Wf.prototype.onDASHInterstitialMetadata=Wf.prototype.onDASHInterstitialMetadata,Wf.prototype.onHLSInterstitialMetadata=Wf.prototype.onHLSInterstitialMetadata,Wf.prototype.onCueMetadataChange=Wf.prototype.onCueMetadataChange,Wf.prototype.onHlsTimedMetadata=Wf.prototype.onHlsTimedMetadata,Wf.prototype.onDashTimedMetadata=Wf.prototype.onDashTimedMetadata,Wf.prototype.onManifestUpdated=Wf.prototype.onManifestUpdated,Wf.prototype.getStats=Wf.prototype.getStats,Wf.prototype.getCuePoints=Wf.prototype.getCuePoints,Wf.prototype.getServerSideCuePoints=Wf.prototype.getServerSideCuePoints,Wf.prototype.replaceServerSideAdTagParameters=Wf.prototype.replaceServerSideAdTagParameters,Wf.prototype.requestServerSideStream=Wf.prototype.requestServerSideStream,Wf.prototype.initServerSide=Wf.prototype.initServerSide,Wf.prototype.addMediaTailorTrackingUrl=Wf.prototype.addMediaTailorTrackingUrl,Wf.prototype.requestMediaTailorStream=Wf.prototype.requestMediaTailorStream,Wf.prototype.initMediaTailor=Wf.prototype.initMediaTailor,Wf.prototype.updateClientSideAdsRenderingSettings=Wf.prototype.updateClientSideAdsRenderingSettings,Wf.prototype.requestClientSideAds=Wf.prototype.requestClientSideAds,Wf.prototype.onAssetUnload=Wf.prototype.onAssetUnload,Wf.prototype.release=Wf.prototype.release,Wf.prototype.initClientSide=Wf.prototype.initClientSide,Wf.prototype.initInterstitial=Wf.prototype.initInterstitial,Wf.prototype.configure=Wf.prototype.configure,Wf.prototype.setLocale=Wf.prototype.setLocale,Wf.ADS_LOADED="ads-loaded",Wf.AD_STARTED="ad-started",Wf.AD_FIRST_QUARTILE="ad-first-quartile",Wf.AD_MIDPOINT="ad-midpoint",Wf.AD_THIRD_QUARTILE="ad-third-quartile",Wf.AD_COMPLETE="ad-complete",Wf.AD_STOPPED="ad-stopped",Wf.AD_SKIPPED="ad-skipped",Wf.AD_VOLUME_CHANGED="ad-volume-changed",Wf.AD_MUTED="ad-muted",Wf.AD_PAUSED="ad-paused",Wf.AD_RESUMED="ad-resumed",Wf.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",Wf.CUEPOINTS_CHANGED="ad-cue-points-changed",Wf.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",Wf.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",Wf.AD_CLICKED="ad-clicked",Wf.AD_PROGRESS="ad-progress",Wf.AD_BUFFERING="ad-buffering",Wf.AD_IMPRESSION="ad-impression",Wf.AD_DURATION_CHANGED="ad-duration-changed",Wf.AD_CLOSED="ad-closed",Wf.AD_LOADED="ad-loaded",Wf.ALL_ADS_COMPLETED="all-ads-completed",Wf.AD_LINEAR_CHANGED="ad-linear-changed",Wf.AD_METADATA="ad-metadata",Wf.AD_RECOVERABLE_ERROR="ad-recoverable-error",Wf.AD_ERROR="ad-error",Wf.AD_BREAK_READY="ad-break-ready",Wf.AD_INTERACTION="ad-interaction",Wf.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",Wf.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",Wf.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",of=function(){return new Wf};var Qf="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),Zf="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),ep=["loop","playbackRate"],tp=["pause","play"],np=(new Map).set("getAssetUri",2).set("getAudioLanguages",4).set("getAudioLanguagesAndRoles",4).set("getBufferFullness",1).set("getBufferedInfo",2).set("getExpiration",2).set("getKeyStatuses",2).set("getPlaybackRate",2).set("getTextLanguages",4).set("getTextLanguagesAndRoles",4).set("isAudioOnly",10).set("isBuffering",1).set("isInProgress",1).set("isLive",10).set("isTextTrackVisible",1).set("isVideoOnly",10).set("keySystem",10).set("seekRange",1).set("getLoadMode",10).set("getManifestType",10).set("isFullyLoaded",1).set("isEnded",1).set("getBandwidthEstimate",1),ip=(new Map).set("getConfiguration",4).set("getConfigurationForLowLatency",4).set("getStats",5).set("getAudioTracks",2).set("getChaptersTracks",2).set("getImageTracks",2).set("getVideoTracks",2).set("getTextTracks",2).set("getVariantTracks",2),rp=(new Map).set("getPlayheadTimeAsDate",1).set("getPresentationStartTimeAsDate",20).set("getSegmentAvailabilityDuration",20),ap=[["getConfiguration","configure","getConfigurationForLowLatency","configurationForLowLatency"]],op=[["isTextTrackVisible","setTextTrackVisibility"]],sp="cancelTrickPlay configure configurationForLowLatency getChapters resetConfiguration retryStreaming selectAudioLanguage selectAudioTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel selectVideoTrack setTextTrackVisibility trickPlay updateStartTime goToLive useTrickPlayTrackIfAvailable".split(" "),up="addChaptersTrack addTextTrackAsync addThumbnailsTrack getAllThumbnails getChaptersAsync getThumbnails attach attachCanvas detach load unload".split(" ");function lp(e,t,n,i,r,a,o){var s=this;this.H=e,this.K=o,this.l=new Si(t),this.M=n,this.u=!1,this.B=i,this.G=r,this.N=a,this.i=this.m=!1,this.J="",this.o=null,this.C=function(){return fp(s)},this.F=function(e,t){switch((e=Jf(t)).type){case"event":var n=e.targetName,i=Lr(e.event);s.B(n,i);break;case"update":for(i in n=e.update)for(var r in e=s.g[i]||{},n[i])e[r]=n[i][r];s.u&&(s.M(),s.u=!1);break;case"asyncComplete":if(r=e.id,i=e.error,t=e.res,e=s.h.get(r),s.h.delete(r),e)if(i){for(n in r=new Ue(i.severity,i.category,i.code),i)r[n]=i[n];e.reject(r)}else e.resolve(t)}},this.g={video:{},player:{}},this.I=0,this.h=new Map,this.j=null,wp.add(this)}function cp(e,t){var n=e.N();yp=t,t.addUpdateListener(e.C),t.addMessageListener("urn:x-cast:com.google.shaka.v2",e.F),fp(e),gp(e,{type:"init",initState:n,appData:e.o}),e.j.resolve()}function dp(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.j.reject(new Ue(2,8,n,t))}function hp(e){var t=yp;t.removeUpdateListener(e.C),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.F)}function fp(e){var t=!!yp&&"connected"==yp.status;if(e.i&&!t){for(var n in e.G(),e.g)e.g[n]={};pp(e)}e.i=t,e.J=t?yp.receiver.friendlyName:"",e.l.Jb()}function pp(e){if(e.h)for(var t=p(e.h.keys()),n=t.next();!n.done;n=t.next()){n=n.value;var i=e.h.get(n);e.h.delete(n),i.reject(new Ue(1,7,7e3))}}function gp(e,t){t=Yf(t);var n=yp;try{n.sendMessage("urn:x-cast:com.google.shaka.v2",t,(function(){}),W)}catch(i){throw t=new Ue(2,8,8005,i),n=new Dr("error",(new Map).set("detail",t)),e.B("player",n),e.qd(),t}}(i=lp.prototype).destroy=function(){return wp.delete(this),pp(this),yp&&hp(this),this.l&&(this.l.stop(),this.l=null),this.G=this.B=null,this.i=this.m=!1,this.F=this.C=this.j=this.h=this.g=this.o=null,Promise.resolve()},i.wb=function(){return this.i},i.$g=function(){return this.J},i.init=function(){if(this.H.length)if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.l.Jb();var t=new chrome.cast.SessionRequest(this.H,[],null,this.K,null);t=new chrome.cast.ApiConfig(t,(function(e){for(var t=p(wp),n=t.next();!n.done;n=t.next()){var i=e;(n=n.value).j=new Ar,n.u=!0,cp(n,i)}}),(function(e){for(var t=p(wp),n=t.next();!n.done;n=t.next())n=n.value,vp="available"==e,n.l.Jb()}),"origin_scoped"),chrome.cast.initialize(t,(function(){}),(function(){})),vp&&this.l.ia(mp),(t=yp)&&t.status!=chrome.cast.SessionStatus.STOPPED?(this.j=new Ar,this.u=!0,cp(this,t)):yp=null}else e.__onGCastApiAvailable!==_p&&(bp=e.__onGCastApiAvailable||null,e.__onGCastApiAvailable=_p)},i.mh=function(e){this.o=e,this.i&&gp(this,{type:"appData",appData:this.o})},i.cast=function(){var e=this;return R((function(t){if(!e.m)throw new Ue(1,8,8e3);if(!vp)throw new Ue(1,8,8001);if(e.i)throw new Ue(1,8,8002);return e.j=new Ar,chrome.cast.requestSession((function(t){return cp(e,t)}),(function(t){return dp(e,t)})),w(t,e.j,0)}))},i.qd=function(){if(this.i){if(pp(this),yp){hp(this);try{yp.stop((function(){}),(function(){}))}catch(e){}yp=null}fp(this)}},i.get=function(e,t){var n=this;if("video"==e){if(tp.includes(t))return function(){return n.Fi.apply(n,[e,t].concat(g(D.apply(0,arguments))))}}else if("player"==e){if(rp.has(t)&&!this.get("player","isLive")())return function(){};if(sp.includes(t))return function(){return n.Fi.apply(n,[e,t].concat(g(D.apply(0,arguments))))};if(up.includes(t))return function(){return n.Mk.apply(n,[e,t].concat(g(D.apply(0,arguments))))};if(np.has(t)||ip.has(t))return function(){return n.g[e][t]}}return this.g[e][t]},i.set=function(e,t,n){this.g[e][t]=n,gp(this,{type:"set",targetName:e,property:t,value:n})},i.Fi=function(e,t){gp(this,{type:"call",targetName:e,methodName:t,args:D.apply(2,arguments)})},i.Mk=function(e,t){var n=D.apply(2,arguments),i=new Ar,r=this.I.toString();this.I++,this.h.set(r,i);try{gp(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:r})}catch(e){i.reject(e)}return i};var mp=.02,vp=!1,yp=null,bp=null,wp=new Set;function _p(t){if(bp?e.__onGCastApiAvailable=bp:delete e.__onGCastApiAvailable,bp=null,t)for(var n=p(wp),i=n.next();!i.done;i=n.next())i.value.init();"function"==typeof e.__onGCastApiAvailable&&e.__onGCastApiAvailable(t)}function Sp(t,n,i,r){r=void 0!==r&&r,Or.call(this);var a=this;this.i=t,this.h=n,this.l=this.o=this.m=this.u=this.j=null,this.I=i,this.H=r,this.F=[],this.C=[],this.B=[],this.G=new Map,this.g=null,e.chrome?(this.g=new lp(i,(function(){return kp(a)}),(function(){return Ap(a)}),(function(e,t){return Mp(a,e,t)}),(function(){return Ep(a)}),(function(){return xp(a)}),r),function(e){e.g.init(),e.l=new te;for(var t=p(Qf),n=t.next();!n.done;n=t.next())e.l.D(e.i,n.value,(function(t){e.g.wb()||(t=Lr(t),e.m.dispatchEvent(t))}));for(var i in Nr)e.l.D(e.h,Nr[i],(function(t){e.g.wb()||e.o.dispatchEvent(t)}));for(var r in e.j={},t={},e.i)(t={ce:t.ce}).ce=r,Object.defineProperty(e.j,t.ce,{configurable:!1,enumerable:!0,get:function(t){return function(){return Ip(e,t.ce)}}(t),set:function(t){return function(n){var i=t.ce;e.g.wb()?e.g.set("video",i,n):e.i[i]=n}}(t)});e.u={},Tp(e,(function(t){Object.defineProperty(e.u,t,{configurable:!1,enumerable:!0,get:function(){return Cp(e,t)}})})),function(e){var t=new Map;Tp(e,(function(n,i){t.has(i)?(i=t.get(i),n.length<i.length?e.G.set(n,i):e.G.set(i,n)):t.set(i,n)}))}(e),e.m=new Or,e.m.Fe=e.j,e.o=new Or,e.o.Fe=e.u,e.l.D(e.h,"unloading",(function(){e.g&&e.g.wb()||Pp(e)}))}(this)):(this.j=this.i,this.u=this.h)}function Tp(e,t){function n(e){return"constructor"!=e&&"function"==typeof r[e]&&!a.has(e)}var i,r=e.h,a=new Set;for(i in r)n(i)&&(a.add(i),t(i,r[i]));for(e=Object.getPrototypeOf(r),i=Object.getPrototypeOf({});e&&e!=i;){for(var o=p(Object.getOwnPropertyNames(e)),s=o.next();!s.done;s=o.next())n(s=s.value)&&(a.add(s),t(s,r[s]));e=Object.getPrototypeOf(e)}}function xp(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.rd(),startTime:null,addThumbnailsTrackCalls:e.F,addTextTrackAsyncCalls:e.C,addChaptersTrackCalls:e.B};e.i.pause();for(var n=p(ep),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.i[i];for(e.i.ended||(t.startTime=e.i.currentTime),i=(n=p(ap)).next();!i.done;i=n.next()){var r=i.value;i=r[1],r=e.h[r[0]](),t.player[i]=r}for(i=(n=p(op)).next();!i.done;i=n.next())i=(r=i.value)[1],r=e.h[r[0]](),t.playerAfterLoad[i]=r;return t}function kp(e){var t=new Dr("caststatuschanged");e.dispatchEvent(t)}function Ap(e){var t=new Dr(e.j.paused?"pause":"play");e.m.dispatchEvent(t)}function Ep(e){for(var t=p(ap),n=t.next();!n.done;n=t.next()){var i=n.value;n=i[1],i=e.g.get("player",i[0])(),e.h[n](i)}var r=e.F,a=e.C,o=e.B;Pp(e);var s=e.g.get("player","getAssetUri")();i=e.g.get("video","ended"),t=Promise.resolve();var u,l=e.i.autoplay;n=null,i||(n=e.g.get("video","currentTime")),(i=e.g.get("player","getTextTracks")())&&i.length&&(u=i.find((function(e){return e.active})));var c=e.g.get("player","isTextTrackVisible")();s&&(e.i.autoplay=!1,t=e.h.load(s,n));var d={};for(i=(n=p(ep)).next();!i.done;i=n.next())i=i.value,d[i]=e.g.get("video",i);t.then((function(){if(e.i){for(var t=p(r),n=t.next();!n.done;n=t.next()){var i;n=n.value,(i=e.td()).Me.apply(i,g(n))}for(i=(t=p(a)).next();!i.done;i=t.next()){var h;i=i.value,(h=e.td()).Od.apply(h,g(i))}for(t=(h=p(o)).next();!t.done;t=h.next()){var f;t=t.value,(f=e.td()).Le.apply(f,g(t))}for(h=(f=p(ep)).next();!h.done;h=f.next())h=h.value,e.i[h]=d[h];for(h=(f=p(op)).next();!h.done;h=f.next())h=(t=h.value)[1],t=e.g.get("player",t[0])(),e.h[h](t);e.h.qh(c),u&&e.h.jh(u.language,u.roles,u.forced),e.i.autoplay=l,s&&e.i.play()}}),(function(t){t=new Dr("error",t=(new Map).set("detail",t)),e.h.dispatchEvent(t)}))}function Ip(e,t){if("addEventListener"==t)return function(t,n,i){return e.m.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.m.removeEventListener(t,n,i)};if(e.g.wb()&&0==Object.keys(e.g.g.video).length){var n=e.i[t];if("function"!=typeof n)return n}return e.g.wb()?e.g.get("video",t):("function"==typeof(t=e.i[t])&&(t=t.bind(e.i)),t)}function Cp(e,t,n){if(n=void 0!==n&&n,e.G.has(t)&&(t=e.G.get(t)),"addEventListener"==t)return function(t,n,i){return e.o.addEventListener(t,n,i)};if("removeEventListener"==t)return function(t,n,i){return e.o.removeEventListener(t,n,i)};if("getMediaElement"==t)return function(){return e.j};if("getSharedConfiguration"==t)return e.g.get("player","getConfiguration");if("getNetworkingEngine"==t)return function(){return e.h.Wb()};if("getDrmEngine"==t)return function(){return e.h.F};if("getAdManager"==t)return function(){return e.h.Yh()};if("getQueueManager"==t)return function(){return e.h.ei()};if("setVideoContainer"==t)return function(t){return e.h.Ti(t)};if(!n){if("addThumbnailsTrack"==t)return function(){var n=D.apply(0,arguments);return e.F.push(n),Cp(e,t,!0).apply(null,g(n))};if("addTextTrackAsync"==t)return function(){var n=D.apply(0,arguments);return e.C.push(n),Cp(e,t,!0).apply(null,g(n))};if("addChaptersTrack"==t)return function(){var n=D.apply(0,arguments);return e.B.push(n),Cp(e,t,!0).apply(null,g(n))}}if(e.g.wb()){if("getManifest"==t||"drmInfo"==t)return function(){return $(t+"() does not work while casting!"),null};if("attach"==t||"detach"==t)return function(){return $(t+"() does not work while casting!"),Promise.resolve()};if("getChapters"==t)return function(){return $(t+"() does not work while casting!"),[]}}return e.g.wb()&&0==Object.keys(e.g.g.video).length&&(np.has(t)||ip.has(t))||!e.g.wb()?e.h[t].bind(e.h):e.g.get("player",t)}function Mp(e,t,n){e.g.wb()&&("video"==t?e.m.dispatchEvent(n):"player"==t&&("unloading"==n.type&&Pp(e),e.o.dispatchEvent(n)))}function Pp(e){e.F=[],e.C=[],e.B=[]}function Rp(e,t,n,i){Or.call(this);var r=this;this.h=e,this.g=t,this.j=new te,this.I={video:e,player:t},this.G=n||function(){},this.J=i||function(e){return e},this.i=null,this.H=!1,this.o=!0,this.m=0,this.C=!1,this.B=!0,this.u=this.l=null,this.F=new Si((function(){Op(r)})),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return Dp(e)},t.onSenderDisconnected=function(){return Dp(e)},t.onSystemVolumeChanged=function(){var t=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();t&&Bp(e,{type:"update",update:{video:{volume:t.level,muted:t.muted}}},e.l),Bp(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.u=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.u.onMessage=function(t){return function(e,t){var n=Jf(t.data);switch(n.type){case"PLAY":e.h.play(),Hp(e);break;case"PAUSE":e.h.pause(),Hp(e);break;case"SEEK":t=n.currentTime;var i=n.resumeState;null!=t&&(e.h.currentTime=Number(t)),i&&"PLAYBACK_START"==i?(e.h.play(),Hp(e)):i&&"PLAYBACK_PAUSE"==i&&(e.h.pause(),Hp(e));break;case"STOP":e.g.Bc().then((function(){e.g&&Hp(e)}));break;case"GET_STATUS":Up(e,Number(n.requestId));break;case"VOLUME":t=(i=n.volume).level,i=i.muted;var r=e.h.volume,a=e.h.muted;null!=t&&(e.h.volume=Number(t)),null!=i&&(e.h.muted=i),r==e.h.volume&&a==e.h.muted||Hp(e);break;case"LOAD":e.m=0,e.C=!1,e.B=!1,t=n.media,i=n.currentTime,r=e.J(t.contentId),a=n.autoplay||!0,e.G(t.customData),a&&(e.h.autoplay=!0),e.g.load(r,i).then((function(){e.g&&Up(e)})).catch((function(t){var i="LOAD_FAILED";7==t.category&&7e3==t.code&&(i="LOAD_CANCELLED"),Bp(e,{requestId:Number(n.requestId),type:i},e.u)}));break;default:Bp(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.u)}}(e,t)},e.l=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(t){return function(e,t){var n=Jf(t.data);switch(n.type){case"init":e.m=0,e.C=!1,e.B=!0,function(e,t,n){var i,r,a,o,s,u,l,c,d,h,f,m,v,y,b,T,A,E,I;R((function(C){switch(C.g){case 1:for(i in t.player)r=t.player[i],e.g[i](r);return e.G(n),a=e.h.autoplay,t.manifest?(e.h.autoplay=!1,S(C,5),w(C,e.g.load(t.manifest,t.startTime),7)):w(C,Promise.resolve(),3);case 7:if(t.addThumbnailsTrackCalls)for(o=p(t.addThumbnailsTrackCalls),s=o.next();!s.done;s=o.next())u=s.value,e.g.Me.apply(e.g,g(u));if(t.addTextTrackAsyncCalls)for(l=p(t.addTextTrackAsyncCalls),c=l.next();!c.done;c=l.next())d=c.value,e.g.Od.apply(e.g,g(d));if(t.addChaptersTrackCalls)for(h=p(t.addChaptersTrackCalls),f=h.next();!f.done;f=h.next())m=f.value,e.g.Le.apply(e.g,g(m));x(C,3);break;case 5:return v=k(C),y=(new Map).set("detail",v),b=new Dr("error",y),e.g&&e.g.dispatchEvent(b),C.return();case 3:if(!e.g)return C.return();for(T in t.video)A=t.video[T],e.h[T]=A;for(E in t.playerAfterLoad)I=t.playerAfterLoad[E],e.g[E](I);e.h.autoplay=a,t.manifest&&(e.h.play(),Hp(e)),_(C)}}))}(e,n.initState,n.appData),Op(e);break;case"appData":e.G(n.appData);break;case"set":var i=n.targetName,r=n.property;if(n=n.value,"video"==i){if(t=cast.receiver.CastReceiverManager.getInstance(),"volume"==r){t.setSystemVolumeLevel(n);break}if("muted"==r){t.setSystemVolumeMuted(n);break}}e.I[i][r]=n;break;case"call":(i=e.I[n.targetName])[n.methodName].apply(i,n.args);break;case"asyncCall":i=n.targetName,r=n.methodName,"player"==i&&"load"==r&&(e.m=0,e.C=!1);var a=n.id,o=t.senderId;n=(t=e.I[i])[r].apply(t,n.args),"player"==i&&"load"==r&&(n=n.then((function(){e.B=!0}))),n.then((function(t){return Fp(e,o,a,null,t)}),(function(t){return Fp(e,o,a,t,null)}))}}(e,t)},t.start();for(var n=(t=p(Qf)).next();!n.done;n=t.next())e.j.D(e.h,n.value,(function(t){return Np(e,"video",t)}));for(var i in Nr)e.j.D(e.g,Nr[i],(function(t){return Np(e,"player",t)}));e.j.D(e.h,"loadeddata",(function(){e.C=!0})),e.j.D(e.g,"loading",(function(){e.o=!1,Lp(e)})),e.j.D(e.h,"playing",(function(){e.o=!1,Lp(e)})),e.j.D(e.h,"pause",(function(){Lp(e)})),e.j.D(e.g,"unloading",(function(){e.o=!0,Lp(e)})),e.j.D(e.h,"ended",(function(){new Si((function(){e.h&&e.h.ended&&(e.o=!0,Lp(e))})).ia(qp)}))}(this)}function Dp(e){e.m=0,e.B=!0,e.H=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,Lp(e)}function Lp(e){var t;R((function(n){return 1==n.g?w(n,Promise.resolve(),2):e.g?(t=new Dr("caststatuschanged"),e.dispatchEvent(t),jp(e)||Hp(e),void _(n)):n.return()}))}function Np(e,t,n){e.g&&(Op(e),Bp(e,{type:"event",targetName:t,event:n},e.l))}function Op(e){e.F.ia(Vp);for(var t={video:{},player:{}},n=p(Zf),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.h[i];e.g.W()&&rp.forEach((function(n,i){e.m%n==0&&(t.player[i]=e.g[i]())})),np.forEach((function(n,i){e.m%n==0&&(t.player[i]=e.g[i]())})),(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),Bp(e,{type:"update",update:t},e.l),ip.forEach((function(t,n){e.m%t==0&&((t={player:{}}).player[n]=e.g[n](),Bp(e,{type:"update",update:t},e.l))})),e.C&&(e.m+=1),jp(e)}function jp(e){return!(!e.B||!e.h.duration&&!e.g.W())&&(Up(e),e.B=!1,!0)}function Up(e,t){var n={contentId:e.g.rd(),streamType:e.g.W()?"LIVE":"BUFFERED",contentType:""};e.g.W()||(n.duration=e.h.duration),e.i&&(n.metadata=e.i),Hp(e,void 0===t?0:t,n)}function Fp(e,t,n,i,r){e.g&&Bp(e,{type:"asyncComplete",id:n,error:i,res:r},e.l,t)}function Bp(e,t,n,i){e.H&&(e=Yf(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function Hp(e,t,n){n=void 0===n?null:n;var i={mediaSessionId:0,playbackRate:e.h.playbackRate,playerState:e.o?Gp:e.g.Ng()?$p:e.h.paused?Kp:zp,currentTime:e.h.currentTime,supportedMediaCommands:63,volume:{level:e.h.volume,muted:e.h.muted}};n&&(i.media=n),Bp(e,{requestId:void 0===t?0:t,type:"MEDIA_STATUS",status:[i]},e.u)}h(Sp,Or),(i=Sp.prototype).destroy=function(e){return this.g&&void 0!==e&&e&&this.g.qd(),this.l&&(this.l.release(),this.l=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.u=this.j=this.i=null,Or.prototype.release.call(this),Promise.all(e)},i.ck=function(){return this.j},i.td=function(){return this.u},i.lj=function(){return!!this.g&&(this.g.m&&vp)},i.wb=function(){return!!this.g&&this.g.wb()},i.$g=function(){return this.g?this.g.$g():""},i.cast=function(){var e=this;return R((function(t){return 1==t.g?e.g?w(t,e.g.cast(),2):t.return():e.h?w(t,e.h.Bc(),0):t.return()}))},i.mh=function(e){this.g&&this.g.mh(e)},i.cl=function(){var e;this.g&&((e=this.g).i&&chrome.cast.requestSession((function(t){return cp(e,t)}),(function(t){return dp(e,t)})))},i.qd=function(){this.g&&this.g.qd()},i.mj=function(e,t){t=void 0!==t&&t;var n=this;return R((function(i){if(1==i.g)return e==n.I&&t==n.H?i.return():(n.I=e,n.H=t,n.g?(n.g.qd(),w(i,n.g.destroy(),2)):i.return());n.g=null,n.g=new lp(e,(function(){return kp(n)}),(function(){return Ap(n)}),(function(e,t){return Mp(n,e,t)}),(function(){return Ep(n)}),(function(){return xp(n)}),t),n.g.init(),_(i)}))},B("shaka.cast.CastProxy",Sp),Sp.prototype.changeReceiverId=Sp.prototype.mj,Sp.prototype.forceDisconnect=Sp.prototype.qd,Sp.prototype.suggestDisconnect=Sp.prototype.cl,Sp.prototype.setAppData=Sp.prototype.mh,Sp.prototype.cast=Sp.prototype.cast,Sp.prototype.receiverName=Sp.prototype.$g,Sp.prototype.isCasting=Sp.prototype.wb,Sp.prototype.canCast=Sp.prototype.lj,Sp.prototype.getPlayer=Sp.prototype.td,Sp.prototype.getVideo=Sp.prototype.ck,Sp.prototype.destroy=Sp.prototype.destroy,h(Rp,Or),(i=Rp.prototype).isConnected=function(){return this.H},i.jk=function(){return this.o},i.Yk=function(e){this.i=e},i.qj=function(){this.i=null},i.Zk=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},i.Xk=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},i.Wk=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},i.destroy=function(){var e,t=this;return R((function(n){if(1==n.g)return t.j&&(t.j.release(),t.j=null),e=[],t.g&&(e.push(t.g.destroy()),t.g=null),t.F&&(t.F.stop(),t.F=null),t.h=null,t.I=null,t.G=null,t.H=!1,t.o=!0,t.l=null,t.u=null,Or.prototype.release.call(t),w(n,Promise.all(e),2);cast.receiver.CastReceiverManager.getInstance().stop(),_(n)}))},B("shaka.cast.CastReceiver",Rp),Rp.prototype.destroy=Rp.prototype.destroy,Rp.prototype.setContentArtist=Rp.prototype.Wk,Rp.prototype.setContentImage=Rp.prototype.Xk,Rp.prototype.setContentTitle=Rp.prototype.Zk,Rp.prototype.clearContentMetadata=Rp.prototype.qj,Rp.prototype.setContentMetadata=Rp.prototype.Yk,Rp.prototype.isIdle=Rp.prototype.jk,Rp.prototype.isConnected=Rp.prototype.isConnected;var Vp=.5,qp=5,Gp="IDLE",zp="PLAYING",$p="BUFFERING",Kp="PAUSED";function Wp(e,t,n,i,r){if(i>=r)return null;for(var a=-1,o=-1,s=0;s<n.length;s++)if(n[s].some((function(e){return null!=e&&""!=e.g.trim()}))){a=s;break}for(s=n.length-1;s>=0;s--)if(n[s].some((function(e){return null!=e&&""!=e.g.trim()}))){o=s;break}if(-1===a||-1===o)return null;for(var u=s=!1,l="white",c="black",d=Xp(i,r,s,u,l,c);a<=o;a++){for(var h=n[a],f=-1,p=-1,g=0;g<h.length;g++)if(null!=h[g]&&""!==h[g].g.trim()){f=g;break}for(g=h.length-1;g>=0;g--)if(null!=h[g]&&""!==h[g].g.trim()){p=g;break}if(-1===f||-1===p)h=Yp(i,r),e.nestedCues.push(h);else{for(;f<=p;f++)if(g=h[f]){var m=g.l,v=g.i,y=g.j,b=g.h;m==s&&v==u&&y==l&&b==c||(d.payload&&e.nestedCues.push(d),d=Xp(i,r,m,v,y,b),s=m,u=v,l=y,c=b),d.payload+=g.g}else d.payload+=" ";d.payload&&e.nestedCues.push(d),a!==o&&(d=Yp(i,r),e.nestedCues.push(d)),d=Xp(i,r,s,u,l,c)}}return e.nestedCues.length?{cue:e,stream:t}:null}function Xp(e,t,n,i,r,a){return e=new _n(e,t,""),n&&e.textDecoration.push(zn),i&&(e.fontStyle=qn),e.color=r,e.backgroundColor=a,e}function Yp(e,t){return(e=new _n(e,t,"")).lineBreak=!0,e}function Jp(e,t,n,i,r){this.g=e,this.l=t,this.i=n,this.h=i,this.j=r}function Qp(e,t){this.i=[],this.g=1,this.h=0,this.F=e,this.C=t,this.j=this.m=!1,this.l="white",this.o="black",this.u=this.B=null,eg(this)}function Zp(e,t,n){var i="CC"+(1+(e.F<<1|e.C)),r=new _n(t,n,"");r.lineInterpretation=1;var a=ug.get(e.g);return a&&(r.line=a),null!=e.u&&null!=e.B&&(r.position=10+Math.min(70,10*e.u)+2.5*e.B),(t=Wp(r,i,e.i,t,n))&&e.g+t.cue.nestedCues.length-3>15&&(a=ug.get(e.g+3-t.cue.nestedCues.length))&&(r.line=a),t}function eg(e){ig(e,0,15),e.g=1}function tg(e,t,n){if(!(n<32||n>127)){var i="";switch(t){case 0:i=rg.has(n)?rg.get(n):String.fromCharCode(n);break;case 1:i=ag.get(n);break;case 2:e.i[e.g].pop(),i=og.get(n);break;case 3:e.i[e.g].pop(),i=sg.get(n)}i&&e.i[e.g].push(new Jp(i,e.m,e.j,e.o,e.l))}}function ng(e,t,n,i){if(!(n<0||t<0))if(t>=n)for(--i;i>=0;i--)e.i[t+i]=e.i[n+i].map((function(e){return e}));else for(var r=0;r<i;r++)e.i[t+r]=e.i[n+r].map((function(e){return e}))}function ig(e,t,n){for(var i=0;i<=n;i++)e.i[t+i]=[]}var rg=new Map([[39,"’"],[42,"á"],[92,"é"],[92,"é"],[94,"í"],[95,"ó"],[96,"ú"],[123,"ç"],[124,"÷"],[125,"Ñ"],[126,"ñ"],[127,"█"]]),ag=new Map([[48,"®"],[49,"°"],[50,"½"],[51,"¿"],[52,"™"],[53,"¢"],[54,"£"],[55,"♪"],[56,"à"],[57," "],[58,"è"],[59,"â"],[60,"ê"],[61,"î"],[62,"ô"],[63,"û"]]),og=new Map([[32,"Á"],[33,"É"],[34,"Ó"],[35,"Ú"],[36,"Ü"],[37,"ü"],[38,"‘"],[39,"¡"],[40,"*"],[41,"'"],[42,"─"],[43,"©"],[44,"℠"],[45,"·"],[46,"“"],[47,"”"],[48,"À"],[49,"Â"],[50,"Ç"],[51,"È"],[52,"Ê"],[53,"Ë"],[54,"ë"],[55,"Î"],[56,"Ï"],[57,"ï"],[58,"Ô"],[59,"Ù"],[60,"ù"],[61,"Û"],[62,"«"],[63,"»"]]),sg=new Map([[32,"Ã"],[33,"ã"],[34,"Í"],[35,"Ì"],[36,"ì"],[37,"Ò"],[38,"ò"],[39,"Õ"],[40,"õ"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"Ä"],[49,"ä"],[50,"Ö"],[51,"ö"],[52,"ß"],[53,"¥"],[54,"¤"],[55,"│"],[56,"Å"],[57,"å"],[58,"Ø"],[59,"ø"],[60,"┌"],[61,"┐"],[62,"└"],[63,"┘"]]),ug=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]);function lg(e,t){this.h=0,this.o=new Qp(e,t),this.i=new Qp(e,t),this.g=this.j=new Qp(e,t),this.l=0,this.m=null}function cg(e,t,n){e.g=e.i;var i=e.g,r=null;return 3!==e.h&&4!==e.h&&(r=Zp(i,e.l,n),(n=e.i).g=n.h>0?n.h:0,ig(n,0,15),(n=e.j).g=n.h>0?n.h:0,ig(n,0,15),i.g=15),e.h=3,i.h=t,r}function dg(e){e.h=1,e.g=e.j,e.g.h=0}function hg(e){K("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.o,e.h=4}var fg="black green blue cyan red yellow magenta black".split(" "),pg="white green blue cyan red yellow magenta white_italics".split(" ");function gg(e,t){this.J=t,this.N=e,this.K=this.l=!1,this.m=this.o=this.H=this.M=this.I=0,this.G=2,this.i=[],this.g=this.h=this.j=0,this.F=this.B=!1,this.C="white",this.u="black",mg(this)}function mg(e){e.i=[];for(var t=0;t<16;t++)e.i.push(vg())}function vg(){for(var e=[],t=0;t<42;t++)e.push(null);return e}function yg(e,t){bg(e)&&(e.i[e.h][e.g]=new Jp(t,e.F,e.B,e.u,e.C),e.g++)}function bg(e){var t=e.g<e.m&&e.g>=0;return e.h<e.o&&e.h>=0&&t}function wg(e,t,n){var i=new _n(e.j,t,"");i.textAlign=0===e.G?"left":1===e.G?"right":Cn;var r=i.region;switch(e.J&&(r.id+="svc"+e.J),r.id+="win"+e.N,r.height=e.o,r.width=e.m,r.heightUnits=2,r.widthUnits=2,r.viewportAnchorX=e.I,r.viewportAnchorY=e.M,r.viewportAnchorUnits=e.K?Ct:2,e.H){case 0:r.regionAnchorX=0,r.regionAnchorY=0;break;case 1:r.regionAnchorX=50,r.regionAnchorY=0;break;case 2:r.regionAnchorX=100,r.regionAnchorY=0;break;case 3:r.regionAnchorX=0,r.regionAnchorY=50;break;case 4:r.regionAnchorX=50,r.regionAnchorY=50;break;case 5:r.regionAnchorX=100,r.regionAnchorY=50;break;case 6:r.regionAnchorX=0,r.regionAnchorY=100;break;case 7:r.regionAnchorX=50,r.regionAnchorY=100;break;case 8:r.regionAnchorX=100,r.regionAnchorY=100}return(n=Wp(i,"svc"+n,e.i,e.j,t))&&(e.j=t),n}function _g(){this.i=[],this.h=null,this.g=0}function Sg(e,t){3===t.type?(e.g=2*(63&t.value)-1,e.h=[]):e.h&&(e.g>0&&(e.h.push(t),e.g--),0===e.g&&(e.i.push(new Tg(e.h)),e.h=null,e.g=0))}function Tg(e){this.g=0,this.h=e}function xg(e){if(!e.Ia())throw new Ue(2,2,3e3);return e.h[e.g++]}function kg(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function Ag(e,t,n,i){if(!e.g)return[];if(24==n)return n=xg(t).value,i=xg(t).value,n=[n,i].map((function(e){return("0"+(255&e).toString(16)).slice(-2)})).join(""),yg(e.g,String.fromCharCode(parseInt(n,16))),[];t=e.g;var r=null;switch(n){case 8:!bg(t)||t.g<=0&&t.h<=0||(t.g<=0?(t.g=t.m-1,t.h--):t.g--,t.i[t.h][t.g]=null);break;case 13:t.isVisible()&&(r=wg(t,i,e.i)),t.h+1>=t.o?function(e){for(var t=0,n=1;n<16;n++,t++)e.i[t]=e.i[n];for(n=0;n<1;n++,t++)e.i[t]=vg()}(t):t.h++,t.g=0;break;case 14:t.isVisible()&&(r=wg(t,i,e.i)),t.i[t.h]=vg(),t.g=0;break;case 12:t.isVisible()&&(r=wg(t,i,e.i)),mg(t),t.h=0,t.g=0}return r?[r]:[]}function Eg(e,t,n,i){if(n>=128&&n<=135)i=7&n,e.h[i]&&(e.g=e.h[i]);else{if(136===n){n=xg(t).value,t=[];for(var r=(n=p(Ig(e,n))).next();!r.done;r=n.next()){if((r=e.h[r.value]).isVisible()){var a=wg(r,i,e.i);a&&t.push(a)}mg(r)}return t}if(137===n)for(n=(t=p(Ig(e,t=xg(t).value))).next();!n.done;n=t.next())(n=e.h[n.value]).isVisible()||(n.j=i),n.display();else{if(138===n){for(n=xg(t).value,t=null,r=(n=p(Ig(e,n))).next();!r.done;r=n.next())(r=e.h[r.value]).isVisible()&&(t=wg(r,i,e.i)),r.l=!1;return t?[t]:[]}if(139===n){for(n=xg(t).value,t=null,r=(n=p(Ig(e,n))).next();!r.done;r=n.next())(r=e.h[r.value]).isVisible()?t=wg(r,i,e.i):r.j=i,r.l=!r.l;return t?[t]:[]}if(140===n)return Cg(e,t=xg(t).value,i);if(143===n)return i=Cg(e,255,i),Mg(e),i;if(144===n)t.skip(1),i=xg(t).value,e.g&&(e.g.B=(128&i)>0,e.g.F=(64&i)>0);else if(145===n)i=xg(t).value,n=xg(t).value,t.skip(1),e.g&&(t=Pg((48&n)>>4,(12&n)>>2,3&n),e.g.C=Pg((48&i)>>4,(12&i)>>2,3&i),e.g.u=t);else if(146===n)i=xg(t).value,t=xg(t).value,e.g&&((e=e.g).h=15&i,e.g=63&t);else if(151===n)t.skip(1),t.skip(1),i=xg(t).value,t.skip(1),e.g&&(e.g.G=3&i);else if(n>=152&&n<=159){n=(15&n)-8,(r=null!==e.h[n])||((a=new gg(n,e.i)).j=i,e.h[n]=a),i=xg(t).value,a=xg(t).value;var o=xg(t).value,s=xg(t).value,u=xg(t).value;t=xg(t).value,r&&!(7&t)||((t=e.h[n]).h=0,t.g=0,t.F=!1,t.B=!1,t.C="white",t.u="black"),(t=e.h[n]).l=(32&i)>0,t.M=127&a,t.I=o,t.H=(240&s)>>4,t.K=(128&a)>0,t.o=1+(15&s),t.m=1+(63&u),e.g=e.h[n]}}}return[]}function Ig(e,t){for(var n=[],i=0;i<8;i++)!(1&~t)&&e.h[i]&&n.push(i),t>>=1;return n}function Cg(e,t,n){for(var i=[],r=(t=p(Ig(e,t))).next();!r.done;r=t.next()){r=r.value;var a=e.h[r];a.isVisible()&&(a=wg(a,n,e.i))&&i.push(a),e.h[r]=null}return i}function Mg(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function Pg(e,t,n){var i={0:0,1:0,2:1,3:1};return Dg[(e=i[e])<<2|(t=i[t])<<1|(n=i[n])]}gg.prototype.isVisible=function(){return this.l},gg.prototype.display=function(){this.l=!0},Tg.prototype.Ia=function(){return this.g<this.h.length},Tg.prototype.Oa=function(){return this.g},Tg.prototype.skip=function(e){if(this.g+e>this.h.length)throw new Ue(2,2,3e3);this.g+=e},Tg.prototype.Ki=function(e){if(this.g-e<0)throw new Ue(2,2,3e3);this.g-=e};var Rg=new Map([[32," "],[33," "],[37,"…"],[42,"Š"],[44,"Œ"],[48,"█"],[49,"‘"],[50,"’"],[51,"“"],[52,"”"],[53,"•"],[57,"™"],[58,"š"],[60,"œ"],[61,"℠"],[63,"Ÿ"],[118,"⅛"],[119,"⅜"],[120,"⅝"],[121,"⅞"],[122,"│"],[123,"┐"],[124,"└"],[125,"─"],[126,"┘"],[127,"┌"]]),Dg="black blue green cyan red magenta yellow white".split(" ");function Lg(){this.h=[],this.g=[],this.i=new _g,this.l=0,this.m=new Map([["CC1",new lg(0,0)],["CC2",new lg(0,1)],["CC3",new lg(1,0)],["CC4",new lg(1,1)]]),this.u=this.o=0,this.j=new Map,this.C=!0,this.B=new Set,Ng(this)}function Ng(e){e.o=0,e.u=0;for(var t=p(e.m.values()),n=t.next();!n.done;n=t.next())(n=n.value).h=0,n.g=n.j,n.m=null,eg(n.i),eg(n.j),eg(n.o);e.C=!0}function Og(e,t){var n=t.type;if(16==(112&t.Cb)){var i=t.Cb>>3&1;0===n?e.o=i:e.u=i}if(i="CC"+(1+(n<<1|(n?e.u:e.o))),n=e.m.get(i),255===t.Cb&&255===t.hc||!t.Cb&&!t.hc||!Ug(t.Cb)||!Ug(t.hc))return++e.l>=45&&Ng(e),null;e.l=0,t.Cb&=127,t.hc&=127;var r=t.Cb;if(r>=1&&r<=15||!t.Cb&&!t.hc)return null;if(r=null,16==(112&t.Cb))e:{if(e.B.add(i),i=t.Cb,e=t.hc,n.m===(i<<8|e))n.m=null;else if(n.m=i<<8|e,16==(240&i)&&64==(192&e)){t=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&i)<<1|e>>5&1],i="white",r=!1;var a=null,o=e>95?e-96:e-64;o<=13?i=pg[Math.floor(o/2)]:o<=15?r=!0:a=Math.floor((o-16)/2),e=!(1&~e),4!==n.h&&(o=n.g,3===n.h&&t!==o.g&&(ng(o,n=1+t-o.h,1+o.g-o.h,o.h),ig(o,0,n-1),ig(o,t+1,15-t)),o.g=t,o.m=e,o.j=r,o.l=i,o.u=a,o.o="black")}else if(17==(247&i)&&32==(240&e))n.g.m=!1,n.g.j=!1,n.g.l="white",tg(n.g,0,32),i=!1,"white_italics"===(t=pg[(14&e)>>1])&&(t="white",i=!0),n.g.m=!(1&~e),n.g.j=i,n.g.l=t;else if(16==(247&i)&&32==(240&e)||23==(247&i)&&45==(255&e))t="black",!(7&i)&&(t=fg[(14&e)>>1]),n.g.o=t;else if(17==(247&i)&&48==(240&e))tg(n.g,1,e);else if(18==(246&i)&&32==(224&e))tg(n.g,1&i?3:2,e);else{if(20==(246&i)&&32==(240&e)){switch(e=t.pts,i=null,t.hc){case 32:dg(n);break;case 33:(n=n.g).i[n.g].pop();break;case 37:i=cg(n,2,e);break;case 38:i=cg(n,3,e);break;case 39:i=cg(n,4,e);break;case 40:tg(n.g,0,32);break;case 41:n.h=2,n.g=n.i,n.g.h=0,n.l=e;break;case 42:eg(n.o),hg(n);break;case 43:hg(n);break;case 44:t=n.i,i=null,4!==n.h&&(i=Zp(t,n.l,e)),ig(t,0,15);break;case 45:t=n.g,3!==n.h?i=null:(i=Zp(t,n.l,e),ng(t,(r=t.g-t.h+1)-1,r,t.h),ig(t,0,r-1),ig(t,t.g,15-t.g),n.l=e);break;case 46:ig(n.j,0,15);break;case 47:t=null,4!==n.h&&(t=Zp(n.i,n.l,e)),i=n.j,n.j=n.i,n.i=i,dg(n),n.l=e,i=t}r=i;break e}(23==i||31==i)&&e>=33&&e<=35&&(n.g.B=e-32)}r=null}else e=t.hc,tg(n.g,0,t.Cb),tg(n.g,0,e);return r}function jg(e,t){var n=[];try{for(;t.Ia();){var i=xg(t).value,r=(224&i)>>5,a=31&i;if(7===r&&0!=a&&(r=63&xg(t).value),0!=r){e.B.add("svc"+r),e.j.has(r)||e.j.set(r,new kg(r));for(var o=e.j.get(r),s=t.Oa();t.Oa()-s<a;){r=o;var u=t,l=xg(u),c=l.value,d=l.pts;if(16===c)c=c<<16|xg(u).value;if(c>=0&&c<=31)var h=Ag(r,u,c,d);else if(c>=128&&c<=159)h=Eg(r,u,c,d);else{if(c>=4096&&c<=4127)r=u,(u=255&c)>=8&&u<=15?r.skip(1):u>=16&&u<=23?r.skip(2):u>=24&&u<=31&&r.skip(3);else if(c>=4224&&c<=4255)r=u,(u=255&c)>=128&&u<=135?r.skip(4):u>=136&&u<=143&&r.skip(5);else if(c>=32&&c<=127)u=c,r.g&&yg(r.g,127===u?"♪":String.fromCharCode(u));else if(c>=160&&c<=255)r.g&&yg(r.g,String.fromCharCode(c));else if(c>=4128&&c<=4223){if(u=255&c,r.g)if(Rg.has(u)){var f=Rg.get(u);yg(r.g,f)}else yg(r.g,"_")}else c>=4256&&c<=4351&&r.g&&yg(r.g,160!=(255&c)?"_":"[CC]");h=[]}n.push.apply(n,g(h))}}}}catch(e){if(!(e instanceof Ue&&3e3===e.code))throw e;K("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return n}function Ug(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t}function Fg(e){for(var t=[],n=e,i=e=0;i<n.length;)2==e&&3==n[i]?(e=0,(n=[].concat(g(n))).splice(i,1),n=new Uint8Array(n)):0==n[i]?e++:e=0,i++;for(e=n,i=0;i<e.length;){for(n=0;255==e[i];)n+=255,i++;n+=e[i++];for(var r=0;255==e[i];)r+=255,i++;r+=e[i++],4==n&&t.push(e.subarray(i,i+r)),i+=r}return t}function Bg(){this.j=new Map,this.i=this.h=0,this.g=Vg}function Hg(e,t,n,i,r,a,o,s,u){var l=0,c=a,d=s.map((function(e){return e.hh}));for((d=[].concat.apply([],g(d))).length&&(c=d[0].sampleSize||a),t.skip(o+s[0].mg);t.Ia();){o=t.U();var h=t.Y(),f=null;switch(f=!1,s=1,e.g){case qg:f=6==(f=31&h);break;case Gg:s=2,t.skip(1),f=39==(f=h>>1&63)||40==f;break;case zg:s=2,t.skip(1),f=23==(f=h>>1&63)||24==f;break;default:return}if(f)for(h=0,l<d.length&&(h=d[l].Cf||0),h=(n+h)/i,f=(s=p(Fg(s=t.Tb(o-s,!1)))).next();!f.done;f=s.next())u.push({packet:f.value,pts:h});else try{t.skip(o-s)}catch(e){break}0==(c-=o+4)&&(n=l<d.length?n+(d[l].ih||r):n+r,c=++l<d.length&&d[l].sampleSize||a)}}Lg.prototype.clear=function(){this.l=0,this.h=[],this.g=[];var e=this.i;e.i=[],e.h=[],e.g=0,Ng(this);for(var t=(e=p(this.j.values())).next();!t.done;t=e.next())Mg(t.value)},Lg.prototype.extract=function(e,t){if(this.C){for(var n=p(this.m.values()),i=n.next();!i.done;i=n.next())i.value.l=t;this.C=!1}if(!((e=new ta(e,0)).getLength()<8)&&181===e.Y()&&49===e.Ca()&&1195456820===e.U()&&3===e.Y()&&64&(n=e.Y()))for(n&=31,e.skip(1),i=0;i<n;i++){var r=e.Y(),a=(4&r)>>2,o=e.Y(),s=e.Y();a&&(0===(r&=3)||1===r?this.h.push({pts:t,type:r,Cb:o,hc:s,order:this.h.length}):(this.g.push({pts:t,type:r,value:o,order:this.g.length}),this.g.push({pts:t,type:2,value:s,order:this.g.length})))}},Lg.prototype.decode=function(){function e(e,t){return e.pts-t.pts||e.order-t.order}var t=[];this.h.sort(e),this.g.sort(e);for(var n=p(this.h),i=n.next();!i.done;i=n.next())(i=Og(this,i.value))&&t.push(i);for(i=(n=p(this.g)).next();!i.done;i=n.next())Sg(this.i,i.value);for(i=(n=p(this.i.i)).next();!i.done;i=n.next())i=jg(this,i.value),t.push.apply(t,g(i));return this.i.i=[],this.h=[],this.g=[],t},Lg.prototype.getStreams=function(){return Array.from(this.B)},B("shaka.cea.CeaDecoder",Lg),Et=function(){return new Lg},Bg.prototype.init=function(e){function t(e){e=e.name,$g.has(e)&&(n.g=$g.get(e))}var n=this,i=[],r=[];if((new ra).box("moov",aa).box("mvex",aa).S("trex",(function(e){var t=e.reader;t.skip(4),t.skip(4),e=t.U(),t=t.U(),n.h=e,n.i=t})).box("trak",aa).S("tkhd",(function(e){var t=e.reader;1==(e=e.version)?(t.skip(8),t.skip(8)):(t.skip(4),t.skip(4));var n=t.U();1==e?t.skip(8):t.skip(4),t.skip(4),t.skip(8),t.skip(2),t.skip(2),t.skip(2),t.skip(2),t.skip(36),t.Ca(),t.Ca(),t.Ca(),t.Ca(),i.push(n)})).box("mdia",aa).S("mdhd",(function(e){e=no(e.reader,e.version),r.push(e.timescale)})).box("minf",aa).box("stbl",aa).S("stsd",oa).box("avc1",t).box("avc3",t).box("dvav",t).box("dva1",t).box("hev1",t).box("hvc1",t).box("dvh1",t).box("dvhe",t).box("vvc1",t).box("vvi1",t).box("dvc1",t).box("dvi1",t).box("encv",sa).box("sinf",aa).box("frma",(function(e){e=ao(e.reader).codec,$g.has(e)&&(n.g=$g.get(e))})).parse(e,!0,!0),!i.length||!r.length||i.length!=r.length)throw new Ue(2,2,2010);this.g==Vg&&$("Unable to determine bitstream format for CEA parsing!"),i.forEach((function(e,t){n.j.set(e,r[t])}))},Bg.prototype.parse=function(e){var t=this;if(this.g==Vg)return[];var n=[],i=0,r=[];return(new ra).box("moof",(function(e){i=e.start,r=[],aa(e)})).box("traf",(function(e){r.push({baseMediaDecodeTime:null,Td:t.h,Ud:t.i,Bi:[],timescale:9e4}),aa(e)})).S("trun",(function(e){var t=r[r.length-1];e=io(e.reader,e.version,e.flags),t.Bi.push(e)})).S("tfhd",(function(e){var n=r[r.length-1];e=eo(e.reader,e.flags),n.Td=e.Td||t.h,n.Ud=e.Ud||t.i,e=e.trackId,t.j.has(e)&&(n.timescale=t.j.get(e))})).S("tfdt",(function(e){var t=r[r.length-1];e=to(e.reader,e.version),t.baseMediaDecodeTime=e.baseMediaDecodeTime})).box("mdat",(function(e){for(var a=i-e.start-8,o=e.reader.Oa(),s=p(r),u=s.next();!u.done;u=s.next())null===(u=u.value).baseMediaDecodeTime?$("Unable to find base media decode time for CEA captions!"):(e.reader.seek(o),Hg(t,e.reader,u.baseMediaDecodeTime,u.timescale,u.Td,u.Ud,a,u.Bi,n))})).parse(e,!1,!0),n},B("shaka.cea.Mp4CeaParser",Bg);var Vg=0,qg=1,Gg=2,zg=3,$g=(new Map).set("avc1",qg).set("avc3",qg).set("dvav",qg).set("dva1",qg).set("hev1",Gg).set("hvc1",Gg).set("dvh1",Gg).set("dvhe",Gg).set("vvc1",zg).set("vvi1",zg).set("dvc1",zg).set("dvi1",zg);function Kg(){this.g=null}function Wg(e){return(e=function(e){var t=0,n=Oe(e),i=n.getUint32(t,!0);if(i!=e.byteLength)return[];e:{for(e=t+4+2,t=[];e<n.byteLength-1;){i=n.getUint16(e,!0),e+=2;var r=n.getUint16(e,!0);if(e+=2,1&r||r+e>n.byteLength){n=[];break e}var a=Le(n,e,r);t.push({type:i,value:a}),e+=r}n=t}return n}(e=Qe(Wt(e))).filter((function(e){return e.type===Yg}))[0])&&(e=qt(e=Ve(e.value,!0),"WRMHEADER"))?e:null}function Xg(e){try{var t=Wg(e);if(t)e:{for(var n=p(Yt(t,"DATA")),i=n.next();!i.done;i=n.next()){var r=i.value;if(r.children)for(var a=p(r.children),o=a.next();!o.done;o=a.next()){var s=o.value;if("LA_URL"==s.tagName){var u=Wt(s);break e}}}u=""}else u="";return u}catch(e){return""}}xt("video/mp4",(function(){return new Bg})),Kg.prototype.init=function(){},Kg.prototype.parse=function(e){this.g?this.g.clearData():this.g=new Ts;var t=[];if(!Es(e=Le(e)))return t;var n=(e=this.g.parse(e)).Vd(),i=e.$e();switch(e=[],n.video){case"avc":e.push(6);break;case"hvc":e.push(39),e.push(40)}if(!e.length)return t;for(i=(n=p(i)).next();!i.done;i=n.next())if(i=i.value,e.includes(i.type)&&null!=i.time)for(var r=p(Fg(i.data)),a=r.next();!a.done;a=r.next())t.push({packet:a.value,pts:i.time});return t},B("shaka.cea.TsCeaParser",Kg),xt("video/mp2t",(function(){return new Kg}));var Yg=1;function Jg(){this.g=new Map}function Qg(t,n,i,r){var a=function(e,t){for(var n=[],i=(t=p(t)).next();!i.done;i=t.next())(i=em(e,i.value))&&n.push(i);return n}(t,n),o=null;t=[];var s=[];n=null;var u=new Set(a.map((function(e){return e.keyId})));u.delete(null);var l="cenc";if(u.size>1)throw new Ue(2,4,4010);if(!i){if((s=a.filter((function(e){return"urn:mpeg:dash:sea:2012"==e.Gd}))).length>1)throw new Ue(2,4,4050);s.length&&(n=function(t){if(!e.crypto||!e.crypto.subtle)throw $("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new Ue(2,4,4042);var n=Qt(t.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!n)throw new Ue(2,4,4051);if("urn:mpeg:dash:sea:aes128-cbc:2013"!=n.attributes.schemeIdUri)throw new Ue(2,4,4051);if(n=Qt(t.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod"),!n)throw new Ue(2,4,4051);if(t=n.attributes.IV,n=Ke(n.attributes.keyUriTemplate),!t||!n)throw new Ue(2,4,4051);if(t=Ze(t.substr(2)),16!=t.byteLength)throw new Ue(2,4,4048);return{rk:n,iv:t}}(s[0])),(s=a.find((function(e){return"urn:mpeg:dash:mp4protection:2011"==e.Gd})))&&s.encryptionScheme&&(l=s.encryptionScheme),(s=a.filter((function(e){return"urn:mpeg:dash:mp4protection:2011"==e.Gd?(o=e.init||o,!1):"urn:mpeg:dash:sea:2012"!=e.Gd}))).length&&(t=function(e,t,n,i,r){for(var a=[],o=(n=p(n)).next();!o.done;o=n.next()){var s=i[(o=o.value).Gd];if(s){var u;if((u=Qt(o.node,"urn:microsoft:playready","pro"))&&Wt(u)){u=Qe(u=Wt(u));var l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);u=[{initData:ma(u,l,new Set,0),initDataType:"cenc",keyId:o.keyId}]}else u=null;if(l=null,"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"===o.Gd){l=o;var c=r;if(0==c.size)l=null;else{var d=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]);l=[{initData:ma(new Uint8Array([]),d,c,1),initDataType:"cenc",keyId:l.keyId}]}}u=it(s,t,o.init||e||u||l),(s=tm.get(s))&&(u.licenseServerUri=s(o)),(o=Qt(o.node,"https://dashif.org/CPS","Certurl"))&&(o=Wt(o))||(o=""),u.serverCertificateUri=o,a.push(u)}}return a}(o,l,s,r,u),0==t.length&&(t=[it("",l,o)]))}if(a.length&&!n&&(i||!s.length))for(t=[],r=(i=p(Object.values(r))).next();!r.done;r=i.next())"org.w3.clearkey"!=(r=r.value)&&t.push(it(r,l,o));if(u=Array.from(u)[0]||null)for(i=(l=p(t)).next();!i.done;i=l.next())for(r=(i=p(i.value.initData)).next();!r.done;r=i.next())r.value.keyId=u;return{Sh:u,Cm:o,drmInfos:t,dg:n,Xh:!0}}function Zg(e){var t=Qt(e.node,"https://dashif.org/CPS","Laurl");if(t&&(t=Wt(t)))return t;if((t=Qt(e.node,"urn:microsoft:playready","pro"))&&Wt(t))return Xg(t);if((e=Qt(e.node,"urn:mpeg:cenc:2013","pssh"))&&(e=Wt(e))){t=Qe(e),e=8;var n=(t=Oe(t)).getUint8(e);return e+=20,n>0&&(e+=4+16*t.getUint32(e)),Xg(e=qt("<pro>"+(e=Ye(e=Le(t,e+4)))+"</pro>"))}return""}function em(e,t){var n=t.attributes.schemeIdUri,i=en(t,"urn:mpeg:cenc:2013","default_KID"),r=tn(t,"urn:mpeg:cenc:2013","pssh").map(Xt),a=t.attributes.value;if(!n)return null;if(n=n.toLowerCase(),i&&(i=i.replace(/-/g,"").toLowerCase()).includes(" "))throw new Ue(2,4,4009);var o=[];try{o=r.map((function(t){if(!e.g.has(t)){var n=Qe(t);e.g.set(t,n)}return{initDataType:"cenc",initData:e.g.get(t),keyId:null}}))}catch(e){throw new Ue(2,4,4007)}return{node:t,Gd:n,keyId:i,init:o.length>0?o:null,encryptionScheme:a}}Jg.prototype.release=function(){this.g.clear()};var tm=(new Map).set("com.apple.fps",(function(t){if("apple"===e.shakaMediaKeysPolyfill)throw new Ue(2,4,4054);return(t=Qt(t.node,"https://dashif.org/CPS","Laurl"))&&(t=Wt(t))?t:""})).set("com.widevine.alpha",(function(e){var t=Qt(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=Wt(t))?t:(e=Qt(e.node,"urn:microsoft","laurl"))&&Ke(e.attributes.licenseUrl)||""})).set("com.microsoft.playready",Zg).set("com.microsoft.playready.recommendation",Zg).set("com.microsoft.playready.software",Zg).set("com.microsoft.playready.hardware",Zg).set("org.w3.clearkey",(function(e){var t=Qt(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=Wt(t))?t:(e=Qt(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&"EME-1.0"===e.attributes.Lic_type&&e&&(e=Wt(e))?e:""}));function nm(t,n,i,r,a,o){var s=(new Map).set("RepresentationID",n).set("Number",i).set("SubNumber",r).set("Bandwidth",a).set("Time",o);return t.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(t,n,i,r){if("$$"==t)return"$";var a=s.get(n);if(null==a)return t;switch("RepresentationID"==n&&i&&(i=void 0),"Time"==n&&"bigint"!=typeof a&&(Math.abs(a-Math.round(a))>=.2&&$("Calculated $Time$ values must be close to integers"),a=Math.round(a)),r){case void 0:case"d":case"i":case"u":t=a.toString();break;case"o":t=a.toString(8);break;case"x":t=a.toString(16);break;case"X":t=a.toString(16).toUpperCase();break;default:t=a.toString()}return i=e.parseInt(i,10)||1,Array(Math.max(0,i-t.length)+1).join("0")+t}))}function im(e,t){var n=am(e,t,"timescale"),i=1;n&&(i=un(n)||1);var r=(n=un((n=am(e,t,"duration"))||""))?n/i:null,a=am(e,t,"startNumber"),o=Number(am(e,t,"presentationTimeOffset"))||0,s=ln(a||"");if(null!=a&&null!=s||(s=1),a=null,t=om(e,t,"SegmentTimeline")){t=Kt(t,"S"),a=i,e=e.na.duration||1/0;for(var u=s,l=[],c=-o,d=0;d<t.length;++d){var h=t[d],f=t[d+1],p=Zt(h,"t",ln),g=Zt(h,"d",ln),m=Zt(h,"r",sn);if(h=Zt(h,"k",sn)||0,null!=p&&(p-=o),g){if(p=null!=p?p:c,(m=m||0)<0)if(f){if(null==(f=Zt(f,"t",ln)))break;if(p>=f)break;m=Math.ceil((f-p)/g)-1}else{if(e==1/0)break;if(p/a>=e)break;m=Math.ceil((e*a-p)/g)-1}for(l.length>0&&p!=c&&(l[l.length-1].end=p/a),f=0;f<=m;++f)c=p+g,l.push({start:p/a,end:c/a,Eh:p,vc:h,Sk:l.length+u}),p=c}}a=l}return{timescale:i,Mf:n,fb:r,qe:s,Ib:o/i||0,gd:o,timeline:a}}function rm(e,t){return[t(e.L),t(e.qa),t(e.sa)].filter(ki)}function am(e,t,n){t=rm(e,t),e=null;for(var i=(t=p(t)).next();!i.done&&!(e=i.value.attributes[n]);i=t.next());return e}function om(e,t,n){t=rm(e,t),e=null;for(var i=(t=p(t)).next();!i.done&&!(e=Jt(i.value,n));i=t.next());return e}function sm(e,t,n,i,r,a){if(a=void 0===a?0:a,en(e,"http://www.w3.org/1999/xlink","href")){var o=function(e,t,n,i,r,a){for(var o=en(e,"http://www.w3.org/1999/xlink","href"),s=en(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",u=p(Object.keys(e.attributes)),l=u.next();!l.done;l=u.next()){var c=(l=l.value).split(":"),d=Gt("http://www.w3.org/1999/xlink");c[0]==d&&delete e.attributes[l]}if(a>=5)return Ir(new Ue(2,4,4028));if("onLoad"!=s)return Ir(new Ue(2,4,4027));var h=nt([i],[o]);return r.request(0,Vr(h,t)).Xa((function(i){if(!(i=Vt(i.data,e.tagName)))return Ir(new Ue(2,4,4001,o));for(e.children=[];i.children.length;){var s=i.children.shift();e.children.push(s)}for(var u=(s=p(Object.keys(i.attributes))).next();!u.done;u=s.next())u=u.value,e.attributes[u]=i.attributes[u];return sm(e,t,n,h[0],r,a+1)}))}(e,t,n,i,r,a);return n&&(o=o.Xa(void 0,(function(){return sm(e,t,n,i,r,a)}))),o}o=[];for(var s=p($t(e)),u=s.next(),l={};!u.done;l={Qd:void 0},u=s.next())l.Qd=u.value,"urn:mpeg:dash:resolve-to-zero:2013"==en(l.Qd,"http://www.w3.org/1999/xlink","href")?e.children=e.children.filter(function(e){return function(t){return t!==e.Qd}}(l)):"SegmentTimeline"!=l.Qd.tagName&&o.push(sm(l.Qd,t,n,i,r,a));return Rr(o).Xa((function(){return e}))}function um(e,t,n,i,r,a,o){var s,u=(new ra).S("sidx",(function(e){s=function(e,t,n,i,r,a,o){var s=[];o.reader.skip(4);var u=o.reader.U();if(0==u)throw new Ue(2,3,3005);if(0==o.version)var l=o.reader.U(),c=o.reader.U();else l=o.reader.Dd(),c=o.reader.Dd();o.reader.skip(2);var d=o.reader.Ca();for(e=e+o.size+c,c=0;c<d;c++){var h=o.reader.U(),f=(2147483648&h)>>>31;h&=2147483647;var p=o.reader.U();if(o.reader.skip(4),1==f)throw new Ue(2,3,3006);s.push(new Fo(l/u+n,(l+p)/u+n,(function(){return a}),e,e+h-1,t,n,i,r)),l+=p,e+=h}return o.parser.stop(),s}(t,i,r,a,o,n,e)}));if(e&&u.parse(e),s)return s;throw new Ue(2,3,3004)}function lm(e){this.h=Oe(e),this.g=new ta(this.h,0)}function cm(e){var t=dm(e);if(t.length>7)throw new Ue(2,3,3002);for(var n=0,i=(t=p(t)).next();!i.done;i=t.next())n=256*n+i.value;t=dm(e);e:{for(var r=(i=p(hm)).next();!r.done;r=i.next())if(Re(t,new Uint8Array(r.value))){i=!0;break e}i=!1}if(i)t=e.h.byteLength-e.g.Oa();else{if(8==t.length&&224&t[1])throw new Ue(2,3,3001);for(r=i=0;r<t.length;r++){var a=t[r];i=0==r?a&(1<<8-t.length)-1:256*i+a}t=i}return t=e.g.Oa()+t<=e.h.byteLength?t:e.h.byteLength-e.g.Oa(),i=Oe(e.h,e.g.Oa(),t),e.g.skip(t),new fm(n,i)}function dm(e){var t=e.g.Oa(),n=e.g.Y();if(0==n)throw new Ue(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.g.skip(n-1),Le(e.h,t,n)}lm.prototype.Ia=function(){return this.g.Ia()};var hm=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function fm(e,t){this.id=e,this.g=t}function pm(e){if(e.g.byteLength>8)throw new Ue(2,3,3002);if(8==e.g.byteLength&&224&e.g.getUint8(0))throw new Ue(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++){t=256*t+e.g.getUint8(n)}return t}function gm(e){var t=new lm(e.g);if(179!=(e=cm(t)).id)throw new Ue(2,3,3013);if(e=pm(e),183!=(t=cm(t)).id)throw new Ue(2,3,3012);t=new lm(t.g);for(var n=0;t.Ia();){var i=cm(t);if(241==i.id){n=pm(i);break}}return{jl:e,Kk:n}}function mm(e,t,n){if(!(t=om(e,t,"Initialization")))return null;var i=e.L.cb(),r=t.attributes.sourceURL;r&&(i=nt(i,[Ke(r)],e.Lb())),r=0;var a=null;return(t=Zt(t,"range",on))&&(r=t.start,a=t.end),(n=new jo((function(){return i}),r,a,Sm(e),null,null,n,e.qa.encrypted)).codecs=e.L.codecs,n.mimeType=e.L.mimeType,e.na&&!e.na.ef&&(n.g=e.na.start+e.na.duration),n}function vm(e,t,n){var i=Number(am(e,bm,"presentationTimeOffset"))||0,r=am(e,bm,"timescale"),a=1;r&&(a=un(r)||1);var o=i/a||0,s=mm(e,bm,n);!function(e,t){if(_m(e,t),!wm(e))throw new Ue(2,4,4002)}(e,s);var u=Bt(e);return{endTime:-1,timeline:-1,Sc:function(){var e=om(u,bm,"RepresentationIndex"),n=u.L.cb();return e&&(e=Ke(e.attributes.sourceURL))&&(n=nt(n,[e],u.Lb())),e=wm(u),ym(u,t,s,n,e.start,e.end,o)},timescale:a}}function ym(e,t,n,i,r,a,o){var s,u,l,c,d,h,f,g,m,v,y,b,_,S,T,x,k,A;return R((function(E){if(1==E.g)return s=e.presentationTimeline,u=!e.Eb||!e.na.ef,l=e.na.start,c=e.na.duration,d=e.L.mimeType.split("/")[1],f=null,g=[(h=t)(i,r,a,!1),"webm"==d?h(n.P(),n.startByte,n.endByte,!0):null],h=null,w(E,Promise.all(g),2);if(m=E.h,v=m[0],y=m[1]||null,null,_=l-o,S=l,T=c?l+c:1/0,"mp4"==d)var I=um(v,r,i,n,_,S,T);else{I=v;var C=new lm(y);if(440786851!=cm(C).id)throw new Ue(2,3,3008);var M=cm(C);if(408125543!=M.id)throw new Ue(2,3,3009);C=M.g.byteOffset,M=new lm(M.g);for(var P=null;M.Ia();){var R=cm(M);if(357149030==R.id){P=R;break}}if(!P)throw new Ue(2,3,3010);for(P=new lm(P.g),R=1e6,M=null;P.Ia();){var D=cm(P);if(2807729==D.id)R=pm(D);else if(17545==D.id)if(4==D.g.byteLength)M=D.g.getFloat32(0);else{if(8!=D.g.byteLength)throw new Ue(2,3,3003);M=D.g.getFloat64(0)}}if(null==M)throw new Ue(2,3,3011);if(M*=P=R/1e9,475249515!=(I=cm(new lm(I))).id)throw new Ue(2,3,3007);I=function(e,t,n,i,r,a,o,s,u){function l(){return r}var c=[];e=new lm(e.g);for(var d=null,h=null;e.Ia();){var f=cm(e);if(187==f.id){var p=gm(f);p&&(f=n*p.jl,p=t+p.Kk,null!=d&&c.push(new Fo(d+o,f+o,l,h,p-1,a,o,s,u)),d=f,h=p)}}return null!=d&&c.push(new Fo(d+o,i+o,l,h,null,a,o,s,u)),c}(I,C,P,M,i,n,_,S,T)}for(x=p(b=I),k=x.next();!k.done;k=x.next())(A=k.value).codecs=e.L.codecs,A.mimeType=e.L.mimeType,A.bandwidth=e.bandwidth;return s.ie(b),f=new Mu(b),u&&f.pd(S,T,!0),E.return(f)}))}function bm(e){return e.Hd}function wm(e){var t=om(e,bm,"RepresentationIndex");return e=on((e=am(e,bm,"indexRange"))||""),t&&(e=Zt(t,"range",on,e)),e}function _m(e,t){var n=e.L.mimeType.split("/")[1];if(e.L.contentType!=ut&&"mp4"!=n&&"webm"!=n)throw new Ue(2,4,4006);if("webm"==n&&!t)throw new Ue(2,4,4005)}function Sm(e){var t=e.L;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.uf,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null,label:e.qa.label||null,roles:e.roles||null,language:e.qa.language||null}}function Tm(e,t,n){var i=mm(e,xm,n),r=function(e){var t=function(e){return[e.L.zc,e.qa.zc,e.sa.zc].filter(ki).map((function(e){return Kt(e,"SegmentURL")})).reduce((function(e,t){return e.length>0?e:t})).map((function(t){return t.attributes.indexRange&&!e.Kg&&(e.Kg=!0),{zk:Ke(t.attributes.media),start:(t=Zt(t,"mediaRange",on,{start:0,end:null})).start,end:t.end}}))}(e);e=im(e,xm);var n=e.qe;0==n&&(n=1);var i=0;return e.fb?i=e.fb*(n-1):e.timeline&&e.timeline.length>0&&(i=e.timeline[0].start),{fb:e.fb,startTime:i,qe:n,Ib:e.Ib,timescale:e.timescale,timeline:e.timeline,yd:t}}(e);if(!r.fb&&!r.timeline&&r.yd.length>1)throw new Ue(2,4,4002);if(!r.fb&&!e.na.duration&&!r.timeline&&1==r.yd.length)throw new Ue(2,4,4002);if(r.timeline&&0==r.timeline.length)throw new Ue(2,4,4002);var a=null,o=null;e.sa.id&&e.L.id&&(o=t.get(e.sa.id+","+e.L.id))&&(a=o.segmentIndex);var s=function(e,t,n,i,r,a,o,s,u,l){var c=i.yd.length;i.timeline&&i.timeline.length!=i.yd.length&&(c=Math.min(i.timeline.length,i.yd.length));for(var d=e-i.Ib,h=t?e+t:1/0,f=[],p=i.startTime,g={},m=0;m<c;g={Of:void 0,Df:void 0},m++){g.Df=i.yd[m];var v=p;p=void 0,p=null!=i.fb?v+i.fb:i.timeline?i.timeline[m].end:v+t,g.Of=null,(g=new Fo(e+v,e+p,function(e){return function(){return null==e.Of&&(e.Of=nt(n(),[e.Df.zk],l())),e.Of}}(g),g.Df.start,g.Df.end,r,d,e,h,[],"",null,null,Vo,a)).codecs=s,g.mimeType=o,g.bandwidth=u,f.push(g)}return f}(e.na.start,e.na.duration,e.L.cb,r,i,n,e.L.mimeType,e.L.codecs,e.bandwidth,e.Lb);return t=!a,a?a.fe(s,e.presentationTimeline.Hb()):a=new Mu(s),e.presentationTimeline.ie(s),e.Eb&&e.na.ef||a.pd(e.na.start,e.na.duration?e.na.start+e.na.duration:1/0,t),o&&(o.segmentIndex=a),{endTime:-1,timeline:-1,Sc:function(){return a&&0!=a.getNumReferences()||a.nf(s),Promise.resolve(a)},timescale:r.timescale}}function xm(e){return e.zc}function km(t,n,i,r,a,o,s,u,l,c){l||t.L.cf||(t.L.cf=am(t,Am,"initialization"));var d=t.L.cf?function(e,t){var n=e.L.cf;if(n||(n=am(e,Am,"initialization")),!n)return null;n=Ke(n);var i=e.L.originalId,r=e.bandwidth||null,a=e.L.cb,o=e.Lb;return t=new jo((function(){var e=nm(n,i,null,null,r,null);return nt(a(),[e],o())}),0,null,Sm(e),null,null,t,e.qa.encrypted),t.codecs=e.L.codecs,t.mimeType=e.L.mimeType,e.na&&!e.na.ef&&(t.g=e.na.start+e.na.duration),t}(t,s):null,h=function(e){var t=im(e,Am),n=am(e,Am,"media"),i=am(e,Am,"index"),r=am(e,Am,"k"),a=0;return r&&(a=parseInt(r,10)),{Mf:t.Mf,fb:t.fb,timescale:t.timescale,qe:t.qe,Ib:t.Ib,gd:t.gd,timeline:t.timeline,$b:n&&Ke(n),ae:i,mimeType:e.L.mimeType,codecs:e.L.codecs,bandwidth:e.bandwidth,Ak:a}}(t);!function(e){var t=e.ae?1:0;if(t+=e.timeline?1:0,t+=e.fb?1:0,0==t)throw new Ue(2,4,4002);if(1!=t&&(e.ae&&(e.timeline=null),e.Mf=null,e.fb=null),!e.ae&&!e.$b)throw new Ue(2,4,4002)}(h);var f=Bt(t);if(h.ae)return _m(t,d),{endTime:-1,timeline:-1,Sc:function(){var e=nm(h.ae,f.L.originalId,null,null,f.bandwidth||null,null);return e=nt(f.L.cb(),[e]),ym(f,n,d,e,0,null,h.Ib)},timescale:h.timescale};if(h.fb)return r||"image"===t.qa.contentType||"text"===t.qa.contentType||(r=t.na.start,c=t.sa.id,i=t.na.duration,c=(c=null!=c&&o.get(c)||i)?r+c:1/0,t.presentationTimeline.Sg(h.fb),t.presentationTimeline.zi(r,c)),{endTime:-1,timeline:-1,Sc:function(){return function(t,n,i,r,a,o,s,u){function l(i){var a=i-y,s=a*v,l=n.Mf,c=a*l;"BigInt"in e&&c>Number.MAX_SAFE_INTEGER&&(c=BigInt(a)*BigInt(l)),a=(s+=f)+v,l=Math.min(a,d());var h=[],p=n.Ak;if(p)for(var g=(l-s)/p,m={},k=0;k<p;m={Wi:void 0},k++){var A=s+g*k,E=A+g;m.Wi=k,(m=new Fo(A,E,function(e){return function(){var t=nm(b,_,i,e.Wi,w,c);return nt(S(),[t],T())}}(m),0,null,r,x,f,d(),[],"",null,null,Vo,o)).codecs=t.L.codecs,m.mimeType=t.L.mimeType,0==u?k>0&&m.wd():k%u!=0&&m.wd(),h.push(m)}return(s=new Fo(s,l,(function(){if(p)return[];var e=nm(b,_,i,null,w,c);return nt(S(),[e],T())}),0,null,r,x,f,d(),h,"",null,null,Vo,o,h.length>0)).codecs=t.L.codecs,s.mimeType=t.L.mimeType,s.bandwidth=t.bandwidth,s.j=a,s}function c(){var e=[Math.max(h.Hb(),f),Math.min(h.Hc(),d())].map((function(e){return e-f}));return e=[Math.ceil(e[0]/v),Math.ceil(e[1]/v)-1],t.L.rb&&e[1]++,e.map((function(e){return e+y}))}function d(){var e=null!=g&&a.get(g)||m;return e?f+e:1/0}var h=t.presentationTimeline,f=t.na.start,g=t.sa.id,m=t.na.duration,v=n.fb,y=n.qe,b=n.$b,w=t.bandwidth||null,_=t.L.originalId,S=t.L.cb,T=t.Lb,x=f-n.Ib,k=c();i=t.Eb?Math.max(k[0],k[1]-i+1):k[0],s=s||k[1],k=[];for(var A=i;A<=s;++A){var E=l(A);k.push(E)}var I=new Mu(k);if(k=h.Hc()<d(),A=h.W(),k||A){var C=Math.max(i,s+1);i=v,t.L.rb&&(i=.1),I.Nf(i,(function(){var e=h.Hb();I.Ya(e);var t=p(c());t.next(),t=t.next().value;for(var n=[];C<=t;){var i=l(C);n.push(i),C++}return e>d()&&!n.length?null:n}))}return Promise.resolve(I)}(f,h,a,d,o,s,u,t.L.Ef)},timescale:h.timescale};var g=null;r=r=null,t.sa.id&&t.L.id&&(r=t.sa.id+","+t.L.id,r=i.get(r))&&(g=r.segmentIndex);var m=t.na.start,v=t.na.duration?m+t.na.duration:1/0;if(g)Im(c=g,h,m,v,d,t.Eb),c.Ya(t.presentationTimeline.Hb());else{if(i=0,l=-1,null!=t.sa.id&&null!=t.L.id){var y=c.get(t.sa.id);if(y)l=y.timeline;else for(y=(c=p(c.values())).next();!y.done;y=c.next()){if(y=y.value,Math.abs(h.Ib-y.endTime)<=ct&&y.bh.includes(t.L.id)){l=y.timeline;break}y.timeline>=i&&(i=y.timeline+1)}}-1==l&&(l=i),g=new Em(t.Eb,h,t.L.originalId,t.bandwidth,t.L.cb,t.Lb,m,v,d,s,t.L.Ef,l)}return h.timeline&&"image"!==t.qa.contentType&&"text"!==t.qa.contentType&&t.presentationTimeline.Ai(g.h?g.h.timeline:[],m),r&&t.Eb&&(r.segmentIndex=g),r=(r=(r=h.timeline)&&r[r.length-1])?r.end+h.Ib:-1,c=-1,g instanceof Em&&(c=g.Te()),{endTime:r,timeline:c,Sc:function(){return g instanceof Em&&0==g.getNumReferences()&&Im(g,h,m,v,d,t.Eb),Promise.resolve(g)},timescale:h.timescale}}function Am(e){return e.Nc}function Em(e,t,n,i,r,a,o,s,u,l,c,d){Mu.call(this,[]),this.F=e,this.h=t,this.H=n,this.C=i,this.G=r,this.J=a,this.j=o,this.l=s,this.u=u,this.B=l,this.I=c,this.K=d,Cm(this)}function Im(e,t,n,i,r,a){if(function(e,t){if(e.u!==t){e.u=t;for(var n=(e=p(e.g)).next();!n.done;n=e.next())(n=n.value)&&Ho(n,t)}}(e,r),e.F=a,e.h){if(e.h.gd!==t.gd&&(e.h.timeline=t.timeline,e.h.gd=t.gd,e.h.Ib=t.Ib),e.h.$b!==t.$b&&(e.h.$b=t.$b),(n=e.h.timeline).length){var o=n[n.length-1];t=t.timeline.filter((function(e){return e.end>o.end}))}else t=t.timeline.slice();t.length>0&&e.h.timeline.push.apply(e.h.timeline,g(t)),e.l!==i&&(e.l=i)}else e.h=t,e.j=n,e.l=i;Cm(e)}function Cm(e){if(e.h&&!e.o){for(var t=[],n=p(e.h.timeline),i=n.next();!i.done;i=n.next())(i=i.value).start>=e.l||i.end<=0||t.push(i);e.h.timeline=t,e.Ya(e.j)}}function Mm(e,t,n,i,r,a,o,s){return e=nm(e,t,n,a,i||null,r),nt(o(),[e],s()).map((function(e){return e.toString()}))}function Pm(e){this.o=null,this.B=e,this.H=new jr,this.i=[],this.h=null,this.m=[],this.C=null,this.G=[],this.F=300,this.l=new Map,this.j=new Map,this.g=null,this.u="UNKNOWN"}function Rm(e,t){var n,i,r,a,o,s,u;return R((function(l){return 1==l.g?(n=nt(e.i,[Dm(e,t)]),i=Vr(n,e.o.retryParameters),r=e.B.networkingEngine.request(8,i),Ur(e.H,r),S(l,2),w(l,r.promise,4)):2!=l.g?(a=l.h,o=He(a.data),1==(s=JSON.parse(o)).VERSION&&function(e,t,n){null!=e.g&&(e.g.stop(),e.g=null);var i=t["RELOAD-URI"]||n;e.g=new Si((function(){Rm(e,i)})),(n=t.TTL)&&(e.F=n);e.g.ia(e.F),e.m=t["PATHWAY-PRIORITY"]||[],e.G=t["PATHWAY-CLONES"]||[]}(e,s,a.uri),x(l,0)):(u=k(l))&&7001==u.code?l.return():(null!=e.g&&(e.g.stop(),e.g=null),e.g=new Si((function(){Rm(e,t)})),e.g.ia(e.F),void _(l))}))}function Dm(e,t){if(!e.m.length)return t;t=new ge(t);var n=e.C||e.m[0],i=Math.round(e.B.getBandwidthEstimate()),r=t.g;return"DASH"==e.u?(r.add("_DASH_pathway",n),r.add("_DASH_throughput",String(i))):"HLS"==e.u&&(r.add("_HLS_pathway",n),r.add("_HLS_throughput",String(i))),Me(r)&&be(t,r),t.toString()}function Lm(e,t,n,i){var r=e.l.get(t);r||(r=new Map),r.set(n,i),e.l.set(t,r)}function Nm(e,t,n){n=void 0!==n&&n,t=e.l.get(t)||new Map;for(var i=[],r=p(e.m),a=r.next(),o={};!a.done;o={Bd:void 0},a=r.next())if(o.Bd=a.value,a=t.get(o.Bd))i.push({Xg:o.Bd,location:a});else if(a=e.G.find(function(e){return function(t){return t.Ll==e.Bd}}(o))){var s=t.get(a["BASE-ID"]);s&&(a["URI-REPLACEMENT"].hj?(ve(s=new ge(s),a["URI-REPLACEMENT"].hj),i.push({Xg:o.Bd,location:s.toString()})):i.push({Xg:o.Bd,location:s}))}for(r=Date.now(),a=(o=p(e.j.keys())).next();!a.done;a=o.next())a=a.value,r>(s=e.j.get(a))&&e.j.delete(a);if(i=i.filter((function(t){for(var n=p(e.j.keys()),i=n.next();!i.done;i=n.next())if(i.value.includes(new ge(t.location).Db))return!1;return!0})),i.length&&(e.C=i[0].Xg),i=i.map((function(e){return e.location})),!i.length&&e.h)for(o=(r=p(e.h.split(","))).next();!o.done;o=r.next())(o=t.get(o.value))&&(e.C=e.h,i.push(o));if(!i.length)for(r=(t=p(t.values())).next();!r.done;r=t.next())i.push(r.value);return n?i:nt(e.i,i)}function Om(){this.l=[],this.h=[],this.g=[],this.j=[],this.i=[],this.o=!1,this.m=new Set}function jm(e,t){for(var n=[],i=[],r=[],a=[],o=(e=p(e)).next();!o.done;o=e.next()){var s=o.value;o=new Map(s.audioStreams.map((function(e){return[cv(e),e]})));var u=new Map(s.videoStreams.map((function(e){return[lv(e),e]}))),l=new Map(s.textStreams.map((function(e){return[dv(e),e]})));if(s=new Map(s.imageStreams.map((function(e){return[hv(e),e]}))),t){var c=rv(ut);l.set(dv(c),c),c=rv("image"),s.set(hv(c),c)}n.push(o),i.push(u),r.push(l),a.push(s)}return{Mh:n,fj:i,bj:r,ji:a}}function Um(e){var t,n,i,r,a,o,s,u,l,c,d,h,f,g,m,v,y,b,_,S,T,x,k,A,E,I,C,M,P;return R((function(R){switch(R.g){case 1:if(t=lt,1==e.length)return R.return(e[0]);for(n=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.ka})).map((function(e){return[cv(e),e]})))})),i=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.Aa})).map((function(e){return[lv(e),e]})))})),r=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.Na})).map((function(e){return[dv(e),e]})))})),a=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.Uf})).map((function(e){return[hv(e),e]})))})),o=p(r),s=o.next();!s.done;s=o.next())u=s.value,l=iv(t.Na),u.set(dv(l),l);for(c=p(a),d=c.next();!d.done;d=c.next())h=d.value,f=iv(t.Uf),h.set(hv(f),f);return w(R,Fm(g=new Om,[],n,0,Gm,$m,0),2);case 2:return m=R.h,w(R,Fm(g,[],i,0,Gm,$m,0),3);case 3:return v=R.h,w(R,Fm(g,[],r,0,Gm,$m,0),4);case 4:return y=R.h,w(R,Fm(g,[],a,0,Gm,$m,0),5);case 5:if(b=R.h,_=0,v.length&&m.length)for(k=p(m),A=k.next();!A.done;A=k.next())for(E=A.value,I=p(v),C=I.next();!C.done;C=I.next())M=C.value,P=_++,M.variantIds.push(P),E.variantIds.push(P);else for(S=v.concat(m),T=p(S),x=T.next();!x.done;x=T.next())x.value.variantIds=[_++];return R.return(v.concat(m).concat(y).concat(b))}}))}function Fm(e,t,n,i,r,a,o){var s,u,l,c,d,h,f,g,m,v,y,b,_,S,T,x,k,A;return R((function(E){switch(E.g){case 1:for(s=[],u=0;u<n.length;u++)u>=i?s.push(new Set(n[u].values())):s.push(new Set);l=p(t),c=l.next();case 2:if(c.done){E.A(4);break}return d=c.value,w(E,function(e,t,n,i,r,a,o){return R((function(s){return 1==s.g?(Km(e,n,t,o>0),t.matchedStreams?t.segmentIndex?w(s,Bm(t,i+o),2):s.A(2):s.return(!1)):(Vm(t,i,r,a,o),s.return(!0))}))}(e,d,n,i,a,s,o),5);case 5:if(!E.h)throw new Ue(2,4,4037);c=l.next(),E.A(2);break;case 4:for(h=p(s),f=h.next();!f.done;f=h.next())for(g=f.value,m=p(g),v=m.next();!v.done;v=m.next())y=v.value,(b=Hm(e,t,y,n,r,a,s))&&t.push(b);for(_=p(s),S=_.next();!S.done;S=_.next())for(T=S.value,x=p(T),k=x.next(),A={};!k.done;A={sh:void 0},k=x.next())if(A.sh=k.value,!uv(A.sh)&&t.some(function(e){return function(t){return Ym(e.sh,t)}}(A)))throw new Ue(2,4,4037);return E.return(t)}}))}function Bm(e,t){var n,i,r,a,o,s;return R((function(u){if(1==u.g){for(n=[],i=e.matchedStreams,r=t;r<i.length;r++)a=i[r],n.push(a.createSegmentIndex()),a.trickModeVideo&&!a.trickModeVideo.segmentIndex&&n.push(a.trickModeVideo.createSegmentIndex()),a.dependencyStream&&!a.dependencyStream.segmentIndex&&n.push(a.dependencyStream.createSegmentIndex());return w(u,Promise.all(n),2)}if(e.segmentIndex instanceof Lu)for(o=t;o<i.length;o++)(s=i[o]).segmentIndex&&e.segmentIndex.h.push(s.segmentIndex);_(u)}))}function Hm(e,t,n,i,r,a,o){if(uv(n))return null;var s=r(n);return Km(e,i,s),s.createSegmentIndex&&(s.createSegmentIndex=function(){return R((function(e){return s.segmentIndex?e.A(0):(s.segmentIndex=new Lu,w(e,Bm(s,0),0))}))},s.closeSegmentIndex=function(){if(s.segmentIndex&&(s.segmentIndex.release(),s.segmentIndex=null),s.matchedStreams)for(var e=p(s.matchedStreams),n=e.next();!n.done;n=e.next()){var i;if(i=(n=n.value).segmentIndex){e:{for(var r=(i=p(t)).next();!r.done;r=i.next())if((r=r.value)!==s&&r.segmentIndex&&r.matchedStreams&&r.matchedStreams.includes(n)){i=!0;break e}i=!1}i=!i}i&&(n.segmentIndex.release(),n.segmentIndex=null)}}),s.matchedStreams&&s.matchedStreams.length?(Vm(s,0,a,o,0),s):null}function Vm(e,t,n,i,r){var a=e.matchedStreams;for(t+=r;t<a.length;t++){var o=a[t];n(e,o);var s=!0;if("audio"==e.type&&0==Ri(e.language,o.language)&&(s=!1),s&&((s=i[t-r])&&s.delete(o),o.fullMimeTypes))for(s=(o=p(o.fullMimeTypes.values())).next();!s.done;s=o.next())e.fullMimeTypes.add(s.value)}}function qm(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set(e.keyIds),t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t.trickModeVideo=null,t.dependencyStream=null,t}function Gm(e){var t=Object.assign({},e);return t.roles=t.roles.slice(),t.keyIds=new Set(e.keyIds),t.segments=[],t.variantIds=[],t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t}function zm(e,t){function n(e,t){e||(e=[]);for(var n=(t=p(t)).next();!n.done;n=t.next())n=n.value,e.includes(n)||e.push(n);return e}e.roles=n(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=n(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var i=p(t.keyIds),r=i.next();!r.done;r=i.next())e.keyIds.add(r.value);if(null==e.originalId?e.originalId=t.originalId:(i=t.originalId||"")&&!e.originalId.endsWith(i)&&(e.originalId+=","+i),i=yr(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!i.length)throw new Ue(2,4,4038);if(e.drmInfos=i,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),r=(i=p(t.closedCaptions)).next();!r.done;r=i.next()){var a=p(r.value);r=a.next().value,a=a.next().value,e.closedCaptions.set(r,a)}e.bandwidth&&t.bandwidth&&(e.bandwidth=Math.max(e.bandwidth,t.bandwidth)),t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=qm(t.trickModeVideo),e.trickModeVideo.matchedStreams=[],e.trickModeVideo.createSegmentIndex=function(){if(e.trickModeVideo.segmentIndex)return Promise.resolve();for(var t=new Lu,n=p(e.trickModeVideo.matchedStreams),i=n.next();!i.done;i=n.next())t.h.push(i.value.segmentIndex);return e.trickModeVideo.segmentIndex=t,Promise.resolve()}),e.trickModeVideo.matchedStreams.push(t.trickModeVideo),zm(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&(e.trickModeVideo.matchedStreams.push(t),zm(e.trickModeVideo,t)),t.dependencyStream?(e.dependencyStream||(e.dependencyStream=qm(t.dependencyStream),e.dependencyStream.matchedStreams=[],e.dependencyStream.createSegmentIndex=function(){if(e.dependencyStream.segmentIndex)return Promise.resolve();for(var t=new Lu,n=p(e.dependencyStream.matchedStreams),i=n.next();!i.done;i=n.next())t.h.push(i.value.segmentIndex);return e.dependencyStream.segmentIndex=t,Promise.resolve()}),e.dependencyStream.matchedStreams.push(t.dependencyStream),zm(e.dependencyStream,t.dependencyStream)):e.dependencyStream&&(e.dependencyStream.matchedStreams.push(t),zm(e.dependencyStream,t))}function $m(e,t){var n=e.roles;n||(n=[]);for(var i=p(t.roles),r=i.next();!r.done;r=i.next())r=r.value,n.includes(r)||n.push(r);for(e.roles=n,i=(n=p(t.keyIds)).next();!i.done;i=n.next())e.keyIds.add(i.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,g(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),n=(t=p(t.closedCaptions)).next();!n.done;n=t.next())n=(i=p(n.value)).next().value,i=i.next().value,e.closedCaptions.set(n,i)}function Km(e,t,n,i){i=void 0!==i&&i?n.matchedStreams:[];for(var r=(t=p(t)).next();!r.done;r=t.next()){if(!(r=Wm(e,r.value,n)))return;i.push(r)}n.matchedStreams=i}function Wm(e,t,n){var i={audio:cv,video:lv,text:dv,image:hv}[n.type],r=null,a=i(n);if(t.has(a))r=t.get(a);else{a={audio:function(e,t){return Ym(e,t)},video:function(e,t){return Ym(e,t)},text:Jm,image:Qm}[n.type];for(var o={audio:Zm,video:ev,text:tv,image:nv}[n.type],s=p(t.values()),u=s.next();!u.done;u=s.next())!a(n,u=u.value)||n.fastSwitching!=u.fastSwitching||r&&!o(n,r,u)||(r=u)}return e.o&&!uv(r)&&t.delete(i(r)),r}function Xm(e,t){return e.mimeType==t.mimeType&&pv(e.codecs)===pv(t.codecs)}function Ym(e,t){return!(e.drmInfos&&!vr(e.drmInfos,t.drmInfos))}function Jm(e,t){return!t.language||e.forced===t.forced&&0!=Ri(e.language,t.language)&&t.kind==e.kind}function Qm(){return!0}function Zm(e,t,n){var i=ov(e,t,n);if(i===gv)return!0;if(i===vv)return!1;i=Ri(e.language,t.language);var r=Ri(e.language,n.language);if(r>i)return!0;if(r<i)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter((function(t){return e.roles.includes(t)})),(r=n.roles.filter((function(t){return e.roles.includes(t)}))).length>i.length)return!0;if(r.length<i.length)return!1;if(n.roles.length!==t.roles.length)return n.roles.length<t.roles.length}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return!(t.primary||!n.primary)||!(t.primary&&!n.primary)&&((i=av(e.channelsCount,t.channelsCount,n.channelsCount))==gv||i!=vv&&((i=av(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate))==gv||i!=vv&&!(!e.bandwidth||sv(e.bandwidth,t.bandwidth,n.bandwidth)!=gv)))}function ev(e,t,n){var i=ov(e,t,n);if(i===gv)return!0;if(i===vv)return!1;if((i=av(e.width*e.height,t.width*t.height,n.width*n.height))==gv)return!0;if(i==vv)return!1;if(e.frameRate){if((i=av(e.frameRate,t.frameRate,n.frameRate))==gv)return!0;if(i==vv)return!1}return!(!e.bandwidth||sv(e.bandwidth,t.bandwidth,n.bandwidth)!=gv)}function tv(e,t,n){var i=Ri(e.language,t.language),r=Ri(e.language,n.language);if(r>i)return!0;if(r<i)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter((function(t){return e.roles.includes(t)})),(r=n.roles.filter((function(t){return e.roles.includes(t)}))).length>i.length)return!0;if(r.length<i.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return n.mimeType==e.mimeType&&n.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)}function nv(e,t,n){return av(e.width*e.height,t.width*t.height,n.width*n.height)==gv}function iv(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1,baseOriginalId:null}}function rv(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Mu([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null}}function av(e,t,n){if(t==e&&e!=n)return vv;if(n==e&&e!=t)return gv;if(t>e){if(n<=e||n-e<t-e)return gv;if(n-e>t-e)return vv}else{if(n>e)return vv;if(e-n<e-t)return gv;if(e-n>e-t)return vv}return mv}function ov(e,t,n){var i=e.mimeType===t.mimeType&&e.codecs===t.codecs,r=e.mimeType===n.mimeType&&e.codecs===n.codecs;return i&&!r?vv:!i&&r?gv:(t=Xm(e,t),e=Xm(e,n),t&&!e?vv:!t&&e?gv:mv)}function sv(e,t,n){return t=Math.abs(e-t),(e=Math.abs(e-n))<t?gv:t<e?vv:mv}function uv(e){switch(e.type){case ut:return!e.language;case"image":return!e.tilesLayout;default:return!1}}function lv(e){return fv([e.fastSwitching,e.width,e.frameRate,e.codecs,e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])}function cv(e){return fv([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,e.codecs,e.mimeType,e.roles,e.audioSamplingRate,e.primary,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])}function dv(e){return fv([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])}function hv(e){return fv([e.width,e.codecs,e.mimeType])}function fv(e){return JSON.stringify(e)}function pv(e){if(!yv.has(e)){var t=oi(e);yv.set(e,t)}return yv.get(e)}h(Em,Mu),(i=Em.prototype).getNumReferences=function(){return this.h?this.h.timeline.length:0},i.release=function(){Mu.prototype.release.call(this),this.h=null},i.Ya=function(e){if(this.h){for(var t=0,n=this.h.timeline,i=0;i<n.length&&n[i].end+this.j<=e;i+=1)t+=1;t>0&&(this.h.timeline=n.slice(t),this.g.length>=t&&(this.g=this.g.slice(t)),this.i+=t,0===this.getNumReferences()&&this.release())}},i.find=function(e){if(this.h&&this.h.timeline&&this.h.timeline.length&&e<this.h.timeline[0].start+this.j)return this.i;if(!this.h)return null;var t=this.h.timeline;if(e<this.j||e>=this.l)return null;for(var n=t.length-1,i=0;i<t.length;i++){var r=t[i],a=r.start+this.j;if(r=i<n?t[i+1].start+this.j:this.l===1/0?r.end+this.j:this.l,e>=a&&e<r)return i+this.i}return null},i.get=function(e){var t=this;if((e-=this.i)<0||e>=this.getNumReferences()||!this.h)return null;var n=this.g[e];if(!n){var i=(n=this.h.timeline[e]).Sk,r=n.Eh+this.h.gd,a=this.j-this.h.Ib,o=this.j+n.end,s=o;e===this.getNumReferences()-1&&this.l!==1/0&&(s=this.F&&Math.abs(s-this.l)>.1?Math.min(s,this.l):this.l);var u=this.h.codecs,l=this.h.mimeType,c=this.h.bandwidth,d=[],h=!1;if(n.vc&&this.h&&this.h.$b&&(h=this.h.$b.includes("$SubNumber$")),h){h=(n.end-n.start)/n.vc;for(var f={},p=0;p<n.vc;f={Pf:void 0,Xi:void 0},p++){var g=n.start+h*p,m=g+h;f.Xi=p,f.Pf=null,(f=new Fo(this.j+g,this.j+m,function(e){return function(){return t.h?(null==e.Pf&&(e.Pf=Mm(t.h.$b,t.H,i,t.C,r,e.Xi,t.G,t.J)),e.Pf):[]}}(f),0,null,this.u,a,this.j,this.l,[],"",null,null,Vo,this.B)).codecs=u,f.mimeType=l,f.bandwidth=c,0==this.I?p>0&&f.wd():p%this.I!=0&&f.wd(),d.push(f)}}(n=new Fo(this.j+n.start,s,(function(){return d.length>0||!t.h?[]:Mm(t.h.$b,t.H,i,t.C,r,null,t.G,t.J)}),0,null,this.u,a,this.j,this.l,d,"",null,null,Vo,this.B,d.length>0)).codecs=u,n.mimeType=l,n.j=o,n.bandwidth=c,this.g[e]=n}return n},i.Fb=function(e){Cm(this);for(var t=0;t<this.getNumReferences();t++){var n=this.get(t+this.i);n&&e(n)}},i.Te=function(){return this.K},Pm.prototype.configure=function(e){this.o=e},Pm.prototype.destroy=function(){return this.B=this.o=null,this.i=[],this.h=null,this.m=[],this.G=[],this.l.clear(),null!=this.g&&(this.g.stop(),this.g=null),this.H.destroy()},Pm.prototype.setManifestType=function(e){this.u=e},Pm.prototype.banLocation=function(e){this.j.set(e,Date.now()+6e4)},(i=Om.prototype).release=function(){for(var e=p(this.h.concat(this.g,this.j,this.i)),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();this.h=[],this.g=[],this.j=[],this.i=[],this.l=[],this.o=!1,this.m.clear()},i.bk=function(){return this.l},i.Ig=function(){return this.j.slice()},i.Gj=function(){return this.i},i.Th=function(e,t){if(e){if("audio"==e.type)for(var n=p(this.h),i=n.next();!i.done;i=n.next())(i=i.value).matchedStreams=i.matchedStreams.filter((function(t){return t!==e}));else if("video"==e.type)for(i=(n=p(this.g)).next();!i.done;i=n.next())(i=i.value).matchedStreams=i.matchedStreams.filter((function(t){return t!==e})),i.trickModeVideo&&(i.trickModeVideo.matchedStreams=i.trickModeVideo.matchedStreams.filter((function(t){return t!==e}))),i.dependencyStream&&(i.dependencyStream.matchedStreams=i.dependencyStream.matchedStreams.filter((function(t){return t!==e})));else if(e.type==ut)for(i=(n=p(this.j)).next();!i.done;i=n.next())(i=i.value).matchedStreams=i.matchedStreams.filter((function(t){return t!==e}));else if("image"==e.type)for(i=(n=p(this.i)).next();!i.done;i=n.next())(i=i.value).matchedStreams=i.matchedStreams.filter((function(t){return t!==e}));e.segmentIndex&&e.closeSegmentIndex(),this.m.delete(t)}},i.hg=function(e,t,n){n=void 0!==n&&n;var i,r,a,o,s,u,l,c,d,h,f,g,m,v,y,b,S,T,x,k,A,E,I,C,M,P,D,L,N,O,j,U,F=this;return R((function(R){if(1==R.g){if(i=lt,!t&&1==e.length)return r=jm(e,!1),a=r.Mh,o=r.fj,s=r.bj,u=r.ji,F.h=Array.from(a[0].values()),F.g=Array.from(o[0].values()),F.j=Array.from(s[0].values()),F.i=Array.from(u[0].values()),R.A(2);for(l=n?F.m.size:0,c=-1,d=0;d<e.length;d++)h=e[d],F.m.has(h.id)||(F.m.add(h.id),-1==c&&(c=d));return-1==c?R.return():(f=jm(e,!0),g=f.Mh,m=f.fj,v=f.bj,y=f.ji,w(R,Promise.all([Fm(F,F.h,g,c,qm,zm,l),Fm(F,F.g,m,c,qm,zm,l),Fm(F,F.j,v,c,qm,zm,l),Fm(F,F.i,y,c,qm,zm,l)]),2))}if(b=0,S=[],F.g.length&&F.h.length)for(C=p(F.h),M=C.next();!M.done;M=C.next())for(P=M.value,D=p(F.g),L=D.next();!L.done;L=D.next())N=L.value,O=yr(P.drmInfos,N.drmInfos),P.drmInfos.length&&N.drmInfos.length&&!O.length||(j=(P.bandwidth||0)+(N.bandwidth||0),P.dependencyStream&&(j+=P.dependencyStream.bandwidth||0),N.dependencyStream&&(j+=N.dependencyStream.bandwidth||0),U=b++,S.push({id:U,language:P.language,disabledUntilTime:0,primary:P.primary,audio:P,video:N,bandwidth:j,drmInfos:O,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(T=F.g.length?F.g:F.h,x=p(T),k=x.next();!k.done;k=x.next())A=k.value,E=b++,I=A.bandwidth||0,A.dependencyStream&&(I+=A.dependencyStream.bandwidth||0),S.push({id:E,language:A.language,disabledUntilTime:0,primary:A.primary,audio:A.type==i.ka?A:null,video:A.type==i.Aa?A:null,bandwidth:I,drmInfos:A.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});F.l=S,_(R)}))},i.Ri=function(e){this.o=e},B("shaka.util.PeriodCombiner",Om),Om.prototype.setUseStreamOnce=Om.prototype.Ri,Om.prototype.combinePeriods=Om.prototype.hg,Om.prototype.deleteStream=Om.prototype.Th,Om.prototype.getImageStreams=Om.prototype.Gj,Om.prototype.getTextStreams=Om.prototype.Ig,Om.prototype.getVariants=Om.prototype.bk;var gv=1,mv=0,vv=-1,yv=new Map;function bv(e,t){try{return function(e,t){var n=new DOMParser,i=wv.value()(e);e=null;try{e=n.parseFromString(i,"text/xml")}catch(e){return null}if(!(n=e.documentElement)||n.getElementsByTagName("parsererror").length||n.tagName!=t)return null;if(!("createNodeIterator"in document))return n;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return n}(qe(e),t)}catch(e){return null}}var wv=new re((function(){if("undefined"!=typeof trustedTypes){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(e){return e}});return function(t){return e.createHTML(t)}}return function(e){return e}}));function _v(){var e=this;this.j=this.g=null,this.B=[],this.h=null,this.Fa=1,this.H=[],this.l={qf:"",type:"",profiles:[],sc:null,rb:0,cb:null,le:0},this.u=new Map,this.C=new Map,this.o=new Map,this.F=new Map,this.ya=new Map,this.m=new Om,this.K=0,this.Da=new H(5),this.M=new Si((function(){e.J&&!e.g.continueLoadingWhenPaused&&(e.I.Ma(e.J,"timeupdate"),e.J.paused)?e.I.Ba(e.J,"timeupdate",(function(){return Ov(e)})):Ov(e)})),this.R=new jr,this.O=null,this.G=[],this.aa=1/0,this.va=!1,this.i=null,this.N=0,this.T=!1,this.I=new te,this.J=null,this.V=!1,this.$="",this.oa=function(){return!1},this.X=[],this.ma=new Set,this.xa=new Jg}function Sv(e){var t,n,i,r,a,o,s,u,l,c,d;return R((function(h){return 1==h.g?(t=4,n="MPD",i=function(e){var t=e.l.le;if(!e.l.qf||!t||!e.H.length)return[];var n=Date.now()/1e3,i=e.H.filter((function(e){return!(e=ln(e.attributes.ttl))||t+e>n})).map(Xt).filter(ki);return i.length?nt(e.B,i):[]}(e),r=e.B,i.length?(r=i,n="Patch",t=6):e.B.length>1&&e.i&&((a=Nm(e.i,"Location",!0)).length&&(r=a)),o=Vr(r,e.g.retryParameters),s=Date.now(),w(h,qv(e,o,0,{type:t}),2)):3!=h.g?(u=h.h,e.j?(u.uri&&u.uri!=u.originalUri&&!e.B.includes(u.uri)&&e.B.unshift(u.uri),l=new ge(u.uri),e.$=l.g.toString(),w(h,function(e,t,n,i){var r,a,o,s,u,l,c,d;return R((function(h){if(1==h.g){if(r=t,(a=e.g.dash.manifestPreprocessor)!=tc){if(ce("manifest.dash.manifestPreprocessor configuration","Please Use manifest.dash.manifestPreprocessorTXml instead."),!(o=bv(r,i)))throw new Ue(2,4,4001,n);a(o),r=Ge(o.outerHTML)}if(!(s=Vt(r,i)))throw new Ue(2,4,4001,n);return(u=e.g.dash.manifestPreprocessorTXml)!=nc&&u(s),"Patch"===i?h.return(function(e,t){var n,i,r,a,o,s,u,l,c,d,h,f,m,v,y,b,S,T,x,k,A,E,I,C;return R((function(M){if(1==M.g){if(n=t.attributes.mpdId,i=Zt(t,"originalPublishTime",rn),!n||n!==e.l.qf||i!==e.l.le)throw e.H=[],new Ue(1,4,4052);for(r=[],a=[],o=new Set,s=p($t(t)),u=s.next();!u.done;u=s.next())if(l=u.value,c=fn(l.attributes.sel||""),d=c[c.length-1],h=Xt(l)||"","MPD"===d.name)if("mediaPresentationDuration"===d.Cc){var P=an(Xt(l)||"");if(null!=P){e.l.sc=P;for(var R=p(e.u.values()),D=R.next();!D.done;D=R.next())D.value.sc=P}}else if("type"===d.Cc){for(e.h.presentationTimeline.cd("static"==h),e.l.type=h,R=(P=p(e.u.values())).next();!R.done;R=P.next())R.value.Eb="dynamic"==h;"static"==h&&(e.K=-1)}else"publishTime"===d.Cc?e.l.le=rn(h)||0:null===d.Cc&&"add"===l.tagName&&a.push(l);else if("PatchLocation"===d.name)pn(e.H,l);else if("Period"===d.name)"add"===l.tagName?a.push(l):"remove"===l.tagName&&d.id&&Av(e,d.id);else if("SegmentTemplate"===d.name){if((P=(R=fn(l.attributes.sel||""))[R.length-1]).Cc){R=Ev(e,R),D=Xt(l)||"";for(var L=p(R),N=L.next();!N.done;N=L.next())mn((N=e.u.get(N.value)).L.Nc,l.tagName,P.Cc,D);P=R}else P=[];for(f=p(P),m=f.next();!m.done;m=f.next())v=m.value,o.add(v)}else if("SegmentTimeline"===d.name||"S"===d.name){for(P=fn(l.attributes.sel||""),D=(R=p(P=Ev(e,P))).next();!D.done;D=R.next())pn(L=Kt(D=om(D=e.u.get(D.value),Am,"SegmentTimeline"),"S"),l),D.children=L;for(y=p(P),b=y.next();!b.done;b=y.next())S=b.value,o.add(S)}for(T=p(o),x=T.next();!x.done;x=T.next())k=x.value,Iv(e,k);for(A=p(a),E=A.next();!E.done;E=A.next())I=E.value,r.push.apply(r,g(kv(e,I)));return r.length?(e.h.periodCount+=r.length,e.h.gapCount=e.N,w(M,xv(e,r,!0),2)):M.A(2)}"static"==e.l.type&&(C=e.l.sc,e.h.presentationTimeline.Ab(C||1/0)),_(M)}))}(e,s)):e.g.dash.disableXlinkProcessing?h.return(Tv(e,s,n)):(l=e.g.dash.xlinkFailGracefully,c=sm(s,e.g.retryParameters,l,n,e.j.networkingEngine),Ur(e.R,c),w(h,c.promise,2))}return d=h.h,h.return(Tv(e,d,n))}))}(e,u.data,u.uri,n),3)):h.return(0)):(c=Date.now(),d=(c-s)/1e3,e.Da.sample(1,d),e.ma.clear(),h.return(d))}))}function Tv(e,t,n){var i,r,a,o,s,u,l,c,d,h,f,m,v,y,b,T,A,E,I,C,M,P,D,L,N,O,j,U,F,B,H,V,q,G,z,K,W,X,Y,J,Q,Z,ee,te,ne,ie,re,ae,oe,se,ue,le,ce,de;return R((function(he){switch(he.g){case 1:for(e.i&&e.i.l.clear(),i=[n],r=[],a=new Map,o=Kt(t,"Location"),s=p(o),u=s.next();!u.done;u=s.next())l=u.value,c=l.attributes.serviceLocation,(d=Xt(l))&&(h=nt(i,[d])[0],c&&(e.i?Lm(e.i,"Location",c,h):a.set(c,h)),r.push(h));if(e.i?(f=Nm(e.i,"Location",!0)).length>0&&(i=e.B=f):r.length&&(i=e.B=r),e.l.qf=t.attributes.id||"",e.l.le=Zt(t,"publishTime",rn)||0,e.H=Kt(t,"PatchLocation"),m=Promise.resolve(),(v=Jt(t,"ContentSteering"))&&e.j)for(y=v.attributes.defaultServiceLocation,e.i?(e.i.i=i,e.i.h=y):(e.i=new Pm(e.j),e.i.configure(e.g),e.i.setManifestType("DASH"),e.i.i=i,e.i.h=y,(b=Xt(v))&&(Zt(v,"queryBeforeStart",dn,!1)?m=Rm(e.i,b):Rm(e.i,b))),T=p(a.keys()),A=T.next();!A.done;A=T.next())E=A.value,I=a.get(E),Lm(e.i,"Location",E,I);if(C=Kt(t,"BaseURL"),M=!1,e.i)for(P=p(C),D=P.next();!D.done;D=P.next())L=D.value,N=L.attributes.serviceLocation,O=Xt(L),N&&O&&(Lm(e.i,"BaseURL",N,O),M=!0);if(e.X.splice(0),M&&e.i||(j=C.map(Xt),e.X.push.apply(e.X,g(nt(i,j)))),U=e.i,F=e.X,B=function(){return U&&M?Nm(U,"BaseURL"):F.slice()},e.l.cb=B,H=0,C&&C.length&&(H=Zt(C[0],"availabilityTimeOffset",cn)||0),e.l.rb=H,e.K=Zt(t,"minimumUpdatePeriod",an,-1),V=Zt(t,"availabilityStartTime",rn),q=Zt(t,"timeShiftBufferDepth",an),G=e.g.dash.ignoreSuggestedPresentationDelay,z=null,G||(z=Zt(t,"suggestedPresentationDelay",an)),K=e.g.dash.ignoreMaxSegmentDuration,W=null,K||(W=Zt(t,"maxSegmentDuration",an)),X=t.attributes.type||"static",e.h&&e.h.presentationTimeline&&(e.V=e.h.presentationTimeline.W()&&"static"==X),e.l.type=X,e.h)for(Y=e.h.presentationTimeline,J=Y.Hb(),Q=p(e.o.values()),Z=Q.next();!Z.done;Z=Q.next())(ee=Z.value).segmentIndex&&ee.segmentIndex.Ya(J);else te=e.g.dash.ignoreMinBufferTime,ne=0,te||(ne=Zt(t,"minBufferTime",an)||0),0,ie=null!=z?Math.min(z,q||1/0):e.g.defaultPresentationDelay>0?e.g.defaultPresentationDelay:Math.min(1.5*ne,q||1/0),Y=new su(V,ie,e.g.dash.autoCorrectDrift);return Y.cd("static"==X),Y.W()&&!isNaN(e.g.availabilityWindowOverride)&&(q=e.g.availabilityWindowOverride),null==q&&(q=1/0),Y.Hf(q),re=t.attributes.profiles||"",e.l.profiles=re.split(","),ae={Eb:"static"!=X,presentationTimeline:Y,sa:null,na:null,qa:null,L:null,bandwidth:0,Kg:!1,rb:H,sc:null,profiles:re.split(","),roles:null,Lb:function(){return""}},w(he,m,2);case 2:return e.N=0,oe=Pv(e,ae,B,t,!1),se=oe.duration,ue=oe.periods,("static"!=X||e.V)&&oe.Vh||Y.Ab(se||1/0),e.T&&e.va&&Y.Oi(e.aa),Y.Sg(W||1),e.T&&e.va&&(le=null!=z?z:e.g.defaultPresentationDelay,Y.nh(le)),e.h?(e.h.periodCount=ue.length,e.h.gapCount=e.N,w(he,xv(e,ue,!1),4)):w(he,e.m.hg(ue,ae.Eb),6);case 6:if(e.h={presentationTimeline:Y,variants:e.m.l,textStreams:e.m.Ig(),imageStreams:e.m.i,offlineSessionIds:[],sequenceMode:e.g.dash.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"DASH",serviceDescription:Cv(t),nextUrl:Mv(t),periodCount:ue.length,gapCount:e.N,isLowLatency:e.T,startTime:null},!Y.ej()){he.A(7);break}return ce=Kt(t,"UTCTiming"),w(he,function(e,t,n){var i,r,a,o,s,u,l,c;return R((function(d){switch(d.g){case 1:i=n.map((function(e){return{scheme:e.attributes.schemeIdUri,value:e.attributes.value}})),r=e.g.dash.clockSyncUri,!i.length&&r&&i.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:r}),a=p(i),o=a.next();case 2:if(o.done){d.A(4);break}switch(s=o.value,S(d,5),u=s.scheme,l=s.value,u){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return d.A(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return d.A(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return c=Date.parse(l),d.return(isNaN(c)?0:c-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":$("NTP UTCTiming scheme is not supported");break;default:$("Unrecognized scheme in UTCTiming element",u)}d.A(9);break;case 7:return w(d,Fv(e,t,l,"HEAD"),10);case 10:return d.return(d.h);case 8:return w(d,Fv(e,t,l,"GET"),11);case 11:return d.return(d.h);case 9:x(d,3);break;case 5:k(d);case 3:o=a.next(),d.A(2);break;case 4:return $("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),d.return(0)}}))}(e,B,ce),8);case 8:if(de=he.h,!e.j)return he.return();Y.Pi(de);case 7:Y.lf(),e.m&&!e.h.presentationTimeline.W()&&e.m.release();case 4:e.j.makeTextStreamsForClosedCaptions(e.h),function(e){for(var t=Array.from(e.F.keys()).filter((function(t){return!e.G.includes(t)})),n=(t=p(t)).next();!n.done;n=t.next()){n=n.value;for(var i=!0,r=p(e.F.get(n)),a=r.next();!a.done;a=r.next()){a=a.value;var o=e.o.get(a);o&&(o.segmentIndex&&0!=o.segmentIndex.getNumReferences()?i=!1:(e.m&&e.m.Th(o,n),e.o.delete(a)))}i&&e.F.delete(n)}}(e),function(e,t){t=new Set(t.map((function(e){return e.id})));for(var n=p(e.C.keys()),i=n.next();!i.done;i=n.next())i=i.value,t.has(i)||e.C.delete(i)}(e,ue),_(he)}}))}function xv(e,t,n){var i;return R((function(r){if(1==r.g)return w(r,e.m.hg(t,!0,n),2);e.h.variants=e.m.l,(i=e.m.Ig()).length>0&&(e.h.textStreams=i),e.h.imageStreams=e.m.i,e.j.filter(e.h),_(r)}))}function kv(e,t){return Pv(e,{Eb:"dynamic"==e.l.type,presentationTimeline:e.h.presentationTimeline,sa:null,na:null,qa:null,L:null,bandwidth:0,Kg:!1,rb:e.l.rb,profiles:e.l.profiles,sc:e.l.sc,roles:null,Lb:function(){return""}},e.l.cb,t,!0).periods}function Av(e,t){e.h.periodCount--;for(var n=p(e.u.keys()),i=n.next();!i.done;i=n.next())if((i=i.value).startsWith(t)){om(e.u.get(i),Am,"SegmentTimeline").children=[],Iv(e,i),e.u.delete(i)}e.G=e.G.filter((function(e){return e!==t}))}function Ev(e,t){for(var n="",i="",r=-1,a="",o=(t=p(t)).next();!o.done;o=t.next())"Period"===(o=o.value).name?n=o.id:"AdaptationSet"===o.name?(i=o.id,null!==o.position&&(r=o.position)):"Representation"===o.name&&(a=o.id);if(t=[],a)t.push(n+","+a);else if(i)for(r=p(e.u.values()),e=r.next();!e.done;e=r.next())(e=e.value).sa.id===n&&e.qa.id===i&&e.L.id&&t.push(n+","+e.L.id);else if(r>-1)for(i=p(e.u.values()),e=i.next();!e.done;e=i.next())(e=e.value).sa.id===n&&e.qa.position===r&&e.L.id&&t.push(n+","+e.L.id);return t}function Iv(e,t){var n=e.u.get(t),i=e.o.get(t);i.segmentIndex&&i.segmentIndex.Ya(e.h.presentationTimeline.Hb());try{var r=km(n,(function(t,n,i,r){return Hv(e,t,n,i,r)}),e.o,!0,e.g.dash.initialSegmentLimit,e.ya,n.L.aesKey,null,!0,e.C);i.createSegmentIndex=function(){return R((function(e){if(1==e.g)return i.segmentIndex?e.A(0):w(e,r.Sc(),3);i.segmentIndex=e.h,_(e)}))}}catch(e){if((t=n.L.contentType)!=ut&&"application"!=t&&"image"!=t||4002!=e.code)throw e}}function Cv(e){var t=Jt(e,"ServiceDescription");if(!t)return null;if(e=Jt(t,"Latency"),t=Jt(t,"PlaybackRate"),!e&&!t)return null;var n={};return e&&("target"in e.attributes&&(n.targetLatency=parseInt(e.attributes.target,10)/1e3),"max"in e.attributes&&(n.maxLatency=parseInt(e.attributes.max,10)/1e3),"min"in e.attributes&&(n.minLatency=parseInt(e.attributes.min,10)/1e3)),t&&("max"in t.attributes&&(n.maxPlaybackRate=parseFloat(t.attributes.max)),"min"in t.attributes&&(n.minPlaybackRate=parseFloat(t.attributes.min))),n}function Mv(e){if(!(e=Kt(e,"SupplementalProperty")).length)return null;for(var t=(e=p(e)).next();!t.done;t=e.next())if("urn:mpeg:dash:chaining:2016"==(t=t.value).attributes.schemeIdUri)return t.attributes.value;return null}function Pv(e,t,n,i,r){var a=t.sc;a||(a=Zt(i,"mediaPresentationDuration",an),e.l.sc=a);var o=0;e.h&&e.h.presentationTimeline&&e.V&&(o=e.h.presentationTimeline.Xb());var s=[],u=o;i=Kt(i,"Period");for(var l=0;l<i.length;l++){var c=i[l],d=i[l+1],h=Zt(c,"start",an,u),f=c.attributes.id,g=Zt(c,"duration",an);h=0==l&&0==h&&e.V?o:h;var m=null;if(d){var v=Zt(d,"start",an);null!=v&&(m=v-h+o)}else null!=a&&(m=a-h+o);if(v=ct,m&&g&&Math.abs(m-g)>v&&m>g&&e.N++,null==m&&(m=g),!(null!==e.O&&null!==f&&null!==h&&h<e.O)||e.G.includes(f)||l+1==i.length){if(null!==h&&(null===e.O||h>e.O)&&(e.O=h),u=Rv(e,t,n,{start:h,duration:m,node:c,ef:null==m||!d}),s.push(u),t.sa.id&&m&&e.ya.set(t.sa.id,m),null==m){u=null;break}u=h+m}}if(r)for(n=(t=p(s)).next();!n.done;n=t.next())n=n.value.id,e.G.includes(n)||e.G.push(n);else e.G=s.map((function(e){return e.id}));return null!=a?{periods:s,duration:a+o,Vh:!1}:{periods:s,duration:u,Vh:!0}}function Rv(e,t,n,i){t.sa=Uv(e,i.node,null,n),t.na=i,t.sa.rb=t.rb,t.sa.id||(t.sa.id="__shaka_period_"+i.start);var r=Kt(i.node,"EventStream");n=t.presentationTimeline.Hb();for(var a=(r=p(r)).next();!a.done;a=r.next())Bv(e,i.start,i.duration,a.value,n);for(r=(n=p(n=Kt(i.node,"SupplementalProperty"))).next();!r.done;r=n.next())"urn:mpeg:dash:urlparam:2014"==(r=r.value).attributes.schemeIdUri&&(r=Nv(e,r))&&(t.Lb=r);if(n=Kt(i.node,"AdaptationSet").map((function(n,i){return Lv(e,t,i,n)})).filter(ki),t.Eb){r=[];for(var o=(a=p(n)).next();!o.done;o=a.next())for(var s=(o=p(o.value.Ok)).next();!s.done;s=o.next())r.push(s.value);if(r.length!=new Set(r).size)throw new Ue(2,4,4018)}for(r=new Map,o=(a=p(n)).next();!o.done;o=a.next())for(s=(o=p(o.value.uj)).next();!s.done;s=o.next()){var u=p(s.value);s=u.next().value,u=u.next().value,r.set(s,u)}if(r.size)for(a=null,s=(o=p(n)).next();!s.done;s=o.next()){u=[];for(var l=p((s=s.value).streams),c=l.next(),d={};!c.done;d={uh:void 0},c=l.next())if(d.uh=c.value,r.has(d.uh.originalId)){a||(a=Kt(i.node,"AdaptationSet").map((function(n,i){return Lv(e,t,i,n)})).filter(ki));for(var h=(c=p(a)).next();!h.done;h=c.next())(h=h.value.streams.find(function(e){return function(t){return t.originalId==e.uh.originalId}}(d)))&&(h.dependencyStream=r.get(h.originalId),h.originalId+=h.dependencyStream.originalId,u.push(h))}u.length&&s.streams.push.apply(s.streams,g(u))}if(i=n.filter((function(e){return!e.Dh})),n=n.filter((function(e){return e.Dh})),!e.g.disableIFrames)for(r=(n=p(n)).next();!r.done;r=n.next())for(a=(r=r.value).Dh.split(" "),s=(o=p(i)).next();!s.done;s=o.next())if(s=s.value,a.includes(s.id))for(u=(s=p(s.streams)).next();!u.done;u=s.next())ar(u.value,r.streams);if(n=Dv(e.g.disableAudio,i,"audio"),r=Dv(e.g.disableVideo,i,"video"),a=Dv(e.g.disableText,i,ut),i=Dv(e.g.disableThumbnails,i,"image"),0===r.length&&0===n.length)throw new Ue(2,4,4004);return{id:t.sa.id,audioStreams:n,videoStreams:r,textStreams:a,imageStreams:i}}function Dv(e,t,n){return e||!t.length?[]:t.reduce((function(e,t){return t.contentType!=n||e.push.apply(e,g(t.streams)),e}),[])}function Lv(t,n,i,r){function a(e){var i=e.attributes["dvb:fontFamily"];e=e.attributes["dvb:url"],i&&e&&(e=nt(n.qa.cb(),[e],n.Lb()),t.j.addFont(i,e[0]))}function o(e){switch(e){case 1:case 5:case 6:case 7:return"srgb";case 9:return"rec2020";case 11:case 12:return"p3"}}function s(e){switch(e){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}n.qa=Uv(t,r,n.sa,null),n.qa.position=i;var u=!1,l=(i=Kt(r,"Role")).map((function(e){return e.attributes.value})).filter(ki),c=void 0,d=n.qa.contentType==ut;d&&(c="subtitle");for(var h=(i=p(i)).next();!h.done;h=i.next()){var f=(h=h.value).attributes.schemeIdUri;if(null==f||"urn:mpeg:dash:role:2011"==f)switch(h=h.attributes.value,h){case"main":u=!0;break;case"caption":case"subtitle":c=h}}var m=Kt(r,"EssentialProperty");i=null;var v=!1;h=null,f=!1;for(var y=(m=p(m)).next();!y.done;y=m.next()){var b=(y=y.value).attributes.schemeIdUri;if("http://dashif.org/guidelines/trickmode"==b)i=y.attributes.value;else if("urn:mpeg:mpegB:cicp:TransferCharacteristics"==b)var S=s(parseInt(y.attributes.value,10));else if("urn:mpeg:mpegB:cicp:ColourPrimaries"==b)var T=o(parseInt(y.attributes.value,10));else"urn:mpeg:mpegB:cicp:MatrixCoefficients"!=b&&("urn:mpeg:dash:ssr:2023"==b&&t.g.dash.enableFastSwitching?v=!0:"urn:dvb:dash:fontdownload:2014"==b?a(y):"urn:mpeg:dash:urlparam:2014"==b&&(h=Nv(t,y))||(f=!0))}if(f)return null;var x=null;for(m=(f=p(f=Kt(r,"SupplementalProperty"))).next();!m.done;m=f.next())"http://dashif.org/guidelines/last-segment-number"==(y=(m=m.value).attributes.schemeIdUri)?x=parseInt(m.attributes.value,10)-1:"urn:mpeg:mpegB:cicp:TransferCharacteristics"==y?S=s(parseInt(m.attributes.value,10)):"urn:mpeg:mpegB:cicp:ColourPrimaries"==y?T=o(parseInt(m.attributes.value,10)):"urn:dvb:dash:fontdownload:2014"==y?a(m):"urn:mpeg:dash:urlparam:2014"==y&&(h=Nv(t,m));h&&(n.Lb=h),h=Kt(r,"Accessibility");var k,A=new Map;for(f=(h=p(h)).next();!f.done;f=h.next())if(f=(m=f.value).attributes.schemeIdUri,m=m.attributes.value,"urn:scte:dash:cc:cea-608:2015"!=f||t.g.disableText)if("urn:scte:dash:cc:cea-708:2015"!=f||t.g.disableText)"urn:mpeg:dash:role:2011"==f?null!=m&&(l.push(m),"captions"==m&&(c="caption")):"urn:tva:metadata:cs:AudioPurposeCS:2007"==f&&("1"==m?k="visually impaired":"2"==m?k="hard of hearing":"9"==m&&(k="spoken subtitles"));else if(f=1,null!=m)for(y=(m=p(m.split(";"))).next();!y.done;y=m.next()){b=y.value;var E=y=void 0;b.includes("=")?(y="svc"+(b=b.split("="))[0],E=b[1].split(",")[0].split(":").pop()):(y="svc"+f,f++,E=b),A.set(y,Pi(E))}else A.set("svc1","und");else if(f=1,null!=m)for(b=(y=p(m=m.split(";"))).next();!b.done;b=y.next()){E=b.value;var I=b=void 0;E.includes("=")?(b=(E=E.split("="))[0].startsWith("CC")?E[0]:"CC"+E[0],I=E[1]||"und"):(b="CC"+f,2==m.length?f+=2:f++,I=E),A.set(b,Pi(I))}else A.set("CC1","und");h=Kt(r,"ContentProtection");var C=Qg(t.xa,h,t.g.ignoreDrmInfo,t.g.dash.keySystemsByURI);n.qa.encrypted=h.length>0;var M=Pi(n.qa.language||"und"),P=n.qa.label,D=new Map;if(r=Kt(r,"Representation"),!t.g.ignoreSupplementalCodecs){for(h=[],m=(f=p(r)).next();!m.done;m=f.next())(m=en(y=m.value,"urn:scte:dash:scte214-extensions","supplementalCodecs"))&&((y=Ft(y)).attributes.codecs=m.split(" ").join(","),y.attributes.id&&(y.attributes.supplementalId=y.attributes.id+"_supplementalCodecs"),h.push(y));r.push.apply(r,g(h))}if(h=r.map((function(i){var r=function(t,n,i,r,a,o,s,u,l,c,d,h){n.L=Uv(t,c,n.qa,null);var f=n.L.id;if(t.aa=Math.min(t.aa,n.L.rb),t.T=t.aa>0,!function(e){var t=e.Hd?1:0;return t+=e.zc?1:0,t+=e.Nc?1:0,0==t?e.contentType==ut||"application"==e.contentType:(1!=t&&(e.Hd&&(e.zc=null),e.Nc=null),!0)}(n.L))return null;var p=n.na.start;n.bandwidth=Zt(c,"bandwidth",un)||0,n.roles=u;var g=Kt(c,"SupplementalProperty"),m=Kt(c,"EssentialProperty"),v=Kt(c,"ContentProtection");c=null;var y,b,S=m.find((function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri}));(S||(S=g.find((function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri}))))&&(c=Nv(t,S)),c&&(n.Lb=c),S=n.L.contentType,c=S==ut||"application"==S,S="image"==S,v.length&&(n.qa.encrypted=!0);try{var T=void 0;if(i.dg){var x=n.L.cb,k=n.Lb,A=Vr(nt(x(),[i.dg.rk],k()),t.g.retryParameters);T={bitsKey:128,blockCipherMode:"CBC",iv:i.dg.iv,firstMediaSequenceNumber:0,fetchKey:function(){var n,i,r;return R((function(a){if(1==a.g)return w(a,qv(t,A,6),2);if(3!=a.g){if(!(n=a.h).data||16!=n.data.byteLength)throw new Ue(2,4,4049);return i={name:"AES-CBC"},r=T,w(a,e.crypto.subtle.importKey("raw",n.data,i,!0,["decrypt"]),3)}r.cryptoKey=a.h,T.fetchKey=void 0,_(a)}))}}}if(n.L.aesKey=T,x=function(e,n,i,r){return Hv(t,e,n,i,r)},n.L.Hd)var E=vm(n,x,T);else if(n.L.zc)E=Tm(n,t.o,T);else if(n.L.Nc)E=km(n,x,t.o,!!t.h,t.g.dash.initialSegmentLimit,t.ya,T,h,!1,t.C);else{var I=n.na.duration||0,C=n.L.cb,M=n.L.mimeType,P=n.L.codecs;E={endTime:-1,timeline:-1,Sc:function(){var e=Ru(p,I,C());return e.Fb((function(e){e.mimeType=M,e.codecs=P})),Promise.resolve(e)},timescale:1}}}catch(e){if((c||S)&&4002==e.code)return null;throw e}if(h=function(e,t,n,i,r){var a=Qg(e,t,i,r);if(n.Xh)e=1==n.drmInfos.length&&!n.drmInfos[0].keySystem,t=0==a.drmInfos.length,(0==n.drmInfos.length||e&&!t)&&(n.drmInfos=a.drmInfos),n.Xh=!1;else if(a.drmInfos.length>0&&(n.drmInfos=n.drmInfos.filter((function(e){return a.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==n.drmInfos.length))throw new Ue(2,4,4008);return a.Sh||n.Sh}(t.xa,v,i,t.g.ignoreDrmInfo,t.g.dash.keySystemsByURI),h=new Set(h?[h]:[]),v=!1,g.some((function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.attributes.schemeIdUri&&"JOC"==e.attributes.value}))&&(v=!0),g=!1,c&&(g=u.includes("forced_subtitle")||u.includes("forced-subtitle")),S&&((m=m.find((function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.attributes.schemeIdUri)})))&&(y=m.attributes.value),!y))return null;c=n.L.codecs,n.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(c.includes("hvc1.2.4.L153.B0")||c.includes("hev1.2.4.L153.B0"))&&(b="PQ"),m=n.L.id?n.sa.id+","+n.L.id:"",t.H.length&&f&&t.u.set(n.sa.id+","+f,function(e){function t(e){return e?((e=Bt(e)).Hd=null,e.zc=null,e.Nc=yn(e.Nc),e.zf=null,e):null}return e=Bt(e),e.sa=t(e.sa),e.qa=t(e.qa),e.L=t(e.L),e.na&&(e.na=Bt(e.na),e.na.node=null),e}(n)),n.L.zf&&function(e,t,n,i){if(!e.ma.has(t)){e.ma.add(t);var r,a=Zt(t,"presentationTime",ln)||0,o=Jt(t,"UTCTiming");(r=o&&o.attributes.schemeIdUri)&&(r=!("urn:mpeg:dash:utc:http-ntp:2014"===(o=o.attributes.schemeIdUri)||"urn:mpeg:dash:utc:ntp:2014"===o||"urn:mpeg:dash:utc:sntp:2014"===o)),r?t=1e3*(Zt(t,"wallClockTime",rn)||0):t=cs(t=Zt(t,"wallClockTime",ln)||0),a=(n=new Date(t-a/n.timescale*1e3)).getTime()/1e3,isNaN(a)||(i.o||i.oh(a),i=new Dr("prft",i=(new Map).set("detail",{wallClockTime:t,programStartDate:n})),e.j.onEvent(i))}}(t,n.L.zf,E,n.presentationTimeline),-1!=E.endTime&&null!=n.sa.id&&null!=n.L.id&&((f=t.C.get(n.sa.id))?(f.endTime=E.endTime,f.bh.includes(n.L.id)||f.bh.push(n.L.id),t.C.set(n.sa.id,f)):t.C.set(n.sa.id,{endTime:E.endTime,timeline:E.timeline,bh:[n.L.id]}));var D=m&&t.o.has(m)?t.o.get(m):{id:t.Fa++,originalId:n.L.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){D.segmentIndex&&(D.segmentIndex.release(),D.segmentIndex=null)},segmentIndex:null,mimeType:n.L.mimeType,codecs:c,frameRate:n.L.frameRate,pixelAspectRatio:n.L.pixelAspectRatio,bandwidth:n.bandwidth,width:n.L.width,height:n.L.height,kind:r,encrypted:i.drmInfos.length>0,drmInfos:i.drmInfos,keyIds:h,language:a,originalLanguage:n.qa.language,label:o,type:n.qa.contentType,primary:s,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:n.L.emsgSchemeIdUris,roles:u,forced:g,channelsCount:n.L.uf,audioSamplingRate:n.L.audioSamplingRate,spatialAudio:v,closedCaptions:l,hdr:b,colorGamut:void 0,videoLayout:void 0,tilesLayout:y,accessibilityPurpose:d,external:!1,fastSwitching:!1,fullMimeTypes:new Set([ni(n.L.mimeType,n.L.codecs)]),isAudioMuxedInVideo:!1,baseOriginalId:null};return D.createSegmentIndex=function(){var e;return R((function(t){if(1==t.g)return D.segmentIndex?t.A(0):(e=D,w(t,E.Sc(),3));e.segmentIndex=t.h,_(t)}))},m&&n.Eb&&!t.o.has(m)&&(n=n.sa.id||"",t.F.has(n)||t.F.set(n,[]),t.o.set(m,D),t.F.get(n).push(m)),D}(t,n,C,c,M,P,u,l,A,i,k,x);return r&&(r.hdr=r.hdr||S,r.colorGamut=r.colorGamut||T,r.fastSwitching=v,i=i.attributes.dependencyId)?(r.baseOriginalId=i,D.set(i,r),null):r})).filter((function(e){return!!e})),0==h.length&&0==D.size){if(i="image"==n.qa.contentType,t.g.dash.ignoreEmptyAdaptationSet||d||i)return null;throw new Ue(2,4,4003)}if(!n.qa.contentType||"application"==n.qa.contentType)for(n.qa.contentType=Vv(h[0].mimeType,h[0].codecs),f=(d=p(h)).next();!f.done;f=d.next())f.value.type=n.qa.contentType;for(d=n.qa.id||"__fake__"+t.Fa++,m=(f=p(h)).next();!m.done;m=f.next()){for(m=m.value,b=(y=p(C.drmInfos)).next();!b.done;b=y.next())(b=b.value).keyIds=b.keyIds&&m.keyIds?new Set([].concat(g(b.keyIds),g(m.keyIds))):b.keyIds||m.keyIds;t.g.enableAudioGroups&&(m.groupId=d)}return r=r.map((function(e){return e.attributes.supplementalId||e.attributes.id})).filter(ki),{id:d,contentType:n.qa.contentType,language:M,Dm:u,streams:h,drmInfos:C.drmInfos,Dh:i,Ok:r,uj:D}}function Nv(e,t){if((t=Qt(t,"urn:mpeg:dash:schema:urlparam:2014","UrlQueryInfo"))&&Zt(t,"useMPDUrlQuery",dn,!1)){var n=t.attributes.queryTemplate;if(n)return function(){return"$querypart$"==n?e.$:n.split("&").map((function(t){if("$querypart$"==t)return e.$;var n=/\$query:(.*?)\$/g.exec(t);if(n&&2==n.length){n=n[1];var i=new Ie(e.$).get(n);if(i.length)return n+"="+i[0]}return t})).join("&")}}return null}function Ov(e){var t,n;return R((function(i){switch(i.g){case 1:return t=0,S(i,2),w(i,Sv(e),4);case 4:t=i.h,x(i,3);break;case 2:if(n=k(i),e.j){if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.j.onError(n),i.return();n.severity=1,e.j.onError(n)}case 3:if(!e.j)return i.return();e.j.onManifestUpdated(),jv(e,t),_(i)}}))}function jv(e,t){if(!(e.K<0)){var n=e.K;e.g.updatePeriod>=0&&(n=e.g.updatePeriod),e.M.ia(Math.max(n-t,V(e.Da)))}}function Uv(e,t,n,i){n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,uf:null,audioSamplingRate:null,rb:0,Ef:1,encrypted:!1},i=i||n.cb;var r,a=t.attributes.id,o=t.attributes.supplementalId,s=Kt(t,"BaseURL"),u=!1;if(e.i)for(var l=p(s),c=l.next();!c.done;c=l.next()){var d=c.value;c=d.attributes.serviceLocation,d=Xt(d),c&&d&&(Lm(e.i,a,c,d),u=!0)}u&&e.i||(r=s.map(Xt));var h=e.i;e=t.attributes.contentType||n.contentType,l=t.attributes.mimeType||n.mimeType,c=il([t.attributes.codecs||n.codecs]).join(","),d=Zt(t,"frameRate",hn)||n.frameRate;var f=t.attributes.sar||n.pixelAspectRatio,g=function(e,t){t=t.slice();for(var n=(e=p(e)).next();!n.done;n=e.next())n=n.value.attributes.schemeIdUri,t.includes(n)||t.push(n);return t}(Kt(t,"InbandEventStream"),n.emsgSchemeIdUris),m=Kt(t,"AudioChannelConfiguration");m=function(e){for(var t=(e=p(e)).next();!t.done;t=e.next()){var n=(t=t.value).attributes.schemeIdUri;if(n&&(t=t.attributes.value))switch(n){case"urn:mpeg:dash:outputChannelPositionList:2012":return t.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(!(t=parseInt(t,10)))continue;return t;case"tag:dolby.com,2015:dash:audio_channel_configuration:2015":if(n=[2,1,2,2,2,2,1,2,2,1,1,1,1,2,1,1,2,2],!(t=parseInt(t,16)))continue;for(var i=0,r=0;r<n.length;r++)t&1<<r&&(i+=n[r]);if(i)return i;continue;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(n=[1,1,1,1,1,2,2,1,1,2,2,2,1,2,1,1].reverse(),!(t=parseInt(t,16)))continue;for(r=i=0;r<n.length;r++)t&1<<r&&(i+=n[r]);if(i)return i;continue;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(n=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(t=parseInt(t,10))&&t>0&&t<n.length)return n[t]}}return null}(m)||n.uf;var v=Zt(t,"audioSamplingRate",ln)||n.audioSamplingRate;e||(e=Vv(l,c));var y=Jt(t,"SegmentBase"),b=Jt(t,"SegmentTemplate"),w=y&&Zt(y,"availabilityTimeOffset",cn)||0,_=b&&Zt(b,"availabilityTimeOffset",cn)||0,S=s&&s.length&&Zt(s[0],"availabilityTimeOffset",cn)||0;w=n.rb+S+w+_,_=null,(S=Jt(t,"SegmentSequenceProperties"))&&(S=Zt(S,"cadence",un))&&(_=S),S=t.attributes.label;var T=Kt(t,"Label");return T&&T.length&&(Wt(T=T[0])&&(S=Wt(T))),{cb:function(){return nt(i(),s.length?h&&u?Nm(h,a):r||[]:[])},Hd:y||n.Hd,zc:Jt(t,"SegmentList")||n.zc,Nc:b||n.Nc,zf:Jt(t,"ProducerReferenceTime")||n.zf,width:Zt(t,"width",ln)||n.width,height:Zt(t,"height",ln)||n.height,contentType:e,mimeType:l,codecs:c,frameRate:d,pixelAspectRatio:f,emsgSchemeIdUris:g,id:o||a,originalId:a,language:t.attributes.lang,uf:m,audioSamplingRate:v,rb:w,cf:null,Ef:_||n.Ef,label:S||null,encrypted:!1}}function Fv(e,t,n,i){var r,a,o,s,u,l,c;return R((function(d){if(1==d.g)return r=[Ke(n)],a=nt(t(),r),(o=Vr(a,e.g.retryParameters)).method=i,s=e.j.networkingEngine.request(4,o,{isPreload:e.oa()}),Ur(e.R,s),w(d,s.promise,2);if(u=d.h,"HEAD"==i){if(!u.headers||!u.headers.date)return d.return(0);l=u.headers.date}else l=He(u.data);return c=Date.parse(l),isNaN(c)?d.return(0):d.return(c-Date.now())}))}function Bv(e,t,n,i,r){for(var a=i.attributes.schemeIdUri||"",o=i.attributes.value||"",s=Zt(i,"timescale",ln)||1,u=Zt(i,"presentationTimeOffset",ln)||0,l=(i=p(Kt(i,"Event"))).next();!l.done;l=i.next()){var c=Zt(l=l.value,"presentationTime",ln)||0,d=Zt(l,"duration",ln)||0;d=(c=Math.max((c-u)/s+t,t))+d/s,null!=n&&(c=Math.min(c,t+n),d=Math.min(d,t+n)),d<r||(l={schemeIdUri:a,value:o,startTime:c,endTime:d,id:l.attributes.id||"",timescale:s,eventElement:vn(l),eventNode:yn(l)},e.j.onTimelineRegionAdded(l))}}function Hv(e,t,n,i,r){var a,o,s,u;return R((function(l){return 1==l.g?(a=Kr,o=r?0:1,s=al(t,n,i,e.g.retryParameters),w(l,qv(e,s,a,{type:o}),2)):(u=l.h,l.return(u.data))}))}function Vv(e,t){return mi(t=ni(e,t))?ut:e.split("/")[0]}function qv(e,t,n,i){return i||(i={}),i.isPreload=e.oa(),t=e.j.networkingEngine.request(n,t,i),Ur(e.R,t),t.promise}function Gv(){}(i=_v.prototype).configure=function(e,t){var n=this.j&&e.updatePeriod!=this.g.updatePeriod&&e.updatePeriod>=0;this.g=e,t&&(this.oa=t),n&&this.h&&this.h.presentationTimeline.W()&&this.M.Jb(),this.i&&this.i.configure(this.g),this.m&&this.m.Ri(this.g.dash.useStreamOnceInPeriodFlattening)},i.start=function(e,t){var n,i=this;return R((function(r){if(1==r.g)return i.va=t.isLowLatencyMode(),i.B=[e],i.j=t,w(r,Sv(i),2);if(n=r.h,i.j&&jv(i,n),!i.j)throw new Ue(2,7,7001);return r.return(i.h)}))},i.stop=function(){for(var e=p(this.o.values()),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();return this.m&&this.m.release(),this.g=this.j=null,this.B=[],this.h=null,this.o.clear(),this.F.clear(),this.u.clear(),this.C.clear(),this.l={qf:"",type:"",profiles:[],sc:null,rb:0,cb:null,le:0},this.m=null,null!=this.M&&(this.M.stop(),this.M=null),this.i&&this.i.destroy(),this.I&&(this.I.release(),this.I=null),this.ma.clear(),this.xa.release(),this.R.destroy()},i.update=function(){var e,t=this;return R((function(n){return 1==n.g?(S(n,2),w(n,Sv(t),4)):2!=n.g?x(n,0):(e=k(n),t.j&&e?(t.j.onError(e),void _(n)):n.return())}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(e){if(this.h&&this.h.presentationTimeline.W()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.h.presentationTimeline.Hc();var n=t.segmentIndex.find(e);null!=n&&(t=t.segmentIndex.get(n))&&(this.K=t.endTime-e,jv(this,0))}}},i.banLocation=function(e){this.i&&this.i.banLocation(e)},i.setMediaElement=function(e){this.J=e},B("shaka.dash.DashParser",_v),Ja("application/dash+xml",(function(){return new _v})),Ja("video/vnd.mpeg.dash.mpd",(function(){return new _v})),B("shaka.dependencies",Gv),Gv.has=function(e){return Kv.has(e)},Gv.add=function(e,t){if(!$v[e])throw Error(e+" is not supported");e==zv?ce("mux.js","mux.js is no longer used in Shaka Player."):Kv.set(e,(function(){return t}))};var zv="muxjs",$v={Em:zv,ISOBoxer:"ISOBoxer"};Gv.Allowed=$v;var Kv=new Map([["ISOBoxer",function(){return e.ISOBoxer}]]);function Wv(){this.j=new re((function(){return["Oculus","Quest"].some((function(e){return navigator.userAgent.includes(e.toLowerCase())}))?"VR":navigator.userAgent.match(/Smart( ?|_)TV/i)||navigator.userAgent.match(/Android ?TV/i)?"TV":navigator.userAgentData?navigator.userAgentData.mobile?"MOBILE":"DESKTOP":/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)?"MOBILE":navigator.userAgentData&&navigator.userAgentData.platform?"android"==navigator.userAgentData.platform.toLowerCase()?"MOBILE":"DESKTOP":navigator.userAgent.includes("Android")?"MOBILE":"DESKTOP"})),this.l=new re((function(){return navigator.vendor.includes("Apple")&&(navigator.userAgent.includes("Version/")||navigator.userAgent.includes("OS/"))?"WEBKIT":navigator.userAgent.includes("Edge/")?"EDGE":navigator.userAgent.includes("Chrome/")?"CHROMIUM":navigator.userAgent.includes("Firefox/")?"GECKO":"UNKNOWN"}))}function Xv(){var t=e.ManagedMediaSource||e.MediaSource;return!(!t||!t.isTypeSupported)}function Yv(){Wv.call(this),this.g=new re((function(){var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null})),this.h=new re((function(){return/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||navigator.maxTouchPoints>1?"xr"in navigator?"APPLE_VR":"MOBILE":"xr"in navigator?"APPLE_VR":"DESKTOP"}))}function Jv(){if(!Qv())throw Error("Not a Chromecast device!");Wv.call(this),this.h=new re((function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/);return e?parseInt(e[1],10):null})),this.g=new re((function(){var e=navigator.userAgentData&&navigator.userAgentData.platform||navigator.userAgent;return(e=e.toLowerCase()).includes("android")?Zv:e.includes("fuchsia")?ey:ty}))}function Qv(){return navigator.userAgent.includes("CrKey")&&!navigator.userAgent.includes("VIZIO SmartCast")}(i=Wv.prototype).cc=function(){return!!navigator.mediaCapabilities},i.Ua=function(){return this.j.value()},i.Ha=function(){return this.l.value()},i.Ed=function(){return!1},i.Gi=function(){return!1},i.df=function(){return!1},i.Hi=function(){return!1},i.oe=function(){return!1},i.fd=function(){return!0},i.Pc=function(){return!0},i.re=function(){return!0},i.Mi=function(){return 0},i.jc=function(){return Promise.resolve({width:1/0,height:1/0})},i.Ui=function(){return!1},i.rh=function(){return!1},i.Wa=function(e){var t=this.Ua();return"TV"!==t&&"CONSOLE"!==t&&"CAST"!==t||(e.ads.customPlayheadTracker=!0,e.ads.skipPlayDetection=!0,e.ads.supportsMultipleMediaElements=!1),e},i.xh=function(){return!!e.indexedDB},i.Ei=function(){return[]},i.sd=function(t){return void 0!==e.matchMedia&&e.matchMedia("(color-gamut: p3)").matches?t?"HLG":"PQ":"SDR"},i.aj=function(){return!1},i.si=function(){return!1},i.gh=function(){return!1},i.Kf=function(){return!0},i.ti=function(){return!1},i.$i=function(){return!0},i.ed=function(){return!1},i.Rg=function(e){return"com.apple.fps"===e},i.Jf=function(){return!0},i.toString=function(){return"Device: "+this.Nb()+" v"+this.za()+"; Type: "+this.Ua()},h(Yv,Wv),(i=Yv.prototype).za=function(){return this.g.value()},i.Nb=function(){return"Apple Browser"},i.Ua=function(){return this.h.value()},i.Ha=function(){return"WEBKIT"},i.cc=function(){return!1},i.Ed=function(e,t){return"audio"===t},i.df=function(){return!0},i.Hi=function(e){return"audio"===e},i.Wa=function(e){return Wv.prototype.Wa.call(this,e),e.abr.minTimeToSwitch=.5,e},i.aj=function(){return!0},i.Jf=function(){return!1},(navigator.vendor||"").includes("Apple")&&(/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||navigator.maxTouchPoints>1||navigator.userAgentData&&navigator.userAgentData.platform&&"macos"==navigator.userAgentData.platform.toLowerCase()||navigator.platform&&navigator.platform.toLowerCase().includes("mac"))&&(oe=function(){return new Yv}),h(Jv,Wv),(i=Jv.prototype).za=function(){return this.h.value()},i.Nb=function(){return"Chromecast with "+this.g.value()},i.Ua=function(){return"CAST"},i.Ha=function(){return"CHROMIUM"},i.cc=function(){return Wv.prototype.cc.call(this)&&this.g.value()!==ty},i.Pc=function(){return this.g.value()!==ty},i.Mi=function(){switch(this.g.value()){case Zv:return 0;case ey:return 3;default:return 1}},i.jc=function(){var t,n,i,r;return R((function(a){switch(a.g){case 1:if(t=e.cast&&cast.__platform__&&cast.__platform__.canDisplayType,n={width:1280,height:720},S(a,2),!(i=t)){a.A(4);break}return w(a,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160'),5);case 5:i=a.h;case 4:if(i){n.width=3840,n.height=2160,a.A(6);break}if(!(r=t)){a.A(7);break}return w(a,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=1920; height=1080'),8);case 8:r=a.h;case 7:r&&(n.width=1920,n.height=1080);case 6:x(a,3);break;case 2:z("Failed to check canDisplayType:",k(a));case 3:return a.return(n)}}))},i.Wa=function(e){return Wv.prototype.Wa.call(this,e),e.streaming.stallSkip=0,e},i.xh=function(){return!1},i.ed=function(){return!0};var Zv="Android",ey="Fuchsia",ty="Linux";function ny(){Wv.call(this);var e=this;this.i=new re((function(){var e=navigator.userAgent.match(/(Chrome|Firefox)\/(\d+)/);return e?parseInt(e[2],10):null})),this.g=new re((function(){return navigator.userAgent.match(/Edge?\//)?"Edge":navigator.userAgent.includes("Chrome")?"Chrome":navigator.userAgent.includes("Firefox")?"Firefox":"Unknown"})),this.h=new re((function(){return navigator.userAgentData&&navigator.userAgentData.platform?"windows"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("win32")})),this.u=new re((function(){return!navigator.userAgent.match(/Edge?\//)||!e.h.value()})),this.o=new re((function(){return navigator.userAgent.includes("sony.hbbtv.tv")})),this.m=new re((function(){return navigator.userAgentData&&navigator.userAgentData.platform?"android"==navigator.userAgentData.platform.toLowerCase():!!navigator.userAgent.includes("Android")}))}function iy(){Wv.apply(this,arguments)}function ry(){Wv.call(this),this.g=new re((function(){var e=navigator.userAgent.match(/PlayStation (\d+)/);return e?parseInt(e[1],10):null}))}function ay(){Wv.call(this);var e=navigator.userAgent.match(/Tizen (\d+).(\d+)/);this.g=e?parseInt(e[1],10):null,this.h=e?parseInt(e[2],10):null}function oy(){Wv.apply(this,arguments)}function sy(){Wv.call(this),this.i=new re((function(){return navigator.userAgent.includes("DT_STB_BCM")||navigator.userAgent.includes("Sky_STB")})),this.h=new re((function(){return navigator.userAgent.includes("SOPOpenBrowser")})),this.g=new re((function(){if(navigator.userAgent.includes("DT_STB_BCM"))return 11;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}))}function uy(){Wv.call(this);var e=this;this.h=function(){var e=null,t=navigator.userAgent.match(/Chrome\/(\d+)/);switch(t&&(e=parseInt(t[1],10)),e){case 38:return 3;case 53:return 4;case 68:return 5;case 79:return 6;case 87:return 22;case 94:return 23;case 108:return 24;case 120:return 25;default:return null}}(),this.g=null;try{var t=new PalmServiceBridge;t.onservicecallback=function(t){t=JSON.parse(t),e.g=t.rj["tv.model.supportHDR"]||t.rj["tv.config.supportDolbyHDRContents"]||!1},t.call("luna://com.webos.service.config/getConfigs",JSON.stringify({Bm:["tv.model.supportHDR","tv.config.supportDolbyHDRContents"]}))}catch(e){$("WebOS: getConfigs call failed",e)}}if(Qv()&&(oe=function(){return new Jv}),h(ny,Wv),(i=ny.prototype).za=function(){return this.i.value()},i.Nb=function(){return this.g.value()},i.Ed=function(e){return!!br(e)&&("Edge"===this.g.value()&&this.h.value())},i.Gi=function(){return"Edge"===this.g.value()&&this.h.value()},i.df=function(){return"Edge"===this.g.value()&&this.h.value()},i.Pc=function(){return this.u.value()},i.Wa=function(e){if(Wv.prototype.Wa.call(this,e),this.h.value())switch(this.g.value()){case"Firefox":e.drm.keySystemsMapping={"com.microsoft.playready":"com.microsoft.playready.recommendation"};break;case"Chrome":e.drm.keySystemsMapping={"com.microsoft.playready":"com.microsoft.playready.recommendation.3000","com.microsoft.playready.recommendation":"com.microsoft.playready.recommendation.3000"}}return this.m.value()&&(e.drm.defaultAudioRobustnessForWidevine="",e.drm.defaultVideoRobustnessForWidevine=""),e},i.gh=function(){return"Edge"===this.g.value()||this.o.value()},i.ed=function(){if("GECKO"===this.Ha()){var e=this.za();return null!==e?e>=100:Wv.prototype.ed.call(this)}return Wv.prototype.ed.call(this)},i.Rg=function(e){return"GECKO"===this.Ha()?e.startsWith("com.microsoft.playready.recommendation"):Wv.prototype.Rg.call(this,e)},se=function(){return new ny},h(iy,Wv),(i=iy.prototype).za=function(){return null},i.Nb=function(){return"Hisense"},i.Ua=function(){return"TV"},i.cc=function(){return!1},i.jc=function(){var t={width:1920,height:1080},n=null;if(e.Hisense_Get4KSupportState)try{n=e.Hisense_Get4KSupportState()}catch(e){}return null==n&&(n=navigator.userAgent.includes("UHD")),n&&(t.width=3840,t.height=2160),Promise.resolve(t)},i.Wa=function(e){return Wv.prototype.Wa.call(this,e),e.streaming.stallSkip=0,e},(navigator.userAgent.includes("Hisense")||navigator.userAgent.includes("VIDAA"))&&(oe=function(){return new iy}),h(ry,Wv),(i=ry.prototype).Nb=function(){return"PlayStation"},i.Ua=function(){return"CONSOLE"},i.Ha=function(){return"WEBKIT"},i.za=function(){return this.g.value()},i.cc=function(){return!1},i.fd=function(){return!1},i.Pc=function(){return!1},i.rh=function(){return 4===this.za()},i.jc=function(){var t,n,i,r;return R((function(a){switch(a.g){case 1:return t={width:1920,height:1080},n=!1,S(a,2),w(a,e.msdk.device.getDisplayInfo(),4);case 4:i=a.h,n="4K"===i.resolution,x(a,3);break;case 2:return k(a),S(a,5),w(a,e.msdk.device.getDisplayInfoImmediate(),7);case 7:r=a.h,n="4K"===r.resolution,x(a,3);break;case 5:$("PlayStation: Failed to get the display info:",k(a));case 3:return n&&(t.width=3840,t.height=2160),a.return(t)}}))},i.Wa=function(e){return Wv.prototype.Wa.call(this,e),4===this.za()&&e.drm.preferredKeySystems.push("com.microsoft.playready"),e.streaming.clearDecodingCache=!0,e},i.gh=function(){return 4===this.za()},i.Kf=function(){return 4!==this.za()},navigator.userAgent.includes("PlayStation")&&(oe=function(){return new ry}),h(ay,Wv),(i=ay.prototype).za=function(){return this.g},i.Nb=function(){return"Tizen"},i.Ha=function(){return"CHROMIUM"},i.Ua=function(){return"TV"},i.Ed=function(){return!0},i.oe=function(){return 3===this.za()},i.cc=function(){return!1},i.fd=function(){var e=this.za();return null!==e?e>=4:Wv.prototype.fd.call(this)},i.Pc=function(){return!1},i.re=function(){return this.g&&this.h?5===this.g?this.h>=5:this.g>5:Wv.prototype.re.call(this)},i.jc=function(){var t=e.devicePixelRatio;t={width:e.screen.width*t>1920?3840:1920,height:e.screen.height*t>1080?2160:1080};try{if(webapis.systeminfo&&webapis.systeminfo.getMaxVideoResolution){var n=webapis.systeminfo.getMaxVideoResolution();t.width=n.width,t.height=n.height}else webapis.productinfo.is8KPanelSupported&&webapis.productinfo.is8KPanelSupported()?(t.width=7680,t.height=4320):webapis.productinfo.isUdPanelSupported&&webapis.productinfo.isUdPanelSupported()&&(t.width=3840,t.height=2160)}catch(e){$("Tizen: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(t)},i.Wa=function(e){return Wv.prototype.Wa.call(this,e),e.drm.ignoreDuplicateInitData=2!==this.za(),3===this.za()&&(e.streaming.crossBoundaryStrategy="reset_to_encrypted"),e.streaming.shouldFixTimestampOffset=!0,e.streaming.stallSkip=0,e.streaming.gapPadding=2,e},i.Ei=function(){var e=[];return null!==this.g&&this.g<5&&e.push("opus"),e},i.sd=function(e){try{if(webapis.avinfo.isHdrTvSupport())return e?"HLG":"PQ"}catch(t){return Wv.prototype.sd.call(this,e)}return"SDR"},i.si=function(){return!0},i.ti=function(){return 3===this.za()},navigator.userAgent.includes("Tizen")&&(oe=function(){return new ay}),h(oy,Wv),oy.prototype.za=function(){return null},oy.prototype.Nb=function(){return"Vizio"},oy.prototype.Ua=function(){return"TV"},oy.prototype.cc=function(){return!1},navigator.userAgent.includes("VIZIO SmartCast")&&(oe=function(){return new oy}),h(sy,Wv),(i=sy.prototype).za=function(){return this.g.value()},i.Nb=function(){return"WebKit STB"},i.Ua=function(){return"TV"},i.Ha=function(){return"WEBKIT"},i.cc=function(){return!1},i.fd=function(){var e=this.g.value();return null===e||e>=15},i.Ed=function(){return this.h.value()},i.jc=function(){return Promise.resolve({width:e.screen.width*e.devicePixelRatio,height:e.screen.height*e.devicePixelRatio})},i.Kf=function(){return!this.i.value()},i.Jf=function(){return!1},(navigator.userAgent.includes("SOPOpenBrowser")||navigator.userAgent.includes("DT_STB_BCM")||navigator.userAgent.includes("Sky_STB")||!(!(navigator.vendor||"").includes("Apple")||/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||navigator.maxTouchPoints>1||navigator.userAgentData&&navigator.userAgentData.platform&&"macos"==navigator.userAgentData.platform.toLowerCase()||navigator.platform&&navigator.platform.toLowerCase().includes("mac")))&&(oe=function(){return new sy}),h(uy,Wv),(i=uy.prototype).za=function(){return this.h},i.Nb=function(){return"WebOS"},i.Ua=function(){return"TV"},i.Ha=function(){return"CHROMIUM"},i.cc=function(){return!1},i.fd=function(){var e=this.za();return null!==e?e>3:Wv.prototype.fd.call(this)},i.Pc=function(){var e=this.za();return null!==e?e>6:Wv.prototype.Pc.call(this)},i.re=function(){var e=this.za();return null!==e?e>3:Wv.prototype.re.call(this)},i.jc=function(){var t={width:1920,height:1080};try{var n=JSON.parse(e.PalmSystem.deviceInfo);t.width=Math.max(1920,n.screenWidth),t.height=Math.max(1080,n.screenHeight)}catch(e){$("WebOS: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(t)},i.Wa=function(e){return Wv.prototype.Wa.call(this,e),3===this.za()&&(e.streaming.crossBoundaryStrategy="reset"),e.streaming.shouldFixTimestampOffset=!0,e.streaming.stallSkip=0,e},i.sd=function(e){return null==this.g?($("WebOS: getConfigs call haven't finished"),Wv.prototype.sd.call(this,e)):this.g?e?"HLG":"PQ":"SDR"},i.$i=function(){return!1},i.ed=function(){var e=this.za();return null!==e?e>=6:Wv.prototype.ed.call(this)},navigator.userAgent.includes("Web0S")){var ly=new uy;oe=function(){return ly}}function cy(){Wv.call(this),this.g=navigator.userAgent.includes("Edge/");var e=navigator.userAgent.match(/Edge?\/(\d+)/);this.h=e?parseInt(e[1],10):null}function dy(){var e=null;try{e="undefined"!=typeof Windows?Windows:chrome.webview.hostObjects.sync.Windows}catch(e){}return e}function hy(e,t,n){this.type=e,this.ea=t,this.segments=n||null}function fy(e,t,n,i){this.id=e,this.name=t,this.attributes=n,this.value=void 0===i?null:i}function py(e,t){return t?e.toString():(t=(new Set).add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI"),e.toString(t))}function gy(e,t){return(e=e.attributes.filter((function(e){return e.name==t}))).length?e[0]:null}function my(e,t,n){return(e=gy(e,t))?e.value:n||null}function vy(e,t){if(!(e=gy(e,t)))throw new Ue(2,4,4023,t);return e.value}function yy(e,t,n){n=void 0===n?[]:n,this.ea=t,this.g=e,this.vc=n}function by(e,t){this.name=e,this.value=t}function wy(e,t){return e.filter((function(e){return e.name==t}))}function _y(e,t){return e.filter((function(e){return vy(e,"TYPE")==t}))}function Sy(e,t){for(var n=(e=p(e)).next();!n.done;n=e.next())if((n=n.value).name===t)return n;return null}function Ty(e,t,n){return n=void 0===n?0:n,(e=Sy(e,t))?Number(e.value):n}function xy(e,t,n){return t?ky(e,[t],n):[]}function ky(e,t,n){if(!t.length)return[];var i=t;return n&&n.size&&(i=t.map((function(e){return Ay(e,n)}))),nt(e,i)}function Ay(e,t){if(!t||!t.size)return e;var n=(e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}")).match(/{\$\w*}/g);if(n)for(var i=(n=p(n)).next();!i.done;i=n.next()){var r=(i=i.value).slice(2,i.length-1),a=t.get(r);if(!a)throw new Ue(2,4,4039,r);e=e.replace(i,a)}return e}function Ey(){this.g=0}function Iy(e,t){var n=(t=(t=He(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!Py.test(n[0]))throw new Ue(2,4,4015);t=0;for(var i=!1,r=[],a=!0,o=0;o<n.length;o++){var s=n[o],u=n[o+1];if(s.startsWith("#")&&!s.startsWith("#EXT")||a)a=!1;else{if(s=Cy(e,s),i||(Ly.has(s.name)?(t=1,i=!0):"EXT-X-STREAM-INF"==s.name||"EXT-X-MEDIA"==s.name?i=!0:Ny.has(s.name)&&(t=1,i=!0)),Ny.has(s.name)){if(1!=t)throw new Ue(2,4,4017);a=e,e=Array(Math.max(100,Math.floor((n.length-o)/2))),i=0,s=[];var l=[];for(u=null;o<n.length;o++){var c=n[o];c.startsWith("#EXT")?(c=Cy(a,c),Ly.has(c.name)?r.push(c):"EXT-X-MAP"==c.name?u=c:"EXT-X-PART"==c.name?l.push(c):"EXT-X-PRELOAD-HINT"==c.name?"PART"==my(c,"TYPE")?l.push(c):"MAP"==my(c,"TYPE")&&(c.name="EXT-X-MAP",u=c):s.push(c)):c.startsWith("#")&&!c.startsWith("#EXT")||(c=c.trim(),u&&s.push(u),s=new yy(c,s,l),i<e.length?e[i++]=s:(e.push(s),i++),s=[],l=[])}return l.length&&(u&&s.push(u),n=new yy("",s,l),i<e.length?e[i++]=n:(e.push(n),i++)),new hy(t,r,i<e.length?e.slice(0,i):e)}r.push(s),"EXT-X-STREAM-INF"==s.name&&(s.attributes.push(new by("URI",u)),a=!0)}}return new hy(t,r)}function Cy(e,t){e=e.g++;var n=t.match(My);if(!n)throw new Ue(2,4,4016,t);t=n[1];var i,r,a=n[2];if(n=[],a)for(a=new Pt(a),Ry.lastIndex=0,(r=Dt(a,Ry))&&(i=r[1]),Dy.lastIndex=0,r=Dt(a,Dy);r;)n.push(new by(r[1],r[2]||r[3])),Rt(a),r=Dt(a,Dy);return new fy(e,t,n,i)}h(cy,Wv),(i=cy.prototype).za=function(){return this.h},i.Nb=function(){return"Xbox"},i.Ua=function(){return"CONSOLE"},i.Ha=function(){return this.g?"EDGE":"CHROMIUM"},i.Ed=function(){return!0},i.df=function(){return!0},i.Ui=function(){return this.g},i.jc=function(){var e={width:1920,height:1080},t=dy();if(t)try{var n=new t.Media.Protection.ProtectionCapabilities,i=t.Media.Protection.ProtectionCapabilityResult;t=null;do{t=n.isTypeSupported('video/mp4;codecs="hvc1,mp4a";features="decode-res-x=3840,decode-res-y=2160,decode-bitrate=20000,decode-fps=30,decode-bpc=10,display-res-x=3840,display-res-y=2160,display-bpc=8"',"com.microsoft.playready.recommendation")}while(t===i.maybe);t===i.probably&&(e.width=3840,e.height=2160)}catch(e){$("Xbox: Error detecting screen size, default screen size 1920x1080.")}return Promise.resolve(e)},i.Wa=function(e){return Wv.prototype.Wa.call(this,e),e.drm.parseInbandPsshEnabled=this.g,e.drm.preferredKeySystems.push("com.microsoft.playready"),this.g&&(e.streaming.gapPadding=.01),e},i.xh=function(){return!1},(navigator.userAgent.includes("Xbox One")||null!==dy())&&(oe=function(){return new cy}),fy.prototype.toString=function(e){var t="#"+this.name,n=this.attributes?this.attributes.filter((function(t){return!e||!e.has(t.name)})).map((function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)})):[];return this.value&&n.unshift(this.value),n.length>0&&(t+=":"+n.join(",")),t};var My=/^#(EXT[^:]*)(?::(.*))?$/,Py=/^#EXTM3U($|[ \t\n])/m,Ry=/^([^,=]+)(?:,|$)/g,Dy=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g,Ly=new Set("EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF EXT-X-DATERANGE".split(" ")),Ny=new Set("EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP EXT-X-GAP EXT-X-TILES".split(" "));function Oy(){}function jy(e,t){try{var n=Uy(e);return Mr({uri:e,originalUri:e,data:n.data,headers:{"content-type":n.contentType},originalRequest:t})}catch(e){return Ir(e)}}function Uy(t){var n=t.split(":");if(n.length<2||"data"!=n[0])throw new Ue(2,1,1004,t);if((n=n.slice(1).join(":").split(",")).length<2)throw new Ue(2,1,1004,t);var i=n[0];t=e.decodeURIComponent(n.slice(1).join(",")),n=i.split(";"),i=n[0];var r=!1;return n.length>1&&"base64"==n[n.length-1]&&(r=!0,n.pop()),{data:r?Qe(t):Ge(t),contentType:i}}function Fy(){var t=this;this.g=this.h=null,this.G=1,this.B=new Map,this.M=new Map,this.C=new Map,this.C.set("video",new Map),this.C.set("audio",new Map),this.C.set(ut,new Map),this.C.set("image",new Map),this.uc=(new Map).set("com.apple.streamingkeydelivery",(function(n,i,r){return function(t,n,i,r){var a,o,s,u,l;return R((function(c){if(1==c.g){if("video/mp2t"==i)throw new Ue(2,4,4040);if("apple"===e.shakaMediaKeysPolyfill)throw new Ue(2,4,4041);if(a=vy(n,"METHOD"),!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(a))return c.return(null);o="cenc","SAMPLE-AES"==a&&(o="cbcs"),s=vy(n,"URI"),u=it("com.apple.fps",o,[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}],s);var d=new ge(s).Db.replace(/-/g,"").toLowerCase();return(l=32===d.length&&/^[0-9a-f]+$/.test(d)?d:null)||!r?c.A(2):w(c,Ib(t,r),3)}return 2!=c.g&&(l=c.h),l&&u.keyIds.add(l),c.return(u)}))}(t,n,i,r)})).set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",(function(e){var n=vy(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(n)){var i="cenc";"SAMPLE-AES"==n&&(i="cbcs");var r=vy(e,"URI");n=Uy(r.split("?")[0]),r=r.split("?")[0],t.I.has(r)||(n=Le(n.data),t.I.set(r,n)),i=it("com.widevine.alpha",i,[{initDataType:"cenc",initData:t.I.get(r)}]),(e=my(e,"KEYID"))&&i.keyIds.add(e.toLowerCase().substr(2)),e=Promise.resolve(i)}else e=Promise.resolve(null);return e})).set("com.microsoft.playready",(function(e){var t=vy(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)){var n="cenc";"SAMPLE-AES"==t&&(n="cbcs"),n=it("com.microsoft.playready",n,[{initDataType:"cenc",initData:t=ma(e=Le((e=Uy((e=vy(e,"URI")).split("?")[0])).data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),new Set,0)}]),(e=qt(["<PLAYREADY>",Je(e),"</PLAYREADY>"].join("\n")))&&(n.licenseServerUri=Xg(e)),n=Promise.resolve(n)}else n=Promise.resolve(null);return n})).set("urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c",(function(e){var n=vy(e,"METHOD");if(["SAMPLE-AES","SAMPLE-AES-CTR"].includes(n)){var i="cenc";"SAMPLE-AES"==n&&(i="cbcs");var r=vy(e,"URI");n=Uy(r.split("?")[0]),r=r.split("?")[0],t.I.has(r)||(n=Le(n.data),t.I.set(r,n)),i=it("com.huawei.wiseplay",i,[{initDataType:"cenc",initData:t.I.get(r)}]),(e=my(e,"KEYID"))&&i.keyIds.add(e.toLowerCase().substr(2)),e=Promise.resolve(i)}else e=Promise.resolve(null);return e})),this.ob=new Set,this.i=new Map,this.l=null,this.H="",this.Ta=new Ey,this.N=-1,this.ma=1/0,this.aa=this.yc=this.kb=!1,this.F=new Si((function(){t.X&&!t.g.continueLoadingWhenPaused&&(t.V.Ma(t.X,"timeupdate"),t.X.paused)?t.V.Ba(t.X,"timeupdate",(function(){return Sb(t)})):Sb(t)})),this.Fa=Ob,this.m=null,this.ib=0,this.o=1/0,this.ab=this.Sa=this.T=0,this.$=new jr,this.J=new Map,this.K=new Map,this.Da=new Map,this.va=new Map,this.O=new Map,this.xa=new Map,this.ya=new Map,this.xc=this.oa=!1,this.Zb=new H(5),this.j=null,this.R=!0,this.V=new te,this.u=this.X=null,this.ac=function(){return!1},this.I=new Map}function By(e,t){return Tb(e)?e.C.get(t.type):t.mf}function Hy(e,t){var n,i,r,a,o,s,u,l,c,d,h,f,m,v,y,b,T,A,E,I,C,M,P,D,L,N,O,j,U,F,B,H,V,q,G;return R((function(R){switch(R.g){case 1:if(t.stream.isAudioMuxedInVideo)return R.return();for(n=[],i=p(t.P()),r=i.next();!r.done;r=i.next())a=r.value,o=new ge(a),s=o.g,t.Re&&(t.Qb>=0&&s.add("_HLS_msn",String(t.Qb)),t.Rb>=0&&s.add("_HLS_part",String(t.Rb))),t.Se&&s.add("_HLS_skip","YES"),Me(s)&&be(o,we(s.toString())),n.push(o.toString());return S(R,2),w(R,_b(e,n,!0).promise,4);case 4:u=R.h,x(R,3);break;case 2:throw l=k(R),e.h&&e.h.disableStream(t.stream),l;case 3:if(!t.stream.segmentIndex)return R.return();if(1!=(c=Iy(e.Ta,u.data)).type)throw new Ue(2,4,4017);return(d=u.uri)==u.originalUri||t.P().includes(d)||t.Af.push(d),h=wy(c.ea,"EXT-X-DEFINE"),f=$y(e,h,d),m=t.stream,v=By(e,t),w(R,sb(e,c,m.mimeType,t.P,f),5);case 5:for(y=R.h,b=y.keyIds,T=y.drmInfos,A=y.encrypted,E=y.Lh,m.encrypted||!A||E||(m.encrypted=!0),function(e,t){return e.size===t.size&&[].concat(g(e)).every((function(e){return t.has(e)}))}(m.keyIds,b)||(m.keyIds=b,m.drmInfos=T,e.h.newDrmInfo(m)),I=mb(e,c,v,f,t.P,t.type),C=I.segments,(M=I.bandwidth)&&(m.bandwidth=M),P=Hu(m),D=p(C),L=D.next();!L.done;L=D.next())(N=L.value).ba&&(N.ba.xd=P);m.segmentIndex.fe(C,e.l.Hb()),C.length&&(O=Ty(c.ea,"EXT-X-MEDIA-SEQUENCE",0),U=(j=Sy(c.ea,"EXT-X-SKIP"))?Number(my(j,"SKIPPED-SEGMENTS")):0,F=ab(O,C),B=F.Qb,H=F.Rb,t.Qb=B+U,t.Rb=H,V=v.get(O),m.segmentIndex.Ya(V)),(q=Pu(m.segmentIndex))&&(t.Wc=q.startTime,G=C[C.length-1],t.Lc=G.endTime),Sy(c.ea,"EXT-X-ENDLIST")&&(t.Yd=!0),cb(e,c),gb(e,c.ea,m.type,f,t.P),_(R)}}))}function Vy(e,t,n){n=void 0!==n&&n;for(var i=-1==e.N,r=p(t),a=r.next();!a.done;a=r.next()){var o=(a=a.value).stream.segmentIndex,s=By(e,a);if(o=Pu(o))for(var u=(s=p(s)).next();!u.done;u=s.next()){var l=(u=p(u.value)).next().value;if(u.next().value==o.startTime){i&&(e.N=Math.max(e.N,l)),a.og=l;break}}}if(!(e.N<0))for(i=(t=p(t)).next();!i.done;i=t.next())(ib(e,(i=i.value).type)||n)&&(r=i.stream.segmentIndex)&&((a=e.N-i.og)>0&&(r.g.splice(0,a),r=Pu(r))&&(r=-r.startTime,i.stream.segmentIndex.offset(r),qy(e,i,r)))}function qy(e,t,n){if(!(Math.abs(n)<.001)){t.Wc+=n,t.Lc+=n;for(var i=p(e=By(e,t)),r=i.next();!r.done;r=i.next()){var a=p(r.value);r=a.next().value,a=a.next().value,e.set(r,a+n)}t.P()}}function Gy(e,t,n){var i,r,a,o,s;return R((function(u){switch(u.g){case 1:return t?(i=Kr,r=al(t.P(),t.Ic(),t.Gc(),e.g.retryParameters),w(u,kb(e,r,i,{type:t instanceof Fo?1:0}).promise,2)):u.return({mimeType:null,data:null});case 2:if(a=u.h,o=a.data,!t.aesKey){u.A(3);break}return w(u,rl(o,t.aesKey,n),4);case 4:o=u.h;case 3:return t instanceof Fo?t.pe(o,!0):t.pe(o),(s=a.headers["content-type"])&&(s=s.split(";")[0].toLowerCase()),u.return({mimeType:s,data:o})}}))}function zy(e){if(Tb(e)){if(e.Fa==Ub){for(var t=1/0,n=1/0,i=p(e.i.values()),r=i.next();!r.done;r=i.next())(r=r.value).stream.segmentIndex&&"text"!=r.stream.type&&!r.stream.isAudioMuxedInVideo&&(t=Math.min(t,r.Lc),n=Math.min(n,r.Wc));t=t-n||0,isNaN(e.g.availabilityWindowOverride)||(t=e.g.availabilityWindowOverride),e.l.Hf(t)}}else e.l.Ab(eb(e));if(!e.l.o)for(n=(t=p(e.i.values())).next();!n.done;n=t.next())!(n=n.value).stream.segmentIndex||"audio"!=n.type&&"video"!=n.type||(n=Pu(n.stream.segmentIndex))&&n.h&&e.l.oh(n.h);e.l.lf()}function $y(e,t,n){n=new ge(n).g;for(var i=new Map,r=(t=p(t)).next();!r.done;r=t.next()){var a=r.value,o=my(a,"NAME"),s=my(a,"VALUE");r=my(a,"QUERYPARAM"),a=my(a,"IMPORT"),o&&s&&(i.has(o)||i.set(o,s)),r&&(o=n.get(r)[0])&&!i.has(o)&&i.set(r,o),a&&(r=e.B.get(a))&&i.set(a,r)}return i}function Ky(e){var t=new Set([ni(e.mimeType,e.codecs)]);e.segmentIndex&&e.segmentIndex.Fb((function(n){n.mimeType&&t.add(ni(n.mimeType,e.codecs))})),e.fullMimeTypes=t}function Wy(e,t,n){for(var i={audio:[],video:[]},r=new Map,a=[],o=!1,s=!1,u=p(t),l=u.next();!l.done;l=u.next()){var c=l.value;l=my(c,"AUDIO");var d=my(c,"VIDEO"),h=l||d;h&&(a.includes(h)||a.push(h),(c=my(c,"PATHWAY-ID"))&&r.set(h,c),l?o=!0:d&&(s=!0))}a.length&&n.length&&function(e,t,n){t=t.filter((function(e){var t=my(e,"URI")||"";return"SUBTITLES"!=(e=my(e,"TYPE"))&&(""!=t||"AUDIO"==e)}));for(var i={},r=(t=p(t)).next();!r.done;r=t.next()){var a=py(r=r.value,!e.j);i[a]?i[a].push(r):i[a]=[r]}for(var o in i)Jy(e,i[o],n,!1)}(e,n=n.filter((function(e){return a.includes(vy(e,"GROUP-ID"))})),r),n=(r=a.sort().join(","))&&e.M.has(r)?e.M.get(r):[],o?i.audio.push.apply(i.audio,g(n)):s&&i.video.push.apply(i.video,g(n)),s=!1;var f=t.map((function(e){return vy(e,"URI")}));return o=i.audio.find((function(e){return e&&e.P().find((function(e){return f.includes(e)}))})),u=ot("video",n=Xy(e,t[0])),(l=ot("audio",n))&&!u?(o="audio",s=i.audio.length>0&&!i.audio.some((function(e){return e.stream.isAudioMuxedInVideo}))):!i.audio.length&&!i.video.length&&l&&u?(o="video",n=[[u,l].join()]):i.audio.length&&o?(o="audio",s=!0):o=i.video.length&&!i.audio.length?"audio":"video",s||(t=function(e,t,n,i){for(var r=e.G++,a=[],o=p(t),s=o.next();!s.done;s=o.next()){var u=s.value;s=vy(u,"URI"),u=my(u,"PATHWAY-ID"),e.j&&u&&Lm(e.j,r,u,s),a.push(s)}if(o=a.sort().join(",")+n.sort().join(","),e.i.has(o))return e.i.get(o);s=a.join(",");e:{if(t=my(t[0],"CLOSED-CAPTIONS"),"video"==i){if(e.g.disableText){e.R=!1,t=null;break e}if(t){if("NONE"!=t){t=e.J.get(t);break e}e.R=!1}else if(!t&&e.J.size)for(t=(t=p(e.J.keys())).next();!t.done;t=t.next()){t=e.J.get(t.value);break e}}t=null}return n=at(i,n),i=Zy(e,r,a,n,i,null,!1,s,null,t,null,!1,null,!1),e.i.set(o,i),i}(e,t,n,o),r&&e.g.enableAudioGroups&&(t.stream.groupId=r),"audio"==t.stream.type&&"audio"===o&&i.audio.some((function(e){return e.stream.isAudioMuxedInVideo}))&&(e=i.audio[0].stream,t.stream.language=e.language,t.stream.channelsCount=e.channelsCount,t.stream.label=e.label,t.stream.audioSamplingRate=e.audioSamplingRate,t.stream.originalId=e.originalId,t.stream.originalLanguage=e.originalLanguage),i[t.stream.type]=[t]),i}function Xy(e,t){return t=my(t,"CODECS")||"",e.aa=t.length>0,e.aa||e.g.hls.disableCodecGuessing||(t=[],e.g.disableVideo||t.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||t.push(e.g.hls.defaultAudioCodec),t=t.join(",")),il(t.split(/\s*,\s*/))}function Yy(e,t,n,i,r,a,o,s,u,l,c,d){for(var h=p(n),f=h.next();!f.done;f=h.next())wb(f.value.stream,r,a,o,s,u,null);for(r=e.g.disableVideo,n.length&&!r||(n=[null]),r&&(t=t.filter((function(e){return!e.stream.isAudioMuxedInVideo}))),r=e.g.disableAudio,t.length&&!r||(t=[null]),r=[],a=(t=p(t)).next();!a.done;a=t.next())for(a=a.value,s=(o=p(n)).next();!s.done;s=o.next()){var g=s.value;(s=a?a.stream:null)&&(s.drmInfos=l,s.keyIds=c),(u=g?g.stream:null)&&(u.drmInfos=l,u.keyIds=c,e.g.disableIFrames||ar(u,d)),u&&!s&&(u.bandwidth=i),!u&&s&&(s.bandwidth=i),h=a?a.stream.drmInfos:null,f=g?g.stream.drmInfos:null,g=g?g.P().sort().join(","):"";var m=a?a.P().sort().join(","):"",v=[];s&&s.codecs&&v.push(s.codecs),u&&u.codecs&&v.push(u.codecs),g=[g,m,v.sort()].join("-"),s&&u&&!vr(h,f)||e.ob.has(g)||(s={id:e.G++,language:s?s.language:"und",disabledUntilTime:0,primary:!!s&&s.primary||!!u&&u.primary,audio:s,video:u,bandwidth:i,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},r.push(s),e.ob.add(g))}return r}function Jy(e,t,n,i){i=void 0===i||i;for(var r=[],a=[],o=new Map,s=p(t),u=s.next(),l={};!u.done;l={ii:void 0},u=s.next())u=u.value,l.ii=++e.G,l=function(e){return function(){return"shaka://hls-muxed"+e.ii}}(l),l=i?vy(u,"URI"):my(u,"URI")||l(),u=vy(u,"GROUP-ID"),r.push(l),a.push(u),o.set(u,l);if(i=a.sort().join(","),u=t[0],t="",s=function(e){return"subtitles"==(e=vy(e,"TYPE").toLowerCase())&&(e=ut),e}(u),s==ut)t=my(u,"CODECS")||"";else for(l=(a=p(a)).next();!l.done;l=a.next())if(l=l.value,e.K.has(l)){t=e.K.get(l);break}if(a=r.sort().join(","),e.i.has(a))return e.i.get(a);if(l=e.G++,e.j)for(var c=(o=p(o)).next();!c.done;c=o.next()){var d=p(c.value);c=d.next().value,d=d.next().value,(c=n.get(c))&&Lm(e.j,l,c,d)}n=my(u,"LANGUAGE"),o=my(u,"NAME"),c="YES"==my(u,"DEFAULT"),d="audio"==s?function(e){return(e=my(e,"CHANNELS"))?parseInt(e.split("/")[0],10):null}(u):null;var h="audio"==s&&function(e){return!!(e=my(e,"CHANNELS"))&&2==(e=e.split("/")).length&&("JOC"===e[1]||e[1].includes("ATMOS"))}(u),f=my(u,"CHARACTERISTICS"),g="YES"==my(u,"FORCED");return u="audio"==s?function(e){return(e=my(e,"SAMPLE-RATE"))?parseInt(e,10):null}(u):null,(r=Zy(e,l,r,t,s,n,c,o,d,null,f,g,u,h)).stream&&e.g.enableAudioGroups&&(r.stream.groupId=i),e.M.has(i)?e.M.get(i).push(r):e.M.set(i,[r]),e.i.set(a,r),r}function Qy(e,t){var n="video",i=vy(t,"URI"),r=my(t,"CODECS")||"";if("mjpg"==r&&(n="image"),e.i.has(i))return e.i.get(i);var a=my(t,"LANGUAGE"),o=my(t,"NAME"),s=my(t,"CHARACTERISTICS");return n=Zy(e,e.G++,[i],r,n,a,!1,o,null,null,s,!1,null,!1),a=p((r=my(t,"RESOLUTION"))?r.split("x"):[null,null]),r=a.next().value,a=a.next().value,n.stream.width=Number(r)||void 0,n.stream.height=Number(a)||void 0,(t=my(t,"BANDWIDTH"))&&(n.stream.bandwidth=Number(t)),e.i.set(i,n),n}function Zy(e,t,n,i,r,a,o,s,u,l,c,d,h,f){function g(t){var n,g,y,T,A,E,I,C,M,P,D,L,N,O,j,U,F,B;return R((function(R){switch(R.g){case 1:return n=lt,S(R,2),w(R,t.promise,4);case 4:if(g=R.h,t.aborted)return R.return();if((y=g.uri)!=g.originalUri&&(b.P().includes(y)||b.Af.push(y)),1!=(T=Iy(e.Ta,g.data)).type)throw new Ue(2,4,4017);return A=wy(T.ea,"EXT-X-DEFINE"),E=$y(e,A,y),I=!1,(!e.aa&&e.g.hls.disableCodecGuessing||e.R&&r==n.Aa&&!e.g.hls.disableClosedCaptionsDetection)&&T.segments.length>0&&(e.R=!1,I=!0),C=!e.aa&&e.g.hls.disableCodecGuessing,M=Tb(e),w(R,rb(e,0,E,T,m,i,r,a,o,s,u,l,c,d,h,f,void 0,I,C),5);case 5:if(P=R.h,t.aborted)return R.return();D=P.stream,lb(e,T),Tb(e)&&!M&&db(e,T),b.Wc=P.Wc,b.Lc=P.Lc,b.Se=P.Se,b.Re=P.Re,b.Yd=P.Yd,b.mf=P.mf,b.Qb=P.Qb,b.Rb=P.Rb,v.segmentIndex=D.segmentIndex,v.encrypted=D.encrypted,v.drmInfos=D.drmInfos,v.keyIds=D.keyIds,v.mimeType=D.mimeType,v.bandwidth=v.bandwidth||D.bandwidth,v.codecs=v.codecs||D.codecs,v.closedCaptions=v.closedCaptions||D.closedCaptions,v.width=v.width||D.width,v.height=v.height||D.height,v.hdr=v.hdr||D.hdr,v.colorGamut=v.colorGamut||D.colorGamut,v.frameRate=v.frameRate||D.frameRate,"und"==v.language&&"und"!=D.language&&(v.language=D.language),v.language=v.language||D.language,v.channelsCount=v.channelsCount||D.channelsCount,v.audioSamplingRate=v.audioSamplingRate||D.audioSamplingRate,Ky(v),v.drmInfos.length&&e.h.newDrmInfo(v),L=!1,(!l&&v.closedCaptions||l&&v.closedCaptions&&l.size!=v.closedCaptions.size)&&(L=!0),e.m&&L&&e.h.makeTextStreamsForClosedCaptions(e.m),r==n.Na&&(N=Pu(D.segmentIndex))&&N.ba&&(v.mimeType="application/mp4",Ky(v)),O=Hu(v),v.segmentIndex.Fb((function(e){e.ba&&(e.ba.xd=O)})),function(e){if(!e.m)return!1;for(var t=[],n=[],i=(e=p(e.m.variants)).next();!i.done;i=e.next())(i=i.value).video&&t.push(i.video),i.audio&&n.push(i.audio);return!(t.length>0&&!t.some((function(e){return e.segmentIndex}))||n.length>0&&!n.some((function(e){return e.segmentIndex})))}(e)&&(e.yc?nb(e,[b]):(e.yc=!0,j=Array.from(e.i.values()),U=j.filter((function(e){return e.stream.segmentIndex})),nb(e,U),zy(e),(F=e.o)>0&&e.F.ia(F))),gb(e,T.ea,v.type,E,m),e.m&&(e.m.startTime=e.u),x(R,0);break;case 2:if(B=k(R),v.closeSegmentIndex(),7001===B.code)return R.return();if(!e.h.disableStream(v))throw B;_(R)}}))}function m(){return e.j&&n.length>1?Nm(e.j,t):b.Af.concat(ky([e.H],n,e.B))}var v=ob(e,i,r,a,o,s,u,l,c,d,h,f);n.some((function(e){return e.startsWith("shaka://hls-muxed")}))&&(v.isAudioMuxedInVideo=!0,v.mimeType="video/mp2t",Ky(v));var y,b={stream:v,type:r,Af:[],Wc:0,Lc:0,mf:new Map,Se:!1,Re:!1,Yd:!1,og:-1,Qb:-1,Rb:-1,P:m},T=null;return v.createSegmentIndex=function(){return T||(v.isAudioMuxedInVideo?(v.segmentIndex=new Mu([]),Promise.resolve()):(y=_b(e,b.P(),!0),T=new Promise((function(e){e(g(y))}))))},v.closeSegmentIndex=function(){T&&!v.segmentIndex&&y.abort(),v.segmentIndex&&(v.segmentIndex.release(),v.segmentIndex=null),T=null},b}function eb(e){for(var t=1/0,n=(e=p(e.i.values())).next();!n.done;n=e.next())(n=n.value).stream.segmentIndex&&"text"!=n.stream.type&&!n.stream.isAudioMuxedInVideo&&(t=Math.min(t,n.Lc));return t}function tb(e,t){for(var n=[],i=(t=p(t)).next();!i.done;i=t.next())(i=i.value).segmentIndex&&i.segmentIndex.Fb((function(e){n.push(e)}));e.l.ie(n)}function nb(e,t){if(!Tb(e))for(var n=eb(e),i=p(t),r=i.next();!r.done;r=i.next())r.value.stream.segmentIndex.pd(0,n);tb(e,t.map((function(e){return e.stream}))),n=(i=Array.from(e.i.values()).filter((function(e){return e.stream.segmentIndex}))).some((function(e){return"audio"==e.stream.type})),r=i.some((function(e){return"video"==e.stream.type})),i=Tb(e)&&!e.kb,n=!Tb(e)&&e.kb&&!(n&&r),e.g.hls.ignoreManifestProgramDateTime||i||n?Vy(e,t,i):(function(e,t){if(e.ma==1/0)for(var n=(t=p(t)).next();!n.done;n=t.next())null!=(n=Pu(n.value.stream.segmentIndex))&&null!=n.h&&(e.ma=Math.min(e.ma,n.h));if((t=e.ma)!=1/0)for(var i=(n=p(e.i.values())).next();!i.done;i=n.next())if(!ib(e,(i=i.value).type)){var r=i.stream.segmentIndex;if(null!=r){var a=Pu(r);if(a)if(null==a.h)z("Missing EXT-X-PROGRAM-DATE-TIME for stream",i.P(),"Expect AV sync issues!");else for(qy(e,i,a.h-t-a.startTime),r=(i=p(r)).next();!r.done;r=i.next())r.value.yh(t)}}}(e,t),e.g.hls.ignoreManifestProgramDateTimeForTypes.length>0&&Vy(e,t))}function ib(e,t){return!!e.g.hls.ignoreManifestProgramDateTime||e.g.hls.ignoreManifestProgramDateTimeForTypes.includes(t)}function rb(e,t,n,i,r,a,o,s,u,l,c,d,h,f,g,m,v,y,b){var _,T,A,E,I,C,M,P,D,L,N,O,j,U,F,B,H,V,q,G,z,$,K,W,X,Y,J,Q,Z;return y=void 0===y||y,b=void 0===b||b,R((function(t){switch(t.g){case 1:if(_=i.segments||[],T=_.every((function(e){return!!Sy(e.ea,"EXT-X-GAP")})),!_.length||T)throw new Ue(2,4,4053);if(function(e,t){var n=Sy(t.ea,"EXT-X-PLAYLIST-TYPE");t=Sy(t.ea,"EXT-X-ENDLIST"),t=n&&"VOD"==n.value||t,n=n&&"EVENT"==n.value&&!t,n=!t&&!n,xb(e,t?Ob:n?Ub:jb)}(e,i),Tb(e)&&cb(e,i),A=Tb(e)?e.C.get(o):new Map,E=mb(e,i,A,n,r,o),I=E.segments,C=E.bandwidth,N=L=D=P=M=null,!(I.length>0&&y)){t.A(2);break}return w(t,function(e,t){var n,i,r,a,o,s,u,l,c,d,h,f,g,m,v,y;return R((function(b){if(1==b.g)return n=tl(e.g.hls.mediaPlaylistFullMimeType),t.length?(i=bb(e,t),r=i.segment,a=i.segmentIndex,o=r.P(),(s=Ac(o[0]))&&(u=Cb.get(s))?b.return(tl(u)):w(b,Promise.all([Gy(e,r.ba,0),Gy(e,r,a)]),2)):b.return(n);if(l=b.h,c=l[1].mimeType,d=l[0].data,h=l[1].data,f="mp4 mp4a m4s m4i m4a m4f cmfa mp4v m4v cmfv fmp4".split(" "),g=["audio/mp4","video/mp4","video/iso.segment"],!(m=r.ba||g.includes(c))&&Es(Le(h))){var _=h,S=e.g.disableAudio,T=e.g.disableVideo,x=e.g.disableText,k=Le(_),A=(new Ts).parse(k),E=A.Vd();k=A.Jg();var I=[],C=!1,M=!1;if(!S)switch(E.audio){case"aac":case"aac-loas":A.ub().length&&(I.push("mp4a.40.2"),C=!0);break;case"mp3":A.ub().length&&(I.push("mp4a.40.34"),C=!0);break;case"ac3":A.ub().length&&(I.push("ac-3"),C=!0);break;case"ec3":A.ub().length&&(I.push("ec-3"),C=!0);break;case"opus":A.ub().length&&(I.push("opus"),C=!0)}if(!T)switch(E.video){case"avc":k.codec?I.push(k.codec):I.push("avc1.42E01E"),M=!0;break;case"hvc":k.codec?I.push(k.codec):I.push("hvc1.1.6.L93.90"),M=!0;break;case"av1":I.push("av01.0.01M.08"),M=!0}if(I.length){if(S=C&&!M,T=new Map,M&&!x){for((x=new Tt("video/mp2t")).xf(_),M=(_=p(x.Vf())).next();!M.done;M=_.next())M=M.value,T.set(M,M);x.Nd()}k={type:S?"audio":"video",mimeType:"video/mp2t",codecs:I.join(", "),language:null,height:k.height,width:k.width,channelCount:null,sampleRate:null,closedCaptions:T,ve:null,colorGamut:null,frameRate:k.frameRate}}else k=null;if(v=k)return b.return(v)}else if((m||f.includes(s))&&(y=nl(d,h,e.g.disableText)))return b.return(y);return c?b.return(tl(c)):b.return(n)}))}(e,I),3);case 3:O=t.h,o!=O.type&&Tb(e)&&(e.C.set(O.type,e.C.get(o)),e.C.set(o,new Map)),o=O.type,s=O.language,c=O.channelCount,g=O.sampleRate,e.g.disableText||(d=O.closedCaptions),P=O.height,M=O.width,D=O.ve,L=O.colorGamut,N=O.frameRate,b&&(v=O.mimeType,a=O.codecs);case 2:if(v){t.A(4);break}return w(t,function(e,t,n,i){var r,a,o,s,u,l,c,d,h,f,p,g,m;return R((function(v){switch(v.g){case 1:return r=Kr,a=bb(e,i),2==(o=a.segment).status?v.return(yb(t)):(u=o.P(),(l=Ac(u[0]))&&(c=Lb.get(t),(d=c.get(l))||(d=Cb.get(l)))?v.return(d):(s=vb(t,n))?v.return(s):(f=1,p=Vr(u,e.g.retryParameters),S(v,2),p.method="HEAD",w(v,kb(e,p,r,{type:f}).promise,4)));case 4:g=v.h,h=g.headers["content-type"],x(v,3);break;case 2:if(!(m=k(v))||1002!=m.code&&1001!=m.code){v.A(3);break}return p.method="GET",e.g.hls.allowRangeRequestsToGuessMimeType&&(p.headers.Range="bytes=0-0"),w(v,kb(e,p,r,{type:f}).promise,6);case 6:g=v.h,h=g.headers["content-type"];case 3:if(!h){v.A(7);break}if("application/octet-stream"!=(s=h.toLowerCase().split(";")[0])){v.A(8);break}if(g.data.byteLength){v.A(9);break}return p.method="GET",w(v,kb(e,p,r,{type:f}).promise,10);case 10:g=v.h;case 9:Es(Le(g.data))&&(s="video/mp2t");case 8:if("application/octet-stream"!=s)return v.return(s);case 7:return v.return(yb(t))}}))}(e,o,a,I),5);case 5:v=t.h,o!=ut||a||"application/mp4"!=v||!I[0]||I[0].ba||(v="text/vtt");case 4:return w(t,sb(e,i,v,r,n),6);case 6:if(j=t.h,U=j.drmInfos,F=j.keyIds,B=j.encrypted,H=j.Lh,B&&!U.length&&!H)throw new Ue(2,4,4026);return(V=ob(e,a,o,s,u,l,c,d,h,f,g,m)).encrypted=B&&!H,V.drmInfos=U,V.keyIds=F,V.mimeType=v,C&&(V.bandwidth=C),Ky(V),"video"==o&&(M||P||D||L)&&wb(V,M,P,N,D,null,L),Tb(e)&&cb(e,i),q=I[0].startTime,G=I[I.length-1],z=G.endTime,$=new Mu(I),V.segmentIndex=$,W=!!(K=Sy(i.ea,"EXT-X-SERVER-CONTROL"))&&null!=gy(K,"CAN-SKIP-UNTIL"),X=!!K&&null!=gy(K,"CAN-BLOCK-RELOAD"),Y=Ty(i.ea,"EXT-X-MEDIA-SEQUENCE",0),J=ab(Y,I),Q=J.Qb,Z=J.Rb,t.return({stream:V,type:o,Af:[],P:r,Wc:q,Lc:z,Se:W,Re:X,Yd:!1,og:-1,Qb:Q,Rb:Z,mf:A})}}))}function ab(e,t){e=e+t.length-1;var n=-1;if(!t.length)return{Qb:++e,Rb:n};var i=(t=t[t.length-1]).g;return t.g.length?(n=i.length-1,i[i.length-1].isPreload()||(e++,n=0),{Qb:e,Rb:n}):(e++,t.o&&(n=0),{Qb:e,Rb:n})}function ob(e,t,n,i,r,a,o,s,u,l,c,d){var h=vb(n,t)||yb(n),f=[];if(u)for(var g=(u=p(u.split(","))).next();!g.done;g=u.next())f.push(g.value);return u=void 0,g=null,n==ut?u=f.includes("public.accessibility.transcribes-spoken-dialog")&&f.includes("public.accessibility.describes-music-and-sound")?"caption":"subtitle":f.includes("public.accessibility.describes-video")&&(g="visually impaired"),f.length||"subtitle"!==u||f.push("subtitle"),Ky(e={id:e.G++,originalId:a,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:h,codecs:t,kind:n==ut?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:Pi(i||"und"),originalLanguage:i,label:a,type:n,primary:r,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:f,forced:l,channelsCount:o,audioSamplingRate:c,spatialAudio:d,closedCaptions:s,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:g,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null}),e}function sb(e,t,n,i,r){var a,o,s,u,l,c,d,h,f,g,m,v,y,b,_,S,T,x,k,A,E,I,C,M,P,D,L,N,O;return R((function(R){switch(R.g){case 1:if(a=new Map,!e.g.ignoreDrmInfo&&t.segments)for(o=p(t.segments),s=o.next();!s.done;s=o.next())if(u=s.value,l=wy(u.ea,"EXT-X-KEY"),c=null,l.length)for(c=hb(e,t,u.ea,i,r),d=p(l),h=d.next();!h.done;h=d.next())f=h.value,a.set(f,c);m=g=!1,v=[],y=new Set,b=p(a),_=b.next();case 2:if(_.done){R.A(4);break}if(S=_.value,T=p(S),x=T.next().value,k=T.next().value,E=k,"NONE"==(I=vy(A=x,"METHOD"))){R.A(3);break}if(g=!0,C=my(A,"KEYFORMAT")||"identity",M=null,Ab(I)){m=!0,R.A(3);break}if("identity"==C)return w(R,Eb(e,A,n,i,E,r),11);if(!(P=e.uc.get(C))){D=null,R.A(9);break}return w(R,P(A,n,E),10);case 10:D=R.h;case 9:M=D,R.A(6);break;case 11:M=R.h;case 6:if(M){if(M.keyIds)for(L=p(M.keyIds),N=L.next();!N.done;N=L.next())O=N.value,y.add(O);v.push(M)}case 3:_=b.next(),R.A(2);break;case 4:return R.return({drmInfos:v,keyIds:y,encrypted:g,Lh:m})}}))}function ub(t,n,i,r,a){if(!e.crypto||!e.crypto.subtle)throw $("Web Crypto API is not available to decrypt AES. (Web Crypto only exists in secure origins like https)"),new Ue(2,4,4042);var o=0,s=my(n,"IV","");if(s){var u=Ze(s.substr(2));if(16!=u.byteLength)throw new Ue(2,4,4048)}else o=Ty(i.ea,"EXT-X-MEDIA-SEQUENCE",0);var l=xy(r(),vy(n,"URI"),a),c=l.sort().join("");if(i=n.toString()+"-"+o+"-"+c,!t.va.has(i)){var d={bitsKey:128,blockCipherMode:"CBC",iv:u,firstMediaSequenceNumber:o};switch(vy(n,"METHOD")){case"AES-256":d.bitsKey=256;break;case"AES-256-CTR":d.bitsKey=256,d.blockCipherMode="CTR"}d.fetchKey=function(){var n,i,r,a;return R((function(o){if(1==o.g)return t.O.has(c)||(n=Vr(l,t.g.retryParameters),i=kb(t,n,6).promise,t.O.set(c,i)),w(o,t.O.get(c),2);if(3!=o.g){if(!(r=o.h).data||r.data.byteLength!=d.bitsKey/8)throw new Ue(2,4,4049);return a={name:"CTR"==d.blockCipherMode?"AES-CTR":"AES-CBC",length:d.bitsKey},w(o,e.crypto.subtle.importKey("raw",r.data,a,!0,["decrypt"]),3)}d.cryptoKey=o.h,d.fetchKey=void 0,_(o)}))},t.va.set(i,d)}return t.va.get(i)}function lb(e,t){null==e.u&&(t=Sy(t.ea,"EXT-X-START"))&&(e.u=Number(vy(t,"TIME-OFFSET")))}function cb(e,t){var n=1/0,i=t.segments;if(i.length)for(var r=i.length-1;r>=0;){var a=Sy(i[r].ea,"EXTINF");if(a){n=Number(a.value.split(",")[0]);break}r--}if(!(i=Sy(t.ea,"EXT-X-TARGETDURATION")))throw new Ue(2,4,4024,"EXT-X-TARGETDURATION");i=Number(i.value),(r=Sy(t.ea,"EXT-X-PART-INF"))&&(e.T=Number(vy(r,"PART-TARGET"))),t=Sy(t.ea,"EXT-X-SERVER-CONTROL"),e.oa&&e.T?(e.o=e.xc?5*e.T<=n?Math.min(e.T,e.o):Math.min(n,e.o):Math.min(e.T,e.o),e.ab=t?Number(vy(t,"PART-HOLD-BACK")):0):(e.o=Math.min(n,e.o),n=t?gy(t,"HOLD-BACK"):null,e.Sa=n?Number(n.value):0),e.ib=Math.max(i,e.ib)}function db(e,t){var n=0;if(e.g.defaultPresentationDelay)n=e.g.defaultPresentationDelay;else if(e.ab)n=e.ab;else if(e.Sa)n=e.Sa;else for(var i=t.segments.length,r=i-Math.min(i,e.g.hls.liveSegmentsDelay);r<i;r++){var a=Sy(t.segments[r].ea,"EXTINF");n=a?n+Number(a.value.split(",")[0]):n+e.ib}e.u&&e.u<0&&(n=Math.min(-e.u,n),e.u+=n),e.l.Qi(0),e.l.nh(n),e.l.cd(!1)}function hb(e,t,n,i,r){var a=Sy(n,"EXT-X-MAP");if(!a)return null;var o=vy(a,"URI"),s=xy(i(),o,r);if(o=[s.toString(),my(a,"BYTERANGE","")].join("-"),!e.Da.has(o)){for(var u=void 0,l=null,c=!1,d=(n=p(n)).next();!d.done;d=n.next())"EXT-X-KEY"==(d=d.value).name?Ab(c=vy(d,"METHOD"))&&d.id<a.id?(c=!1,u=ub(e,d,t,i,r)):c="NONE"!=c:"EXT-X-BYTERANGE"==d.name&&d.id<a.id&&(l=d);t=function(e,t,n,i,r){var a=0,o=null;return t=my(t,"BYTERANGE"),!t&&n&&(t=n.value),t&&(a=t.split("@"),o=Number(a[0]),a=Number(a[1]),o=a+o-1,i&&(n=o+1-a,n%16&&(o+=16-n%16))),new jo((function(){return e}),a,o,null,null,null,i,r)}(s,a,l,u,c),e.Da.set(o,t)}return e.Da.get(o)}function fb(t,n,i,r,a,o,s,u,l,c){var d=r.ea,h=Sy(d,"EXTINF"),f=0,g=0,m=null;r.vc.length&&(t.m.isLowLatency=!0);var v=null;if(i&&i.h)v=i.h+i.endTime-i.startTime;else if(!t.g.hls.ignoreManifestProgramDateTime){var y=Sy(d,"EXT-X-PROGRAM-DATE-TIME");y&&y.value&&(v=rn(y.value),t.kb=!0)}var b=Vo;if(Sy(d,"EXT-X-GAP")&&(t.m.gapCount++,b=2),!h){if(0==r.vc.length)throw new Ue(2,4,4024,"EXTINF");if(!t.oa)return null}var w=[];y=!1;var _=null,S=!1,T=!1;if(t.oa&&r.vc.length){f=n&&e.ReadableStream&&t.g.hls.allowLowLatencyByteRangeOptimization;for(var x=v,k={},A=0;A<r.vc.length;k={Qf:void 0,ke:void 0},A++){var E=r.vc[A],I=0==A?i:w[w.length-1],C=0==A?a:I.endTime,M=Number(my(E,"DURATION"))||t.T;if(M){var P=C+M,R=0,D=null;if("EXT-X-PRELOAD-HINT"==E.name?(R=(R=my(E,"BYTERANGE-START"))?Number(R):0,(I=my(E,"BYTERANGE-LENGTH"))?D=R+Number(I)-1:R&&(D=Number.MAX_SAFE_INTEGER)):(R=(D=p(pb(I,R=my(E,"BYTERANGE")))).next().value,D=D.next().value),k.ke=my(E,"URI"),k.ke){I=Vo,"YES"==my(E,"GAP")&&(t.m.gapCount++,I=2,S=!0),k.Qf=null;var L=function(e){return function(){return null==e.Qf&&(e.Qf=xy(u(),e.ke,o)),e.Qf}}(k);f&&R>=0&&null!=D&&(_=L,y=!0),C=new Fo(C,P,L,R,D,n,0,0,1/0,[],"",null,x,I,c),"EXT-X-PRELOAD-HINT"==E.name&&(C.Qg(),T=!0),"YES"!=my(E,"INDEPENDENT")&&A>0&&C.wd(),(E=l)||(w.length&&w[0].mimeType?E=w[0].mimeType:k.ke&&(k=Ac(k.ke),E=Lb.get(s).get(k)||null)),E&&(C.mimeType=E,Nb.has(E)&&(C.ba=null)),w.push(C),x&&(x+=M)}}}}if(h){if(0==(h=Number(h.value.split(",")[0])))return null;f=a+h}else{if(!w.length)return null;f=w[w.length-1].endTime}y&&(S||0!=w[0].startByte?(y=!1,_=null):w=[]),(h=Sy(d,"EXT-X-BYTERANGE"))?(g=(m=p(pb(i,h.value))).next().value,m=m.next().value):w.length&&(g=w[0].startByte,m=w[w.length-1].endByte),i="",h=null,"image"==s&&(i="1x1",s=Sy(d,"EXT-X-TILES"))&&(i=vy(s,"LAYOUT"),(s=my(s,"DURATION"))&&(h=Number(s)));var N=null;return n=new Fo(a,f,(function(){return _?_():(null==N&&(N=xy(u(),r.g,o)),N||[])}),g,m,n,0,0,1/0,w,i,h,v,b,c,w.length>0&&!!r.g),l&&(n.mimeType=l,Nb.has(l)&&(n.ba=null)),y&&(t.xc=!0,n.oi(),T&&n.Qg()),n}function pb(e,t){var n=0,i=null;return t&&(n=t.split("@"),t=Number(n[0]),i=(n=n[1]?Number(n[1]):e.endByte+1)+t-1),[n,i]}function gb(e,t,n,i,r){if("video"==n||"audio"==n){var a=e.l.m;if(a&&!ib(e,n))for(t=(t=wy(t,"EXT-X-DATERANGE")).filter((function(e){return null!=gy(e,"START-DATE")})).sort((function(e,t){return(e=vy(e,"START-DATE"))<(t=vy(t,"START-DATE"))?-1:e>t?1:0})),n=0;n<t.length;n++){var o=t[n];try{var s=rn(vy(o,"START-DATE"));if(!isNaN(s)){var u=Math.max(0,s-a),l=null,c=my(o,"END-DATE");if(c){var d=rn(c);if(!isNaN(d)&&(l=d-a)<0)continue}if(null==l){var h=my(o,"DURATION")||my(o,"PLANNED-DURATION");if(h){var f=parseFloat(h);if(isNaN(f)||(l=u+f),s-a+f<0)continue}}var g=my(o,"CLASS")||"com.apple.quicktime.HLS",m="YES"==my(o,"END-ON-NEXT");if(null==l&&m){for(var v=n+1;v<t.length;v++){if(g==(my(t[v],"CLASS")||"com.apple.quicktime.HLS")){var y=rn(vy(t[v],"START-DATE"));if(!isNaN(y)&&y&&y>s){l=Math.max(0,y-a);break}}}if(null==l)continue}v=["CLASS","START-DATE","END-DATE","DURATION","END-ON-NEXT"];for(var b=[],w=p(o.attributes),_=w.next();!_.done;_=w.next()){var S=_.value;if(!v.includes(S.name)){var T=Ay(S.value,i);"X-ASSET-URI"!=S.name&&"X-ASSET-LIST"!=S.name||(T=xy(r(),S.value,i)[0]),b.push({key:S.name,description:"",data:T,mimeType:null,pictureType:null})}}b.length>1&&e.h.onMetadata(g,u,l,b)}}catch(e){}}}}function mb(e,t,n,i,r,a){function o(e){if(!(e=Ac(e)))return null;var t=Lb.get(a).get(e);return t||(t=Cb.get(e)),t}var s=t.segments,u=null,l=null,c=null,d=null,h=void 0,f=Ty(t.ea,"EXT-X-DISCONTINUITY-SEQUENCE",-1),g=Ty(t.ea,"EXT-X-MEDIA-SEQUENCE",0),m=Sy(t.ea,"EXT-X-SKIP"),v=m?Number(my(m,"SKIPPED-SEGMENTS")):0,y=g+v,b=0;Tb(e)&&n.has(y)&&(b=n.get(y)),0===b&&e.Fa==Ub&&n.size>0&&!n.has(y)&&null!=e.l.i&&(b=e.l.Hb());var w=[],_=null;m=[];for(var S=0;S<s.length;S++){var T=s[S];(y=Sy(T.ea,"EXT-X-MAP"))&&y.id!==l&&(u=hb(e,t,T.ea,r,i),l=y.id);var x="";(y=T.g)&&(x=Ac(y)),x!==d&&(c=o(y),d=x),x=0==S?b:_.endTime,y=g+v+S,Sy(T.ea,"EXT-X-DISCONTINUITY")&&(f++,_&&_.ba&&(_.ba.g=x));for(var k=p(T.ea),A=k.next();!A.done;A=k.next())"EXT-X-KEY"==(A=A.value).name&&(h=Ab(vy(A,"METHOD"))?ub(e,A,t,r,i):void 0);if(n.set(y,x),x=fb(e,u,_,T,x,i,a,r,c,h)){if((_=Ty(T.ea,"EXT-X-BITRATE"))?(m.push({bitrate:_,duration:x.endTime-x.startTime}),x.bandwidth=_):x.endByte?(T=Bo(x))&&(T=8*T/(_=x.endTime-x.startTime)/1e3,m.push({bitrate:T,duration:_}),x.bandwidth=T):m.length&&((_=m.pop()).duration+=x.endTime-x.startTime,m.push(_),x.bandwidth=_.bitrate),x.bandwidth)for(T=(_=p(x.g)).next();!T.done;T=_.next())T.value.bandwidth=x.bandwidth;_=x,x.i=f,ib(e,a)&&null!=e.N&&y<e.N||w.push(x)}}if(t=void 0,m.length&&(t=m.reduce((function(e,t){return e+t.duration}),0),t=Math.round(m.reduce((function(e,t){return e+t.bitrate*t.duration}),0)/t*1e3)),m=w.some((function(e){return null!=e.h})))for(n={},i=0;i<w.length;n={We:void 0,Ve:void 0,Oe:void 0,Zc:void 0,Ne:void 0},i++)if(n.Zc=w[i],null==n.Zc.h)for(n.Ve=0,n.We=i,r=function(e){return function(){var t=w[e.We];if(t){if(null!=t.h)return t.h+e.Ve;e.Ve-=t.endTime-t.startTime,e.We+=1}return null}}(n),n.Ne=0,n.Oe=i,s=function(e){return function(){var t=w[e.Oe];if(t){if(t!=e.Zc&&(e.Ne+=t.endTime-t.startTime),null!=t.h)return t.h+e.Ne;--e.Oe}return null}}(n);null==n.Zc.h;)n.Zc.h=s(),null==n.Zc.h&&(n.Zc.h=r());if(m)for(i=(n=p(w)).next();!i.done;i=n.next())for(i=(r=i.value).h,s=(r=p(r.g)).next();!s.done;s=r.next())(s=s.value).h=i,i+=s.endTime-s.startTime;if(n=e.ma,m&&n!=1/0&&!ib(e,a))for(m=(e=p(w)).next();!m.done;m=e.next())m.value.yh(n);return{segments:w,bandwidth:t}}function vb(e,t){if(e==ut){if("vtt"==t||"wvtt"==t)return"text/vtt";if(t&&""!==t)return"application/mp4"}return"image"!=e||t&&"jpeg"!=t?"audio"==e&&"mp4a.40.34"==t?"audio/mpeg":"mjpg"==t?"application/mp4":null:"image/jpeg"}function yb(e){return e==ut?"text/vtt":Lb.get(e).get("mp4")}function bb(e,t){for(var n=t[e=Tb(e)?Math.trunc((t.length-1)/2):0];2==n.Jc()&&e+1<t.length;)n=t[++e];return{segment:n,segmentIndex:e}}function wb(e,t,n,i,r,a,o){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(i)||void 0,e.hdr=r||void 0,e.videoLayout=a||void 0,e.colorGamut=o||void 0)}function _b(e,t,n){return kb(e,Vr(t,e.g.retryParameters),0,{type:n?2:3})}function Sb(e){var t,n,i,r,a,o;return R((function(s){switch(s.g){case 1:return e.h?(S(s,2),t=Date.now(),w(s,e.update(),4)):s.return();case 4:n=Date.now(),Tb(e)&&(i=(n-t)/1e3,e.Zb.sample(1,i),r=e.g.updatePeriod>0?e.g.updatePeriod:e.o,a=Math.max(0,r-V(e.Zb)),e.F.ia(a)),x(s,3);break;case 2:if(o=k(s),!e.h)return s.return();if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.h.onError(o),s.return();o.severity=1,e.h.onError(o),e.F.ia(.1);case 3:if(!e.h)return s.return();e.h.onManifestUpdated(),_(s)}}))}function Tb(e){return e.Fa!=Ob}function xb(e,t){e.Fa=t,e.l&&e.l.cd(!Tb(e)),Tb(e)||e.F.stop()}function kb(e,t,n,i){if(!e.$)throw new Ue(2,7,7001);return i||(i={}),i.isPreload=e.ac(),t=e.h.networkingEngine.request(n,t,i),Ur(e.$,t),t}function Ab(e){return"AES-128"==e||"AES-256"==e||"AES-256-CTR"==e}function Eb(t,n,i,r,a,o){var s,u,l,c,d,h,f,p,g,m,v;return R((function(y){switch(y.g){case 1:if("video/mp2t"==i)throw new Ue(2,4,4040);if("apple"===e.shakaMediaKeysPolyfill)throw new Ue(2,4,4041);if(s=vy(n,"METHOD"),!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(s))return y.return(null);if((u=xy(r(),vy(n,"URI"),o))[0].startsWith("data:text/plain;base64,")){l=et(Qe(u[0].split("data:text/plain;base64,").pop())),y.A(2);break}return c=u.sort().join(""),t.xa.has(c)||(d=Vr(u,t.g.retryParameters),h=kb(t,d,6).promise,t.xa.set(c,h)),w(y,t.xa.get(c),3);case 3:f=y.h,l=et(f.data);case 2:if(p="00000000000000000000000000000000",!a){y.A(4);break}return w(y,Ib(t,a),5);case 5:(g=y.h)&&(p=g);case 4:return(m=new Map).set(p,l),v="cenc","SAMPLE-AES"==s&&(v="cbcs"),y.return(rt(m,v))}}))}function Ib(e,t){var n,i,r;return R((function(a){return 1==a.g?(n=null,e.ya.has(t)?(n=e.ya.get(t),a.A(2)):(i=al(t.P(),t.Ic(),t.Gc(),e.g.retryParameters),w(a,kb(e,i,Kr,{type:0}).promise,3))):(2!=a.g&&(r=a.h,t.pe(r.data),n=function(e){var t=null;return(new ra).box("moov",aa).box("trak",aa).box("mdia",aa).box("minf",aa).box("stbl",aa).S("stsd",oa).box("encv",sa).box("enca",ua).box("sinf",aa).box("schi",aa).S("tenc",(function(e){(e=e.reader).Y(),e.Y(),e.Y(),e.Y(),e=e.Tb(16,!1),t=et(e)})).parse(e,!0),t}(r.data),e.ya.set(t,n)),a.return(n))}))}B("shaka.net.DataUriPlugin",Oy),Oy.parse=jy,Br("data",jy),(i=Fy.prototype).configure=function(e,t){var n=this.h&&e.updatePeriod!=this.g.updatePeriod&&e.updatePeriod>=0;this.g=e,t&&(this.ac=t),this.j&&this.j.configure(this.g),n&&this.m&&this.m.presentationTimeline.W()&&this.F.Jb()},i.start=function(e,t){var n,i=this;return R((function(r){return 1==r.g?(i.h=t,i.oa=t.isLowLatencyMode(),w(r,_b(i,[e]).promise,2)):3!=r.g?(n=r.h,i.H=n.uri,w(r,function(e,t){var n,i,r,a,o,s,u,l,c,d,h,f,m,v,y,b,T,x,A,E,I,C,M,P,D,L,N,O,j,U,F,B,H,V,q,G,z,$,K,W,X,Y,Q;return R((function(Z){switch(Z.g){case 1:return n=lt,i=Iy(e.Ta,t),r=wy(i.ea,"EXT-X-DEFINE"),a=[],o=[],s=[],e.l=new su(null,0),e.l.cd(!0),u=function(){return[e.H]},l=null,c=new Map,1==i.type?(e.R=!1,B=wy(i.ea,"EXT-X-DEFINE"),c=$y(e,B,e.H),l=n.Aa,H="",V=new Map,w(Z,rb(e,e.G++,c,i,u,"",l,H,!0,"Media Playlist",null,V,null,!1,null,!1),7)):(function(e,t){for(var n=new ge(e.H).g,i=(t=p(t)).next();!i.done;i=t.next()){var r=i.value;i=my(r,"NAME");var a=my(r,"VALUE");r=my(r,"QUERYPARAM"),i&&a&&(e.B.has(i)||e.B.set(i,a)),r&&(i=n.get(r)[0])&&!e.B.has(i)&&e.B.set(r,i)}}(e,r),d=wy(i.ea,"EXT-X-MEDIA"),h=wy(i.ea,"EXT-X-STREAM-INF"),f=wy(i.ea,"EXT-X-IMAGE-STREAM-INF"),m=wy(i.ea,"EXT-X-I-FRAME-STREAM-INF"),v=wy(i.ea,"EXT-X-SESSION-KEY"),y=wy(i.ea,"EXT-X-SESSION-DATA"),b=wy(i.ea,"EXT-X-CONTENT-STEERING"),function(e,t){for(var n=(t=p(t)).next();!n.done;n=t.next()){var i=n.value,r=my(i,"DATA-ID");n=my(i,"URI");var a=my(i,"LANGUAGE");i=my(i,"VALUE"),r=(new Map).set("id",r),n&&r.set("uri",xy([e.H],n,e.B)[0]),a&&r.set("language",a),i&&r.set("value",i),n=new Dr("sessiondata",r),e.h&&e.h.onEvent(n)}}(e,y),w(Z,function(e,t){var n,i,r,a,o,s;return R((function(u){if(!e.h||!e.g)return u.return();for(i=p(t),r=i.next();!r.done;r=i.next())if(a=r.value,o=my(a,"PATHWAY-ID"),s=my(a,"SERVER-URI"),o&&s){e.j=new Pm(e.h),e.j.configure(e.g),e.j.i=[e.H],e.j.setManifestType("HLS"),e.j.h=o,n=Rm(e.j,s);break}return w(u,n,0)}))}(e,b),4));case 4:if(!e.g.ignoreSupplementalCodecs){for(T=[],x=p(h),A=x.next(),E={};!A.done;E={Yi:void 0},A=x.next())I=A.value,(C=my(I,"SUPPLEMENTAL-CODECS"))&&(E.Yi=C.split(/\s*,\s*/).map((function(e){return e.split("/")[0]})),M=I.attributes.map(function(e){return function(t){var n=t.name,i=t.value;return"CODECS"==n&&(i=e.Yi.join(","),(t=t.value.split(",")).length>1&&(t=ot("audio",t))&&(i+=","+t)),new by(n,i)}}(E)),T.push(new fy(I.id,I.name,M,null)));for(h.push.apply(h,g(T)),P=[],D=p(m),L=D.next(),N={};!L.done;N={Zi:void 0},L=D.next())O=L.value,(j=my(O,"SUPPLEMENTAL-CODECS"))&&(N.Zi=j.split(/\s*,\s*/).map((function(e){return e.split("/")[0]})),U=O.attributes.map(function(e){return function(t){var n=t.name;return t=t.value,"CODECS"==n&&(t=e.Zi.join(",")),new by(n,t)}}(N)),P.push(new fy(O.id,O.name,U,null)));m.push.apply(m,g(P))}return function(e,t){for(var n=(t=p(t)).next();!n.done;n=t.next()){var i=n.value,r=my(i,"AUDIO");n=my(i,"VIDEO");var a=my(i,"SUBTITLES");if(i=Xy(e,i),a){var o=ot(ut,i);e.K.set(a,o),J(i,o)}r&&((a=ot("audio",i))||(a=e.g.hls.defaultAudioCodec),e.K.set(r,a)),n&&((r=ot("video",i))||(r=e.g.hls.defaultVideoCodec),e.K.set(n,r))}}(e,h),function(e,t){t=_y(t,"CLOSED-CAPTIONS"),e.R=0==t.length;for(var n=(t=p(t)).next();!n.done;n=t.next()){var i=n.value,r=my(i,"LANGUAGE");n=Pi(r||"und"),r||(r=my(i,"NAME"))&&(n=r),r=vy(i,"GROUP-ID"),i=vy(i,"INSTREAM-ID").replace("SERVICE","svc"),e.J.get(r)||e.J.set(r,new Map),e.J.get(r).set(i,n)}}(e,d),F=function(e,t){return t.map((function(t){return"video"!==(t=Qy(e,t)).stream.type?null:t.stream})).filter((function(e){return e}))}(e,m),w(Z,function(e,t,n,i,r,a,o){var s,u,l,c,d,h,f,m,v,y,b,_,S,T,x,k,A,E,I,C,M,P,D,L,N,O,j,U,F,B,H,V,q,G,z,$;return R((function(R){switch(R.g){case 1:if(s=[],u=new Set,e.g.ignoreDrmInfo||!(n.length>0)){R.A(2);break}l=p(n),c=l.next();case 3:if(c.done){R.A(2);break}if(d=c.value,h=vy(d,"METHOD"),f=my(d,"KEYFORMAT")||"identity",m=null,"NONE"==h){R.A(4);break}if(Ab(h)){v=xy(r(),vy(d,"URI"),a),y=v.sort().join(""),e.O.has(y)||(b=Vr(v,e.g.retryParameters),_=kb(e,b,6).promise,e.O.set(y,_)),R.A(4);break}if("identity"==f)return w(R,Eb(e,d,"",r,null,a),12);if(!(S=e.uc.get(f))){T=null,R.A(10);break}return w(R,S(d,"",null),11);case 11:T=R.h;case 10:m=T,R.A(6);break;case 12:m=R.h;case 6:if(m){if(m.keyIds)for(x=p(m.keyIds),k=x.next();!k.done;k=x.next())A=k.value,u.add(A);s.push(m)}case 4:c=l.next(),R.A(3);break;case 2:for(E={},I=p(t),C=I.next();!C.done;C=I.next())M=C.value,P=py(M,!e.j),E[P]?E[P].push(M):E[P]=[M];for(L in D=[],E)N=E[L],O=N[0],j=my(O,"FRAME-RATE"),U=Number(my(O,"AVERAGE-BANDWIDTH"))||Number(vy(O,"BANDWIDTH")),F=my(O,"RESOLUTION"),B=p(F?F.split("x"):[null,null]),H=B.next().value,V=B.next().value,q=my(O,"VIDEO-RANGE"),(G=my(O,"REQ-VIDEO-LAYOUT"))&&G.includes(",")&&(z=G.split(",").filter((function(e){return"CH-STEREO"==e||"CH-MONO"==e})),G=z[0]),G=G||"CH-MONO",$=Wy(e,N,i),D.push.apply(D,g(Yy(e,$.audio,$.video,U,H,V,j,q,G,s,u,o)));return R.return(D.filter((function(e){return null!=e})))}}))}(e,h,v,d,u,e.B,F),5);case 5:return a=Z.h,o=function(e,t){var n=_y(t,"SUBTITLES");t=n.map((function(t){if(e.g.disableText)return null;try{return Jy(e,[t],new Map).stream}catch(t){if(e.g.hls.ignoreTextStreamFailures)return null;throw t}}));for(var i=(n=p(n)).next();!i.done;i=n.next()){var r=vy(i.value,"GROUP-ID");if((i=e.K.get(r))&&(r=e.M.get(r)))for(var a=(r=p(r)).next();!a.done;a=r.next())(a=a.value).stream.codecs=i,a.stream.mimeType=vb(ut,i)||yb(ut),Ky(a.stream)}return t.filter((function(e){return e}))}(e,d),w(Z,function(e,t,n){var i,r;return R((function(a){return 1==a.g?(i=t.map((function(t){var n,i;return R((function(r){if(1==r.g)return e.g.disableThumbnails?r.return(null):(S(r,2),w(r,function(e,t){var n,i,r,a,o,s,u,l,c,d;return R((function(h){return 1==h.g?(n=vy(t,"URI"),i=my(t,"CODECS","jpeg")||"",e.i.has(n)?h.return(e.i.get(n)):(r=my(t,"LANGUAGE"),a=my(t,"NAME"),o=my(t,"CHARACTERISTICS"),s=Zy(e,e.G++,[n],i,"image",r,!1,a,null,null,o,!1,null,!1),(u=my(t,"RESOLUTION"))?w(h,s.stream.createSegmentIndex(),3):h.A(2))):(2!=h.g&&(l=Pu(s.stream.segmentIndex),(c=l.tilesLayout)&&(s.stream.width=Number(u.split("x")[0])*Number(c.split("x")[0]),s.stream.height=Number(u.split("x")[1])*Number(c.split("x")[1])),s.stream.closeSegmentIndex()),(d=my(t,"BANDWIDTH"))&&(s.stream.bandwidth=Number(d)),e.i.set(n,s),h.return(s))}))}(e,t),4));if(2!=r.g)return n=r.h,r.return(n.stream);if(i=k(r),e.g.hls.ignoreImageStreamFailures)return r.return(null);throw i}))})).concat(n.map((function(t){if(e.g.disableThumbnails)return null;try{var n=Qy(e,t);return"image"!==n.stream.type?null:n.stream}catch(t){if(e.g.hls.ignoreImageStreamFailures)return null;throw t}}))),w(a,Promise.all(i),2)):(r=a.h,a.return(r.filter((function(e){return e}))))}))}(e,f,m),6);case 6:s=Z.h,Z.A(3);break;case 7:q=Z.h,e.i.set(e.H,q),q.stream&&(G=Hu(q.stream),q.stream.segmentIndex.Fb((function(e){e.ba&&(e.ba.xd=G)}))),l=q.stream.type,z=!0,(e.g.disableAudio&&"audio"==q.type||e.g.disableVideo&&"video"==q.type&&!q.stream.codecs.includes(","))&&(z=!1),z&&a.push({id:0,language:Pi(H||"und"),disabledUntilTime:0,primary:!0,audio:"audio"==q.type?q.stream:null,video:"video"==q.type?q.stream:null,bandwidth:q.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.h)throw new Ue(2,7,7001);if(lb(e,i),1==i.type&&(Tb(e)&&(db(e,i),$=e.o,e.F.ia($)),K=Array.from(e.i.values()),nb(e,K),zy(e),gb(e,i.ea,l,c,u)),e.m={presentationTimeline:e.l,variants:a,textStreams:o,imageStreams:s,offlineSessionIds:[],sequenceMode:e.g.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:e.g.hls.ignoreManifestTimestampsInSegmentsMode,type:"HLS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:e.u},e.aa||!e.g.hls.disableCodecGuessing){Z.A(8);break}for(W=[],X=p(e.m.variants),Y=X.next();!Y.done;Y=X.next())(Q=Y.value).audio&&""===Q.audio.codecs&&W.push(Q.audio.createSegmentIndex()),Q.video&&""===Q.video.codecs&&W.push(Q.video.createSegmentIndex());return w(Z,Promise.all(W),8);case 8:e.h.makeTextStreamsForClosedCaptions(e.m),_(Z)}}))}(i,n.data),3)):r.return(i.m)}))},i.stop=function(){this.F&&(this.F.stop(),this.F=null);var e=[];return this.$&&(e.push(this.$.destroy()),this.$=null),this.g=this.h=null,this.ob.clear(),this.m=null,this.i.clear(),this.M.clear(),this.K.clear(),this.B.clear(),this.Da.clear(),this.va.clear(),this.O.clear(),this.xa.clear(),this.ya.clear(),this.I.clear(),this.j&&this.j.destroy(),this.V&&(this.V.release(),this.V=null),Promise.all(e)},i.update=function(){var e,t,n,i,r,a,o,s,u,l,c=this;return R((function(d){if(1==d.g){if(!Tb(c))return d.return();for(e=[],t=Array.from(c.i.values()),c.o=1/0,c.m.gapCount=0,n=t.filter((function(e){return!e.stream.isAudioMuxedInVideo&&e.stream.segmentIndex})),i=p(n),r=i.next();!r.done;r=i.next())a=r.value,e.push(Hy(c,a));return w(d,Promise.all(e),2)}for(tb(c,n.map((function(e){return e.stream}))),o=n.some((function(e){return 0==e.Yd})),n.length&&!o&&(xb(c,Ob),zy(c)),o&&zy(c),s=p(n),u=s.next();!u.done;u=s.next())(l=u.value).stream.isAudioMuxedInVideo||!l.stream.segmentIndex||Pu(l.stream.segmentIndex)||c.h.disableStream(l.stream);_(d)}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(e){this.j&&this.j.banLocation(e)},i.setMediaElement=function(e){this.X=e},B("shaka.hls.HlsParser",Fy);var Cb=(new Map).set("aac","audio/aac").set("ac3","audio/ac3").set("ec3","audio/ec3").set("mp3","audio/mpeg"),Mb=(new Map).set("mp4","audio/mp4").set("mp4a","audio/mp4").set("m4s","audio/mp4").set("m4i","audio/mp4").set("m4a","audio/mp4").set("m4f","audio/mp4").set("cmfa","audio/mp4").set("ts","video/mp2t").set("tsa","video/mp2t"),Pb=(new Map).set("mp4","video/mp4").set("mp4v","video/mp4").set("m4s","video/mp4").set("m4i","video/mp4").set("m4v","video/mp4").set("m4f","video/mp4").set("cmfv","video/mp4").set("ts","video/mp2t").set("tsv","video/mp2t"),Rb=(new Map).set("mp4","application/mp4").set("m4s","application/mp4").set("m4i","application/mp4").set("m4f","application/mp4").set("cmft","application/mp4").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml"),Db=(new Map).set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif"),Lb=(new Map).set("audio",Mb).set("video",Pb).set("text",Rb).set("image",Db),Nb=new Set(["video/mp2t"].concat(g(hi))),Ob="VOD",jb="EVENT",Ub="LIVE";function Fb(e){return Xg(e)}Ja("application/x-mpegurl",(function(){return new Fy})),Ja("application/vnd.apple.mpegurl",(function(){return new Fy}));var Bb=(new Map).set("com.microsoft.playready",Fb).set("com.microsoft.playready.recommendation",Fb).set("com.microsoft.playready.software",Fb).set("com.microsoft.playready.hardware",Fb);function Hb(){var e=this;this.h=this.g=null,this.l=[],this.j=null,this.u=1,this.i=null,this.F=new H(5),this.o=new Si((function(){!function(e){var t;R((function(n){switch(n.g){case 1:return S(n,2),w(n,Vb(e),4);case 4:x(n,3);break;case 2:t=k(n),e.h&&(t.severity=1,e.h.onError(t));case 3:if(!e.h)return n.return();_(n)}}))}(e)})),this.C=new jr,this.m=new Map,this.B=function(){return!1}}function Vb(e){var t,n,i,r,a,o,s;return R((function(u){if(1==u.g)return t=Vr(e.l,e.g.retryParameters),n=e.h.networkingEngine,i=Date.now(),r=n.request(0,t,{type:5,isPreload:e.B()}),Ur(e.C,r),w(u,r.promise,2);if(a=u.h,!e.h)return u.return();a.uri&&!e.l.includes(a.uri)&&e.l.unshift(a.uri);var l=a.uri,c=a.data,d=e.g.mss.manifestPreprocessor;if(d!=tc){if(ce("manifest.mss.manifestPreprocessor configuration","Please Use manifest.mss.manifestPreprocessorTXml instead."),!(c=bv(c,"SmoothStreamingMedia")))throw new Ue(2,4,4046,l);d(c),c=Ge(c.outerHTML)}var h=Vt(c,"SmoothStreamingMedia");if(!h)throw new Ue(2,4,4046,l);if((l=e.g.mss.manifestPreprocessorTXml)!=nc&&l(h),e.i||(e.i=new su(null,0)),l=Zt(h,"IsLive",dn,!1))throw new Ue(2,4,4047);e.i.cd(!l),d=Zt(h,"TimeScale",ln,1e7),c=Zt(h,"DVRWindowLength",ln),l&&(0===c||isNaN(c))&&(c=1/0);var f,m=Zt(h,"CanSeek",dn,!1);for(0===c&&m&&(c=1/0),m=null,c&&c>0&&(m=c/d),l&&!isNaN(e.g.availabilityWindowOverride)&&(m=e.g.availabilityWindowOverride),null==m&&(m=1/0),e.i.Hf(m),c=Zt(h,"Duration",ln,1/0),l||e.i.Ab(c/d),l={variants:[],textStreams:[],timescale:d,duration:c/d},m=Kt(h,"Protection"),d=e.g.mss.keySystemsBySystemId,c=[],f=(m=p(m)).next();!f.done;f=m.next())c=c.concat(Kt(f.value,"ProtectionHeader"));if(c.length){for(m=[],f=0;f<c.length;f++){var v=c[f],y=v.attributes.SystemID.toLowerCase(),b=d[y];if(b){var S;e:{if(S=Wg(v))for(var T=(S=p(Yt(S,"DATA"))).next();!T.done;T=S.next())if(T=Jt(T.value,"KID")){S=Qe(Wt(T)),S=et(S=new Uint8Array([S[3],S[2],S[1],S[0],S[5],S[4],S[7],S[6]].concat(g(S.slice(8)))));break e}S=null}y=it(b,"cenc",y=[{initData:ma(T=Qe(Wt(v)),y=Ze(y.replace(/-/g,"")),new Set,0),initDataType:"cenc",keyId:S}]),S&&y.keyIds.add(S),(b=Bb.get(b))&&(y.licenseServerUri=b(v)),m.push(y)}}d=m}else d=[];for(f=d,m=[],d=[],c=[],v=(h=p(h=Kt(h,"StreamIndex"))).next();!v.done;v=h.next()){b=Kt(v=v.value,"QualityLevel"),y=l.timescale,S=l.duration,T=Kt(v,"c");for(var x=[],k=0,A=0;A<T.length;++A){var E=T[A],I=T[A+1],C=Zt(E,"t",ln),M=Zt(E,"d",ln);if(E=Zt(E,"r",sn),!M)break;if(C=null!=C?C:k,(E=E||0)&&E--,E<0)if(I){if(null==(I=Zt(I,"t",ln)))break;if(C>=I)break;E=Math.ceil((I-C)/M)-1}else{if(S==1/0)break;if(C/y>=S)break;E=Math.ceil((S*y-C)/M)-1}for(I=0;I<=E;++I)k=C+M,x.push({start:C/y,end:k/y,Eh:C}),C=k}for(y=x,S=(b=p(b)).next();!S.done;S=b.next())(S=qb(e,v,S.value,y,f,l))&&("audio"!=S.type||e.g.disableAudio?"video"!=S.type||e.g.disableVideo?S.type!=ut||e.g.disableText||c.push(S):d.push(S):m.push(S))}for(h=[],f=(m=p(m.length>0?m:[null])).next();!f.done;f=m.next())for(f=f.value,x=(v=p(d.length>0?d:[null])).next();!x.done;x=v.next())y=(b=h).push,S=e,T=f,x=x.value,A=0,T&&T.bandwidth&&T.bandwidth>0&&(A+=T.bandwidth),x&&x.bandwidth&&x.bandwidth>0&&(A+=x.bandwidth),S={id:S.u++,language:T?T.language:"und",disabledUntilTime:0,primary:!!T&&T.primary||!!x&&x.primary,audio:T,video:x,bandwidth:A,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},y.call(b,S);l.variants=h,l.textStreams=c,e.j?(e.j.variants=l.variants,e.j.textStreams=l.textStreams,e.h.filter(e.j)):(e.j={presentationTimeline:e.i,variants:l.variants,textStreams:l.textStreams,imageStreams:[],offlineSessionIds:[],sequenceMode:e.g.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"MSS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null},e.i.lf()),Promise.resolve(),o=Date.now(),s=(o-i)/1e3,e.F.sample(1,s),_(u)}))}function qb(e,t,n,i,r,a){var o=t.attributes.Type;if("audio"!==o&&"video"!==o&&"text"!==o)return $("Ignoring unrecognized type:",o),null;var s=t.attributes.Language,u=e.u++,l=Zt(n,"Bitrate",un),c=Zt(n,"MaxWidth",un),d=Zt(n,"MaxHeight",un),h=Zt(n,"Channels",un),f=Zt(n,"SamplingRate",un),g=a.duration;i.length&&(g=i[i.length-1].end-i[0].start);var m=e.i.getDuration();e.i.Ab(Math.min(g,m)),(m=t.attributes.Name)&&(m+=n.attributes.Index),m||(m=String(u));var v={id:u,originalId:m,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:l||0,width:c||void 0,height:d||void 0,kind:"",encrypted:r.length>0,drmInfos:r,keyIds:new Set,language:Pi(s||"und"),originalLanguage:s,label:"",type:"",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:h,audioSamplingRate:f,spatialAudio:!1,closedCaptions:null,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:g,timescale:a.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null};if((r=t.attributes.Subtype)&&((r=zb.get(r))&&v.roles.push(r),"main"===r&&(v.primary=!0)),null!==(r=n.attributes.FourCC)&&""!==r||(r=t.attributes.FourCC),!r)if("audio"===o)r="AAC";else if("video"===o)return $('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;if(!Gb.includes(r.toUpperCase()))return $("Codec not supported:",r),null;switch(n=function(e,t,n,i){if(e=e.attributes.CodecPrivateData)return e;if("audio"!==t)return null;t=i.channelsCount||2,e=i.audioSamplingRate||44100;var r={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return i=r[e],"AACH"===n?(n=new Uint8Array(4),e=r[2*e],n[0]=40|i>>1,n[1]=i<<7|t<<3|e>>1,n[2]=e<<7|8,n[3]=0,t=new Uint16Array(2),t[0]=(n[0]<<8)+n[1],t[1]=(n[2]<<8)+n[3],t[0].toString(16)+t[1].toString(16)):(n=new Uint8Array(2),n[0]=16|i>>1,n[1]=i<<7|t<<3,t=new Uint16Array(1),t[0]=(n[0]<<8)+n[1],t[0].toString(16))}(n,o,r,v),v.mssPrivateData.codecPrivateData=n,o){case"audio":if(!n)return $("Quality unsupported without CodecPrivateData",o),null;v.type="audio",v.mimeType="mss/audio/mp4",v.codecs=function(e,t){var n=0;return"AACH"===e&&(n=5),t?0===n&&(n=(248&parseInt(t.substr(0,2),16))>>3):(n=2,"AACH"===e&&(n=5)),"mp4a.40."+n}(r,n);break;case"video":if(!n)return $("Quality unsupported without CodecPrivateData",o),null;v.type="video",v.mimeType="mss/video/mp4",v.codecs=function(e){var t=/00000001[0-9]7/.exec(e);return t.length&&e?"avc1."+e.substr(e.indexOf(t[0])+10,6):""}(n);break;case"text":v.type=ut,v.mimeType="application/mp4",("TTML"===r||"DFXP"===r)&&(v.codecs="stpp")}return v.fullMimeTypes.add(ni(v.mimeType,v.codecs)),v.createSegmentIndex=function(){if(v.segmentIndex)return Promise.resolve();if(e.m.has(v.id))var n=e.m.get(v.id);else n=[],"video"==v.type&&(n=v.mssPrivateData.codecPrivateData.split("00000001").slice(1)),n=lo(new uo([n={id:v.id,type:v.type,codecs:v.codecs,encrypted:v.encrypted,timescale:v.mssPrivateData.timescale,duration:v.mssPrivateData.duration,Bb:n,Ga:new Uint8Array([]),Ra:new Uint8Array([]),Za:0,$a:0,data:null,stream:v}])),e.m.set(v.id,n);return n=function(e,t,n,i,r){var a=i.attributes.Url.replace("{bitrate}",String(n.bandwidth));i=[];for(var o=(r=p(r)).next(),s={};!o.done;s={Lf:void 0},o=r.next())s.Lf=o.value,i.push(new Fo(s.Lf.start,s.Lf.end,function(t){return function(){return nt(e.l,[a.replace("{start time}",String(t.Lf.Eh))])}}(s),0,null,t,0,0,n.mssPrivateData.duration));return i}(e,new jo((function(){return[]}),0,null,Hu(v),v.mssPrivateData.timescale,n,null,v.encrypted),v,t,i),v.segmentIndex=new Mu(n),Promise.resolve()},v.closeSegmentIndex=function(){v.segmentIndex&&(v.segmentIndex.release(),v.segmentIndex=null)},v}(i=Hb.prototype).configure=function(e,t){this.g=e,t&&(this.B=t)},i.start=function(e,t){var n=this;return R((function(i){if(1==i.g)return n.l=[e],n.h=t,w(i,Vb(n),2);if(!n.h)throw new Ue(2,7,7001);return i.return(n.j)}))},i.stop=function(){return this.g=this.h=null,this.l=[],this.j=null,null!=this.o&&(this.o.stop(),this.o=null),this.m.clear(),this.C.destroy()},i.update=function(){var e,t=this;return R((function(n){return 1==n.g?(S(n,2),w(n,Vb(t),4)):2!=n.g?x(n,0):(e=k(n),t.h&&e?(t.h.onError(e),void _(n)):n.return())}))},i.onExpirationUpdated=function(){},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},B("shaka.mss.MssParser",Hb);var Gb="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),zb=(new Map).set("CAPT","main").set("SUBT","alternate").set("DESC","main");function $b(e,t,n,i,r,a,o){if(n>=200&&n<=299&&202!=n||304==n)return{uri:r||i,originalUri:i,data:t,status:n,headers:e,fromCache:!!e["x-shaka-from-cache"],originalRequest:a};a=null;try{a=qe(t)}catch(e){}throw new Ue(401==n||403==n?2:1,1,1001,i,n,a,e,o,r||i)}function Kb(){}function Wb(e,t,n,i,r,a){var o=new Zb;try{Zr(t.headers).forEach((function(e,t){o.append(t,e)}))}catch(t){return Ir(new Ue(1,1,1002,e,t,n))}var s=new Jb,u={Ph:!1,cj:!1};if(e=function(e,t,n,i,r,a,o,s,u){var l,c,d,h,f,p,g,m,v,y,b,T,A,E;return R((function(I){switch(I.g){case 1:return l=Yb,c=Qb,h=new ArrayBuffer(0),p=f=0,g={},m=Date.now(),S(I,2),w(I,l(e,i),4);case 4:if(d=I.h,g=function(e){var t={};return e.forEach((function(e,n){t[n.trim()]=e})),t}(d.headers),o(g),"HEAD"==i.method){I.A(5);break}return y=(v=d.headers.get("Content-Length"))?parseInt(v,10):0,d.body?(b=d.clone().body.getReader(),new c({start:function(e){function t(){var n,i,r,o;return R((function(l){switch(l.g){case 1:return S(l,2),w(l,b.read(),4);case 4:n=l.h,x(l,3);break;case 2:return k(l),l.return();case 3:if(n.done){l.A(5);break}if(f+=n.value.byteLength,!s){l.A(5);break}return w(l,s(n.value),5);case 5:i=Date.now(),r=f-p,(i-m>100&&r>=u||n.done)&&(o=n.done?0:y-f,a(i-m,r,o),p=f,m=i),n.done?e.close():(e.enqueue(n.value),t()),_(l)}}))}t()}}),w(I,d.arrayBuffer(),8)):w(I,d.arrayBuffer(),9);case 8:h=I.h,I.A(5);break;case 9:h=I.h,T=Date.now(),a(T-m,h.byteLength,0);case 5:t.headers.Range&&(2==(A=t.headers.Range.replace("bytes=","").split("-").filter((function(e){return e})).map((function(e){return parseInt(e,10)}))).length&&h.byteLength!=A[1]-A[0]+1&&$("Payload length does not match range requested bytes",t,d)),x(I,3);break;case 2:if(E=k(I),r.Ph)throw new Ue(1,1,7001,e,n);if(r.cj)throw new Ue(1,1,1003,e,n);throw new Ue(1,1,1002,e,E,n);case 3:return I.return($b(g,h,d.status,e,d.url,t,n))}}))}(e,t,n,{body:t.body||void 0,headers:o,method:t.method,signal:s.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},u,i,r,t.streamDataCallback,a.minBytesForProgressEvents||0),e=new Er(e,(function(){return u.Ph=!0,s.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var l=new Si((function(){u.cj=!0,s.abort()}));l.ia(t/1e3),e.finally((function(){l.stop()}))}return e}function Xb(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!!e.Response&&(!!new Response("").body&&!(!e.fetch||"polyfill"in e.fetch||!e.AbortController))}Ja("application/vnd.ms-sstr+xml",(function(){return new Hb})),B("shaka.net.HttpFetchPlugin",Kb),Kb.isSupported=Xb,Kb.parse=Wb;var Yb=e.fetch,Jb=e.AbortController,Qb=e.ReadableStream,Zb=e.Headers;function ew(){}function tw(e,t,n,i,r,a){var o=new nw,s=Date.now(),u=0;return new Er(new Promise((function(l,c){o.open(t.method,e,!0),o.responseType="arraybuffer",o.timeout=t.retryParameters.timeout,o.withCredentials=t.allowCrossSiteCredentials;var d={};for(var h in o.onabort=function(){c(new Ue(1,1,7001,e,n))},o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.HEADERS_RECEIVED){for(var e=o.getAllResponseHeaders().trim().split("\r\n"),t={},n=(e=p(e)).next();!n.done;n=e.next())t[(n=n.value.split(": "))[0].toLowerCase()]=n.slice(1).join(": ");r(d=t)}},o.onload=function(r){var a=o.response;try{i(Date.now()-s,r.loaded-u,0);var h=$b(d,a,o.status,e,o.responseURL,t,n);l(h)}catch(e){c(e)}},o.onerror=function(t){c(new Ue(1,1,1002,e,t,n))},o.ontimeout=function(){c(new Ue(1,1,1003,e,n))},o.onprogress=function(e){var t=Date.now(),n=a.minBytesForProgressEvents||0,r=e.loaded-u;(t-s>100&&r>=n||e.lengthComputable&&e.loaded==e.total)&&(i(t-s,r,4==o.readyState?0:e.total-e.loaded),u=e.loaded,s=t)},t.headers)try{o.setRequestHeader(h.toLowerCase(),t.headers[h])}catch(t){throw new Ue(1,1,1002,e,t,n)}o.send(t.body)})),(function(){return o.abort(),Promise.resolve()}))}Xb()&&(Br("http",Wb,2,!0),Br("https",Wb,2,!0),Br("blob",Wb,2,!0)),B("shaka.net.HttpXHRPlugin",ew),ew.parse=tw;var nw=e.XMLHttpRequest;function iw(e,t,n,i,r){this.g=e,this.i=t,this.groupId=n,this.h=i,this.j=r}function rw(e){var t=e.Yb(!1);return t?Je(t):e.P().map((function(e){return"{"+encodeURI(e.split("#xywh=")[0])+"}"})).join("")+":"+e.startByte+":"+e.endByte}function aw(e,t){return al(e.g.P(),e.g.startByte,e.g.endByte,t.streaming.retryParameters)}function ow(){this.g=this.j=this.i=0,this.h=new Map,this.l=0}function sw(e,t){e.i+=t;var n=e.l;return e.l++,e.h.set(n,t),n}function uw(e){return 0==e.i?0:e.j/e.i}function lw(e){var t=this;this.u=e,this.i=new Map,this.h=new Yr((function(){return cw(t).catch((function(){}))})),this.j=[],this.o=function(){},this.m=function(){},this.g=new ow,this.l=!1}function cw(e){e.l=!0;var t=e.j.map((function(e){return e()}));return e.j=[],Promise.all(t)}function dw(e,t,n,i,r,a){Jr(e.h);var o=(e.i.get(t)||Promise.resolve()).then((function(){if(e.h.g)throw new Ue(2,9,7001);if(r){var t=Le(n);for(var o in(t=new ga(t)).data){var s=Number(o);e.m(t.data[s],t.g[s])}}return e.g.close(i,n.byteLength),e.o(uw(e.g),e.g.g),a(n)}));e.i.set(t,o)}function hw(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new Ar,e.onabort=function(e){e.preventDefault(),n.g.reject()},e.onerror=function(e){e.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}function fw(e,t){return new Promise((function(n,i){var r=e.h.openCursor();r.onerror=i,r.onsuccess=function(){var e;return R((function(i){if(1==i.g)return null==r.result?(n(),i.return()):(e=r.result,w(i,t(e.key,e.value,e),2));e.continue(),_(i)}))}}))}function pw(e){this.h=e,this.g=[]}function gw(e,t){return mw(e,t,"readwrite")}function mw(e,t,n){var i=new hw(n=e.h.transaction([t],n),t);return e.g.push(i),i.promise().then((function(){J(e.g,i)}),(function(){J(e.g,i)})),i}function vw(e,t,n){this.h=new pw(e),this.i=t,this.g=n}function yw(e){return Promise.reject(new Ue(2,9,9011,"Cannot add new value to "+e))}function bw(e,t,n,i){t=(e=gw(e.h,t)).store();for(var r=(n=p(n)).next(),a={};!r.done;a={Pg:void 0},r=n.next())a.Pg=r.value,t.delete(a.Pg).onsuccess=function(e){return function(){return i(e.Pg)}}(a);return e.promise()}function ww(e,t,n){var i,r,a,o,s,u,l;return R((function(c){if(1==c.g){for(i=mw(e.h,t,"readonly"),r=i.store(),a={},o=[],s=p(n),u=s.next(),l={};!u.done;l={Bf:void 0,gf:void 0},u=s.next())l.gf=u.value,l.Bf=r.get(l.gf),l.Bf.onsuccess=function(e){return function(){null==e.Bf.result&&o.push(e.gf),a[e.gf]=e.Bf.result}}(l);return w(c,i.promise(),2)}if(o.length)throw new Ue(2,9,9012,"Could not find values for "+o);return c.return(n.map((function(e){return a[e]})))}))}function _w(e){this.g=new pw(e)}function Sw(){this.g=new Map}function Tw(e){var t=null;if(e.g.forEach((function(e,n){e.getCells().forEach((function(e,i){e.hasFixedKeySpace()||t||(t={path:{Pb:n,bb:i},bb:e})}))})),t)return t;throw new Ue(2,9,9013,"Could not find a cell that supports add-operations")}function xw(e,t,n){if(!(e=e.g.get(t)))throw new Ue(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new Ue(2,9,9013,"Could not find cell with name "+n);return t}function kw(e,t){Aw.set(e,t)}Br("http",tw,1,!0),Br("https",tw,1,!0),Br("blob",tw,1,!0),ow.prototype.close=function(e,t){if(this.h.has(e)){var n=this.h.get(e);this.h.delete(e),this.j+=n,this.g+=t}},lw.prototype.destroy=function(){return this.h.destroy()},lw.prototype.queue=function(e,t,n,i,r){var a=this;Jr(this.h);var o=(this.i.get(e)||Promise.resolve()).then((function(){var e,o,s,u,l,c,d;return R((function(h){if(1==h.g)return w(h,function(e,t){var n,i,r,a;return R((function(o){return 1==o.g?(n=Kr,i=e.u.request(n,t),r=function(){return i.abort()},e.j.push(r),w(o,i.promise,2)):(a=o.h,J(e.j,r),o.return(a.data))}))}(a,t),2);if(e=h.h,a.h.g)throw new Ue(2,9,7001);if(i)for(u in o=Le(e),(s=new ga(o)).data)l=Number(u),c=s.data[l],d=s.g[l],a.m(c,d);return a.g.close(n,e.byteLength),a.o(uw(a.g),a.g.g),h.return(r(e))}))}));return this.i.set(e,o),o},hw.prototype.abort=function(){var e=this;return R((function(t){if(1==t.g){try{e.i.abort()}catch(e){}return S(t,2),w(t,e.g,4)}if(2!=t.g)return x(t,0);k(t),_(t)}))},hw.prototype.store=function(){return this.h},hw.prototype.promise=function(){return this.g},pw.prototype.destroy=function(){return Promise.all(this.g.map((function(e){return e.abort()})))},(i=vw.prototype).destroy=function(){return this.h.destroy()},i.hasFixedKeySpace=function(){return!0},i.addSegments=function(){return yw(this.i)},i.removeSegments=function(e,t){return bw(this,this.i,e,t)},i.getSegments=function(e){var t,n=this;return R((function(i){return 1==i.g?w(i,ww(n,n.i,e),2):(t=i.h,i.return(t.map((function(e){return n.Rh(e)}))))}))},i.addManifests=function(){return yw(this.g)},i.updateManifest=function(){return Promise.reject(new Ue(2,9,9016,"Cannot modify values in "+this.g))},i.updateManifestExpiration=function(e,t){var n=gw(this.h,this.g),i=n.store();return i.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,i.put(n,e))},n.promise()},i.removeManifests=function(e,t){return bw(this,this.g,e,t)},i.getManifests=function(e){var t,n=this;return R((function(i){return 1==i.g?w(i,ww(n,n.g,e),2):(t=i.h,i.return(Promise.all(t.map((function(e){return n.Rd(e)})))))}))},i.getAllManifests=function(){var e,t,n=this;return R((function(i){return 1==i.g?(e=mw(n.h,n.g,"readonly"),t=new Map,w(i,fw(e,(function(e,i){var r;return R((function(a){if(1==a.g)return w(a,n.Rd(i),2);r=a.h,t.set(e,r),_(a)}))})),2)):3!=i.g?w(i,e.promise(),3):i.return(t)}))},i.Rh=function(e){return e},i.Rd=function(e){return Promise.resolve(e)},i.add=function(e,t){var n,i,r,a,o,s,u,l=this;return R((function(c){if(1==c.g){for(n=gw(l.h,e),i=n.store(),r=[],a=p(t),o=a.next(),s={};!o.done;s={dh:void 0},o=a.next())u=o.value,s.dh=i.add(u),s.dh.onsuccess=function(e){return function(){r.push(e.dh.result)}}(s);return w(c,n.promise(),2)}return c.return(r)}))},_w.prototype.destroy=function(){return this.g.destroy()},_w.prototype.getAll=function(){var e,t,n=this;return R((function(i){return 1==i.g?(e=mw(n.g,"session-ids","readonly"),t=[],w(i,fw(e,(function(e,n){t.push(n)})),2)):3!=i.g?w(i,e.promise(),3):i.return(t)}))},_w.prototype.add=function(e){for(var t=gw(this.g,"session-ids"),n=t.store(),i=(e=p(e)).next();!i.done;i=e.next())n.add(i.value);return t.promise()},_w.prototype.remove=function(e){var t,n=this;return R((function(i){return 1==i.g?w(i,fw(t=gw(n.g,"session-ids"),(function(t,n,i){e.includes(n.sessionId)&&i.delete()})),2):w(i,t.promise(),0)}))},Sw.prototype.destroy=function(){for(var e=[],t=p(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},Sw.prototype.init=function(){var e=this;Aw.forEach((function(t,n){(t=t())&&e.g.set(n,t)}));for(var t=[],n=p(this.g.values()),i=n.next();!i.done;i=n.next())t.push(i.value.init());return Promise.all(t)},B("shaka.offline.StorageMuxer",Sw),Sw.unregister=function(e){Aw.delete(e)},Sw.register=kw,Sw.prototype.destroy=Sw.prototype.destroy;var Aw=new Map;function Ew(){vw.apply(this,arguments)}function Iw(e,t){!function(e){var t=e.streams.filter((function(e){return"audio"==e.contentType}));if(e=e.streams.filter((function(e){return"video"==e.contentType})),!t.every((function(e){return e.variantIds}))||!e.every((function(e){return e.variantIds}))){for(var n=p(t),i=n.next();!i.done;i=n.next())i.value.variantIds=[];for(i=(n=p(e)).next();!i.done;i=n.next())i.value.variantIds=[];if(n=0,e.length&&!t.length){i=n++;for(var r=p(e),a=r.next();!a.done;a=r.next())a.value.variantIds.push(i)}if(!e.length&&t.length)for(i=n++,a=(r=p(t)).next();!a.done;a=r.next())a.value.variantIds.push(i);if(e.length&&t.length)for(i=(t=p(t)).next();!i.done;i=t.next())for(i=i.value,a=(r=p(e)).next();!a.done;a=r.next()){a=a.value;var o=n++;i.variantIds.push(o),a.variantIds.push(o)}}}(e);for(var n=p(e.streams),i=n.next();!i.done;i=n.next());return e.streams.map((function(n){return function(e,t,n){var i=e.initSegmentUri?Cw(e.initSegmentUri):null,r=t+e.presentationTimeOffset,a=t+n;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:i,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(e){var n=Cw(e.uri);return{startTime:t+e.startTime,endTime:t+e.endTime,dataKey:n,initSegmentKey:i,appendWindowStart:t,appendWindowEnd:a,timestampOffset:r,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}(n,e.startTime,t)}))}function Cw(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new Ue(2,9,9004,"Could not parse uri "+e)}function Mw(){vw.apply(this,arguments)}function Pw(e,t,n){return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(i){return{startTime:t+i.startTime,endTime:t+i.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:i.dataKey,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}}function Rw(){vw.apply(this,arguments)}function Dw(){this.m=this.j=this.i=this.h=this.g=this.l=null}h(Ew,vw),Ew.prototype.updateManifestExpiration=function(e,t){var n,i,r,a=this;return R((function(o){return n=gw(a.h,a.g),i=n.store(),r=new Ar,i.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,i.put(n),r.resolve()):r.reject(new Ue(2,9,9012,"Could not find values for "+e))},w(o,Promise.all([n.promise(),r]),0)}))},Ew.prototype.Rd=function(e){var t,n,i,r,a,o;return R((function(s){if(1==s.g){for(t=[],n=0;n<e.periods.length;++n)i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime,a=Iw(e.periods[n],r),t.push(a);return w(s,Um(t),2)}return o=s.h,s.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:o,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})}))},Ew.prototype.Rh=function(e){return{data:e.data}},h(Mw,vw),Mw.prototype.Rd=function(e){var t,n,i,r,a,o;return R((function(s){if(1==s.g){for(t=[],n=0;n<e.periods.length;++n){i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,r=i-e.periods[n].startTime;for(var u=e.periods[n],l=[],c=p(u.streams),d=c.next();!d.done;d=c.next())0!=(d=d.value).variantIds.length&&l.push(Pw(d,u.startTime,u.startTime+r));a=l,t.push(a)}return w(s,Um(t),2)}return o=s.h,s.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:o,sequenceMode:!1})}))},h(Rw,vw),(i=Rw.prototype).hasFixedKeySpace=function(){return!1},i.addSegments=function(e){return this.add(this.i,e)},i.addManifests=function(e){return this.add(this.g,e)},i.updateManifest=function(e,t){return function(e,t,n){var i=(e=gw(e.h,e.g)).store();return i.get(t).onsuccess=function(){i.put(n,t)},e.promise()}(this,e,t)},i.Rd=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},(i=Dw.prototype).init=function(){var t=this,n=new Ar,i=!1,r=new Si((function(){i=!0,n.reject(new Ue(2,9,9017))}));"number"==typeof Lw&&Lw>0&&r.ia(Lw);var a=e.indexedDB.open("shaka_offline_db",5);return a.onsuccess=function(){if(!i){r.stop();var e=a.result;t.l=e;var o=e.objectStoreNames;o=o.contains("manifest")&&o.contains("segment")?new Ew(e,"segment","manifest"):null,t.g=o,o=(o=e.objectStoreNames).contains("manifest-v2")&&o.contains("segment-v2")?new Mw(e,"segment-v2","manifest-v2"):null,t.h=o,o=(o=e.objectStoreNames).contains("manifest-v3")&&o.contains("segment-v3")?new Mw(e,"segment-v3","manifest-v3"):null,t.i=o,o=(o=e.objectStoreNames).contains("manifest-v5")&&o.contains("segment-v5")?new Rw(e,"segment-v5","manifest-v5"):null,t.j=o,e=e.objectStoreNames.contains("session-ids")?new _w(e):null,t.m=e,n.resolve()}},a.onupgradeneeded=function(){for(var e=a.result,t=p(["segment-v5","manifest-v5","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},a.onerror=function(e){i||(r.stop(),n.reject(new Ue(2,9,9001,a.error)),e.preventDefault())},n},i.destroy=function(){var e=this;return R((function(t){switch(t.g){case 1:if(!e.g){t.A(2);break}return w(t,e.g.destroy(),2);case 2:if(!e.h){t.A(4);break}return w(t,e.h.destroy(),4);case 4:if(!e.i){t.A(6);break}return w(t,e.i.destroy(),6);case 6:if(!e.j){t.A(8);break}return w(t,e.j.destroy(),8);case 8:if(!e.m){t.A(10);break}return w(t,e.m.destroy(),10);case 10:e.l&&e.l.close(),_(t)}}))},i.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},i.getEmeSessionCell=function(){return this.m},i.erase=function(){var t=this;return R((function(n){switch(n.g){case 1:if(!t.g){n.A(2);break}return w(n,t.g.destroy(),2);case 2:if(!t.h){n.A(4);break}return w(n,t.h.destroy(),4);case 4:if(!t.i){n.A(6);break}return w(n,t.i.destroy(),6);case 6:if(!t.j){n.A(8);break}return w(n,t.j.destroy(),8);case 8:return t.l&&t.l.close(),w(n,function(){var t=new Ar,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new Ue(2,9,9001,n.error)),e.preventDefault()},t}(),10);case 10:return t.l=null,t.g=null,t.h=null,t.i=null,t.j=null,w(n,t.init(),0)}}))};var Lw=5;function Nw(e,t,n,i){this.g=e,this.i=t,this.h=n,this.l=i,this.j=["offline:",e,"/",t,"/",n,"/",i].join("")}function Ow(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var i=e[3];return i&&null!=t?new Nw(t,n,i,Number(e[4])):null}function jw(e,t){this.h=e,this.g=t}function Uw(e,t){var n=new su(null,0);n.Ab(t.duration);var i=t.streams.filter((function(e){return"audio"==e.type})),r=t.streams.filter((function(e){return"video"==e.type}));i=function(e,t,n,i){for(var r=new Set,a=p(t),o=a.next();!o.done;o=a.next())for(var s=(o=p(o.value.variantIds)).next();!s.done;s=o.next())r.add(s.value);for(a=p(n),o=a.next();!o.done;o=a.next())for(o=p(o.value.variantIds),s=o.next();!s.done;s=o.next())r.add(s.value);for(a=new Map,r=p(r),o=r.next();!o.done;o=r.next())o=o.value,a.set(o,{id:o,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(t=p(t),r=t.next();!r.done;r=t.next())for(o=r.value,r=Fw(e,o,i),o=p(o.variantIds),s=o.next();!s.done;s=o.next())(s=a.get(s.value)).language=r.language,s.primary=s.primary||r.primary,s.audio=r;for(n=p(n),t=n.next();!t.done;t=n.next())for(r=t.value,t=Fw(e,r,i),r=p(r.variantIds),o=r.next();!o.done;o=r.next())(o=a.get(o.value)).primary=o.primary||t.primary,o.video=t;return a}(e,i,r,n),r=t.streams.filter((function(e){return e.type==ut})).map((function(t){return Fw(e,t,n)}));var a=t.streams.filter((function(e){return"image"==e.type})).map((function(t){return Fw(e,t,n)})),o=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var s=p(i.values()),u=s.next();!u.done;u=s.next())(u=u.value).audio&&u.audio.encrypted&&(u.audio.drmInfos=o),u.video&&u.video.encrypted&&(u.video.drmInfos=o);return{presentationTimeline:n,offlineSessionIds:t.sessionIds,variants:Array.from(i.values()),textStreams:r,imageStreams:a,sequenceMode:t.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:t.type||"UNKNOWN",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null}}function Fw(e,t,n){var i=t.segments.map((function(n){return function(e,t,n){var i=new Nw("segment",e.h,e.g,t.dataKey);return e=new Fo(t.startTime,t.endTime,(function(){return[i.toString()]}),0,null,null!=t.initSegmentKey?function(e,t){var n=new Nw("segment",e.h,e.g,t);return new jo((function(){return[n.toString()]}),0,null)}(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||""),e.mimeType=t.mimeType||n.mimeType||"",e.codecs=t.codecs||n.codecs||"",t.thumbnailSprite&&e.If(t.thumbnailSprite),e}(e,n,t)}));return n.ie(i),{id:t.id,originalId:t.originalId,groupId:t.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Mu(i),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,colorGamut:t.colorGamut,videoLayout:t.videoLayout,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,originalLanguage:t.originalLanguage||null,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout,mssPrivateData:t.mssPrivateData,accessibilityPurpose:null,external:t.external,fastSwitching:t.fastSwitching,fullMimeTypes:new Set([ni(t.mimeType,t.codecs)]),isAudioMuxedInVideo:!1,baseOriginalId:null}}function Bw(){this.g=null}function Hw(){}function Vw(e,t){var n=Ow(e);return n&&"manifest"==n.g?e=Mr(e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"},originalRequest:t}):e=n&&"segment"==n.g?function(e,t,n){var i=new Sw;return Mr(void 0).Xa((function(){return i.init()})).Xa((function(){return xw(i,t.Pb(),t.bb())})).Xa((function(e){return e.getSegments([t.key()])})).Xa((function(e){return{uri:t,data:e[0].data,headers:{},originalRequest:n}})).finally((function(){return i.destroy()}))}(n.key(),n,t):Ir(new Ue(2,1,9004,e)),e}function qw(e,t,n){var i,r,a,o,s,u;return R((function(l){switch(l.g){case 1:i=[];for(var c=[],d=p(n),h=d.next();!h.done;h=d.next()){h=h.value;for(var f=!1,g=p(c),m=g.next();!m.done;m=g.next())if(Gw((m=m.value).info,h)){m.sessionIds.push(h.sessionId),f=!0;break}f||c.push({info:h,sessionIds:[h.sessionId]})}r=p(c),a=r.next();case 2:if(a.done){l.A(4);break}return o=a.value,s=function(e,t,n){var i,r;return R((function(a){switch(a.g){case 1:return i=new va({tc:t,onError:function(){},vf:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),S(a,2),i.configure(e),w(a,function(e,t,n,i,r,a){var o,s,u,l,c;return R((function(d){return 1==d.g?(o=[],a.length&&o.push(a[0].contentType),r.length&&o.push(r[0].contentType),s=function(e){return(e=it(t,e,null)).licenseServerUri=n,e.serverCertificate=i,e.persistentStateRequired=!0,e.sessionType="persistent-license",e},(u=ur(o)).video&&(l=s(a[0].encryptionScheme||""),u.video.drmInfos.push(l)),u.audio&&(c=s(r[0].encryptionScheme||""),u.audio.drmInfos.push(c)),w(d,Gi([u],!0,e.O,[]),2)):(Jr(e.l),d.return(xa(e,[u])))}))}(i,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:x(a,3);break;case 2:return k(a),w(a,i.destroy(),5);case 5:return a.return([]);case 3:return r=[],w(a,Promise.all(n.sessionIds.map((function(e){return R((function(t){return 1==t.g?(S(t,2),w(t,function(e,t){var n,i,r;return R((function(a){return 1==a.g?w(a,Ea(e,t,{initData:null,initDataType:null}),2):3!=a.g?(n=a.h)?(i=[],(r=e.i.get(n))&&(r.Kb=new Ar,i.push(r.Kb)),i.push(n.remove()),w(a,Promise.all(i),3)):a.return():(e.i.delete(n),void _(a))}))}(i,e),4)):2!=t.g?(r.push(e),x(t,0)):(k(t),void _(t))}))}))),6);case 6:return w(a,i.destroy(),7);case 7:return a.return(r)}}))}(e,t,o),w(l,s,5);case 5:u=l.h,i=i.concat(u),a=r.next(),l.A(2);break;case 4:return l.return(i)}}))}function Gw(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&Q(e.audioCapabilities,t.audioCapabilities,n)&&Q(e.videoCapabilities,t.videoCapabilities,n)}function zw(e,t){var n=Uw(new jw(e.Pb(),e.bb()),t),i=t.appMetadata||{};return n=$w(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i,isIncomplete:t.isIncomplete||!1}}function $w(e){for(var t=[],n=tr(e.variants),i=(n=p(n)).next();!i.done;i=n.next())t.push(Wi(i.value));for(n=(e=p(e.textStreams)).next();!n.done;n=e.next())t.push(Xi(n.value));return t}function Kw(){this.g=new Map}function Ww(e,t){var n=t.audio,i=t.video;if(n&&!i&&e.g.set(n.id,n.bandwidth||t.bandwidth),!n&&i&&e.g.set(i.id,i.bandwidth||t.bandwidth),n&&i){var r=n.bandwidth||393216,a=i.bandwidth||t.bandwidth-r;a<=0&&(a=t.bandwidth),e.g.set(n.id,r),e.g.set(i.id,a)}}function Xw(e,t){e.g.set(t.id,t.bandwidth||2048)}function Yw(e,t){return null==(e=e.g.get(t))&&(e=0),e}function Jw(e){var t=this;if(e&&e.constructor!=Xd)throw new Ue(2,9,9008);this.g=this.h=null,e?(this.h=e.g,this.g=e.Wb()):(this.h=Ql(),this.g=new Fr,this.g.configure(this.h.networking)),this.i=[],this.l=[];var n=!e;this.j=new Yr((function(){var e,i,r,a,o;return R((function(s){switch(s.g){case 1:return w(s,Promise.all(t.l.map((function(e){return cw(e)}))),2);case 2:for(e=function(){},i=[],r=p(t.i),a=r.next();!a.done;a=r.next())o=a.value,i.push(o.then(e,e));return w(s,Promise.all(i),3);case 3:if(!n){s.A(4);break}return w(s,t.g.destroy(),4);case 4:t.h=null,t.g=null,_(s)}}))})),this.m=1e9}function Qw(){if(Xv(ae()))e:{for(var e=p(Aw.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function Zw(e){var t,n,i;return R((function(r){switch(r.g){case 1:return w(r,(t=new Sw).init(),2);case 2:return w(r,Tw(t),3);case 3:return n=r.h,i=new Nw("manifest",n.path.Pb,n.path.bb,e),w(r,t.destroy(),4);case 4:return w(r,(new Jw).remove(i.toString()),0)}}))}function e_(e,t,n,i,r,a){var o,s,u,l,c,d,h,f,g,m,v;return R((function(y){switch(y.g){case 1:for(o=!1,S(y,2),s=!0,u=p(n.streams),l=u.next();!l.done;l=u.next())for(c=l.value,d=p(c.segments),h=d.next();!h.done;h=d.next())f=h.value,null!=(g=f.pendingSegmentRefId?i[f.pendingSegmentRefId]:null)&&(f.dataKey=g,f.pendingSegmentRefId=void 0),null!=(g=f.pendingInitSegmentRefId?i[f.pendingInitSegmentRefId]:null)&&(f.initSegmentKey=g,f.pendingInitSegmentRefId=void 0),f.pendingSegmentRefId&&(s=!1),f.pendingInitSegmentRefId&&(s=!1);return n.size+=r,s&&(n.isIncomplete=!1),w(y,e.updateManifest(t,n),4);case 4:o=!0,a(),x(y,0);break;case 2:return m=k(y),w(y,Zw(t),5);case 5:if(o){y.A(6);break}return v=Object.values(i),w(y,e.removeSegments(v,(function(){})),6);case 6:throw m}}))}function t_(e){return e.variants.some((function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t}))}function n_(e){return e.variants.some((function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some((function(e){return e.initData&&e.initData.length}))}))}function i_(e,t,n,i){if(t.expiration=n.Wd(),n=Ta(n),t.sessionIds=i?n:[],t_(e)&&i&&!n.length)throw new Ue(2,9,9007)}function r_(e,t){for(var n=[],i=p(e.streams),r=i.next();!r.done;r=i.next())r=r.value,t&&"video"==r.type?n.push({contentType:ni(r.mimeType,r.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=r.type||n.push({contentType:ni(r.mimeType,r.codecs),robustness:e.drmInfo.audioRobustness});return n}function a_(e,t,n){return R((function(i){return w(i,function(e,t,n,i){var r,a,o;return R((function(s){return 1==s.g?i.drmInfo?(r=function(e){var t=Array.from(e.g.keys());if(!t.length)throw new Ue(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}(n),a=i.sessionIds.map((function(e){return{sessionId:e,keySystem:i.drmInfo.keySystem,licenseUri:i.drmInfo.licenseServerUri,serverCertificate:i.drmInfo.serverCertificate,audioCapabilities:r_(i,!1),videoCapabilities:r_(i,!0)}})),w(s,qw(t,e,a),2)):s.return():3!=s.g?(o=s.h,w(s,r.remove(o),3)):w(s,r.add(a.filter((function(e){return!o.includes(e.sessionId)}))),0)}))}(e.g,e.h.drm,n,t),0)}))}function o_(e,t,n){function i(){}var r=function(e){for(var t=new Set,n=(e=p(e.streams)).next();!n.done;n=e.next())for(var i=(n=p(n.value.segments)).next();!i.done;i=n.next())null!=(i=i.value).initSegmentKey&&t.add(i.initSegmentKey),t.add(i.dataKey);return Array.from(t)}(n);return zw(t,n),Promise.all([e.removeSegments(r,i),e.removeManifests([t.key()],i)])}function s_(e,t){var n;return R((function(i){switch(i.g){case 1:return S(i,2),w(i,kc(t,e.g,e.h.streaming.retryParameters),4);case 4:n=i.h,x(i,3);break;case 2:k(i);case 3:if(n)return i.return(n);throw new Ue(1,2,2011,t)}}))}function u_(e,t,n,i,r,a){var o={id:i.id,originalId:i.originalId,groupId:i.groupId,primary:i.primary,type:i.type,mimeType:i.mimeType,codecs:i.codecs,frameRate:i.frameRate,pixelAspectRatio:i.pixelAspectRatio,hdr:i.hdr,colorGamut:i.colorGamut,videoLayout:i.videoLayout,kind:i.kind,language:i.language,originalLanguage:i.originalLanguage,label:i.label,width:i.width||null,height:i.height||null,encrypted:i.encrypted,keyIds:i.keyIds,segments:[],variantIds:[],roles:i.roles,forced:i.forced,channelsCount:i.channelsCount,audioSamplingRate:i.audioSamplingRate,spatialAudio:i.spatialAudio,closedCaptions:i.closedCaptions,tilesLayout:i.tilesLayout,mssPrivateData:i.mssPrivateData,external:i.external,fastSwitching:i.fastSwitching,isAudioMuxedInVideo:i.isAudioMuxedInVideo},s=r.offline.numberOfParallelDownloads,u=0===s?i.id:0;return function(e,t,n){if(t=e.segmentIndex.find(t),null!=t)for(var i=e.segmentIndex.get(t);i;)n(i,t),i=e.segmentIndex.get(++t)}(i,n.presentationTimeline.Hb(),(function(n,r){var l=rw(n),c=void 0;if(!a.has(l)){var d=n.endTime-n.startTime;d=Yw(t,i.id)*d,d=sw(e.g,d),a.set(l,new iw(n,d,u,!1,r))}n.ba&&(c=rw(n.ba),a.has(c)||(d=.5*Yw(t,i.id),d=sw(e.g,d),a.set(c,new iw(n.ba,d,u,!0,r)))),o.segments.push({pendingInitSegmentRefId:c,initSegmentKey:c?0:null,startTime:n.startTime,endTime:n.endTime,appendWindowStart:n.appendWindowStart,appendWindowEnd:n.appendWindowEnd,timestampOffset:n.timestampOffset,tilesLayout:n.tilesLayout,pendingSegmentRefId:l,dataKey:0,mimeType:n.mimeType,codecs:n.codecs,thumbnailSprite:n.thumbnailSprite}),0!==s&&(u=(u+1)%s)})),o}function l_(e){if(e.j.g)throw new Ue(2,9,7001)}function c_(){if(!Qw())throw new Ue(2,9,9e3)}function d_(e,t){return R((function(n){return 1==n.g?(e.i.push(t),T(n,2),w(n,t,4)):2!=n.g?n.return(n.h):(A(n),J(e.i,t),E(n,0))}))}function h_(e){for(var t=new Set,n=p(e.variants),i=n.next();!i.done;i=n.next())(i=i.value).audio&&t.add(i.audio),i.video&&t.add(i.video);for(i=(n=p(e.textStreams)).next();!i.done;i=n.next())t.add(i.value);for(n=(e=p(e.imageStreams)).next();!n.done;n=e.next())t.add(n.value);return t}B("shaka.offline.indexeddb.StorageMechanismOpenTimeout",Lw),kw("idb",(function(){return ae().xh()?new Dw:null})),Nw.prototype.Pb=function(){return this.i},Nw.prototype.bb=function(){return this.h},Nw.prototype.key=function(){return this.l},Nw.prototype.toString=function(){return this.j},(i=Bw.prototype).configure=function(){},i.start=function(e,t){var n,i,r,a,o,s,u=this;return R((function(l){switch(l.g){case 1:if(n=Ow(e),u.g=n,null==n||"manifest"!=n.g)throw new Ue(2,1,9004,e);return i=new Sw,T(l,2),w(l,i.init(),4);case 4:return w(l,xw(i,n.Pb(),n.bb()),5);case 5:return w(l,l.h.getManifests([n.key()]),6);case 6:return r=l.h,a=r[0],o=new jw(n.Pb(),n.bb()),s=Uw(o,a),t.makeTextStreamsForClosedCaptions(s),l.return(s);case 2:return A(l),w(l,i.destroy(),7);case 7:E(l,0)}}))},i.stop=function(){return Promise.resolve()},i.update=function(){},i.onExpirationUpdated=function(e,t){var n,i,r,a,o,s,u,l=this;return R((function(c){switch(c.g){case 1:return n=l.g,i=new Sw,S(c,2,3),w(c,i.init(),5);case 5:return w(c,xw(i,n.Pb(),n.bb()),6);case 6:return w(c,(r=c.h).getManifests([n.key()]),7);case 7:if(a=c.h,o=a[0],s=o.sessionIds.includes(e),u=null==o.expiration||o.expiration>t,!s||!u){c.A(3);break}return w(c,r.updateManifestExpiration(n.key(),t),3);case 3:return A(c),w(c,i.destroy(),10);case 10:E(c,0);break;case 2:k(c),c.A(3)}}))},i.onInitialVariantChosen=function(){},i.banLocation=function(){},i.setMediaElement=function(){},Ja("application/x-offline-manifest",(function(){return new Bw})),B("shaka.offline.OfflineScheme",Hw),Hw.plugin=Vw,Br("offline",Vw),(i=Jw.prototype).destroy=function(){return this.j.destroy()},i.configure=function(e,t){return 2==arguments.length&&"string"==typeof e&&(e=jl(e,t)),ec(this.h,e)},i.getConfiguration=function(){var e=Ql();return ec(e,this.h,Ql()),e},i.Wb=function(){return this.g},i.store=function(e,t,n,i,r){var a=this,o=this.getConfiguration(),s=new lw(this.g);return this.l.push(s),t=function(e,t,n,i,r,a,o,s){var u,l,c,d,h,f,g,m,v,y,b,T,I,C,M,P,D,L,N,O,j,U,F;return R((function(B){switch(B.g){case 1:return c_(),l=u=null,c=new Sw,f=h=d=null,S(B,2,3),w(B,a(),5);case 5:return u=B.h,w(B,function(e,t,n,i){var r,a,o,s,u;return R((function(l){if(1==l.g)return r=null,a=e.g,o={networkingEngine:a,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){r=e},isLowLatencyMode:function(){return!1},updateDuration:function(){},newDrmInfo:function(){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return i.abr.defaultBandwidthEstimate},onMetadata:function(){},disableStream:function(){},addFont:function(){}},n.configure(i.manifest),l_(e),w(l,n.start(t,o),2);if(3!=l.g)return s=l.h,l_(e),u=h_(s),w(l,Promise.all(Qr(u,(function(e){return e.createSegmentIndex()}))),3);if(l_(e),r)throw r;return l.return(s)}))}(e,t,u,o),6);case 6:if(g=B.h,l_(e),!(!g.presentationTimeline.W()&&!g.presentationTimeline.Vc()))throw new Ue(2,9,9005,t);m=p(i),v=m.next();case 7:if(v.done){B.A(9);break}return y=v.value,w(B,function(e,t,n){var i,r,a,o,s,u,l,c,d,h,f,g,m,v,y;return R((function(b){switch(b.g){case 1:return w(b,s_(e,t),2);case 2:if("text/vtt"!=(i=b.h))throw new Ue(1,2,2017,t);return w(b,function(e,t,n){var i,r,a;return R((function(o){return 1==o.g?(i=Kr,(r=Vr([e],n)).method="GET",w(o,t.request(i,r).promise,2)):(a=o.h,o.return(a.data))}))}(t,e.g,e.h.streaming.retryParameters),3);case 3:if(r=b.h,!(a=gi(i)))throw new Ue(2,2,2014,i);for(o=a(),s={periodStart:0,segmentStart:0,segmentEnd:n.presentationTimeline.getDuration(),vttOffset:0},u=Le(r),l=o.parseMedia(u,s,t,[]),c=[],d=p(l),h=d.next(),f={};!h.done;f={Rf:void 0,od:void 0},h=d.next())f.od=h.value,f.Rf=null,g=function(e){return function(){return null==e.Rf&&(e.Rf=nt([t],[e.od.payload])),e.Rf||[]}}(f),m=new Fo(f.od.startTime,f.od.endTime,g,0,null,null,0,0,1/0),f.od.payload.includes("#xywh")&&(4===(v=f.od.payload.split("#xywh=")[1].split(",")).length&&m.If({height:parseInt(v[3],10),positionX:parseInt(v[0],10),positionY:parseInt(v[1],10),width:parseInt(v[2],10)})),c.push(m);if(y=i,!c.length){b.A(4);break}return w(b,kc(c[0].P()[0],e.g,e.h.manifest.retryParameters),5);case 5:y=b.h;case 4:return b.return({id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Mu(c),mimeType:y||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:"image",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([ni(y||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null})}}))}(e,y,g),10);case 10:b=B.h,g.imageStreams.push(b),l_(e),v=m.next(),B.A(7);break;case 9:T=p(r),I=T.next();case 11:return I.done?(Na(o.drm.clearKeys,g.variants),P=g.variants.some((function(e){if(e.audio)for(var t=p(e.audio.drmInfos),n=t.next();!n.done;n=t.next())if(n.value.licenseServerUri.startsWith("data:"))return!0;if(e.video)for(t=(e=p(e.video.drmInfos)).next();!t.done;t=e.next())if(t.value.licenseServerUri.startsWith("data:"))return!0;return!1})),D=o.offline.usePersistentLicense,P&&(D=!1),w(B,e.md(g,(function(e){f=f||e}),o,D),15)):(C=I.value,w(B,function(e,t,n,i,r,a,o){var s,u;return R((function(l){if(1==l.g)return a?l.A(2):w(l,s_(e,n),3);if(2!=l.g&&(a=l.h),s={id:e.m++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:Ru(0,t.presentationTimeline.getDuration(),[n]),mimeType:a||"",codecs:o||"",kind:r,encrypted:!1,drmInfos:[],keyIds:new Set,language:i,originalLanguage:i,label:null,type:ut,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([ni(a||"",o||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},u=ni(s.mimeType,s.codecs),!mi(u))throw new Ue(2,2,2014,a);return l.return(s)}))}(e,g,C.uri,C.language,C.kind,C.mime,C.codecs),14));case 14:M=B.h,g.textStreams.push(M),l_(e),I=T.next(),B.A(11);break;case 15:if(l=B.h,l_(e),f)throw f;return w(B,function(e,t,n,i){var r,a,o,s,u,l,c,d,h,f,g,m,v,y,b,T,A,E,I,C,M,P,D,L,N,O,j,U,F;return R((function(R){switch(R.g){case 1:return r={width:1/0,height:1/0},function(e,t,n){e.variants=e.variants.filter((function(e){return Fi(e,t,n)}))}(e,n.restrictions,r),w(R,Hi(t,e,i,n.drm.preferredKeySystems,n.drm.keySystemsMapping),2);case 2:for(a=[],o=n.preferredDecodingAttributes,s=n.preferredVideoCodecs,u=n.preferredAudioCodecs,l=n.preferredTextFormats,Ui(e,s,u,o,l),c=p(e.variants),d=c.next();!d.done;d=c.next())h=d.value,a.push(Wi(h));for(f=p(e.textStreams),g=f.next();!g.done;g=f.next())m=g.value,a.push(Xi(m));for(v=p(e.imageStreams),y=v.next();!y.done;y=v.next())b=y.value,a.push(Yi(b));return w(R,n.offline.trackSelectionCallback(a),3);case 3:for(T=R.h,A=e.presentationTimeline.getDuration(),E=0,I=p(T),C=I.next();!C.done;C=I.next())M=C.value,P=M.bandwidth*A/8,E+=P;return S(R,4),w(R,n.offline.downloadSizeCallback(E),6);case 6:if(!R.h)throw new Ue(2,9,9014);x(R,5);break;case 4:if((D=k(R))instanceof Ue)throw D;throw new Ue(2,9,9015);case 5:for(L=new Set,N=new Set,O=new Set,j=p(T),U=j.next();!U.done;U=j.next())"variant"==(F=U.value).type&&L.add(F.id),"text"==F.type&&N.add(F.id),"image"==F.type&&O.add(F.id);e.variants=e.variants.filter((function(e){return L.has(e.id)})),e.textStreams=e.textStreams.filter((function(e){return N.has(e.id)})),e.imageStreams=e.imageStreams.filter((function(e){return O.has(e.id)})),function(e){e.variants.map((function(e){return e.video}));var t=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams;for(var n=p(t),i=n.next();!i.done;i=n.next())for(var r=(i=p(t)).next();!r.done;r=i.next());for(t=p(e),n=t.next();!n.done;n=t.next())for(n=p(e),i=n.next();!i.done;i=n.next());}(e),_(R)}}))}(g,l,o,D),16);case 16:return w(B,c.init(),17);case 17:return l_(e),w(B,Tw(c),18);case 18:return d=B.h,l_(e),L=function(e,t,n,i,r,a,o){var s=function(e,t,n){return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.getDuration(),size:0,expiration:1/0,tracks:t=$w(t),appMetadata:n,isIncomplete:!1}}(n,t,i),u=r.offline.progressCallback;!function(e,t,n){e.o=t,e.m=n}(a,(function(e,t){s.size=t,u(s,e)}),(function(t,n){l&&o&&c==n&&Sa(e,"cenc",t)}));var l=t_(t)&&!n_(t),c=null;l&&(c=f_.get(e.g.keySystem));for(var d=new Kw,h=p(t.textStreams),f=h.next();!f.done;f=h.next())d.g.set(f.value.id,52);for(h=p(t.imageStreams),f=h.next();!f.done;f=h.next())Xw(d,f.value);for(h=p(t.variants),f=h.next();!f.done;f=h.next())Ww(d,f.value);return a=function(e,t,n,i){for(var r=new Map,a=h_(n),o=new Map,s=(a=p(a)).next();!s.done;s=a.next()){var u=u_(e,t,n,s=s.value,i,r);o.set(s.id,u)}for(e=p(n.variants),t=e.next();!t.done;t=e.next())(t=t.value).audio&&o.get(t.audio.id).variantIds.push(t.id),t.video&&o.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(o.values()),Ch:Array.from(r.values())}}(a,d,t,r),r=a.streams,a=a.Ch,(d=e.g)&&o&&(d.initData=[]),{tk:{creationTime:Date.now(),originalManifestUri:n,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.Wd(),streams:r,sessionIds:o?Ta(e):[],drmInfo:d,appMetadata:i,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},Ch:a}}(l,g,t,n,o,s,D),N=L.tk,O=L.Ch,w(B,d.bb.addManifests([N]),19);case 19:if(j=B.h,l_(e),h=j[0],l_(e),f)throw f;return w(B,function(e,t,n,i,r,a,o,s,u,l){var c,d,h,f,g,m,v,y,b,T,A;return R((function(E){switch(E.g){case 1:if(c={},d=0,h=function(){if(e.j.g||r.l)throw new Ue(2,9,7001)},f=function(e,t){var f,g,m,v,y,b,S,T,x;return R((function(k){if(1==k.g){for(f=p(e),g=f.next(),m={};!g.done;m={kc:void 0},g=f.next())m.kc=g.value,h(),v=aw(m.kc,a),y=m.kc.i,b=m.kc.h,S=function(e){return function(t){var n,i,r,a;return R((function(s){switch(s.g){case 1:if(n=e.kc.g,i=n.Yb(!1),!n.aesKey||i){s.A(2);break}return w(s,rl(t,n.aesKey,e.kc.j),3);case 3:t=s.h;case 2:return r=rw(n),w(s,o.addSegments([{data:t}]),4);case 4:a=s.h,h(),c[r]=a[0],d+=t.byteLength,_(s)}}))}}(m),T=m.kc.g,(x=T.Yb(!1))?dw(r,m.kc.groupId,x,y,b,S):r.queue(m.kc.groupId,v,y,b,S);return w(k,function(e){return R((function(t){return 1==t.g?w(t,Promise.all(e.i.values()),2):t.return(e.g.g)}))}(r),2)}return h(),!t||r.l?k.A(0):(i_(s,i,u,l),w(k,o.updateManifest(n,i),0))}))},g=!1,S(E,2),!t_(s)||!g||n_(s)){E.A(4);break}return w(E,f(t.filter((function(e){return e.h})),!0),5);case 5:return h(),t=t.filter((function(e){return!e.h})),m=c,v=d,c={},d=0,w(E,e_(o,n,i,m,v,(function(){return l_(e)})),6);case 6:h();case 4:if(g){E.A(7);break}return w(E,f(t,!1),8);case 8:return h(),y=c,b=d,c={},d=0,w(E,e_(o,n,i,y,b,(function(){return h()})),9);case 9:h();case 7:x(E,0);break;case 2:return T=k(E),A=Object.values(c),w(E,o.removeSegments(A,(function(){})),10);case 10:throw T}}))}(e,O,h,N,s,o,d.bb,g,l,D),20);case 20:return l_(e),i_(g,N,l,D),w(B,d.bb.updateManifest(h,N),21);case 21:return l_(e),U=new Nw("manifest",d.path.Pb,d.path.bb,h),B.return(zw(U,N));case 3:return A(B),w(B,c.destroy(),22);case 22:if(!u){B.A(23);break}return w(B,u.stop(),23);case 23:if(!l){B.A(25);break}return w(B,l.destroy(),25);case 25:E(B,0);break;case 2:if(F=k(B),null==h){B.A(27);break}return w(B,Zw(h),27);case 27:throw f||F}}))}(this,e,t||{},i||[],r||[],(function(){var t;return R((function(i){return 1==i.g?n?i.A(2):w(i,kc(e,a.g,o.manifest.retryParameters),3):(2!=i.g&&(n=i.h),t=Qa(e,n||null),i.return(t()))}))}),o,s),(t=new Er(t,(function(){return cw(s)}))).finally((function(){J(a.l,s)})),function(e,t){var n=t.promise;return e.i.push(n),t.finally((function(){J(e.i,n)}))}(this,t)},i.remove=function(e){return d_(this,function(e,t){var n,i,r,a,o,s;return R((function(u){switch(u.g){case 1:if(c_(),null==(n=Ow(t))||"manifest"!=n.g)throw new Ue(2,9,9004,t);return i=n,r=new Sw,T(u,2),w(u,r.init(),4);case 4:return w(u,xw(r,i.Pb(),i.bb()),5);case 5:return w(u,(a=u.h).getManifests([i.key()]),6);case 6:return o=u.h,s=o[0],w(u,Promise.all([a_(e,s,r),o_(a,i,s)]),2);case 2:return A(u),w(u,r.destroy(),8);case 8:E(u,0)}}))}(this,e))},i.Nk=function(){return d_(this,function(e){var t,n,i,r,a,o,s,u,l,c;return R((function(d){switch(d.g){case 1:return c_(),t=e.g,n=e.h.drm,i=new Sw,r=!1,T(d,2),w(d,i.init(),4);case 4:a=[],function(e,t){e.g.forEach((function(e){t(e.getEmeSessionCell())}))}(i,(function(e){return a.push(e)})),o=p(a),s=o.next();case 5:if(s.done){d.A(2);break}return w(d,(u=s.value).getAll(),8);case 8:return l=d.h,w(d,qw(n,t,l),9);case 9:return c=d.h,w(d,u.remove(c),10);case 10:c.length!=l.length&&(r=!0),s=o.next(),d.A(5);break;case 2:return A(d),w(d,i.destroy(),11);case 11:E(d,3);break;case 3:return d.return(!r)}}))}(this))},i.list=function(){return d_(this,R((function(i){switch(i.g){case 1:return c_(),e=[],t=new Sw,T(i,2),w(i,t.init(),4);case 4:return n=Promise.resolve(),function(e,t){e.g.forEach((function(e,n){e.getCells().forEach((function(e,i){t({Pb:n,bb:i},e)}))}))}(t,(function(t,i){n=n.then((function(){return R((function(n){if(1==n.g)return w(n,i.getAllManifests(),2);n.h.forEach((function(n,i){n=zw(new Nw("manifest",t.Pb,t.bb,i),n),e.push(n)})),_(n)}))}))})),w(i,n,2);case 2:return A(i),w(i,t.destroy(),6);case 6:E(i,3);break;case 3:return i.return(e)}})));var e,t,n},i.md=function(e,t,n,i){var r,a=this;return R((function(o){return 1==o.g?((r=new va({tc:a.g,onError:t,vf:function(){},onExpirationUpdated:function(){},onEvent:function(){}})).configure(n.drm),w(o,function(e,t,n){return e.oa=!0,e.C=new Map,e.R=n,ba(e,t,!1)}(r,e.variants,i),2)):3!=o.g?w(o,_a(r),3):o.return(r)}))},B("shaka.offline.Storage",Jw),Jw.deleteAll=function(){var e;return R((function(t){return 1==t.g?(e=new Sw,T(t,2),w(t,function(e){var t,n;return R((function(i){return 1==i.g?(t=Array.from(e.g.values()),(n=t.length>0)||Aw.forEach((function(e){(e=e())&&t.push(e)})),w(i,Promise.all(t.map((function(e){return e.erase()}))),2)):n?i.A(0):w(i,Promise.all(t.map((function(e){return e.destroy()}))),0)}))}(e),2)):5!=t.g?(A(t),w(t,e.destroy(),5)):E(t,0)}))},Jw.prototype.list=Jw.prototype.list,Jw.prototype.removeEmeSessions=Jw.prototype.Nk,Jw.prototype.remove=Jw.prototype.remove,Jw.prototype.store=Jw.prototype.store,Jw.prototype.getNetworkingEngine=Jw.prototype.Wb,Jw.prototype.getConfiguration=Jw.prototype.getConfiguration,Jw.prototype.configure=Jw.prototype.configure,Jw.prototype.destroy=Jw.prototype.destroy,Jw.support=Qw;var f_=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.huawei.wiseplay","3d5e6d359b9a41e8b843dd3c6e72c42c");function p_(){}function g_(e,t){for(e={priority:t||0,callback:e},t=0;t<y_.length;t++)if(y_[t].priority<e.priority)return void y_.splice(t,0,e);y_.push(e)}Qd("offline",Qw),B("shaka.polyfill",p_),p_.register=g_,p_.installAll=function(){for(var e=p(y_),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(e){$("Error installing polyfill!",e)}}};var m_,v_,y_=[];function b_(){}function w_(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var e=p(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())__(t.value)}function __(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(e){null==e||null==e?this.removeAttribute(t):this.setAttribute(t,e)}})}function S_(e,t,n){this.g=e,this.i=t||null,this.h=n||null,this.keySystem=e.keySystem}function T_(e){return e.startsWith("com.apple")?"cbcs":e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("org.w3")||e.startsWith("com.huawei")?"cenc":($("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function x_(e){if(!e)return!1;var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function k_(e,t){return!(e&&e!=t&&("cbcs"!=e&&"cbcs-1-9"!=e||!ae().ed()))}function A_(){}function E_(){ae().Kf()&&!m_&&!navigator.emeEncryptionSchemePolyfilled&&navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration&&(m_=navigator.requestMediaKeySystemAccess,navigator.requestMediaKeySystemAccess=I_,navigator.emeEncryptionSchemePolyfilled=!0)}function I_(e,t){var n,i=this;return R((function(r){return 1==r.g?w(r,m_.call(i,e,t),2):(n=r.h,x_(n)?(navigator.requestMediaKeySystemAccess=m_,r.return(n)):(navigator.requestMediaKeySystemAccess=C_,r.return(C_.call(i,e,t))))}))}function C_(e,t){var n,i,r,a,o,s,u,l,c,d,h,f,g=this;return R((function(m){if(1==m.g){for(n=T_(e),i=[],r=p(t),a=r.next();!a.done;a=r.next())o=a.value,s=M_(o.videoCapabilities,n),u=M_(o.audioCapabilities,n),o.videoCapabilities&&o.videoCapabilities.length&&!s.length||o.audioCapabilities&&o.audioCapabilities.length&&!u.length||((l=Object.assign({},o)).videoCapabilities=s,l.audioCapabilities=u,i.push(l));if(!i.length)throw(c=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c;return w(m,m_.call(g,e,i),2)}return d=m.h,f=h=null,i[0]&&(i[0].videoCapabilities&&(h=i[0].videoCapabilities[0].encryptionScheme),i[0].audioCapabilities&&(f=i[0].audioCapabilities[0].encryptionScheme)),m.return(new S_(d,h,f))}))}function M_(e,t){return e?e.filter((function(e){return k_(e.encryptionScheme,t)})):e}function P_(){}function R_(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",D_),document.addEventListener("webkitfullscreenerror",D_),document.addEventListener("mozfullscreenchange",D_),document.addEventListener("mozfullscreenerror",D_),document.addEventListener("MSFullscreenChange",D_),document.addEventListener("MSFullscreenError",D_)}}function D_(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),n=document.createEvent("Event");n.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(n)}function L_(){}function N_(){ae().Kf()&&!v_&&!navigator.mediaCapabilitiesEncryptionSchemePolyfilled&&navigator.mediaCapabilities&&(v_=navigator.mediaCapabilities.decodingInfo,navigator.mediaCapabilities.decodingInfo=O_,navigator.mediaCapabilitiesEncryptionSchemePolyfilled=!0)}function O_(e){var t,n,i=this;return R((function(r){switch(r.g){case 1:return w(r,v_.call(i,e),2);case 2:if(!(t=r.h).supported||!e.keySystemConfiguration)return r.return(t);if(n=t.keySystemAccess,x_(n))return navigator.mediaCapabilities.decodingInfo=v_,r.return(t);if(navigator.mediaCapabilities.decodingInfo=j_,n){r.A(3);break}return w(r,U_(e),4);case 4:return t.keySystemAccess=r.h,r.return(t);case 3:return r.return(j_.call(i,e))}}))}function j_(e){var t,n,i,r,a,o,s,u=this;return R((function(l){switch(l.g){case 1:return n=t=null,!e.keySystemConfiguration||(i=e.keySystemConfiguration,r=i.keySystem,n=i.audio&&i.audio.encryptionScheme,t=i.video&&i.video.encryptionScheme,a=T_(r),o={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},k_(n,a)&&k_(t,a))?w(l,v_.call(u,e),2):l.return(o);case 2:if((s=l.h).keySystemAccess){s.keySystemAccess=new S_(s.keySystemAccess,t,n),l.A(3);break}if(!e.keySystemConfiguration){l.A(3);break}return w(l,U_(e),5);case 5:s.keySystemAccess=l.h;case 3:return l.return(s)}}))}function U_(e){var t,n;return R((function(i){if(1==i.g){var r=e.keySystemConfiguration,a=[],o=[];return r.audio&&a.push({robustness:r.audio.robustness||"",contentType:e.audio.contentType,encryptionScheme:r.audio.encryptionScheme}),r.video&&o.push({robustness:r.video.robustness||"",contentType:e.video.contentType,encryptionScheme:r.video.encryptionScheme}),r={initDataTypes:r.initDataType?[r.initDataType]:[],distinctiveIdentifier:r.distinctiveIdentifier,persistentState:r.persistentState,sessionTypes:r.sessionTypes},a.length&&(r.audioCapabilities=a),o.length&&(r.videoCapabilities=o),t=r,w(i,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)}return n=i.h,i.return(n)}))}function F_(){}function B_(){ae().cc()||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),F_.originalMcap=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=H_)}function H_(t){var n,i,r,a,o,s,u;return R((function(l){switch(l.g){case 1:if(n={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:t},ae(),i=t.video,r=t.audio,"media-source"!=t.type){if("file"!=t.type)return l.return(n);if(i&&(a=i.contentType,!(""!=es().canPlayType(a)))||r&&(o=r.contentType,!(""!=es().canPlayType(o))))return l.return(n);l.A(2);break}if(!Xv())return l.return(n);if(!i){l.A(3);break}return w(l,function(t){var n,i;return R((function(r){return 1==r.g?(n=ae(),"CAST"!==n.Ua()?r.A(2):w(r,function(t){var n,i,r,a;return R((function(o){if(1==o.g){if(!(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType))return o.return(mt(t.contentType));switch(n=t.contentType,t.width&&t.height&&t.width>1280&&t.height>720&&(n+="; width="+t.width+"; height="+t.height),t.framerate&&((i=Math.round(t.framerate))<24||i>30)&&(n+="; framerate="+t.framerate),t.transferFunction||""){case"":case"srgb":break;case"pq":n+="; eotf=smpte2084";break;case"hlg":n+="; eotf=arib-std-b67";break;default:return o.return(!1)}return r=!1,(a=W_).has(n)?(r=a.get(n),o.A(2)):w(o,cast.__platform__.canDisplayType(n),3)}return 2!=o.g&&(r=o.h,a.set(n,r)),o.return(r)}))}(t),3)):2!=r.g?(i=r.h,r.return(i)):r.return(mt(t.contentType))}))}(i),4);case 4:if(!l.h)return l.return(n);case 3:if(r){var c=ae().Ua(),d=r.contentType;if("CAST"===c&&r.spatialRendering&&(d+="; spatialRendering=true"),!mt(d))return l.return(n)}case 2:return t.keySystemConfiguration?(s=t.keySystemConfiguration,w(l,function(e,t,n){var i,r,a,o,s,u,l,c,d,h,f;return R((function(p){switch(p.g){case 1:if(i=[],r=[],n.audio&&(a={robustness:n.audio.robustness||"",contentType:t.contentType},ae().si()&&t.contentType.includes('codecs="ac-3"')&&(a.contentType='audio/mp4; codecs="ec-3"'),n.audio.encryptionScheme&&(a.encryptionScheme=n.audio.encryptionScheme),i.push(a)),n.video&&(o={robustness:n.video.robustness||"",contentType:e.contentType},n.video.encryptionScheme&&(o.encryptionScheme=n.video.encryptionScheme),r.push(o)),s={initDataTypes:[n.initDataType],distinctiveIdentifier:n.distinctiveIdentifier,persistentState:n.persistentState,sessionTypes:n.sessionTypes},i.length&&(s.audioCapabilities=i),r.length&&(s.videoCapabilities=r),u=e?e.contentType:"",l=t?t.contentType:"",c=ui(u)+";"+si(u),d=ui(l)+";"+si(l),h=n.keySystem,f=null,S(p,2),Tr.has(c+"#"+d+"#"+h)){f=Tr.get(c+"#"+d+"#"+h)||null,p.A(4);break}return w(p,navigator.requestMediaKeySystemAccess(n.keySystem,[s]),5);case 5:f=p.h,Tr.set(c+"#"+d+"#"+h,f);case 4:x(p,3);break;case 2:k(p);case 3:return p.return(f)}}))}(i,r,s),6)):(n.supported=!0,l.return(n));case 6:(u=l.h)&&(n.supported=!0,n.keySystemAccess=u);case 5:return l.return(n)}}))}p_.Aria=b_,b_.install=w_,g_(w_),S_.prototype.getConfiguration=function(){var e=this.g.getConfiguration();if(e.videoCapabilities)for(var t=p(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.i;if(e.audioCapabilities)for(n=(t=p(e.audioCapabilities)).next();!n.done;n=t.next())n.value.encryptionScheme=this.h;return e},S_.prototype.createMediaKeys=function(){return this.g.createMediaKeys()},p_.EmeEncryptionScheme=A_,A_.install=E_,g_(E_),p_.Fullscreen=P_,P_.install=R_,g_(R_),p_.MCapEncryptionScheme=L_,L_.install=N_,g_(N_,-2),p_.MediaCapabilities=F_,F_.install=B_,F_.originalMcap=null;var V_,q_,G_,z_,$_,K_,W_=new Map;function X_(){}function Y_(){var t=ae(),n="WEBKIT"===t.Ha()?t.za():null;for((e.MediaSource||e.ManagedMediaSource)&&n&&e.MediaSource&&(n<=12?(J_(),function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}()):n<=15&&J_()),n=(t=p(t.Ei())).next();!n.done;n=t.next())Q_(n.value);(e.MediaSource||e.ManagedMediaSource)&&function(){if(e.MediaSource){var t=MediaSource.isTypeSupported.bind(MediaSource);MediaSource.isTypeSupported=function(e){return"mp2t"!=ai(e)&&t(e)}}if(e.ManagedMediaSource){var n=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return"mp2t"!=ai(e)&&n(e)}}}(),e.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&function(){var e=MediaSource.isTypeSupported;ae().$i()&&(MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),i=n.findIndex((function(e){return e.startsWith("codecs=")}));if(i<0)return e(t);var r=n[i].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),a=r.findIndex((function(e){return e.startsWith("vp09")}));return a>=0&&(r[a]="vp9",n[i]='codecs="'+r.join(",")+'"',t=n.join("; ")),e(t)})}()}function J_(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,D.apply(0,arguments));return t.abort=function(){},t}}function Q_(t){var n=MediaSource.isTypeSupported.bind(MediaSource);if(MediaSource.isTypeSupported=function(e){return si(e)!=t&&n(e)},e.ManagedMediaSource){var i=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);e.ManagedMediaSource.isTypeSupported=function(e){return si(e)!=t&&i(e)}}}function Z_(){}function eS(){screen.orientation&&screen.orientation.unlock||(null!=screen.orientation?(void 0===screen.orientation.lock&&(screen.orientation.lock=function(){return Promise.resolve()}),void 0===screen.orientation.unlock&&(screen.orientation.unlock=function(){})):null!=e.orientation&&function(){function t(){switch(e.orientation){case-90:n.type="landscape-secondary",n.angle=270;break;case 0:n.type="portrait-primary",n.angle=0;break;case 90:n.type="landscape-primary",n.angle=90;break;case 180:n.type="portrait-secondary",n.angle=180}}var n=new tS;screen.orientation=n,t(),e.addEventListener("orientationchange",(function(){t();var e=new Dr("change");n.dispatchEvent(e)}))}())}function tS(){Or.call(this),this.type="",this.angle=0}function nS(){}function iS(t){e.HTMLVideoElement&&e.WebKitMediaKeys&&e.shakaMediaKeysPolyfill!=fS&&(void 0!==t&&t&&(V_=!0,q_=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),G_=HTMLMediaElement.prototype.setMediaKeys,z_=e.MediaKeys,$_=e.MediaKeySystemAccess,K_=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=aS,e.MediaKeys=uS,e.MediaKeySystemAccess=sS,navigator.requestMediaKeySystemAccess=rS,e.shakaMediaKeysPolyfill=fS,lr.clear(),Tr.clear())}function rS(e,t){try{var n=new sS(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function aS(e){var t=this.mediaKeys;return t&&t!=e&&lS(t,null),delete this.mediaKeys,(this.mediaKeys=e)?lS(e,this):Promise.resolve()}function oS(e){if(Oe(e=Le(e.initData)).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=Ge(e=Ve(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=De(e),this.dispatchEvent(t)}function sS(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(t=(e=p(t)).next();!t.done;t=e.next()){var n=t.value;if("required"==n.persistentState)t=null;else{t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:n.initDataTypes,sessionTypes:["temporary"],label:n.label};var i=!1,r=!1;if(n.audioCapabilities)for(var a=p(n.audioCapabilities),o=a.next();!o.done;o=a.next())(o=o.value).contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,o.contentType.split(";")[0])&&(t.audioCapabilities.push(o),r=!0));if(n.videoCapabilities)for(a=(n=p(n.videoCapabilities)).next();!a.done;a=n.next())(a=a.value).contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,a.contentType.split(";")[0])&&(t.videoCapabilities.push(a),r=!0));i||(r=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),t=r?t:null}if(t)return void(this.g=t)}throw(e=Error("Unsupported keySystem")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function uS(e){this.h=new WebKitMediaKeys(e),this.g=new te}function lS(e,t){if(e.g.Pa(),!t)return Promise.resolve();e.g.D(t,"webkitneedkey",oS);try{return fu(t,HTMLMediaElement.HAVE_METADATA,e.g,(function(){t.webkitSetMediaKeys(e.h)})),Promise.resolve()}catch(e){return Promise.reject(e)}}function cS(e){Or.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new te,this.sessionId="",this.expiration=NaN,this.closed=new Ar,this.keyStatuses=new hS,this.onkeystatuseschange=null}function dS(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.g=t,t=new Dr("keystatuseschange"),e.dispatchEvent(t),e.onkeystatuseschange&&e.onkeystatuseschange(t)}function hS(){this.size=0,this.g=void 0}g_(B_,-1),p_.MediaSource=X_,X_.install=Y_,g_(Y_),p_.Orientation=Z_,Z_.install=eS,h(tS,Or),tS.prototype.lock=function(e){function t(e){return screen.lockOrientation?screen.lockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):!!screen.msLockOrientation&&screen.msLockOrientation(e)}var n=!1;switch(e){case"natural":n=t("default");break;case"any":n=!0,this.unlock();break;default:n=t(e)}return n?Promise.resolve():((e=Error("screen.orientation.lock() is not available on this device")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},tS.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},g_(eS),p_.PatchedMediaKeysApple=nS,nS.uninstall=function(){e.shakaMediaKeysPolyfill==fS&&V_&&(V_=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",q_),HTMLMediaElement.prototype.setMediaKeys=G_,e.MediaKeys=z_,e.MediaKeySystemAccess=$_,navigator.requestMediaKeySystemAccess=K_,q_=K_=G_=$_=z_=null,e.shakaMediaKeysPolyfill="",lr.clear(),Tr.clear())},nS.install=iS,sS.prototype.createMediaKeys=function(){var e=new uS(this.keySystem);return Promise.resolve(e)},sS.prototype.getConfiguration=function(){return this.g},uS.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new cS(this.h,e)},uS.prototype.setServerCertificate=function(){return Promise.resolve(!1)},uS.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},h(cS,Or),(i=cS.prototype).generateRequest=function(e,t){var n=this;this.h=new Ar;try{var i=this.l.createSession("video/mp4",Le(t));this.i=i,this.sessionId=i.sessionId||"",this.j.D(this.i,"webkitkeymessage",(function(e){n.h&&(n.h.resolve(),n.h=null),e=new Dr("message",e=(new Map).set("messageType",null==n.keyStatuses.Jc()?"license-request":"license-renewal").set("message",De(e.message))),n.dispatchEvent(e)})),this.j.D(i,"webkitkeyadded",(function(){n.g&&(dS(n,"usable"),n.g.resolve(),n.g=null)})),this.j.D(i,"webkitkeyerror",(function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=n.i.error,null!=n.h)n.h.reject(e),n.h=null;else if(null!=n.g)n.g.reject(e),n.g=null;else switch(n.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:dS(n,"output-not-allowed");break;default:dS(n,"internal-error")}})),dS(this,"status-pending")}catch(e){this.h.reject(e)}return this.h},i.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},i.update=function(e){this.g=new Ar;try{this.i.update(Le(e))}catch(e){this.g.reject(e)}return this.g},i.close=function(){try{this.i.close(),this.closed.resolve(),this.j.Pa()}catch(e){this.closed.reject(e)}return this.closed},i.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},(i=hS.prototype).Jc=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,Sr.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=Sr.value();return!(!this.g||!Re(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var fS="apple";function pS(){}function gS(){if(e.MediaKeys){var t=ae();MediaKeys.prototype.setServerCertificate&&t.re()||(MediaKeys.prototype.setServerCertificate=mS)}}function mS(){return Promise.resolve(!1)}function vS(){}function yS(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)PS="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=wS,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=_S,e.MediaKeys=TS,e.MediaKeySystemAccess=SS,e.shakaMediaKeysPolyfill=RS}}function bS(e){return PS?PS+e.charAt(0).toUpperCase()+e.slice(1):e}function wS(e,t){try{var n=new SS(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function _S(e){var t=this.mediaKeys;return t&&t!=e&&xS(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&xS(e,this),Promise.resolve()}function SS(e,t){this.g=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.g="webkit-org.w3.clearkey",n=!1);var i=!1,r=document.getElementsByTagName("video");r=r.length?r[0]:document.createElement("video");for(var a=(t=p(t)).next();!a.done;a=t.next()){var o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:(a=a.value).initDataTypes,sessionTypes:["temporary"],label:a.label},s=!1;if(a.audioCapabilities)for(var u=p(a.audioCapabilities),l=u.next();!l.done;l=u.next())(l=l.value).contentType&&(s=!0,r.canPlayType(l.contentType.split(";")[0],this.g)&&(o.audioCapabilities.push(l),i=!0));if(a.videoCapabilities)for(l=(u=p(a.videoCapabilities)).next();!l.done;l=u.next())(l=l.value).contentType&&(s=!0,r.canPlayType(l.contentType,this.g)&&(o.videoCapabilities.push(l),i=!0));if(s||(i=r.canPlayType("video/mp4",this.g)||r.canPlayType("video/webm",this.g)),"required"==a.persistentState&&(n?(o.persistentState="required",o.sessionTypes=["persistent-license"]):i=!1),i)return void(this.h=o)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),(e=Error(n)).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function TS(e){this.l=e,this.h=null,this.g=new te,this.i=[],this.j=new Map}function xS(e,t){e.h=t,e.g.Pa();var n=PS;t&&(e.g.D(t,n+"needkey",(function(t){var n=new CustomEvent("encrypted");n.initDataType="cenc",n.initData=De(t.initData),e.h.dispatchEvent(n)})),e.g.D(t,n+"keymessage",(function(t){var n=kS(e,t.sessionId);n&&(t=new Dr("message",t=(new Map).set("messageType",null==n.keyStatuses.Jc()?"licenserequest":"licenserenewal").set("message",t.message)),n.h&&(n.h.resolve(),n.h=null),n.dispatchEvent(t))})),e.g.D(t,n+"keyadded",(function(t){(t=kS(e,t.sessionId))&&t.ready()})),e.g.D(t,n+"keyerror",(function(t){var n=kS(e,t.sessionId);if(n){var i=Error("EME v0.1b key error"),r=t.errorCode;r.systemCode=t.systemCode,i.errorCode=r,!t.sessionId&&n.h?(45==t.systemCode&&(i.message="Unsupported session type."),n.h.reject(i),n.h=null):t.sessionId&&n.g?(n.g.reject(i),n.g=null):(i=t.systemCode,t.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?CS(n,"output-restricted"):CS(n,1==i?"expired":"internal-error"))}})))}function kS(e,t){var n=e.j.get(t);return n||((n=e.i.shift())?(n.sessionId=t,e.j.set(t,n),n):null)}function AS(e,t,n){Or.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new Ar,this.keyStatuses=new MS,this.onkeystatuseschange=null}function ES(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if("persistent-license"==e.l)if(n)var i=Le(Ge("LOAD_SESSION|"+n));else{var r=Ge("PERSISTENT|");i=tt(r,t)}else i=Le(t)}catch(e){return Promise.reject(e)}e.h=new Ar;var a=bS("generateKeyRequest");try{e.j[a](e.i,i)}catch(t){if("InvalidStateError"!=t.name)return e.h=null,Promise.reject(t);new Si((function(){try{e.j[a](e.i,i)}catch(t){e.h.reject(t),e.h=null}})).ia(.01)}return e.h}function IS(e,t,n){if(e.g)e.g.then((function(){return IS(e,t,n)})).catch((function(){return IS(e,t,n)}));else{if(e.g=t,"webkit-org.w3.clearkey"==e.i){var i=He(n),r=JSON.parse(i);"oct"!=r.keys[0].kty&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),i=Qe(r.keys[0].k),r=Qe(r.keys[0].kid)}else i=Le(n),r=null;var a=bS("addKey");try{e.j[a](e.i,i,r,e.sessionId)}catch(t){e.g.reject(t),e.g=null}}}function CS(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.g=t,t=new Dr("keystatuseschange"),e.dispatchEvent(t),e.onkeystatuseschange&&e.onkeystatuseschange(t)}function MS(){this.size=0,this.g=void 0}g_((function(){e.HTMLVideoElement&&e.WebKitMediaKeys&&(navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||iS())})),p_.PatchedMediaKeysCert=pS,pS.install=gS,g_(gS),p_.PatchedMediaKeysWebkit=vS,vS.install=yS,SS.prototype.createMediaKeys=function(){var e=new TS(this.g);return Promise.resolve(e)},SS.prototype.getConfiguration=function(){return this.h},TS.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new AS(t,this.l,e),this.i.push(e),e},TS.prototype.setServerCertificate=function(){return Promise.resolve(!1)},TS.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},h(AS,Or),(i=AS.prototype).ready=function(){CS(this,"usable"),this.g&&this.g.resolve(),this.g=null},i.generateRequest=function(e,t){return ES(this,t,null)},i.load=function(e){return"persistent-license"==this.l?ES(this,null,e):Promise.reject(Error("Not a persistent session."))},i.update=function(e){var t=new Ar;return IS(this,t,e),t},i.close=function(){if("persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=bS("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},i.remove=function(){return"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()},(i=MS.prototype).Jc=function(){return this.g},i.forEach=function(e){this.g&&e(this.g,Sr.value())},i.get=function(e){if(this.has(e))return this.g},i.has=function(e){var t=Sr.value();return!(!this.g||!Re(e,t))},i.entries=function(){},i.keys=function(){},i.values=function(){};var PS="",RS="webkit";function DS(){}function LS(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=OS,Object.defineProperty(t,"disablePictureInPicture",{get:US,set:FS,enumerable:!0,configurable:!0}),document.exitPictureInPicture=jS,document.addEventListener("webkitpresentationmodechanged",NS,!0))}}function NS(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function OS(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function jS(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function US(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function FS(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function BS(){}function HS(){e.crypto&&("randomUUID"in e.crypto||(e.crypto.randomUUID=VS))}function VS(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}function qS(){}function GS(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:zS})}function zS(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}function $S(){}function KS(){for(var e=p([Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array]),t=e.next();!t.done;t=e.next())(t=t.value).prototype.indexOf||(t.prototype.indexOf=WS),t.prototype.lastIndexOf||(t.prototype.lastIndexOf=XS),t.prototype.includes||(t.prototype.includes=YS)}function WS(e,t){return Array.prototype.indexOf.call(this,e,t)}function XS(e,t){return Array.prototype.lastIndexOf.call(this,e,t)}function YS(e,t){return-1!==this.indexOf(e,t)}function JS(){}function QS(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch((function(){})),e}}}function ZS(){}function eT(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in t||"number"==typeof es().webkitDroppedFrameCount)&&(t.getVideoPlaybackQuality=tT)}}function tT(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function nT(){}function iT(){if(!e.VTTCue&&e.TextTrackCue){var t=null,n=TextTrackCue.length;if(3==n)t=rT;else if(6==n)t=aT;else{try{var i=!!rT(1,2,"")}catch(e){i=!1}i&&(t=rT)}t&&(e.VTTCue=function(e,n,i){return t(e,n,i)})}}function rT(t,n,i){return new e.TextTrackCue(t,n,i)}function aT(t,n,i){return new e.TextTrackCue(t+"-"+n+"-"+i,t,n,i)}function oT(e){Or.call(this),this.g=e,this.m=null,this.h=[],this.j=-1,this.i=this.l=null,this.o=new te}function sT(){}g_(yS),p_.PiPWebkit=DS,DS.install=LS,g_(LS),p_.RandomUUID=BS,BS.install=HS,g_(HS),p_.Symbol=qS,qS.install=GS,g_(GS),p_.TypedArray=$S,$S.install=KS,g_(KS),p_.VideoPlayPromise=JS,JS.install=QS,g_(QS),p_.VideoPlaybackQuality=ZS,ZS.install=eT,g_(eT),p_.VTTCue=nT,nT.install=iT,g_(iT),h(oT,Or),(i=oT.prototype).destroy=function(){var e=this;return R((function(t){if(1==t.g)return w(t,e.removeAllItems(),2);e.g=null,e.o&&(e.o.release(),e.o=null),Or.prototype.release.call(e),_(t)}))},i.configure=function(e){this.m=e},i.getConfiguration=function(){return this.m},i.getCurrentItem=function(){return this.h.length&&this.j>=0&&this.j<this.h.length?this.h[this.j]:null},i.getCurrentItemIndex=function(){return this.j},i.getItems=function(){return this.h.slice()},i.insertItems=function(e){this.h.push.apply(this.h,g(e)),this.dispatchEvent(new Dr("itemsinserted"))},i.removeAllItems=function(){var e,t,n,i,r=this;return R((function(a){if(1==a.g)return r.o.Pa(),r.h.length&&r.j>=0?w(a,r.g.Bc(),2):a.A(2);if(4!=a.g){for(e=[],r.i&&(r.i.preloadManager.j||e.push(r.i.preloadManager.destroy()),r.i=null),r.l&&(r.l.preloadManager.j||e.push(r.l.preloadManager.destroy()),r.l=null),t=p(r.h),n=t.next();!n.done;n=t.next())(i=n.value).preloadManager&&!i.preloadManager.j&&e.push(i.preloadManager.destroy());return e.length?w(a,Promise.all(e),4):a.A(4)}r.h=[],r.j=-1,r.dispatchEvent(new Dr("itemsremoved")),_(a)}))},i.playItem=function(e){var t,n,i,r,a,o,s,u,l,c,d,h,f,g,m,v,y,b=this;return R((function(T){switch(T.g){case 1:if(b.o.Pa(),!b.h.length||e>=b.h.length)throw new Ue(2,7,7007);if(t=b.getCurrentItem(),n=b.h[e],b.j!=e&&(b.j=e,b.dispatchEvent(new Dr("currentitemchanged"))),i=b.g.h,(r=b.m?b.m.preloadNextUrlWindow:0)>0&&(a=!1,b.o.D(i,"timeupdate",(function(){var e,t,n,o;return R((function(s){switch(s.g){case 1:if(b.l||b.h.length<=1||a||b.g.W()||!i.duration)return s.return();if(e=b.g.Qa().end-i.currentTime,isNaN(e)){s.A(0);break}if(!(e<=r)){s.A(0);break}if(t=b.m&&b.m.repeatMode,n=null,b.j+1<b.h.length?n=b.h[b.j+1]:1==t&&(n=b.h[0]),!n||n.preloadManager&&!n.preloadManager.j){s.A(0);break}return a=!0,o=null,S(s,5),w(s,b.g.preload(n.manifestUri,n.startTime,n.mimeType,n.config),7);case 7:o=s.h,x(s,6);break;case 5:k(s),o=null;case 6:b.l={item:n,preloadManager:o},a=!1,_(s)}}))}))),b.o.D(b.g,"complete",(function(){var e=b.m&&b.m.repeatMode,t=!1;if(2==e)t=!0;else{var n=b.j+1;n<b.h.length?b.playItem(n):1==e&&(1==b.h.length?t=!0:b.playItem(0))}t&&(i.paused?(i.currentTime=b.g.Qa().start,i.play()):b.o.D(i,"paused",(function(){i.currentTime=b.g.Qa().start,i.play()})))})),o=n.manifestUri,n.preloadManager&&!n.preloadManager.j&&(o=n.preloadManager),s=!1,b.l&&b.l.item==n&&b.l.preloadManager?o=b.l.preloadManager:b.i&&b.i.item==n&&b.i.preloadManager&&(o=b.i.preloadManager,s=!0),!b.i){T.A(2);break}if(s||b.i.preloadManager.j){T.A(3);break}return w(T,b.i.preloadManager.destroy(),3);case 3:b.i=null;case 2:if(!(b.m&&b.m.preloadPrevItem&&t&&b.g.m===tf)){T.A(5);break}return u=null,S(T,6),w(T,b.g.dj(),8);case 8:u=T.h,x(T,7);break;case 6:k(T),u=null;case 7:b.i={item:t,preloadManager:u};case 5:return n.config&&(b.g.Ii(),b.g.configure(n.config)),w(T,b.g.load(o,n.startTime,n.mimeType),9);case 9:if(b.l=null,n.extraText)for(l=p(n.extraText),c=l.next();!c.done;c=l.next())(d=c.value).mime?b.g.Od(d.uri,d.language,d.kind,d.mime,d.codecs):b.g.Od(d.uri,d.language,d.kind);if(n.extraThumbnail)for(h=p(n.extraThumbnail),f=h.next();!f.done;f=h.next())g=f.value,b.g.Me(g);if(n.extraChapter)for(m=p(n.extraChapter),v=m.next();!v.done;v=m.next())y=v.value,b.g.Le(y.uri,y.language,y.mime);_(T)}}))},B("shaka.queue.QueueManager",oT),oT.prototype.playItem=oT.prototype.playItem,oT.prototype.removeAllItems=oT.prototype.removeAllItems,oT.prototype.insertItems=oT.prototype.insertItems,oT.prototype.getItems=oT.prototype.getItems,oT.prototype.getCurrentItemIndex=oT.prototype.getCurrentItemIndex,oT.prototype.getCurrentItem=oT.prototype.getCurrentItem,oT.prototype.getConfiguration=oT.prototype.getConfiguration,oT.prototype.configure=oT.prototype.configure,oT.prototype.destroy=oT.prototype.destroy,sf=function(e){return new oT(e)},sT.prototype.parseInit=function(){},sT.prototype.setSequenceMode=function(){},sT.prototype.setManifestType=function(){},sT.prototype.parseMedia=function(e,t){for(var n=null,i=[],r=(e=p(e=He(e).split(/\r?\n/))).next();!r.done;r=e.next())if((r=r.value)&&!/^\s+$/.test(r)&&(r=uT.exec(r))){var a=lT.exec(r[1]);r=new _n(a=60*parseInt(a[1],10)+parseFloat(a[2].replace(",",".")),t.segmentEnd?t.segmentEnd:a+2,r[2]),n&&(n.endTime=a,i.push(n)),n=r}return n&&i.push(n),i},B("shaka.text.LrcTextParser",sT),sT.prototype.parseMedia=sT.prototype.parseMedia,sT.prototype.setManifestType=sT.prototype.setManifestType,sT.prototype.setSequenceMode=sT.prototype.setSequenceMode,sT.prototype.parseInit=sT.prototype.parseInit;var uT=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,lT=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;function cT(){this.g="UNKNOWN"}function dT(e,t,n,i,r,a,o,s,u,l,c,d,h,f){var g=c;if(zt(t)){if(!d)return null;var m={tagName:"span",children:[Wt(t)],attributes:{},parent:null}}else m=t;for(var v=null,y=p(FT),b=y.next();!b.done&&!(v=bT(m,"backgroundImage",r,"#",b.value)[0]);b=y.next());y=null;var w=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/;if((b=nn(m,FT,"backgroundImage"))&&w.test(b)){if((y=parseInt(b.split(":").pop(),10)-1)>=f.length)return null;y=f[y]}else h&&b&&!b.startsWith("#")&&(w=new ge(h),b=new ge(b),(b=w.resolve(b).toString())&&(y=b));if(("p"==t.tagName||v||y)&&(d=!0),t=d,b="default"==(m.attributes["xml:space"]||(u?"default":"preserve")),u=[],!(w=m.children.every(zt)))for(var _=p(m.children),S=_.next();!S.done;S=_.next())(S=dT(e,S.value,n,i,r,a,o,s,b,l,m,d,h,f))&&u.push(S);if(r=null!=c,h=Wt(m),h=m.children.length&&h&&/\S/.test(h),!((_=m.attributes.begin||m.attributes.end||m.attributes.dur)||h||"br"==m.tagName||0!=u.length||r&&!b))return null;for(h=(f=_T(m,i)).start,f=f.end;g&&g.tagName&&"tt"!=g.tagName;)h=(f=wT(g,i,h,f)).start,f=f.end,g=g.parent;if(null==h&&(h=0),h+=n.periodStart,f=null==f?1/0:f+n.periodStart,"HLS"!==e.g&&(h=Math.max(h,n.segmentStart),f=Math.min(f,n.segmentEnd)),!_&&u.length>0)for(h=1/0,f=0,i=(n=p(u)).next();!i.done;i=n.next())i=i.value,h=Math.min(h,i.startTime),f=Math.max(f,i.endTime);if("br"==m.tagName)return(e=new _n(h,f,"")).lineBreak=!0,e;if(n="",w&&(n=Ke(Wt(m)||""),b&&(n=n.replace(/\s+/g," "))),(n=new _n(h,f,n)).nestedCues=u,d||(n.isContainer=!0),l&&(n.cellResolution=l),l=bT(m,"region",o,"")[0],m.attributes.region&&l&&l.attributes["xml:id"]){var T=l.attributes["xml:id"];n.region=s.filter((function(e){return e.id==T}))[0]}return s=l,c&&r&&!m.attributes.region&&!m.attributes.style&&(s=bT(c,"region",o,"")[0]),function(e,t,n,i,r,a,o,s,u){s=s||u,"rtl"==gT(e,n,i,o,"direction",s)&&(t.direction="rtl"),u=gT(e,n,i,o,"writingMode",s),"tb"==u||"tblr"==u?t.writingMode="vertical-lr":"tbrl"==u?t.writingMode="vertical-rl":"rltb"==u||"rl"==u?t.direction="rtl":u&&(t.direction=Dn),(u=gT(e,n,i,o,"textAlign",!0))?(t.positionAlign=OT.get(u),t.lineAlign=NT.get(u),t.textAlign=Mn[u.toUpperCase()]):t.textAlign=Cn,(u=gT(e,n,i,o,"displayAlign",!0))&&(t.displayAlign=Rn[u.toUpperCase()]);(u=gT(e,n,i,o,"color",s))&&(t.color=fT(u));(u=gT(e,n,i,o,"backgroundColor",s))&&(t.backgroundColor=fT(u));(u=gT(e,n,i,o,"border",s))&&(t.border=u);if(u=gT(e,n,i,o,"fontFamily",s))switch(u){case"monospaceSerif":t.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":t.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":t.fontFamily="sans-serif";break;case"monospaceSansSerif":t.fontFamily="Consolas,monospace";break;case"proportionalSerif":t.fontFamily="serif";break;default:t.fontFamily=u.split(",").filter((function(e){return"default"!=e})).join(",")}(u=gT(e,n,i,o,"fontWeight",s))&&"bold"==u&&(t.fontWeight=Hn),u=gT(e,n,i,o,"wrapOption",s),t.wrapLine=!u||"noWrap"!=u,(u=gT(e,n,i,o,"lineHeight",s))&&u.match(ET)&&(t.lineHeight=u),(u=gT(e,n,i,o,"fontSize",s))&&(u.match(ET)||u.match(AT))&&(t.fontSize=u),(u=gT(e,n,i,o,"fontStyle",s))&&(t.fontStyle=Gn[u.toUpperCase()]);r?(a=r.attributes.imageType||r.attributes.imagetype,u=r.attributes.encoding,r=Wt(r).trim(),"PNG"==a&&"Base64"==u&&r&&(t.backgroundImage="data:image/png;base64,"+r)):a&&(t.backgroundImage=a),(r=gT(e,n,i,o,"textOutline",s))&&(r=r.split(" "),r[0].match(ET)?t.textStrokeColor=t.color:(t.textStrokeColor=fT(r[0]),r.shift()),r[0]&&r[0].match(ET)?t.textStrokeWidth=r[0]:t.textStrokeColor="");(r=gT(e,n,i,o,"letterSpacing",s))&&r.match(ET)&&(t.letterSpacing=r),(r=gT(e,n,i,o,"linePadding",s))&&r.match(ET)&&(t.linePadding=r),(r=gT(e,n,i,o,"opacity",s))&&(t.opacity=parseFloat(r));(r=mT(e,i,o,"textDecoration"))&&pT(t,r),(r=vT(e,n,o,"textDecoration"))&&pT(t,r),(r=gT(e,n,i,o,"textCombine",s))&&(t.textCombineUpright=r);switch(gT(e,n,i,o,"ruby",s)){case"container":t.rubyTag="ruby";break;case"text":t.rubyTag="rt"}}(e,n,m,s,v,y,a,t,0==u.length),n}function hT(e,t,n,i){var r=new It,a=t.attributes["xml:id"];if(!a)return null;r.id=a,a=null,i&&(a=kT.exec(i)||IT.exec(i)),i=a?Number(a[1]):null,a=a?Number(a[2]):null;var o,s=mT(e,t,n,"extent");if(s){var u=(o=kT.exec(s))||IT.exec(s);null!=u&&(r.width=Number(u[1]),r.height=Number(u[2]),o||(null!=i&&(r.width=100*r.width/i),null!=a&&(r.height=100*r.height/a)),r.widthUnits=o||null!=i?Ct:0,r.heightUnits=o||null!=a?Ct:0)}return(e=mT(e,t,n,"origin"))&&(null!=(u=(o=kT.exec(e))||IT.exec(e))&&(r.viewportAnchorX=Number(u[1]),r.viewportAnchorY=Number(u[2]),o?s||(r.width=100-r.viewportAnchorX,r.widthUnits=Ct,r.height=100-r.viewportAnchorY,r.heightUnits=Ct):(null!=a&&(r.viewportAnchorY=100*r.viewportAnchorY/a),null!=i&&(r.viewportAnchorX=100*r.viewportAnchorX/i)),r.viewportAnchorUnits=o||null!=i?Ct:0)),r}function fT(e){var t=e.match(/rgba\(([^)]+)\)/);return t&&4==(t=t[1].split(",")).length?(t[3]=String(Number(t[3])/255),"rgba("+t.join(",")+")"):e}function pT(e,t){for(var n=(t=p(t.split(" "))).next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes(zn)||e.textDecoration.push(zn);break;case"noUnderline":e.textDecoration.includes(zn)&&J(e.textDecoration,zn);break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&J(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&J(e.textDecoration,"overline")}}function gT(e,t,n,i,r,a){return a=void 0===a||a,(t=vT(e,t,i,r))?t:a?mT(e,n,i,r):null}function mT(e,t,n,i){if(!t)return null;var r=nn(t,UT,i);return r||yT(e,t,n,i)}function vT(e,t,n,i){var r=nn(t,UT,i);return r||yT(e,t,n,i)}function yT(e,t,n,i){t=bT(t,"style",n,"");for(var r=null,a=0;a<t.length;a++){var o=en(t[a],"urn:ebu:tt:style",i);o||(o=nn(t[a],UT,i)),o||(o=vT(e,t[a],n,i)),o&&(r=o)}return r}function bT(e,t,n,i,r){var a=[];if(!e||n.length<1)return a;var o=e;for(e=null;!e&&!(e=r?en(o,r,t):o.attributes[t])&&(o=o.parent););if(t=e)for(r=(t=p(t.split(" "))).next();!r.done;r=t.next())for(r=r.value,o=(e=p(n)).next();!o.done;o=e.next())if(i+(o=o.value).attributes["xml:id"]==r){a.push(o);break}return a}function wT(e,t,n,i){return e=_T(e,t),null==n?n=e.start:null!=e.start&&(n+=e.start),null==i?i=e.end:null!=e.start&&(i+=e.start),{start:n,end:i}}function _T(e,t){var n=ST(e.attributes.begin,t),i=ST(e.attributes.end,t);return e=ST(e.attributes.dur,t),null==i&&null!=e&&(i=n+e),{start:n,end:i}}function ST(e,t){var n=null;if(CT.test(e)){e=CT.exec(e),n=Number(e[1]);var i=Number(e[2]),r=Number(e[3]),a=Number(e[4]);n=(r+=(a+=(Number(e[5])||0)/t.h)/t.frameRate)+60*i+3600*n}else if(MT.test(e))n=TT(MT,e);else if(PT.test(e))n=TT(PT,e);else if(RT.test(e))e=RT.exec(e),n=Number(e[1])/t.frameRate;else if(DT.test(e))e=DT.exec(e),n=Number(e[1])/t.g;else if(LT.test(e))n=TT(LT,e);else if(e)throw new Ue(2,2,2001,"Could not parse cue time range in TTML");return n}function TT(e,t){return null==(e=e.exec(t))||""==e[0]?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)}function xT(e,t,n,i){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(i),0==this.g&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}pi("application/x-subtitle-lrc",(function(){return new sT})),cT.prototype.parseInit=function(){},cT.prototype.setSequenceMode=function(){},cT.prototype.setManifestType=function(e){this.g=e},cT.prototype.parseMedia=function(e,t,n,i){var r=He(e);if(e=[],""==r)return e;var a=qt(r,"tt",!0);if(!a)throw new Ue(2,2,2005,"Failed to parse TTML.");if(!(r=Yt(a,"body")[0]))return[];var o=nn(a,jT,"frameRate"),s=nn(a,jT,"subFrameRate"),u=nn(a,jT,"frameRateMultiplier"),l=nn(a,jT,"tickRate"),c=nn(a,jT,"cellResolution"),d=a.attributes["xml:space"]||"default",h=nn(a,UT,"extent");if("default"!=d&&"preserve"!=d)throw new Ue(2,2,2005,"Invalid xml:space value: "+d);d="default"==d,o=new xT(o,s,u,l),c=function(e){return e&&(e=/^(\d+) (\d+)$/.exec(e))?{columns:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}(c),s=((s=Yt(a,"metadata")[0])?s.children:[]).filter((function(e){return"\n"!=e})),u=Yt(a,"style"),l=[];for(var f=p(a=Yt(a,"region")),g=f.next();!g.done;g=f.next())(g=hT(this,g.value,u,h))&&l.push(g);if(Kt(r,"p").length)throw new Ue(2,2,2001,"<p> can only be inside <div> in TTML");for(f=(h=p(Kt(r,"div"))).next();!f.done;f=h.next())if(Kt(f.value,"span").length)throw new Ue(2,2,2001,"<span> can only be inside <p> in TTML");return(t=dT(this,r,t,o,s,u,a,l,d,c,null,!1,n,i))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e},B("shaka.text.TtmlTextParser",cT),cT.prototype.parseMedia=cT.prototype.parseMedia,cT.prototype.setManifestType=cT.prototype.setManifestType,cT.prototype.setSequenceMode=cT.prototype.setSequenceMode,cT.prototype.parseInit=cT.prototype.parseInit;var kT=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,AT=/^(\d{1,4}(?:\.\d+)?|100)%$/,ET=/^(\d+px|\d+em|\d*\.?\d+c)$/,IT=/^(\d+)px (\d+)px$/,CT=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,MT=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,PT=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,RT=/^(\d*(?:\.\d*)?)f$/,DT=/^(\d*(?:\.\d*)?)t$/,LT=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),NT=(new Map).set("left",On).set("center","center").set("right","end").set("start",On).set("end","end"),OT=(new Map).set("left","line-left").set("center","center").set("right","line-right"),jT=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],UT=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],FT=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];function BT(){this.g=new cT}function HT(){this.g="UNKNOWN"}function VT(e,t,n){var i;(i=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=i[1],e.textAlign="middle"==t?Cn:Mn[t.toUpperCase()]):(i=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==i[1]?"vertical-lr":"vertical-rl":(i=/^size:([\d.]+)%$/.exec(t))?e.size=Number(i[1]):(i=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))?(e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center"==t||"middle"==t?"center":In)):(i=/^region:(.*)$/.exec(t))?(t=function(e,t){return e=e.filter((function(e){return e.id==t})),e.length?e[0]:null}(n,i[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=jn[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=Nn,e.line=Number(n[1]),n[2]&&(e.lineAlign=jn[n[2].toUpperCase()]))}function qT(){this.g=null}function GT(e,t,n){var i,r,a;return(new ra).box("payl",la((function(e){i=He(e)}),!1)).box("iden",la((function(e){r=He(e)}),!1)).box("sttg",la((function(e){a=He(e)}),!1)).parse(e),i?function(e,t,n,i,r){if(e=new _n(i,r,e),xn(e),t&&(e.id=t),n)for(t=new Pt(n),n=Lt(t);n;)VT(e,n,[]),Rt(t),n=Lt(t);return e}(i,r,a,t,n):null}function zT(){}function $T(){this.g=new HT}function KT(e){var t="WEBVTT\n\n";if(""==e)return t;for(var n=(e=p((e=(e=e.replace(/\r+/g,"")).trim()).split("\n\n"))).next();!n.done;n=e.next())(n=n.value.split(/\n/))[0].match(/\d+/)&&n.shift(),n[0]=n[0].replace(/,/g,"."),t+=n.join("\n").replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+"\n\n";return t}function WT(){}function XT(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=YT(n))&&(e.color=n),(n=t.BackColour)&&(n=YT(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=Hn),t.Italic&&(e.fontStyle=qn),t.Underline&&e.textDecoration.push(zn),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=Pn,e.textAlign="start";break;case 2:e.displayAlign=Pn,e.textAlign=Cn;break;case 3:e.displayAlign=Pn,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=Cn;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=Cn;break;case 11:e.displayAlign="center",e.textAlign="end"}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))}function YT(e){return(e=parseInt(e.replace("&H",""),16))>=0?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function JT(e){return 3600*((e=tx.exec(e))[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}pi("application/ttml+xml",(function(){return new cT})),BT.prototype.parseInit=function(e){var t=!1;if((new ra).box("moov",aa).box("trak",aa).box("mdia",aa).box("minf",aa).box("stbl",aa).S("stsd",oa).box("stpp",(function(e){t=!0,e.parser.stop()})).parse(e),!t)throw new Ue(2,2,2007)},BT.prototype.setSequenceMode=function(e){this.g.setSequenceMode(e)},BT.prototype.setManifestType=function(e){this.g.setManifestType(e)},BT.prototype.parseMedia=function(e,t,n){var i=[],r=null,a=[],o=new Map,s=[];if((new ra).box("moof",aa).box("traf",aa).S("tfhd",(function(e){r=eo(e.reader,e.flags).Ud})).S("trun",(function(e){for(var t=(e=p((e=io(e.reader,e.version,e.flags)).hh)).next();!t.done;t=e.next())s.push(t.value.sampleSize||r||0)})).S("subs",(function(e){for(var t=e.reader,n=t.U(),i=-1,r=0;r<n;r++){var a=t.U();i+=a,a=t.Ca();for(var s=[],u=0;u<a;u++)1==e.version?s.push(t.U()):s.push(t.Ca()),t.Y(),t.Y(),t.U();o.set(i,s)}})).box("mdat",la((function(e){a.push(e)}),!1)).parse(e,!1),0==a.length)throw new Ue(2,2,2007);for(var u=tt.apply(Xe,g(a)),l=0,c=0;c<s.length;c++){var d=Le(u,l,s[c]);l+=s[c];var h=o.get(c);if(h&&h.length){d=Le(d,0,h[0]);for(var f=[],m=h[0],v=1;v<h.length;v++){var y=Le(e,m,h[v]);y=Ye(y),f.push("data:image/png;base64,"+y),m+=h[v]}i=i.concat(this.g.parseMedia(d,t,n,f))}else i=i.concat(this.g.parseMedia(d,t,n,[]))}return i},B("shaka.text.Mp4TtmlParser",BT),BT.prototype.parseMedia=BT.prototype.parseMedia,BT.prototype.setManifestType=BT.prototype.setManifestType,BT.prototype.setSequenceMode=BT.prototype.setSequenceMode,BT.prototype.parseInit=BT.prototype.parseInit,pi('application/mp4; codecs="stpp"',(function(){return new BT})),pi('application/mp4; codecs="stpp.ttml"',(function(){return new BT})),pi('application/mp4; codecs="stpp.ttml.im1i"',(function(){return new BT})),pi('application/mp4; codecs="stpp.ttml.im1t"',(function(){return new BT})),pi('application/mp4; codecs="stpp.ttml.im2i"',(function(){return new BT})),pi('application/mp4; codecs="stpp.ttml.im2t"',(function(){return new BT})),pi('application/mp4; codecs="stpp.ttml.etd1"',(function(){return new BT})),pi('application/mp4; codecs="stpp.ttml.etd1|im1t"',(function(){return new BT})),pi('application/mp4; codecs="stpp.ttml.im1t|etd1"',(function(){return new BT})),pi('application/mp4; codecs="stpp.TTML.im1t"',(function(){return new BT})),HT.prototype.parseInit=function(){},HT.prototype.setSequenceMode=function(){},HT.prototype.setManifestType=function(e){this.g=e},HT.prototype.parseMedia=function(e,t){var n=(e=(e=He(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new Ue(2,2,2e3);if(e=t.vttOffset,"HLS"==this.g)if(n[0].includes("X-TIMESTAMP-MAP")){var i=n[0];if(e=i.match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),i=i.match(/MPEGTS:(\d+)/m),!e||!i)throw new Ue(2,2,2e3);if(null==(e=Ot(e[1])))throw new Ue(2,2,2e3);i=Number(i[1]);for(var r=t.segmentStart-t.periodStart;r>=95443.7176888889;)r-=95443.7176888889,i+=8589934592;e=t.periodStart+i/9e4-e}else t.periodStart&&t.vttOffset==t.periodStart&&(e=0);for(t=[],r=(i=p(n[0].split("\n"))).next();!r.done;r=i.next())if(r=r.value,/^Region:/.test(r)){r=new Pt(r);var a=new It;Lt(r),Rt(r);for(var o=Lt(r);o;){var s=a,u=o;(o=/^id=(.*)$/.exec(u))?s.id=o[1]:(o=/^width=(\d{1,2}|100)%$/.exec(u))?s.width=Number(o[1]):(o=/^lines=(\d+)$/.exec(u))?(s.height=Number(o[1]),s.heightUnits=2):(o=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))?(s.regionAnchorX=Number(o[1]),s.regionAnchorY=Number(o[2])):(o=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))?(s.viewportAnchorX=Number(o[1]),s.viewportAnchorY=Number(o[2])):/^scroll=up$/.exec(u)&&(s.scroll="up"),Rt(r),o=Lt(r)}t.push(a)}for(kn(i=new Map),r=[],a=(n=p(n.slice(1))).next();!a.done;a=n.next()){if((1!=(a=a.value.split("\n")).length||a[0])&&!/^NOTE($|[ \t])/.test(a[0])&&"STYLE"==a[0]){for(s=[],o=-1,u=1;u<a.length;u++)a[u].includes("::cue")&&(s.push([]),o=s.length-1),-1!=o&&(s[o].push(a[u]),a[u].includes("}")&&(o=-1));for(o=(s=p(s)).next();!o.done;o=s.next()){var l=o.value;o="global",(u=l[0].match(/\((.*)\)/))&&(o=u.pop()),u=l.slice(1,-1),l[0].includes("}")&&(l=/\{(.*?)\}/.exec(l[0]))&&(u=l[1].split(";")),(l=i.get(o))||(l=new _n(0,0,""));for(var c=!1,d=0;d<u.length;d++){var h=/^\s*([^:]+):\s*(.*)/.exec(u[d]);if(h){var f=h[2].trim().replace(";","");switch(h[1].trim()){case"background-color":case"background":c=!0,l.backgroundColor=f;break;case"color":c=!0,l.color=f;break;case"font-family":c=!0,l.fontFamily=f;break;case"font-size":c=!0,l.fontSize=f;break;case"font-weight":(parseInt(f,10)>=700||"bold"==f)&&(c=!0,l.fontWeight=Hn);break;case"font-style":switch(f){case"normal":c=!0,l.fontStyle=Vn;break;case"italic":c=!0,l.fontStyle=qn;break;case"oblique":c=!0,l.fontStyle="oblique"}break;case"opacity":c=!0,l.opacity=parseFloat(f);break;case"text-combine-upright":c=!0,l.textCombineUpright=f;break;case"text-shadow":c=!0,l.textShadow=f;break;case"white-space":c=!0,l.wrapLine="noWrap"!=f}}}c&&i.set(o,l)}}if(c=e,1==(l=a).length&&!l[0]||/^NOTE($|[ \t])/.test(l[0])||"STYLE"==l[0]||"REGION"==l[0])a=null;else if(a=null,l[0].includes("--\x3e")||(a=l[0],l.splice(0,1)),o=Nt(s=new Pt(l[0])),d=Dt(s,/[ \t]+--\x3e[ \t]+/g),u=Nt(s),null==o||null==d||null==u)$("Failed to parse VTT time code. Cue skipped:",a,l),a=null;else{for(o+=c,u+=c,c=l.slice(1).join("\n").trim(),i.has("global")?((l=i.get("global").clone()).startTime=o,l.endTime=u,l.payload=c):l=new _n(o,u,c),Rt(s),o=Lt(s);o;)VT(l,o,t),Rt(s),o=Lt(s);xn(l,i),null!=a&&(l.id=a),a=l}a&&r.push(a)}return r},B("shaka.text.VttTextParser",HT),HT.prototype.parseMedia=HT.prototype.parseMedia,HT.prototype.setManifestType=HT.prototype.setManifestType,HT.prototype.setSequenceMode=HT.prototype.setSequenceMode,HT.prototype.parseInit=HT.prototype.parseInit,pi("text/vtt",(function(){return new HT})),pi('text/vtt; codecs="vtt"',(function(){return new HT})),pi('text/vtt; codecs="wvtt"',(function(){return new HT})),qT.prototype.parseInit=function(e){var t=this,n=!1;if((new ra).box("moov",aa).box("trak",aa).box("mdia",aa).S("mdhd",(function(e){e=no(e.reader,e.version),t.g=e.timescale})).box("minf",aa).box("stbl",aa).S("stsd",oa).box("wvtt",(function(){n=!0})).parse(e),!this.g)throw new Ue(2,2,2008);if(!n)throw new Ue(2,2,2008)},qT.prototype.setSequenceMode=function(){},qT.prototype.setManifestType=function(){},qT.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.g)throw new Ue(2,2,2008);var n,i=0,r=[],a=[],o=!1,s=!1,u=!1,l=null;if((new ra).box("moof",aa).box("traf",aa).S("tfdt",(function(e){o=!0,i=to(e.reader,e.version).baseMediaDecodeTime})).S("tfhd",(function(e){l=eo(e.reader,e.flags).Td})).S("trun",(function(e){s=!0,r=io(e.reader,e.version,e.flags).hh})).box("mdat",la((function(e){u=!0,n=e}),!1)).parse(e,!1),!u&&!o&&!s)throw new Ue(2,2,2008);e=i;for(var c=new ta(n,0),d=p(r),h=d.next();!h.done;h=d.next()){var f=(h=h.value).ih||l,g=h.Cf?i+h.Cf:e;e=g+(f||0);var m=0;do{var v=c.U();m+=v;var y=null;"vttc"==da(c.U())?v>8&&(y=c.Tb(v-8,!1)):c.skip(v-8),f&&y&&(v=GT(y,t.periodStart+g/this.g,t.periodStart+e/this.g),a.push(v))}while(h.sampleSize&&m<h.sampleSize)}return a.filter(ki)},B("shaka.text.Mp4VttParser",qT),qT.prototype.parseMedia=qT.prototype.parseMedia,qT.prototype.setManifestType=qT.prototype.setManifestType,qT.prototype.setSequenceMode=qT.prototype.setSequenceMode,qT.prototype.parseInit=qT.prototype.parseInit,pi('application/mp4; codecs="wvtt"',(function(){return new qT})),zT.prototype.parseInit=function(){},zT.prototype.setSequenceMode=function(){},zT.prototype.setManifestType=function(){},zT.prototype.parseMedia=function(e){var t=He(e).replace(/\r+/g,"");if(e=[],""==(t=t.trim()))return e;for(var n=(t=p(t.split("\n\n"))).next();!n.done;n=t.next()){var i=new Pt((n=n.value.split("\n"))[0]),r=Nt(i),a=Dt(i,/,/g);if(i=Nt(i),null==r||null==a||null==i)throw new Ue(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new _n(r,i,n.slice(1).join("\n").trim()))}return e},B("shaka.text.SbvTextParser",zT),zT.prototype.parseMedia=zT.prototype.parseMedia,zT.prototype.setManifestType=zT.prototype.setManifestType,zT.prototype.setSequenceMode=zT.prototype.setSequenceMode,zT.prototype.parseInit=zT.prototype.parseInit,pi("text/x-subviewer",(function(){return new zT})),$T.prototype.parseInit=function(){},$T.prototype.setSequenceMode=function(){},$T.prototype.setManifestType=function(){},$T.prototype.parseMedia=function(e,t,n){return e=Le(Ge(e=KT(e=He(e)))),this.g.parseMedia(e,t,n,[])},B("shaka.text.SrtTextParser",$T),$T.srt2webvtt=KT,$T.prototype.parseMedia=$T.prototype.parseMedia,$T.prototype.setManifestType=$T.prototype.setManifestType,$T.prototype.setSequenceMode=$T.prototype.setSequenceMode,$T.prototype.parseInit=$T.prototype.parseInit,pi("text/srt",(function(){return new $T})),WT.prototype.parseInit=function(){},WT.prototype.setSequenceMode=function(){},WT.prototype.setManifestType=function(){},WT.prototype.parseMedia=function(e){var t="",n="",i=null,r=null;for(r=(e=p(r=He(e).split(/\r?\n\s*\r?\n/))).next();!r.done;r=e.next()){var a=r.value;r=a,(a=QT.exec(a))&&(i=a[1],r=a[2]),"V4 Styles"==i||"V4+ Styles"==i?(t=r,t=n?t+"\n"+r:r):"Events"==i&&(n=n?n+"\n"+r:r)}for(i=[],r=null,e=(t=p(t.split(/\r?\n/))).next();!e.done;e=t.next())if(e=e.value,!/^\s*;/.test(e)&&(a=ZT.exec(e)))if(e=a[1].trim(),a=a[2].trim(),"Format"==e)r=a.split(ex);else if("Style"==e){e=a.split(ex),a={};for(var o=0;o<r.length&&o<e.length;o++)a[r[o]]=e[o];i.push(a)}for(r=[],t=null,a=(n=p(n.split(/\r?\n/))).next(),e={};!a.done;e={Vi:void 0},a=n.next())if(a=a.value,!/^\s*;/.test(a)&&(o=ZT.exec(a)))if(a=o[1].trim(),o=o[2].trim(),"Format"==a)t=o.split(ex);else if("Dialogue"==a){o=o.split(ex),a={};for(var s=0;s<t.length&&s<o.length;s++)a[t[s]]=o[s];o=new _n(s=JT(a.Start),JT(a.End),o.slice(t.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,"")),e.Vi=a.Style,(e=i.find(function(e){return function(t){return t.Name==e.Vi}}(e)))&&XT(o,e),r.push(o)}return r},B("shaka.text.SsaTextParser",WT),WT.prototype.parseMedia=WT.prototype.parseMedia,WT.prototype.setManifestType=WT.prototype.setManifestType,WT.prototype.setSequenceMode=WT.prototype.setSequenceMode,WT.prototype.parseInit=WT.prototype.parseInit;var QT=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,ZT=/^\s*([^:]+):\s*(.*)/,ex=/\s*,\s*/,tx=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;function nx(e,t){var n=1&e[t+1]?7:9;return t+n<=e.length&&(e=((3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5)-n)>0?{$d:n,ra:e}:null}function ix(e,t){var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=(60&e[t+2])>>>2;if(i>n.length-1)return null;var r=1+((192&e[t+2])>>>6),a=(1&e[t+2])<<2;return a|=(192&e[t+3])>>>6,{sampleRate:n[i],channelCount:a,codec:"mp4a.40."+r}}function rx(e,t){if(t+1<e.length&&255===e[t]&&240==(246&e[t+1])){var n=1&e[t+1]?7:9;if(t+n>=e.length)return!1;var i=(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5;return!(i<=n)&&((t+=i)===e.length||t+1<e.length&&255===e[t]&&240==(246&e[t+1]))}return!1}function ax(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function ox(e,t){if(t+8>e.length||11!==e[t]||119!==e[t+1])return null;var n=e[t+4]>>6;if(n>=3)return null;var i=63&e[t+4],r=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*i+n];if(t+r>e.length)return null;var a=e[t+6]>>5,o=0;2===a?o+=2:(1&a&&1!==a&&(o+=2),4&a&&(o+=2)),o=(e[t+6]<<8|e[t+7])>>12-o&1;var s=7&e[t+5];return e=new Uint8Array([n<<6|e[t+5]>>3<<1|s>>2,(3&s)<<6|a<<3|o<<2|i>>4,i<<4&224]),{sampleRate:[48e3,44100,32e3][n],channelCount:[2,1,2,3,3,4,4,5][a]+o,Ga:e,ra:r}}function sx(e,t){if(11===e[t]&&119===e[t+1]){var n,i,r=0,a=5;for(t+=a;a>0;){i=e[t];var o=Math.min(a,8),s=8-o;n=(i&(n=4278190080>>>24+s<<s))>>s,r=r?r<<o|n:n,t+=1,a-=o}if(r<16)return!0}return!1}function ux(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function lx(e,t){if(t+8>e.length||2935!=(e[t]<<8|e[t+1]))return null;var n=new ds(e.subarray(t+2));fs(n,2),fs(n,3);var i=ps(n,11)+1<<1,r=ps(n,2);if(3==r){r=[24e3,22060,16e3][r=ps(n,2)];var a=3}else r=[48e3,44100,32e3][r],a=ps(n,2);var o=ps(n,3),s=ps(n,1);return n=ps(n,5),t+i>e.byteLength?null:(e=Math.floor(i*r/(16*[1,2,3,6][a])),e=new Uint8Array([(8160&e)>>5,(31&e)<<3,r<<6|n<<1,o<<1|s,0]),{sampleRate:r,channelCount:[2,1,2,3,3,4,4,5][o]+s,Ga:e,ra:i})}function cx(e){this.j=e,this.h=0,this.g=new Map,this.i=null}pi("text/x-ssa",(function(){return new WT})),(i=ax.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/aac"==e.toLowerCase().split(";")[0]&&mt(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/aac"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="'+(li(t)||"mp4a.40.2")+'"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=Le(e),a=ls(r),o=a.length;o<r.length&&!rx(r,o);o++);if(e=1e3*n.endTime,(a=us(a)).length&&n&&(a=a.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(e=a.data),!(a=ix(r,o)))return Promise.reject(new Ue(2,3,3018,n?n.P()[0]:null));t.audioSamplingRate=a.sampleRate,t.channelsCount=a.channelCount;for(var s=[];o<r.length;){var u=nx(r,o);if(!u)return Promise.reject(new Ue(2,3,3018,n?n.P()[0]:null));var l=u.$d+u.ra;o+l<=r.length&&s.push({data:r.subarray(o+u.$d,o+l),size:u.ra,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,gb:0,hb:2,yb:0}}),o+=l}return r=a.sampleRate,e=Math.floor(e*r/1e3),i=new uo([i={id:t.id,type:"audio",codecs:a.codec,encrypted:t.encrypted&&t.drmInfos.length>0,timescale:r,duration:i,Bb:[],Ga:new Uint8Array([]),Ra:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:e,zb:s},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=lo(i),this.g.set(n,t)),n=this.i!==t,i=go(i),this.i=t,this.h++,Promise.resolve({data:i,init:n?t:null})},B("shaka.transmuxer.AacTransmuxer",ax),ax.prototype.transmux=ax.prototype.transmux,ax.prototype.getOriginalMimeType=ax.prototype.getOriginalMimeType,ax.prototype.convertCodecs=ax.prototype.convertCodecs,ax.prototype.isSupported=ax.prototype.isSupported,ax.prototype.destroy=ax.prototype.destroy,Wn("audio/aac",(function(){return new ax("audio/aac")}),Jn),(i=ux.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ac3"==e.toLowerCase().split(";")[0]&&mt(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ac3"==t.toLowerCase().split(";")[0]?ae().oe()?'audio/mp4; codecs="ec-3"':'audio/mp4; codecs="ac-3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=ls(e=Le(e)),a=r.length;a<e.length&&!sx(e,a);a++);var o=1e3*n.endTime;(r=us(r)).length&&n&&(r=r.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(o=r.data),r=0;for(var s=new Uint8Array([]),u=[];a<e.length;){var l=ox(e,a);if(!l)return Promise.reject(new Ue(2,3,3018,n?n.P()[0]:null));t.audioSamplingRate=l.sampleRate,t.channelsCount=l.channelCount,r=l.sampleRate,s=l.Ga,u.push({data:e.subarray(a,a+l.ra),size:l.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,gb:0,hb:2,yb:0}}),a+=l.ra}return e=Math.floor(o*r/1e3),i=new uo([i={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:r,duration:i,Bb:[],Ga:s,Ra:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:e,zb:u},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=lo(i),this.g.set(n,t)),n=this.i!==t,i=go(i),this.i=t,this.h++,Promise.resolve({data:i,init:n?t:null})},B("shaka.transmuxer.Ac3Transmuxer",ux),ux.prototype.transmux=ux.prototype.transmux,ux.prototype.getOriginalMimeType=ux.prototype.getOriginalMimeType,ux.prototype.convertCodecs=ux.prototype.convertCodecs,ux.prototype.isSupported=ux.prototype.isSupported,ux.prototype.destroy=ux.prototype.destroy,Wn("audio/ac3",(function(){return new ux("audio/ac3")}),Jn),(i=cx.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/ec3"==e.toLowerCase().split(";")[0]&&mt(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/ec3"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="ec-3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=ls(e=Le(e)),a=r.length;a<e.length&&2935!=(e[a]<<8|e[a+1]);a++);var o=1e3*n.endTime;(r=us(r)).length&&n&&(r=r.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(o=r.data),r=0;for(var s=new Uint8Array([]),u=[];a<e.length;){var l=lx(e,a);if(!l)return Promise.reject(new Ue(2,3,3018,n?n.P()[0]:null));t.audioSamplingRate=l.sampleRate,t.channelsCount=l.channelCount,r=l.sampleRate,s=l.Ga,u.push({data:e.subarray(a,a+l.ra),size:l.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,gb:0,hb:2,yb:0}}),a+=l.ra}return e=Math.floor(o*r/1e3),i=new uo([i={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:r,duration:i,Bb:[],Ga:s,Ra:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:e,zb:u},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=lo(i),this.g.set(n,t)),n=this.i!==t,i=go(i),this.i=t,this.h++,Promise.resolve({data:i,init:n?t:null})},B("shaka.transmuxer.Ec3Transmuxer",cx),cx.prototype.transmux=cx.prototype.transmux,cx.prototype.getOriginalMimeType=cx.prototype.getOriginalMimeType,cx.prototype.convertCodecs=cx.prototype.convertCodecs,cx.prototype.isSupported=cx.prototype.isSupported,cx.prototype.destroy=cx.prototype.destroy,Wn("audio/ec3",(function(){return new cx("audio/ec3")}),Jn);var dx=[100,110,122,244,44,83,86,118,128,138,139,134];function hx(e){if(!e.length)return null;var t=e.find((function(e){return 32==e.type})),n=e.find((function(e){return 33==e.type})),i=e.find((function(e){return 34==e.type}));if(!t||!n||!i)return null;var r=function(e){var t=new ds(e,!0);return ws(t),ws(t),ps(t,4),ps(t,2),ps(t,6),e=ps(t,3),t=bs(t),{Tg:e+1,Ah:t}}(t.fullData);e=function(e){e=new ds(e,!0),ws(e),ws(e);var t=0,n=0,i=0,r=0;ps(e,4);var a=ps(e,3);bs(e);for(var o=ps(e,2),s=ps(e,1),u=ps(e,5),l=ws(e),c=ws(e),d=ws(e),h=ws(e),f=ws(e),p=ws(e),g=ws(e),m=ws(e),v=ws(e),y=ws(e),b=ws(e),w=[],_=[],S=0;S<a;S++)w.push(bs(e)),_.push(bs(e));if(a>0)for(S=a;S<8;S++)ps(e,2);for(S=0;S<a;S++)w[S]&&ps(e,88),_[S]&&ws(e);vs(e),w=vs(e),3==w&&ps(e,1),_=vs(e),S=vs(e),bs(e)&&(t+=vs(e),n+=vs(e),i+=vs(e),r+=vs(e));var T=vs(e),x=vs(e),k=vs(e);if(bs(e))for(var A=0;A<=a;A++)vs(e),vs(e),vs(e);else vs(e),vs(e),vs(e);if(vs(e),vs(e),vs(e),vs(e),vs(e),vs(e),bs(e)&&bs(e))for(A=0;A<4;A++)for(var E=0;E<(3===A?2:6);E++)if(bs(e)){var I=Math.min(64,1<<4+(A<<1));A>1&&ys(e);for(var C=0;C<I;C++)ys(e)}else vs(e);for(bs(e),bs(e),bs(e)&&(ws(e),vs(e),vs(e),bs(e)),A=vs(e),I=E=0;I<A;I++)if(C=!1,0!==I&&(C=bs(e)),C){I===A&&vs(e),bs(e),vs(e);for(var M=C=0;M<=E;M++){var P=bs(e),R=!1;P||(R=bs(e)),(P||R)&&C++}E=C}else{for(E=(M=vs(e))+(C=vs(e)),P=0;P<M;P++)vs(e),bs(e);for(M=0;M<C;M++)vs(e),bs(e)}if(bs(e))for(A=vs(e),E=0;E<A;E++){for(I=0;I<k+4;I++)ps(e,1);ps(e,1)}if(A=k=1,E=!0,I=1,M=C=0,bs(e),bs(e),bs(e)){if(bs(e)){R=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2];var D=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];(P=ws(e))>0&&P<=16?(k=R[P-1],A=D[P-1]):255===P&&(k=ps(e,16),A=ps(e,16))}if(bs(e)&&bs(e),bs(e)&&(ps(e,3),bs(e),bs(e)&&(ws(e),ws(e),ws(e))),bs(e)&&(vs(e),vs(e)),bs(e),bs(e),bs(e),(P=bs(e))&&(ms(e),ms(e),ms(e),ms(e)),bs(e)&&(I=ps(e,32),C=ps(e,32),bs(e)&&vs(e),bs(e))){D=!1,P=bs(e),R=bs(e),(P||R)&&((D=bs(e))&&(ws(e),ps(e,5),bs(e),ps(e,5)),ps(e,4),ps(e,4),D&&ps(e,4),ps(e,5),ps(e,5),ps(e,5));for(var L=0;L<=a;L++){var N=!0,O=1;(E=bs(e))||(N=bs(e));var j=!1;if(N?vs(e):j=bs(e),j||(O=vs(e)+1),P){for(N=0;N<O;N++)vs(e),vs(e),D&&(vs(e),vs(e));bs(e)}if(R){for(N=0;N<O;N++)vs(e),vs(e),D&&(vs(e),vs(e));bs(e)}}}bs(e)&&(bs(e),bs(e),bs(e),M=vs(e),vs(e),vs(e),vs(e),vs(e))}return{yg:b,Eg:o,Fg:s,Dg:u,zg:l,Ag:c,Bg:d,Cg:h,rg:f,sg:p,ug:g,vg:m,wg:v,xg:y,pf:M,gg:w,fg:T,eg:x,width:_-(t+n)*(1===w||2===w?2:1),height:S-(i+r)*(1===w?2:1),Rk:k,Qk:A,qg:C/I,pg:E}}(n.fullData);var a=function(e){var t=new ds(e,!0);ws(t),ws(t),vs(t),vs(t),bs(t),bs(t),ps(t,3),bs(t),bs(t),vs(t),vs(t),ys(t),bs(t),bs(t),bs(t)&&vs(t),ys(t),ys(t),bs(t),bs(t),bs(t),bs(t),e=bs(t),t=bs(t);var n=1;return t&&e?n=0:t?n=3:e&&(n=2),{Vg:n}}(i.fullData);return t=function(e,t,n,i){var r=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+n.byteLength));for(r[0]=1,r[1]=(3&i.Eg)<<6|(i.Fg?1:0)<<5|31&i.Dg,r[2]=i.zg,r[3]=i.Ag,r[4]=i.Bg,r[5]=i.Cg,r[6]=i.rg,r[7]=i.sg,r[8]=i.ug,r[9]=i.vg,r[10]=i.wg,r[11]=i.xg,r[12]=i.yg,r[13]=240|(3840&i.pf)>>8,r[14]=255&i.pf,r[15]=252|3&i.Vg,r[16]=252|3&i.gg,r[17]=248|7&i.fg,r[18]=248|7&i.eg,r[19]=0,r[20]=parseInt(i.qg,10),r[21]=(3&(i.pg?1:0))<<6|(7&i.Tg)<<3|(i.Ah?1:0)<<2|3,r[22]=3,e=[e,t,n],t=23,n=e.length-1,i=0;i<e.length;i+=1)r.set(new Uint8Array([32+i|(i===n?128:0),0,1]),t),t+=3,r.set(new Uint8Array([e[i].byteLength>>8,255&e[i].byteLength]),t),t+=2,r.set(e[i],t),t+=e[i].byteLength;return r}(t.fullData,n.fullData,i.fullData,{Tg:r.Tg,Ah:r.Ah,Eg:e.Eg,Fg:e.Fg,yg:e.yg,Dg:e.Dg,zg:e.zg,Ag:e.Ag,Bg:e.Bg,Cg:e.Cg,rg:e.rg,sg:e.sg,ug:e.ug,vg:e.vg,wg:e.wg,xg:e.xg,pf:e.pf,gg:e.gg,fg:e.fg,eg:e.eg,Vg:a.Vg,qg:e.qg,pg:e.pg}),{height:e.height,width:e.width,Ra:t,Za:e.Rk,$a:e.Qk}}function fx(e,t){var n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,a=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==a){var o=e[t+3]>>6;r=1e3*mx[14*(3===n?3-i:3===i?3:4)+r-1],a=vx[3*(3===n?0:2===n?1:2)+a],n=yx[n][i];var s=bx[i],u=Math.floor(n*r/a+(e[t+2]>>1&1))*s,l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);return(l=l?parseInt(l[1],10):0)&&l<=87&&2===i&&r>=224e3&&0===o&&(e[t+3]|=128),{sampleRate:a,channelCount:3===o?1:2,ra:u,Pk:8*n*s}}return null}function px(e,t){return!(255!==e[t]||224&~e[t+1]||!(6&e[t+1]))}function gx(e,t){if(t+1<e.length&&px(e,t)){var n=fx(e,t),i=4;return n&&n.ra&&(i=n.ra),(t+=i)===e.length||t+1<e.length&&px(e,t)}return!1}var mx=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],vx=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],yx=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],bx=[0,1,1,4];function wx(e){this.j=e,this.h=0,this.g=new Map,this.i=null}function _x(e){this.h=e,this.g=null}function Sx(e){this.h=e,(this.g=Kv.get("ISOBoxer")())&&function(e){function t(){this._procFullBox(),1&this.flags&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,(function(e){this._procEntryField(e,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(e,"NumberOfEntries","uint",16),this._procSubEntries(e,"clearAndCryptedData",e.NumberOfEntries,(function(e){this._procEntryField(e,"BytesOfClearData","uint",16),this._procEntryField(e,"BytesOfEncryptedData","uint",32)})))}))}e.g.addBoxProcessor("saio",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)})),e.g.addBoxProcessor("saiz",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)})),e.g.addBoxProcessor("senc",t),e.g.addBoxProcessor("uuid",(function(){for(var e=!0,n=0;n<16;n++)this.usertype[n]!==xx[n]&&(e=!1);e&&(this._parsing&&(this.type="sepiff"),t.call(this))}))}(this)}function Tx(e,t){for(var n=8,i=0;i<e.boxes.length&&e.boxes[i].type!==t;i++)n+=e.boxes[i].size;return n}(i=wx.prototype).destroy=function(){this.g.clear()},i.isSupported=function(e){return"audio/mpeg"==e.toLowerCase().split(";")[0]&&mt(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"audio/mpeg"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="mp3"':t},i.getOriginalMimeType=function(){return this.j},i.transmux=function(e,t,n,i){for(var r=Le(e),a=ls(r).length;a<r.length&&!gx(r,a);a++);var o;for(e=[];a<r.length;){var s=fx(r,a);if(!s)return Promise.reject(new Ue(2,3,3018,n?n.P()[0]:null));o||(o=s),a+s.ra<=r.length&&e.push({data:r.subarray(a,a+s.ra),size:s.ra,duration:1152,sb:0,flags:{xb:0,mb:0,jb:0,gb:0,hb:2,yb:0}}),a+=s.ra}return o?(r=9e4*o.Pk/o.sampleRate*this.h,i=new uo([i={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:o.sampleRate,duration:i,Bb:[],Ga:new Uint8Array([]),Ra:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.h,baseMediaDecodeTime:r,zb:e},stream:t}]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=lo(i),this.g.set(n,t)),n=this.i!==t,i=go(i),this.i=t,this.h++,Promise.resolve({data:i,init:n?t:null})):Promise.reject(new Ue(2,3,3018,n?n.P()[0]:null))},B("shaka.transmuxer.Mp3Transmuxer",wx),wx.prototype.transmux=wx.prototype.transmux,wx.prototype.getOriginalMimeType=wx.prototype.getOriginalMimeType,wx.prototype.convertCodecs=wx.prototype.convertCodecs,wx.prototype.isSupported=wx.prototype.isSupported,wx.prototype.destroy=wx.prototype.destroy,Wn("audio/mpeg",(function(){return new wx("audio/mpeg")}),Jn),(i=_x.prototype).destroy=function(){},i.isSupported=function(e){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var t=li(e).split(","),n=ot("audio",t);return t=ot("video",t),!(!n||t||"mp3"!=oi(n))&&mt(this.convertCodecs("audio",e))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?"audio/mpeg":t},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n,i,r){if(this.g?this.g.clearData():this.g=new Ts,this.g.Gf(n.i),e=Le(e),"mp3"!=(e=this.g.parse(e)).Vd().audio||"audio"!=r)return Promise.reject(new Ue(2,3,3018,n?n.P()[0]:null));for(n=new Uint8Array([]),r=p(e.ub()),e=r.next();!e.done;e=r.next())if(e=e.value.data)for(t=0;t<e.length;)(i=fx(e,t))?(t+i.ra<=e.length&&(n=tt(n,e.subarray(t,t+i.ra))),t+=i.ra):t++;return Promise.resolve(n)},B("shaka.transmuxer.MpegTsTransmuxer",_x),_x.prototype.transmux=_x.prototype.transmux,_x.prototype.getOriginalMimeType=_x.prototype.getOriginalMimeType,_x.prototype.convertCodecs=_x.prototype.convertCodecs,_x.prototype.isSupported=_x.prototype.isSupported,_x.prototype.destroy=_x.prototype.destroy,Wn("video/mp2t",(function(){return new _x("video/mp2t")}),Qn),(i=Sx.prototype).destroy=function(){},i.isSupported=function(e,t){var n=e.startsWith("mss/");return!(!this.g||!n)&&(t?mt(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),mt(t)||mt(e)))},i.convertCodecs=function(e,t){return t.replace("mss/","")},i.getOriginalMimeType=function(){return this.h},i.transmux=function(e,t,n){if(!n)return Promise.resolve(Le(e));if(!t.mssPrivateData)return Promise.reject(new Ue(2,3,3020,n?n.P()[0]:null));try{var i,r=this.g.parseBuffer(e),a=r.fetch("tfhd");a.track_ID=t.id+1;var o=r.fetch("tfdt"),s=r.fetch("traf");null===o&&((o=this.g.createFullBox("tfdt",s,a)).version=1,o.flags=0,o.baseMediaDecodeTime=Math.floor(n.startTime*t.mssPrivateData.timescale));var u=r.fetch("trun"),l=r.fetch("tfxd");l&&l._parent.boxes.splice(l._parent.boxes.indexOf(l),1);var c=r.fetch("tfrf");c&&c._parent.boxes.splice(c._parent.boxes.indexOf(c),1);var d=r.fetch("sepiff");if(null!==d){d.type="senc",d.usertype=void 0;var h=r.fetch("saio");if(null===h){(h=this.g.createFullBox("saio",s)).version=0,h.flags=0,h.entry_count=1,h.offset=[0];var f=this.g.createFullBox("saiz",s);if(f.version=0,f.flags=0,f.sample_count=d.sample_count,f.default_sample_info_size=0,f.sample_info_size=[],2&d.flags)for(i=0;i<d.sample_count;i+=1)f.sample_info_size[i]=10+6*d.entry[i].NumberOfEntries;else f.default_sample_info_size=8}}a.flags&=16777214,a.flags|=131072,u.flags|=1;var p=r.fetch("moof");u.data_offset=p.getLength()+8;var g=r.fetch("saio");null!==g&&(g.offset[0]=Tx(p,"traf")+Tx(s,"senc")+16);var m=Le(r.write());return Promise.resolve(m)}catch(e){return e instanceof Ue?Promise.reject(e):Promise.reject(new Ue(2,3,3022,n?n.P()[0]:null))}},B("shaka.transmuxer.MssTransmuxer",Sx),Sx.prototype.transmux=Sx.prototype.transmux,Sx.prototype.getOriginalMimeType=Sx.prototype.getOriginalMimeType,Sx.prototype.convertCodecs=Sx.prototype.convertCodecs,Sx.prototype.isSupported=Sx.prototype.isSupported,Sx.prototype.destroy=Sx.prototype.destroy;var xx=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]);function kx(e){this.m=e,this.g=0,this.j=new Map,this.l=this.i=this.h=null}Wn("mss/audio/mp4",(function(){return new Sx("mss/audio/mp4")}),Jn),Wn("mss/video/mp4",(function(){return new Sx("mss/video/mp4")}),Jn),(i=kx.prototype).destroy=function(){this.j.clear(),this.i&&this.i.destroy()},i.isSupported=function(e,t){if("video/mp2t"!=e.toLowerCase().split(";")[0])return!1;var n=e;t&&(n=this.convertCodecs(t,e));var i=li(n).split(",");return n=ot("audio",i),i=ot("video",i),!(n&&(n=oi(n),!Ax.includes(n))||i&&(n=oi(i),!Ex.includes(n)))&&(t?mt(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),mt(t)||mt(e)))},i.convertCodecs=function(e,t){return"video/mp2t"==t.toLowerCase().split(";")[0]?(t=li(t).replace("mp4a.40.34","mp3").split(",").map((function(e){return $i(e,"audio/mp4")})).map(Ki).join(","),"audio"==e?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'):t},i.getOriginalMimeType=function(){return this.m},i.transmux=function(e,t,n,i,r){var a=Le(e);if("audio"==r&&!Es(a)){for(var o=ls(a),s=o.length;s<a.length;s++)if(gx(a,s))return Promise.reject(new Ue(2,3,3018,n?n.P()[0]:null));for(s=o.length;s<a.length;s++)if(rx(a,s))return this.i||(this.i=new ax("audio/aac")),this.i.transmux(e,t,n,i,r);return Promise.reject(new Ue(2,3,3018,n?n.P()[0]:null))}this.h?this.h.clearData():this.h=new Ts,this.h.Gf(n.i);var u=this.h.parse(a),l=[],c=u.Vd();try{var d=null;if("video"==r){switch(c.video){case"avc":var h=[],f=null,m=u.ud(),v=function(e){function t(e){r={data:new Uint8Array([]),frame:!1,isKeyframe:!1,pts:e.pts,dts:e.dts,nalus:[]}}function n(){if(r&&r.nalus.length&&r.frame){for(var e=[],t=p(r.nalus),n=t.next();!n.done;n=t.next()){var a=(n=n.value).fullData.byteLength,o=new Uint8Array(4);o[0]=a>>24&255,o[1]=a>>16&255,o[2]=a>>8&255,o[3]=255&a,e.push(o),e.push(n.fullData)}r.data=tt.apply(Xe,g(e)),i.push(r)}}for(var i=[],r=null,a=!1,o=0;o<e.length;o++){var s=e[o],u=s.nalus,l=!1;r&&u.length&&!a&&(n(),t(s));for(var c=(u=p(s.nalus)).next();!c.done;c=u.next()){var d=!1;switch((c=c.value).type){case 1:var h=!1;d=!0;var f=c.data;l&&f.length>4&&(2===(f=Ss(new ds(f)))||4===f||7===f||9===f)&&(h=!0),h&&r&&r.frame&&!r.isKeyframe&&(n(),r=null),r||t(s),r.frame=!0,r.isKeyframe=h;break;case 5:d=!0,r&&r.frame&&!r.isKeyframe&&(n(),r=null),r||t(s),r.frame=!0,r.isKeyframe=!0;break;case 6:case 8:case 12:d=!0;break;case 7:l=d=!0;break;case 9:a=d=!0,r&&r.frame&&(n(),r=null),r||t(s);break;default:d=!1}r&&d&&r.nalus.push(c)}}return n(),i}(m);if(!v.length)throw new Ue(2,3,3023,n?n.P()[0]:null);for(var y=0;y<v.length;y++){var b=v[y];null==f&&(f=b.dts);var w;w=y+1<v.length?(v[y+1].dts||0)-(b.dts||0):v.length>1?(b.dts||0)-(v[y-1].dts||0):9e4*(n.endTime-n.startTime),h.push({data:b.data,size:b.data.byteLength,duration:w,sb:Math.round((b.pts||0)-(b.dts||0)),flags:{xb:0,mb:0,jb:0,gb:0,hb:b.isKeyframe?2:1,yb:b.isKeyframe?0:1}})}for(var _=[],S=p(m),T=S.next();!T.done;T=S.next())_.push.apply(_,g(T.value.nalus));var x=function(e){if(!e.length)return null;var t=e.find((function(e){return 7==e.type}));if(e=e.find((function(e){return 8==e.type})),!t||!e)return null;var n=new ds(t.data),i=ws(n);if(ws(n),ws(n),ms(n),dx.includes(i)&&(3===(i=vs(n))&&fs(n,1),ms(n),ms(n),fs(n,1),bs(n))){i=3!==i?8:12;for(var r=0;r<i;r++)bs(n)&&_s(n,r<6?16:64)}if(ms(n),0===(i=vs(n)))vs(n);else if(1===i)for(fs(n,1),ms(n),ms(n),i=vs(n),r=0;r<i;r++)ms(n);ms(n),fs(n,1);var a=vs(n),o=vs(n),s=ps(n,1);0===s&&fs(n,1),fs(n,1);var u=0,l=0,c=0,d=0;if(bs(n)&&(u=vs(n),l=vs(n),c=vs(n),d=vs(n)),r=i=1,bs(n)&&bs(n)){var h=ws(n);h>0&&h<=16?(i=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][h-1],r=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][h-1]):255===h&&(i=ps(n,16),r=ps(n,16))}return n=(2-s)*(o+1)*16-2*c-2*d,a=16*(a+1)-2*u-2*l,u=[],t=t.fullData,u.push(t.byteLength>>>8&255),u.push(255&t.byteLength),u=u.concat.apply(u,g(t)),t=[],e=e.fullData,t.push(e.byteLength>>>8&255),t.push(255&e.byteLength),t=t.concat.apply(t,g(e)),{height:n,width:a,Ra:e=new Uint8Array([1,u[3],u[4],u[5],255,225].concat(u,[1],t)),Za:i,$a:r}}(_);if(!x||null==f)throw new Ue(2,3,3018,n?n.P()[0]:null);t.height=x.height,t.width=x.width,d={id:t.id,type:"video",codecs:"avc1",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:9e4,duration:i,Bb:[],Ga:new Uint8Array([]),Ra:x.Ra,Za:x.Za,$a:x.$a,data:{sequenceNumber:this.g,baseMediaDecodeTime:f,zb:h},stream:t};break;case"hvc":var k=[],A=null,E=[],I=u.ud();if(!I.length)throw new Ue(2,3,3023,n?n.P()[0]:null);for(var C=0;C<I.length;C++){var M=I[C],P=M.nalus;E.push.apply(E,g(P));for(var R=!1,D=[],L=!1,N=p(P),O=N.next();!O.done;O=N.next()){var j=O.value;switch(j.type){case 1:case 0:var U=L=!0;break;case 19:case 20:case 21:R=U=L=!0;break;case 32:case 33:case 34:case 39:case 40:U=!0;break;case 35:L=U=!0;break;default:U=!1}if(L&&U){var F=j.fullData.byteLength,B=new Uint8Array(4);B[0]=F>>24&255,B[1]=F>>16&255,B[2]=F>>8&255,B[3]=255&F,D.push(B),D.push(j.fullData)}}var H=D.length?{data:tt.apply(Xe,g(D)),isKeyframe:R}:null;if(H){null==A&&null!=M.dts&&(A=M.dts);var V;V=C+1<I.length?(I[C+1].dts||0)-(M.dts||0):I.length>1?(M.dts||0)-(I[C-1].dts||0):9e4*(n.endTime-n.startTime),k.push({data:H.data,size:H.data.byteLength,duration:V,sb:Math.round((M.pts||0)-(M.dts||0)),flags:{xb:0,mb:0,jb:0,gb:0,hb:H.isKeyframe?2:1,yb:H.isKeyframe?0:1}})}}var q=hx(E);if(!q||null==A)throw new Ue(2,3,3018,n?n.P()[0]:null);t.height=q.height,t.width=q.width,d={id:t.id,type:"video",codecs:"hvc1",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:9e4,duration:i,Bb:[],Ga:new Uint8Array([]),Ra:q.Ra,Za:q.Za,$a:q.$a,data:{sequenceNumber:this.g,baseMediaDecodeTime:A,zb:k},stream:t}}d&&(l.push(d),d=null)}if("audio"==r){switch(c.audio){case"aac":for(var G,z=[],$=null,K=null,W=null,X=p(u.ub()),Y=X.next();!Y.done;Y=X.next()){var J=Y.value,Q=J.data;if(Q){var Z=0;if(-1==K&&W)Q=tt(W,J.data),K=null;else if(null!=K&&W){Z=Math.max(0,K);var ee=tt(W,Q.subarray(0,Z));z.push({data:ee,size:ee.byteLength,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,gb:0,hb:2,yb:0}}),K=W=null}if(!(G=ix(Q,Z)))throw new Ue(2,3,3018,n?n.P()[0]:null);for(t.audioSamplingRate=G.sampleRate,t.channelsCount=G.channelCount,null==$&&null!==J.pts&&($=J.pts);Z<Q.length;){var te=nx(Q,Z);if(!te){W=Q.subarray(Z,Q.length),K=-1;break}var ne=te.$d+te.ra;0!=(K=Math.max(0,Z+ne-Q.length))?W=Q.subarray(Z+te.$d,Z+ne):Z+ne<=Q.length&&z.push({data:Q.subarray(Z+te.$d,Z+ne),size:te.ra,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,gb:0,hb:2,yb:0}}),Z+=ne}}}if(!G||null==$){$=9e4*n.startTime;var ie=ot("audio",t.codecs.split(","));if(!ie||!t.channelsCount||!t.audioSamplingRate)throw new Ue(2,3,3018,n?n.P()[0]:null);G={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,codec:ie};var re=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t||3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}(ie,t.channelsCount);if(!re)throw new Ue(2,3,3018,n?n.P()[0]:null);for(var ae=$+9e4*(n.endTime-n.startTime),oe=$;oe<ae;)z.push({data:re,size:re.byteLength,duration:1024,sb:0,flags:{xb:0,mb:0,jb:0,gb:0,hb:2,yb:0}}),oe+=1024/G.sampleRate*9e4}var se=G.sampleRate,ue=$/9e4*se;d={id:t.id,type:"audio",codecs:G.codec,encrypted:t.encrypted&&t.drmInfos.length>0,timescale:se,duration:i,Bb:[],Ga:new Uint8Array([]),Ra:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:ue,zb:z},stream:t};break;case"ac3":for(var le=[],ce=0,de=new Uint8Array([]),he=null,fe=p(u.ub()),pe=fe.next();!pe.done;pe=fe.next()){var ge=pe.value,me=ge.data;null==he&&null!==ge.pts&&(he=ge.pts);for(var ve=0;ve<me.length;){var ye=ox(me,ve);ye?(t.audioSamplingRate=ye.sampleRate,t.channelsCount=ye.channelCount,ce=ye.sampleRate,de=ye.Ga,le.push({data:me.subarray(ve,ve+ye.ra),size:ye.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,gb:0,hb:2,yb:0}}),ve+=ye.ra):ve++}}if(0==ce||0==de.byteLength||null==he)throw new Ue(2,3,3018,n?n.P()[0]:null);var be=he/9e4*ce;d={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:ce,duration:i,Bb:[],Ga:de,Ra:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:be,zb:le},stream:t};break;case"ec3":for(var we=[],_e=0,Se=new Uint8Array([]),Te=null,xe=p(u.ub()),ke=xe.next();!ke.done;ke=xe.next()){var Ae=ke.value,Ee=Ae.data;null==Te&&null!==Ae.pts&&(Te=Ae.pts);for(var Ie=0;Ie<Ee.length;){var Ce=lx(Ee,Ie);Ce?(t.audioSamplingRate=Ce.sampleRate,t.channelsCount=Ce.channelCount,_e=Ce.sampleRate,Se=Ce.Ga,we.push({data:Ee.subarray(Ie,Ie+Ce.ra),size:Ce.ra,duration:1536,sb:0,flags:{xb:0,mb:0,jb:0,gb:0,hb:2,yb:0}}),Ie+=Ce.ra):Ie++}}if(0==_e||0==Se.byteLength||null==Te)throw new Ue(2,3,3018,n?n.P()[0]:null);var Me=Te/9e4*_e;d={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:_e,duration:i,Bb:[],Ga:Se,Ra:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:Me,zb:we},stream:t};break;case"mp3":for(var Pe,Re=[],De=null,Ne=p(u.ub()),Oe=Ne.next();!Oe.done;Oe=Ne.next()){var je=Oe.value,Fe=je.data;if(Fe){null==De&&null!==je.pts&&(De=je.pts);for(var Be=0;Be<Fe.length;){var He=fx(Fe,Be);He?(Pe||(Pe=He),Be+He.ra<=Fe.length&&Re.push({data:Fe.subarray(Be,Be+He.ra),size:He.ra,duration:1152,sb:0,flags:{xb:0,mb:0,jb:0,gb:0,hb:2,yb:0}}),Be+=He.ra):Be++}}}if(!Pe||null==De)throw new Ue(2,3,3018,n?n.P()[0]:null);var Ve=Pe.sampleRate,qe=De/9e4*Ve;d={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:Ve,duration:i,Bb:[],Ga:new Uint8Array([]),Ra:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:qe,zb:Re},stream:t};break;case"opus":var Ge=[],ze=null,$e=u.H;if(!$e)throw new Ue(2,3,3018,n?n.P()[0]:null);var Ke=[];switch($e.nj){case 1:case 2:Ke=[0];break;case 0:Ke=[255,1,1,0,1];break;case 128:Ke=[255,2,0,0,1];break;case 3:Ke=[1,2,1,0,2,1];break;case 4:Ke=[1,2,2,0,1,2,3];break;case 5:Ke=[1,3,2,0,4,1,2,3];break;case 6:Ke=[1,4,2,0,4,1,2,3,5];break;case 7:Ke=[1,4,2,0,4,1,2,3,5,6];break;case 8:Ke=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:Ke=[1,1,2,0,1];break;case 131:Ke=[1,1,3,0,1,2];break;case 132:Ke=[1,1,4,0,1,2,3];break;case 133:Ke=[1,1,5,0,1,2,3,4];break;case 134:Ke=[1,1,6,0,1,2,3,4,5];break;case 135:Ke=[1,1,7,0,1,2,3,4,5,6];break;case 136:Ke=[1,1,8,0,1,2,3,4,5,6,7]}for(var We=new Uint8Array([0,$e.channelCount,0,0,$e.sampleRate>>>24&255,$e.sampleRate>>>17&255,$e.sampleRate>>>8&255,$e.sampleRate>>>0&255,0,0].concat(g(Ke))),Ye=$e.sampleRate,Je=p(u.ub()),Qe=Je.next();!Qe.done;Qe=Je.next()){var Ze=Qe.value,et=Ze.data;null==ze&&null!==Ze.pts&&(ze=Ze.pts);for(var nt=0;nt<et.length;){for(var it=!!(16&et[nt+1]),rt=!!(8&et[nt+1]),at=nt+2,st=0;255===et[at];)st+=255,at+=1;st+=et[at],at+=1,at+=it?2:0,at+=rt?2:0;var ut=et.slice(at,at+st);Ge.push({data:ut,size:ut.byteLength,duration:960,sb:0,flags:{xb:0,mb:0,jb:0,gb:0,hb:2,yb:0}}),nt=at+st}}if(0==We.byteLength||null==ze)throw new Ue(2,3,3018,n?n.P()[0]:null);t.audioSamplingRate=$e.sampleRate,t.channelsCount=$e.channelCount;var lt=ze/9e4*Ye;d={id:t.id,type:"audio",codecs:"opus",encrypted:t.encrypted&&t.drmInfos.length>0,timescale:Ye,duration:i,Bb:[],Ga:We,Ra:new Uint8Array([]),Za:0,$a:0,data:{sequenceNumber:this.g,baseMediaDecodeTime:lt,zb:Ge},stream:t}}d&&(l.push(d),d=null)}}catch(e){return e&&3023==e.code?Promise.resolve(new Uint8Array([])):Promise.reject(e)}if(!l.length)return Promise.reject(new Ue(2,3,3018,n?n.P()[0]:null));var ct=new uo(l),dt=t.id+"_"+n.i;if(this.j.has(dt))var ht=this.j.get(dt);else ht=lo(ct),this.j.set(dt,ht);var ft=this.l!==ht,pt=go(ct);return this.l=ht,this.g++,Promise.resolve({data:pt,init:ft?ht:null})},B("shaka.transmuxer.TsTransmuxer",kx),kx.prototype.transmux=kx.prototype.transmux,kx.prototype.getOriginalMimeType=kx.prototype.getOriginalMimeType,kx.prototype.convertCodecs=kx.prototype.convertCodecs,kx.prototype.isSupported=kx.prototype.isSupported,kx.prototype.destroy=kx.prototype.destroy;var Ax=["aac","ac-3","ec-3","mp3","opus"],Ex=["avc","hevc"];function Ix(){}Wn("video/mp2t",(function(){return new kx("video/mp2t")}),Zn),h(Ix,Bl),B("shaka.util.FairPlayUtils",Ix)}.call(i,e,e,void 0),i.shaka)t[r]=i.shaka[r]}()},713:(e,t,n)=>{"use strict";n.r(t),n.d(t,{COPY_AUTOCAPTURE_EVENT:()=>y,Compression:()=>i,PostHog:()=>ro,SurveyQuestionBranchingType:()=>Nr,SurveyQuestionType:()=>Lr,SurveyType:()=>Dr,default:()=>oo,knownUnsafeEditableEvent:()=>b,posthog:()=>oo,severityLevels:()=>w});var i,r="undefined"!=typeof window?window:void 0,a="undefined"!=typeof globalThis?globalThis:r,o=Array.prototype,s=o.forEach,u=o.indexOf,l=null==a?void 0:a.navigator,c=null==a?void 0:a.document,d=null==a?void 0:a.location,h=null==a?void 0:a.fetch,f=null!=a&&a.XMLHttpRequest&&"withCredentials"in new a.XMLHttpRequest?a.XMLHttpRequest:void 0,p=null==a?void 0:a.AbortController,g=null==l?void 0:l.userAgent,m=null!=r?r:{},v={DEBUG:!1,LIB_VERSION:"1.212.1"},y="$copy_autocapture",b=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];!function(e){e.GZipJS="gzip-js",e.Base64="base64"}(i||(i={}));var w=["fatal","error","warning","log","info","debug"];function _(e,t){return-1!==e.indexOf(t)}var S=function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},T=function(e){return e.replace(/^\$/,"")},x=Array.isArray,k=Object.prototype,A=k.hasOwnProperty,E=k.toString,I=x||function(e){return"[object Array]"===E.call(e)},C=e=>"function"==typeof e,M=e=>e===Object(e)&&!I(e),P=e=>{if(M(e)){for(var t in e)if(A.call(e,t))return!1;return!0}return!1},R=e=>void 0===e,D=e=>"[object String]"==E.call(e),L=e=>D(e)&&0===e.trim().length,N=e=>null===e,O=e=>R(e)||N(e),j=e=>"[object Number]"==E.call(e),U=e=>"[object Boolean]"===E.call(e),F=e=>_(b,e),B=e=>{var t={_log:function(t){if(r&&(v.DEBUG||m.POSTHOG_DEBUG)&&!R(r.console)&&r.console){for(var n=("__rrweb_original__"in r.console[t]?r.console[t].__rrweb_original__:r.console[t]),i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];n(e,...a)}},info:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t._log("log",...n)},warn:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t._log("warn",...n)},error:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t._log("error",...n)},critical:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];console.error(e,...n)},uninitializedWarning:e=>{t.error("You must initialize PostHog before calling ".concat(e))},createLogger:t=>B("".concat(e," ").concat(t))};return t},H=B("[PostHog.js]"),V=H.createLogger,q=V("[ExternalScriptsLoader]"),G=(e,t,n)=>{if(e.config.disable_external_dependency_loading)return q.warn("".concat(t," was requested but loading of external scripts is disabled.")),n("Loading of external scripts is disabled");var i=()=>{if(!c)return n("document not found");var i=c.createElement("script");if(i.type="text/javascript",i.crossOrigin="anonymous",i.src=t,i.onload=e=>n(void 0,e),i.onerror=e=>n(e),e.config.prepare_external_dependency_script&&(i=e.config.prepare_external_dependency_script(i)),!i)return n("prepare_external_dependency_script returned null");var r,a=c.querySelectorAll("body > script");a.length>0?null===(r=a[0].parentNode)||void 0===r||r.insertBefore(i,a[0]):c.body.appendChild(i)};null!=c&&c.body?i():null==c||c.addEventListener("DOMContentLoaded",i)};function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}m.__PosthogExtensions__=m.__PosthogExtensions__||{},m.__PosthogExtensions__.loadExternalDependency=(e,t,n)=>{var i="/static/".concat(t,".js")+"?v=".concat(e.version);if("remote-config"===t&&(i="/array/".concat(e.config.token,"/config.js")),"toolbar"===t){var r=3e5,a=Math.floor(Date.now()/r)*r;i="".concat(i,"&t=").concat(a)}var o=e.requestRouter.endpointFor("assets",i);G(e,o,n)},m.__PosthogExtensions__.loadSiteApp=(e,t,n)=>{var i=e.requestRouter.endpointFor("api",t);G(e,i,n)};var X={};function Y(e,t,n){if(I(e))if(s&&e.forEach===s)e.forEach(t,n);else if("length"in e&&e.length===+e.length)for(var i=0,r=e.length;i<r;i++)if(i in e&&t.call(n,e[i],i)===X)return}function J(e,t,n){if(!O(e)){if(I(e))return Y(e,t,n);if((e=>e instanceof FormData)(e)){for(var i of e.entries())if(t.call(n,i[1],i[0])===X)return}else for(var r in e)if(A.call(e,r)&&t.call(n,e[r],r)===X)return}}var Q=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Y(n,(function(t){for(var n in t)void 0!==t[n]&&(e[n]=t[n])})),e},Z=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Y(n,(function(t){Y(t,(function(t){e.push(t)}))})),e};function ee(e){for(var t=Object.keys(e),n=t.length,i=new Array(n);n--;)i[n]=[t[n],e[t[n]]];return i}var te=function(e){try{return e()}catch(e){return}},ne=function(e){return function(){try{for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.apply(this,n)}catch(e){H.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),H.critical(e)}}},ie=function(e){var t={};return J(e,(function(e,n){D(e)&&e.length>0&&(t[n]=e)})),t};var re=["herokuapp.com","vercel.app","netlify.app"];function ae(e){var t=null==e?void 0:e.hostname;if(!D(t))return!1;var n=t.split(".").slice(-2).join(".");for(var i of re)if(n===i)return!1;return!0}function oe(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]}function se(e,t,n,i){var{capture:r=!1,passive:a=!0}=null!=i?i:{};null==e||e.addEventListener(t,n,{capture:r,passive:a})}var ue="$people_distinct_id",le="__alias",ce="__timers",de="$autocapture_disabled_server_side",he="$heatmaps_enabled_server_side",fe="$exception_capture_enabled_server_side",pe="$web_vitals_enabled_server_side",ge="$dead_clicks_enabled_server_side",me="$web_vitals_allowed_metrics",ve="$session_recording_enabled_server_side",ye="$console_log_recording_enabled_server_side",be="$session_recording_network_payload_capture",we="$session_recording_canvas_recording",_e="$replay_sample_rate",Se="$replay_minimum_duration",Te="$replay_script_config",xe="$sesid",ke="$session_is_sampled",Ae="$session_recording_url_trigger_activated_session",Ee="$session_recording_event_trigger_activated_session",Ie="$enabled_feature_flags",Ce="$early_access_features",Me="$stored_person_properties",Pe="$stored_group_properties",Re="$surveys",De="$surveys_activated",Le="$flag_call_reported",Ne="$user_state",Oe="$client_session_props",je="$capture_rate_limit",Ue="$initial_campaign_params",Fe="$initial_referrer_info",Be="$initial_person_info",He="$epp",Ve="__POSTHOG_TOOLBAR__",qe="$posthog_cookieless",Ge=[ue,le,"__cmpns",ce,ve,he,xe,Ie,Ne,Ce,Pe,Me,Re,Le,Oe,je,Ue,Fe,He],ze=V("[FeatureFlags]"),$e="$active_feature_flags",Ke="$override_feature_flags",We="$feature_flag_payloads",Xe=e=>{var t={};for(var[n,i]of ee(e||{}))i&&(t[n]=i);return t};class Ye{constructor(e){K(this,"_override_warning",!1),K(this,"_hasLoadedFlags",!1),K(this,"_requestInFlight",!1),K(this,"_reloadingDisabled",!1),K(this,"_additionalReloadRequested",!1),K(this,"_decideCalled",!1),K(this,"_flagsLoadedFromRemote",!1),this.instance=e,this.featureFlagEventHandlers=[]}decide(){if(this.instance.config.__preview_remote_config)this._decideCalled=!0;else{var e=!this._reloadDebouncer&&(this.instance.config.advanced_disable_feature_flags||this.instance.config.advanced_disable_feature_flags_on_first_load);this._callDecideEndpoint({disableFlags:e})}}get hasLoadedFlags(){return this._hasLoadedFlags}getFlags(){return Object.keys(this.getFlagVariants())}getFlagVariants(){var e=this.instance.get_property(Ie),t=this.instance.get_property(Ke);if(!t)return e||{};for(var n=Q({},e),i=Object.keys(t),r=0;r<i.length;r++)n[i[r]]=t[i[r]];return this._override_warning||(ze.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:n}),this._override_warning=!0),n}getFlagPayloads(){return this.instance.get_property(We)||{}}reloadFeatureFlags(){this._reloadingDisabled||this.instance.config.advanced_disable_feature_flags||this._reloadDebouncer||(this._reloadDebouncer=setTimeout((()=>{this._callDecideEndpoint()}),5))}clearDebouncer(){clearTimeout(this._reloadDebouncer),this._reloadDebouncer=void 0}ensureFlagsLoaded(){this._hasLoadedFlags||this._requestInFlight||this._reloadDebouncer||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this._reloadingDisabled=e}_callDecideEndpoint(e){if(this.clearDebouncer(),!this.instance.config.advanced_disable_decide)if(this._requestInFlight)this._additionalReloadRequested=!0;else{var t={token:this.instance.config.token,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:this.instance.get_property(Me),group_properties:this.instance.get_property(Pe)};(null!=e&&e.disableFlags||this.instance.config.advanced_disable_feature_flags)&&(t.disable_flags=!0),this._requestInFlight=!0,this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:t,compression:this.instance.config.disable_compression?void 0:i.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:e=>{var n,i,r=!0;200===e.statusCode&&(this.$anon_distinct_id=void 0,r=!1),this._requestInFlight=!1,this._decideCalled||(this._decideCalled=!0,this.instance._onRemoteConfig(null!==(i=e.json)&&void 0!==i?i:{})),t.disable_flags||(this._flagsLoadedFromRemote=!r,this.receivedFeatureFlags(null!==(n=e.json)&&void 0!==n?n:{},r),this._additionalReloadRequested&&(this._additionalReloadRequested=!1,this._callDecideEndpoint()))}})}}getFeatureFlag(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0){var n,i,r,a,o,s=this.getFlagVariants()[e],u="".concat(s),l=this.instance.get_property(Le)||{};return!t.send_event&&"send_event"in t||e in l&&l[e].includes(u)||(I(l[e])?l[e].push(u):l[e]=[u],null===(n=this.instance.persistence)||void 0===n||n.register({[Le]:l}),this.instance.capture("$feature_flag_called",{$feature_flag:e,$feature_flag_response:s,$feature_flag_payload:this.getFeatureFlagPayload(e)||null,$feature_flag_bootstrapped_response:(null===(i=this.instance.config.bootstrap)||void 0===i||null===(r=i.featureFlags)||void 0===r?void 0:r[e])||null,$feature_flag_bootstrapped_payload:(null===(a=this.instance.config.bootstrap)||void 0===a||null===(o=a.featureFlagPayloads)||void 0===o?void 0:o[e])||null,$used_bootstrap_value:!this._flagsLoadedFromRemote})),s}ze.warn('getFeatureFlag for key "'+e+"\" failed. Feature flags didn't load in time.")}getFeatureFlagPayload(e){return this.getFlagPayloads()[e]}isFeatureEnabled(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(e,t);ze.warn('isFeatureEnabled for key "'+e+"\" failed. Feature flags didn't load in time.")}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((t=>t!==e))}receivedFeatureFlags(e,t){if(this.instance.persistence){this._hasLoadedFlags=!0;var n=this.getFlagVariants(),i=this.getFlagPayloads();!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=e.featureFlags,a=e.featureFlagPayloads;if(r)if(I(r)){var o={};if(r)for(var s=0;s<r.length;s++)o[r[s]]=!0;t&&t.register({[$e]:r,[Ie]:o})}else{var u=r,l=a;e.errorsWhileComputingFlags&&(u=$($({},n),u),l=$($({},i),l)),t&&t.register({[$e]:Object.keys(Xe(u)),[Ie]:u||{},[We]:l||{}})}}(e,this.instance.persistence,n,i),this._fireFeatureFlagsCallbacks(t)}}override(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.instance.__loaded||!this.instance.persistence)return ze.uninitializedWarning("posthog.feature_flags.override");if(this._override_warning=t,!1===e)this.instance.persistence.unregister(Ke);else if(I(e)){for(var n={},i=0;i<e.length;i++)n[e[i]]=!0;this.instance.persistence.register({[Ke]:n})}else this.instance.persistence.register({[Ke]:e})}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this._hasLoadedFlags){var{flags:t,flagVariants:n}=this._prepareFeatureFlagsForCallbacks();e(t,n)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t){var n,i=(this.instance.get_property(Ce)||[]).find((t=>t.flagKey===e)),r={["$feature_enrollment/".concat(e)]:t},a={$feature_flag:e,$feature_enrollment:t,$set:r};i&&(a.$early_access_feature_name=i.name),this.instance.capture("$feature_enrollment_update",a),this.setPersonPropertiesForFlags(r,!1);var o=$($({},this.getFlagVariants()),{},{[e]:t});null===(n=this.instance.persistence)||void 0===n||n.register({[$e]:Object.keys(Xe(o)),[Ie]:o}),this._fireFeatureFlagsCallbacks()}getEarlyAccessFeatures(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.instance.get_property(Ce);if(n&&!t)return e(n);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/early_access_features/?token=".concat(this.instance.config.token)),method:"GET",callback:t=>{var n;if(t.json){var i=t.json.earlyAccessFeatures;return null===(n=this.instance.persistence)||void 0===n||n.register({[Ce]:i}),e(i)}}})}_prepareFeatureFlagsForCallbacks(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter((e=>t[e])),flagVariants:Object.keys(t).filter((e=>t[e])).reduce(((e,n)=>(e[n]=t[n],e)),{})}}_fireFeatureFlagsCallbacks(e){var{flags:t,flagVariants:n}=this._prepareFeatureFlagsForCallbacks();this.featureFlagEventHandlers.forEach((i=>i(t,n,{errorsLoading:e})))}setPersonPropertiesForFlags(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.instance.get_property(Me)||{};this.instance.register({[Me]:$($({},n),e)}),t&&this.instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this.instance.unregister(Me)}setGroupPropertiesForFlags(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.instance.get_property(Pe)||{};0!==Object.keys(n).length&&Object.keys(n).forEach((t=>{n[t]=$($({},n[t]),e[t]),delete e[t]})),this.instance.register({[Pe]:$($({},n),e)}),t&&this.instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this.instance.get_property(Pe)||{};this.instance.register({[Pe]:$($({},t),{},{[e]:{}})})}else this.instance.unregister(Pe)}}Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)}),Number.isInteger||(Number.isInteger=function(e){return j(e)&&isFinite(e)&&Math.floor(e)===e});var Je="0123456789abcdef";class Qe{constructor(e){if(this.bytes=e,16!==e.length)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,n,i){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(i)||e<0||t<0||n<0||i<0||e>0xffffffffffff||t>4095||n>1073741823||i>4294967295)throw new RangeError("invalid field value");var r=new Uint8Array(16);return r[0]=e/Math.pow(2,40),r[1]=e/Math.pow(2,32),r[2]=e/Math.pow(2,24),r[3]=e/Math.pow(2,16),r[4]=e/Math.pow(2,8),r[5]=e,r[6]=112|t>>>8,r[7]=t,r[8]=128|n>>>24,r[9]=n>>>16,r[10]=n>>>8,r[11]=n,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i,new Qe(r)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+Je.charAt(this.bytes[t]>>>4)+Je.charAt(15&this.bytes[t]),3!==t&&5!==t&&7!==t&&9!==t||(e+="-");if(36!==e.length)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new Qe(this.bytes.slice(0))}equals(e){return 0===this.compareTo(e)}compareTo(e){for(var t=0;t<16;t++){var n=this.bytes[t]-e.bytes[t];if(0!==n)return Math.sign(n)}return 0}}class Ze{constructor(){K(this,"timestamp",0),K(this,"counter",0),K(this,"random",new nt)}generate(){var e=this.generateOrAbort();if(R(e)){this.timestamp=0;var t=this.generateOrAbort();if(R(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.timestamp)this.timestamp=e,this.resetCounter();else{if(!(e+1e4>this.timestamp))return;this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter())}return Qe.fromFieldsV7(this.timestamp,Math.trunc(this.counter/Math.pow(2,30)),this.counter&Math.pow(2,30)-1,this.random.nextUint32())}resetCounter(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}}var et,tt=e=>{if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var t=0;t<e.length;t++)e[t]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return e};r&&!R(r.crypto)&&crypto.getRandomValues&&(tt=e=>crypto.getRandomValues(e));class nt{constructor(){K(this,"buffer",new Uint32Array(8)),K(this,"cursor",1/0)}nextUint32(){return this.cursor>=this.buffer.length&&(tt(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}var it=()=>rt().toString(),rt=()=>(et||(et=new Ze)).generate(),at="",ot=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;var st={is_supported:()=>!!c,error:function(e){H.error("cookieStore error: "+e)},get:function(e){if(c){try{for(var t=e+"=",n=c.cookie.split(";").filter((e=>e.length)),i=0;i<n.length;i++){for(var r=n[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return decodeURIComponent(r.substring(t.length,r.length))}}catch(e){}return null}},parse:function(e){var t;try{t=JSON.parse(st.get(e))||{}}catch(e){}return t},set:function(e,t,n,i,r){if(c)try{var a="",o="",s=function(e,t){if(t){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;if(at)return at;if(!t)return"";if(["localhost","127.0.0.1"].includes(e))return"";for(var n=e.split("."),i=Math.min(n.length,8),r="dmn_chk_"+it(),a=new RegExp("(^|;)\\s*"+r+"=1");!at&&i--;){var o=n.slice(i).join("."),s=r+"=1;domain=."+o;t.cookie=s,a.test(t.cookie)&&(t.cookie=s+";expires=Thu, 01 Jan 1970 00:00:00 GMT",at=o)}return at}(e);if(!n){var i=(e=>{var t=e.match(ot);return t?t[0]:""})(e);i!==n&&H.info("Warning: cookie subdomain discovery mismatch",i,n),n=i}return n?"; domain=."+n:""}return""}(c.location.hostname,i);if(n){var u=new Date;u.setTime(u.getTime()+24*n*60*60*1e3),a="; expires="+u.toUTCString()}r&&(o="; secure");var l=e+"="+encodeURIComponent(JSON.stringify(t))+a+"; SameSite=Lax; path=/"+s+o;return l.length>3686.4&&H.warn("cookieStore warning: large cookie, len="+l.length),c.cookie=l,l}catch(e){return}},remove:function(e,t){try{st.set(e,"",-1,t)}catch(e){return}}},ut=null,lt={is_supported:function(){if(!N(ut))return ut;var e=!0;if(R(r))e=!1;else try{var t="__mplssupport__";lt.set(t,"xyz"),'"xyz"'!==lt.get(t)&&(e=!1),lt.remove(t)}catch(t){e=!1}return e||H.error("localStorage unsupported; falling back to cookie store"),ut=e,e},error:function(e){H.error("localStorage error: "+e)},get:function(e){try{return null==r?void 0:r.localStorage.getItem(e)}catch(e){lt.error(e)}return null},parse:function(e){try{return JSON.parse(lt.get(e))||{}}catch(e){}return null},set:function(e,t){try{null==r||r.localStorage.setItem(e,JSON.stringify(t))}catch(e){lt.error(e)}},remove:function(e){try{null==r||r.localStorage.removeItem(e)}catch(e){lt.error(e)}}},ct=["distinct_id",xe,ke,He,Be],dt=$($({},lt),{},{parse:function(e){try{var t={};try{t=st.parse(e)||{}}catch(e){}var n=Q(t,JSON.parse(lt.get(e)||"{}"));return lt.set(e,n),n}catch(e){}return null},set:function(e,t,n,i,r,a){try{lt.set(e,t,void 0,void 0,a);var o={};ct.forEach((e=>{t[e]&&(o[e]=t[e])})),Object.keys(o).length&&st.set(e,o,n,i,r,a)}catch(e){lt.error(e)}},remove:function(e,t){try{null==r||r.localStorage.removeItem(e),st.remove(e,t)}catch(e){lt.error(e)}}}),ht={},ft={is_supported:function(){return!0},error:function(e){H.error("memoryStorage error: "+e)},get:function(e){return ht[e]||null},parse:function(e){return ht[e]||null},set:function(e,t){ht[e]=t},remove:function(e){delete ht[e]}},pt=null,gt={is_supported:function(){if(!N(pt))return pt;if(pt=!0,R(r))pt=!1;else try{var e="__support__";gt.set(e,"xyz"),'"xyz"'!==gt.get(e)&&(pt=!1),gt.remove(e)}catch(e){pt=!1}return pt},error:function(e){H.error("sessionStorage error: ",e)},get:function(e){try{return null==r?void 0:r.sessionStorage.getItem(e)}catch(e){gt.error(e)}return null},parse:function(e){try{return JSON.parse(gt.get(e))||null}catch(e){}return null},set:function(e,t){try{null==r||r.sessionStorage.setItem(e,JSON.stringify(t))}catch(e){gt.error(e)}},remove:function(e){try{null==r||r.sessionStorage.removeItem(e)}catch(e){gt.error(e)}}},mt=["localhost","127.0.0.1"],vt=e=>{var t=null==c?void 0:c.createElement("a");return R(t)?null:(t.href=e,t)},yt=function(e,t){return!!function(e){try{new RegExp(e)}catch(e){return!1}return!0}(t)&&new RegExp(t).test(e)},bt=function(e,t){for(var n,i=((e.split("#")[0]||"").split("?")[1]||"").split("&"),r=0;r<i.length;r++){var a=i[r].split("=");if(a[0]===t){n=a;break}}if(!I(n)||n.length<2)return"";var o=n[1];try{o=decodeURIComponent(o)}catch(e){H.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},wt=function(e,t,n){if(!e||!t||!t.length)return e;for(var i=e.split("#"),r=i[0]||"",a=i[1],o=r.split("?"),s=o[1],u=o[0],l=(s||"").split("&"),c=[],d=0;d<l.length;d++){var h=l[d].split("=");I(h)&&(t.includes(h[0])?c.push(h[0]+"="+n):c.push(l[d]))}var f=u;return null!=s&&(f+="?"+c.join("&")),null!=a&&(f+="#"+a),f},_t=function(e,t){var n=e.match(new RegExp(t+"=([^&]*)"));return n?n[1]:null},St="Mobile",Tt="iOS",xt="Android",kt="Tablet",At=xt+" "+kt,Et="iPad",It="Apple",Ct=It+" Watch",Mt="Safari",Pt="BlackBerry",Rt="Samsung",Dt=Rt+"Browser",Lt=Rt+" Internet",Nt="Chrome",Ot=Nt+" OS",jt=Nt+" "+Tt,Ut="Internet Explorer",Ft=Ut+" "+St,Bt="Opera",Ht=Bt+" Mini",Vt="Edge",qt="Microsoft "+Vt,Gt="Firefox",zt=Gt+" "+Tt,$t="Nintendo",Kt="PlayStation",Wt="Xbox",Xt=xt+" "+St,Yt=St+" "+Mt,Jt="Windows",Qt=Jt+" Phone",Zt="Nokia",en="Ouya",tn="Generic",nn=tn+" "+St.toLowerCase(),rn=tn+" "+kt.toLowerCase(),an="Konqueror",on="(\\d+(\\.\\d+)?)",sn=new RegExp("Version/"+on),un=new RegExp(Wt,"i"),ln=new RegExp(Kt+" \\w+","i"),cn=new RegExp($t+" \\w+","i"),dn=new RegExp(Pt+"|PlayBook|BB10","i"),hn={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},fn=function(e,t){return t=t||"",_(e," OPR/")&&_(e,"Mini")?Ht:_(e," OPR/")?Bt:dn.test(e)?Pt:_(e,"IE"+St)||_(e,"WPDesktop")?Ft:_(e,Dt)?Lt:_(e,Vt)||_(e,"Edg/")?qt:_(e,"FBIOS")?"Facebook "+St:_(e,"UCWEB")||_(e,"UCBrowser")?"UC Browser":_(e,"CriOS")?jt:_(e,"CrMo")||_(e,Nt)?Nt:_(e,xt)&&_(e,Mt)?Xt:_(e,"FxiOS")?zt:_(e.toLowerCase(),an.toLowerCase())?an:((e,t)=>t&&_(t,It)||function(e){return _(e,Mt)&&!_(e,Nt)&&!_(e,xt)}(e))(e,t)?_(e,St)?Yt:Mt:_(e,Gt)?Gt:_(e,"MSIE")||_(e,"Trident/")?Ut:_(e,"Gecko")?Gt:""},pn={[Ft]:[new RegExp("rv:"+on)],[qt]:[new RegExp(Vt+"?\\/"+on)],[Nt]:[new RegExp("("+Nt+"|CrMo)\\/"+on)],[jt]:[new RegExp("CriOS\\/"+on)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+on)],[Mt]:[sn],[Yt]:[sn],[Bt]:[new RegExp("(Opera|OPR)\\/"+on)],[Gt]:[new RegExp(Gt+"\\/"+on)],[zt]:[new RegExp("FxiOS\\/"+on)],[an]:[new RegExp("Konqueror[:/]?"+on,"i")],[Pt]:[new RegExp(Pt+" "+on),sn],[Xt]:[new RegExp("android\\s"+on,"i")],[Lt]:[new RegExp(Dt+"\\/"+on)],[Ut]:[new RegExp("(rv:|MSIE )"+on)],Mozilla:[new RegExp("rv:"+on)]},gn=[[new RegExp(Wt+"; "+Wt+" (.*?)[);]","i"),e=>[Wt,e&&e[1]||""]],[new RegExp($t,"i"),[$t,""]],[new RegExp(Kt,"i"),[Kt,""]],[dn,[Pt,""]],[new RegExp(Jt,"i"),(e,t)=>{if(/Phone/.test(t)||/WPDesktop/.test(t))return[Qt,""];if(new RegExp(St).test(t)&&!/IEMobile\b/.test(t))return[Jt+" "+St,""];var n=/Windows NT ([0-9.]+)/i.exec(t);if(n&&n[1]){var i=n[1],r=hn[i]||"";return/arm/i.test(t)&&(r="RT"),[Jt,r]}return[Jt,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,e=>{if(e&&e[3]){var t=[e[3],e[4],e[5]||"0"];return[Tt,t.join(".")]}return[Tt,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,e=>{var t="";return e&&e.length>=3&&(t=R(e[2])?e[3]:e[2]),["watchOS",t]}],[new RegExp("("+xt+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+xt+")","i"),e=>{if(e&&e[2]){var t=[e[2],e[3],e[4]||"0"];return[xt,t.join(".")]}return[xt,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,e=>{var t=["Mac OS X",""];if(e&&e[1]){var n=[e[1],e[2],e[3]||"0"];t[1]=n.join(".")}return t}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[Ot,""]],[/Linux|debian/i,["Linux",""]]],mn=function(e){return cn.test(e)?$t:ln.test(e)?Kt:un.test(e)?Wt:new RegExp(en,"i").test(e)?en:new RegExp("("+Qt+"|WPDesktop)","i").test(e)?Qt:/iPad/.test(e)?Et:/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(e)?Ct:dn.test(e)?Pt:/(kobo)\s(ereader|touch)/i.test(e)?"Kobo":new RegExp(Zt,"i").test(e)?Zt:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(e)||/(kf[a-z]+)( bui|\)).+silk\//i.test(e)?"Kindle Fire":/(Android|ZTE)/i.test(e)?!new RegExp(St).test(e)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(e)?/pixel[\daxl ]{1,6}/i.test(e)&&!/pixel c/i.test(e)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(e)||/lmy47v/i.test(e)&&!/QTAQZ3/i.test(e)?xt:At:xt:new RegExp("(pda|"+St+")","i").test(e)?nn:new RegExp(kt,"i").test(e)&&!new RegExp(kt+" pc","i").test(e)?rn:""},vn="https?://(.*)",yn=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","irclid","_kx"],bn=Z(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],yn),wn="<masked>",_n={campaignParams:function(){var{customTrackedParams:e,maskPersonalDataProperties:t,customPersonalDataProperties:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!c)return{};var i=t?Z([],yn,n||[]):[];return this._campaignParamsFromUrl(wt(c.URL,i,wn),e)},_campaignParamsFromUrl:function(e,t){var n=bn.concat(t||[]),i={};return J(n,(function(t){var n=bt(e,t);i[t]=n||null})),i},_searchEngine:function(e){return e?0===e.search(vn+"google.([^/?]*)")?"google":0===e.search(vn+"bing.com")?"bing":0===e.search(vn+"yahoo.com")?"yahoo":0===e.search(vn+"duckduckgo.com")?"duckduckgo":null:null},_searchInfoFromReferrer:function(e){var t=_n._searchEngine(e),n="yahoo"!=t?"q":"p",i={};if(!N(t)){i.$search_engine=t;var r=c?bt(c.referrer,n):"";r.length&&(i.ph_keyword=r)}return i},searchInfo:function(){var e=null==c?void 0:c.referrer;return e?this._searchInfoFromReferrer(e):{}},browser:fn,browserVersion:function(e,t){var n=fn(e,t),i=pn[n];if(R(i))return null;for(var r=0;r<i.length;r++){var a=i[r],o=e.match(a);if(o)return parseFloat(o[o.length-2])}return null},browserLanguage:function(){return navigator.language||navigator.userLanguage},browserLanguagePrefix:function(){var e=this.browserLanguage();return"string"==typeof e?e.split("-")[0]:void 0},os:function(e){for(var t=0;t<gn.length;t++){var[n,i]=gn[t],r=n.exec(e),a=r&&(C(i)?i(r,e):i);if(a)return a}return["",""]},device:mn,deviceType:function(e){var t=mn(e);return t===Et||t===At||"Kobo"===t||"Kindle Fire"===t||t===rn?kt:t===$t||t===Wt||t===Kt||t===en?"Console":t===Ct?"Wearable":t?St:"Desktop"},referrer:function(){return(null==c?void 0:c.referrer)||"$direct"},referringDomain:function(){var e;return null!=c&&c.referrer&&(null===(e=vt(c.referrer))||void 0===e?void 0:e.host)||"$direct"},referrerInfo:function(){return{$referrer:this.referrer(),$referring_domain:this.referringDomain()}},initialPersonInfo:function(){return{r:this.referrer().substring(0,1e3),u:null==d?void 0:d.href.substring(0,1e3)}},initialPersonPropsFromInfo:function(e){var t,{r:n,u:i}=e,r={$initial_referrer:n,$initial_referring_domain:null==n?void 0:"$direct"==n?"$direct":null===(t=vt(n))||void 0===t?void 0:t.host};if(i){r.$initial_current_url=i;var a=vt(i);r.$initial_host=null==a?void 0:a.host,r.$initial_pathname=null==a?void 0:a.pathname,J(this._campaignParamsFromUrl(i),(function(e,t){r["$initial_"+T(t)]=e}))}return n&&J(this._searchInfoFromReferrer(n),(function(e,t){r["$initial_"+T(t)]=e})),r},timezone:function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){return}},timezoneOffset:function(){try{return(new Date).getTimezoneOffset()}catch(e){return}},properties:function(){var{maskPersonalDataProperties:e,customPersonalDataProperties:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!g)return{};var n=e?Z([],yn,t||[]):[],[i,a]=_n.os(g);return Q(ie({$os:i,$os_version:a,$browser:_n.browser(g,navigator.vendor),$device:_n.device(g),$device_type:_n.deviceType(g),$timezone:_n.timezone(),$timezone_offset:_n.timezoneOffset()}),{$current_url:wt(null==d?void 0:d.href,n,wn),$host:null==d?void 0:d.host,$pathname:null==d?void 0:d.pathname,$raw_user_agent:g.length>1e3?g.substring(0,997)+"...":g,$browser_version:_n.browserVersion(g,navigator.vendor),$browser_language:_n.browserLanguage(),$browser_language_prefix:_n.browserLanguagePrefix(),$screen_height:null==r?void 0:r.screen.height,$screen_width:null==r?void 0:r.screen.width,$viewport_height:null==r?void 0:r.innerHeight,$viewport_width:null==r?void 0:r.innerWidth,$lib:"web",$lib_version:v.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})},people_properties:function(){if(!g)return{};var[e,t]=_n.os(g);return Q(ie({$os:e,$os_version:t,$browser:_n.browser(g,navigator.vendor)}),{$browser_version:_n.browserVersion(g,navigator.vendor)})}},Sn=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class Tn{constructor(e){this.config=e,this.props={},this.campaign_params_saved=!1,this.name=(e=>{var t="";return e.token&&(t=e.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),e.persistence_name?"ph_"+e.persistence_name:"ph_"+t+"_posthog"})(e),this.storage=this.buildStorage(e),this.load(),e.debug&&H.info("Persistence loaded",e.persistence,$({},this.props)),this.update_config(e,e),this.save()}buildStorage(e){-1===Sn.indexOf(e.persistence.toLowerCase())&&(H.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=e.persistence.toLowerCase();return"localstorage"===t&&lt.is_supported()?lt:"localstorage+cookie"===t&&dt.is_supported()?dt:"sessionstorage"===t&&gt.is_supported()?gt:"memory"===t?ft:"cookie"===t?st:dt.is_supported()?dt:st}properties(){var e={};return J(this.props,(function(t,n){if(n===Ie&&M(t))for(var i=Object.keys(t),r=0;r<i.length;r++)e["$feature/".concat(i[r])]=t[i[r]];else o=n,s=!1,(N(a=Ge)?s:u&&a.indexOf===u?-1!=a.indexOf(o):(J(a,(function(e){if(s||(s=e===o))return X})),s))||(e[n]=t);var a,o,s})),e}load(){if(!this.disabled){var e=this.storage.parse(this.name);e&&(this.props=Q({},e))}}save(){this.disabled||this.storage.set(this.name,this.props,this.expire_days,this.cross_subdomain,this.secure,this.config.debug)}remove(){this.storage.remove(this.name,!1),this.storage.remove(this.name,!0)}clear(){this.remove(),this.props={}}register_once(e,t,n){if(M(e)){R(t)&&(t="None"),this.expire_days=R(n)?this.default_expiry:n;var i=!1;if(J(e,((e,n)=>{this.props.hasOwnProperty(n)&&this.props[n]!==t||(this.props[n]=e,i=!0)})),i)return this.save(),!0}return!1}register(e,t){if(M(e)){this.expire_days=R(t)?this.default_expiry:t;var n=!1;if(J(e,((t,i)=>{e.hasOwnProperty(i)&&this.props[i]!==t&&(this.props[i]=t,n=!0)})),n)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.campaign_params_saved){var e=_n.campaignParams({customTrackedParams:this.config.custom_campaign_params,maskPersonalDataProperties:this.config.mask_personal_data_properties,customPersonalDataProperties:this.config.custom_personal_data_properties});P(ie(e))||this.register(e),this.campaign_params_saved=!0}}update_search_keyword(){this.register(_n.searchInfo())}update_referrer_info(){this.register_once(_n.referrerInfo(),void 0)}set_initial_person_info(){this.props[Ue]||this.props[Fe]||this.register_once({[Be]:_n.initialPersonInfo()},void 0)}get_referrer_info(){return ie({$referrer:this.props.$referrer,$referring_domain:this.props.$referring_domain})}get_initial_props(){var e={};J([Fe,Ue],(t=>{var n=this.props[t];n&&J(n,(function(t,n){e["$initial_"+T(n)]=t}))}));var t=this.props[Be];if(t){var n=_n.initialPersonPropsFromInfo(t);Q(e,n)}return e}safe_merge(e){return J(this.props,(function(t,n){n in e||(e[n]=t)})),e}update_config(e,t){if(this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence){var n=this.buildStorage(e),i=this.props;this.clear(),this.storage=n,this.props=i,this.save()}}set_disabled(e){this.disabled=e,this.disabled?this.remove():this.save()}set_cross_subdomain(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())}get_cross_subdomain(){return!!this.cross_subdomain}set_secure(e){e!==this.secure&&(this.secure=e,this.remove(),this.save())}set_event_timer(e,t){var n=this.props[ce]||{};n[e]=t,this.props[ce]=n,this.save()}remove_event_timer(e){var t=(this.props[ce]||{})[e];return R(t)||(delete this.props[ce][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}function xn(e){var t,n;return(null===(t=JSON.stringify(e,(n=[],function(e,t){if(M(t)){for(;n.length>0&&n[n.length-1]!==this;)n.pop();return n.includes(t)?"[Circular]":(n.push(t),t)}return t})))||void 0===t?void 0:t.length)||0}function kn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6606028.8;if(e.size>=t&&e.data.length>1){var n=Math.floor(e.data.length/2),i=e.data.slice(0,n),r=e.data.slice(n);return[kn({size:xn(i),data:i,sessionId:e.sessionId,windowId:e.windowId}),kn({size:xn(r),data:r,sessionId:e.sessionId,windowId:e.windowId})].flatMap((e=>e))}return[e]}var An=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(An||{}),En=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(En||{});function In(e){var t;return e instanceof Element&&(e.id===Ve||!(null===(t=e.closest)||void 0===t||!t.call(e,".toolbar-global-fade-container")))}function Cn(e){return!!e&&1===e.nodeType}function Mn(e,t){return!!e&&!!e.tagName&&e.tagName.toLowerCase()===t.toLowerCase()}function Pn(e){return!!e&&3===e.nodeType}function Rn(e){return!!e&&11===e.nodeType}function Dn(e){return e?S(e).split(/\s+/):[]}function Ln(e){var t=null==r?void 0:r.location.href;return!!(t&&e&&e.some((e=>t.match(e))))}function Nn(e){var t="";switch(typeof e.className){case"string":t=e.className;break;case"object":t=(e.className&&"baseVal"in e.className?e.className.baseVal:null)||e.getAttribute("class")||"";break;default:t=""}return Dn(t)}function On(e){return O(e)?null:S(e).split(/(\s+)/).filter((e=>Xn(e))).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function jn(e){var t="";return Hn(e)&&!Vn(e)&&e.childNodes&&e.childNodes.length&&J(e.childNodes,(function(e){var n;Pn(e)&&e.textContent&&(t+=null!==(n=On(e.textContent))&&void 0!==n?n:"")})),S(t)}function Un(e){return R(e.target)?e.srcElement||null:null!==(t=e.target)&&void 0!==t&&t.shadowRoot?e.composedPath()[0]||null:e.target||null;var t}var Fn=["a","button","form","input","select","textarea","label"];function Bn(e){var t=e.parentNode;return!(!t||!Cn(t))&&t}function Hn(e){for(var t=e;t.parentNode&&!Mn(t,"body");t=t.parentNode){var n=Nn(t);if(_(n,"ph-sensitive")||_(n,"ph-no-capture"))return!1}if(_(Nn(e),"ph-include"))return!0;var i=e.type||"";if(D(i))switch(i.toLowerCase()){case"hidden":case"password":return!1}var r=e.name||e.id||"";return!D(r)||!/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(r.replace(/[^a-zA-Z0-9]/g,""))}function Vn(e){return!!(Mn(e,"input")&&!["button","checkbox","submit","reset"].includes(e.type)||Mn(e,"select")||Mn(e,"textarea")||"true"===e.getAttribute("contenteditable"))}var qn="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",Gn=new RegExp("^(?:".concat(qn,")$")),zn=new RegExp(qn),$n="\\d{3}-?\\d{2}-?\\d{4}",Kn=new RegExp("^(".concat($n,")$")),Wn=new RegExp("(".concat($n,")"));function Xn(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(O(e))return!1;if(D(e)){if(e=S(e),(t?Gn:zn).test((e||"").replace(/[- ]/g,"")))return!1;if((t?Kn:Wn).test(e))return!1}return!0}function Yn(e){var t=jn(e);return Xn(t="".concat(t," ").concat(Jn(e)).trim())?t:""}function Jn(e){var t="";return e&&e.childNodes&&e.childNodes.length&&J(e.childNodes,(function(e){var n;if(e&&"span"===(null===(n=e.tagName)||void 0===n?void 0:n.toLowerCase()))try{var i=jn(e);t="".concat(t," ").concat(i).trim(),e.childNodes&&e.childNodes.length&&(t="".concat(t," ").concat(Jn(e)).trim())}catch(e){H.error("[AutoCapture]",e)}})),t}function Qn(e){return function(e){var t=e.map((e=>{var t,n,i="";if(e.tag_name&&(i+=e.tag_name),e.attr_class)for(var r of(e.attr_class.sort(),e.attr_class))i+=".".concat(r.replace(/"/g,""));var a=$($($($({},e.text?{text:e.text}:{}),{},{"nth-child":null!==(t=e.nth_child)&&void 0!==t?t:0,"nth-of-type":null!==(n=e.nth_of_type)&&void 0!==n?n:0},e.href?{href:e.href}:{}),e.attr_id?{attr_id:e.attr_id}:{}),e.attributes),o={};return ee(a).sort(((e,t)=>{var[n]=e,[i]=t;return n.localeCompare(i)})).forEach((e=>{var[t,n]=e;return o[Zn(t.toString())]=Zn(n.toString())})),(i+=":")+ee(a).map((e=>{var[t,n]=e;return"".concat(t,'="').concat(n,'"')})).join("")}));return t.join(";")}(function(e){return e.map((e=>{var t,n,i={text:null===(t=e.$el_text)||void 0===t?void 0:t.slice(0,400),tag_name:e.tag_name,href:null===(n=e.attr__href)||void 0===n?void 0:n.slice(0,2048),attr_class:ei(e),attr_id:e.attr__id,nth_child:e.nth_child,nth_of_type:e.nth_of_type,attributes:{}};return ee(e).filter((e=>{var[t]=e;return 0===t.indexOf("attr__")})).forEach((e=>{var[t,n]=e;return i.attributes[t]=n})),i}))}(e))}function Zn(e){return e.replace(/"|\\"/g,'\\"')}function ei(e){var t=e.attr__class;return t?I(t)?t:Dn(t):void 0}var ti="[SessionRecording]",ni="redacted",ii={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:e=>e,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com"]},ri=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],ai=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],oi=["/s/","/e/","/i/"];function si(e,t,n,i){if(O(e))return e;var r=(null==t?void 0:t["content-length"])||function(e){return new Blob([e]).size}(e);return D(r)&&(r=parseInt(r)),r>n?ti+" ".concat(i," body too large to record (").concat(r," bytes)"):e}function ui(e,t){if(O(e))return e;var n=e;return Xn(n,!1)||(n=ti+" "+t+" body "+ni),J(ai,(e=>{var i,r;null!==(i=n)&&void 0!==i&&i.length&&-1!==(null===(r=n)||void 0===r?void 0:r.indexOf(e))&&(n=ti+" "+t+" body "+ni+" as might contain: "+e)})),n}function li(e,t,n,i,r){return t>n&&(H.warn("min cannot be greater than max."),t=n),j(e)?e>n?(i&&H.warn(i+" cannot be  greater than max: "+n+". Using max value instead."),n):e<t?(i&&H.warn(i+" cannot be less than min: "+t+". Using min value instead."),t):e:(i&&H.warn(i+" must be a number. using max or fallback. max: "+n+", fallback: "+r),li(r||n,t,n,i))}class ci{constructor(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};K(this,"bucketSize",100),K(this,"refillRate",10),K(this,"mutationBuckets",{}),K(this,"loggedTracker",{}),K(this,"refillBuckets",(()=>{Object.keys(this.mutationBuckets).forEach((e=>{this.mutationBuckets[e]=this.mutationBuckets[e]+this.refillRate,this.mutationBuckets[e]>=this.bucketSize&&delete this.mutationBuckets[e]}))})),K(this,"getNodeOrRelevantParent",(e=>{var t=this.rrweb.mirror.getNode(e);if("svg"!==(null==t?void 0:t.nodeName)&&t instanceof Element){var n=t.closest("svg");if(n)return[this.rrweb.mirror.getId(n),n]}return[e,t]})),K(this,"numberOfChanges",(e=>{var t,n,i,r,a,o,s,u;return(null!==(t=null===(n=e.removes)||void 0===n?void 0:n.length)&&void 0!==t?t:0)+(null!==(i=null===(r=e.attributes)||void 0===r?void 0:r.length)&&void 0!==i?i:0)+(null!==(a=null===(o=e.texts)||void 0===o?void 0:o.length)&&void 0!==a?a:0)+(null!==(s=null===(u=e.adds)||void 0===u?void 0:u.length)&&void 0!==s?s:0)})),K(this,"throttleMutations",(e=>{if(3!==e.type||0!==e.data.source)return e;var t=e.data,n=this.numberOfChanges(t);t.attributes&&(t.attributes=t.attributes.filter((e=>{var t,n,i,[r,a]=this.getNodeOrRelevantParent(e.id);return 0!==this.mutationBuckets[r]&&(this.mutationBuckets[r]=null!==(t=this.mutationBuckets[r])&&void 0!==t?t:this.bucketSize,this.mutationBuckets[r]=Math.max(this.mutationBuckets[r]-1,0),0===this.mutationBuckets[r]&&(this.loggedTracker[r]||(this.loggedTracker[r]=!0,null===(n=(i=this.options).onBlockedNode)||void 0===n||n.call(i,r,a))),e)})));var i=this.numberOfChanges(t);return 0!==i||n===i?e:void 0})),this.rrweb=e,this.options=i,this.refillRate=li(null!==(t=this.options.refillRate)&&void 0!==t?t:this.refillRate,0,100,"mutation throttling refill rate"),this.bucketSize=li(null!==(n=this.options.bucketSize)&&void 0!==n?n:this.bucketSize,0,100,"mutation throttling bucket size"),setInterval((()=>{this.refillBuckets()}),1e3)}}var di=Uint8Array,hi=Uint16Array,fi=Uint32Array,pi=new di([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),gi=new di([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),mi=new di([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vi=function(e,t){for(var n=new hi(31),i=0;i<31;++i)n[i]=t+=1<<e[i-1];var r=new fi(n[30]);for(i=1;i<30;++i)for(var a=n[i];a<n[i+1];++a)r[a]=a-n[i]<<5|i;return[n,r]},yi=vi(pi,2),bi=yi[0],wi=yi[1];bi[28]=258,wi[258]=28;for(var _i=vi(gi,0)[1],Si=new hi(32768),Ti=0;Ti<32768;++Ti){var xi=(43690&Ti)>>>1|(21845&Ti)<<1;xi=(61680&(xi=(52428&xi)>>>2|(13107&xi)<<2))>>>4|(3855&xi)<<4,Si[Ti]=((65280&xi)>>>8|(255&xi)<<8)>>>1}var ki=function(e,t,n){for(var i=e.length,r=0,a=new hi(t);r<i;++r)++a[e[r]-1];var o,s=new hi(t);for(r=0;r<t;++r)s[r]=s[r-1]+a[r-1]<<1;if(n){o=new hi(1<<t);var u=15-t;for(r=0;r<i;++r)if(e[r])for(var l=r<<4|e[r],c=t-e[r],d=s[e[r]-1]++<<c,h=d|(1<<c)-1;d<=h;++d)o[Si[d]>>>u]=l}else for(o=new hi(i),r=0;r<i;++r)o[r]=Si[s[e[r]-1]++]>>>15-e[r];return o},Ai=new di(288);for(Ti=0;Ti<144;++Ti)Ai[Ti]=8;for(Ti=144;Ti<256;++Ti)Ai[Ti]=9;for(Ti=256;Ti<280;++Ti)Ai[Ti]=7;for(Ti=280;Ti<288;++Ti)Ai[Ti]=8;var Ei=new di(32);for(Ti=0;Ti<32;++Ti)Ei[Ti]=5;var Ii=ki(Ai,9,0),Ci=ki(Ei,5,0),Mi=function(e){return(e/8|0)+(7&e&&1)},Pi=function(e,t,n){(null==n||n>e.length)&&(n=e.length);var i=new(e instanceof hi?hi:e instanceof fi?fi:di)(n-t);return i.set(e.subarray(t,n)),i},Ri=function(e,t,n){n<<=7&t;var i=t/8|0;e[i]|=n,e[i+1]|=n>>>8},Di=function(e,t,n){n<<=7&t;var i=t/8|0;e[i]|=n,e[i+1]|=n>>>8,e[i+2]|=n>>>16},Li=function(e,t){for(var n=[],i=0;i<e.length;++i)e[i]&&n.push({s:i,f:e[i]});var r=n.length,a=n.slice();if(!r)return[new di(0),0];if(1==r){var o=new di(n[0].s+1);return o[n[0].s]=1,[o,1]}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var s=n[0],u=n[1],l=0,c=1,d=2;for(n[0]={s:-1,f:s.f+u.f,l:s,r:u};c!=r-1;)s=n[n[l].f<n[d].f?l++:d++],u=n[l!=c&&n[l].f<n[d].f?l++:d++],n[c++]={s:-1,f:s.f+u.f,l:s,r:u};var h=a[0].s;for(i=1;i<r;++i)a[i].s>h&&(h=a[i].s);var f=new hi(h+1),p=Ni(n[c-1],f,0);if(p>t){i=0;var g=0,m=p-t,v=1<<m;for(a.sort((function(e,t){return f[t.s]-f[e.s]||e.f-t.f}));i<r;++i){var y=a[i].s;if(!(f[y]>t))break;g+=v-(1<<p-f[y]),f[y]=t}for(g>>>=m;g>0;){var b=a[i].s;f[b]<t?g-=1<<t-f[b]++-1:++i}for(;i>=0&&g;--i){var w=a[i].s;f[w]==t&&(--f[w],++g)}p=t}return[new di(f),p]},Ni=function(e,t,n){return-1==e.s?Math.max(Ni(e.l,t,n+1),Ni(e.r,t,n+1)):t[e.s]=n},Oi=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new hi(++t),i=0,r=e[0],a=1,o=function(e){n[i++]=e},s=1;s<=t;++s)if(e[s]==r&&s!=t)++a;else{if(!r&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(r),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(r);a=1,r=e[s]}return[n.subarray(0,i),t]},ji=function(e,t){for(var n=0,i=0;i<t.length;++i)n+=e[i]*t[i];return n},Ui=function(e,t,n){var i=n.length,r=Mi(t+2);e[r]=255&i,e[r+1]=i>>>8,e[r+2]=255^e[r],e[r+3]=255^e[r+1];for(var a=0;a<i;++a)e[r+a+4]=n[a];return 8*(r+4+i)},Fi=function(e,t,n,i,r,a,o,s,u,l,c){Ri(t,c++,n),++r[256];for(var d=Li(r,15),h=d[0],f=d[1],p=Li(a,15),g=p[0],m=p[1],v=Oi(h),y=v[0],b=v[1],w=Oi(g),_=w[0],S=w[1],T=new hi(19),x=0;x<y.length;++x)T[31&y[x]]++;for(x=0;x<_.length;++x)T[31&_[x]]++;for(var k=Li(T,7),A=k[0],E=k[1],I=19;I>4&&!A[mi[I-1]];--I);var C,M,P,R,D=l+5<<3,L=ji(r,Ai)+ji(a,Ei)+o,N=ji(r,h)+ji(a,g)+o+14+3*I+ji(T,A)+(2*T[16]+3*T[17]+7*T[18]);if(D<=L&&D<=N)return Ui(t,c,e.subarray(u,u+l));if(Ri(t,c,1+(N<L)),c+=2,N<L){C=ki(h,f,0),M=h,P=ki(g,m,0),R=g;var O=ki(A,E,0);for(Ri(t,c,b-257),Ri(t,c+5,S-1),Ri(t,c+10,I-4),c+=14,x=0;x<I;++x)Ri(t,c+3*x,A[mi[x]]);c+=3*I;for(var j=[y,_],U=0;U<2;++U){var F=j[U];for(x=0;x<F.length;++x){var B=31&F[x];Ri(t,c,O[B]),c+=A[B],B>15&&(Ri(t,c,F[x]>>>5&127),c+=F[x]>>>12)}}}else C=Ii,M=Ai,P=Ci,R=Ei;for(x=0;x<s;++x)if(i[x]>255){B=i[x]>>>18&31,Di(t,c,C[B+257]),c+=M[B+257],B>7&&(Ri(t,c,i[x]>>>23&31),c+=pi[B]);var H=31&i[x];Di(t,c,P[H]),c+=R[H],H>3&&(Di(t,c,i[x]>>>5&8191),c+=gi[H])}else Di(t,c,C[i[x]]),c+=M[i[x]];return Di(t,c,C[256]),c+M[256]},Bi=new fi([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Hi=function(){for(var e=new fi(256),t=0;t<256;++t){for(var n=t,i=9;--i;)n=(1&n&&3988292384)^n>>>1;e[t]=n}return e}(),Vi=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8};function qi(e,t){void 0===t&&(t={});var n=function(){var e=4294967295;return{p:function(t){for(var n=e,i=0;i<t.length;++i)n=Hi[255&n^t[i]]^n>>>8;e=n},d:function(){return 4294967295^e}}}(),i=e.length;n.p(e);var r=function(e,t,n,i,r){return function(e,t,n,i,r,a){var o=e.length,s=new di(i+o+5*(1+Math.floor(o/7e3))+r),u=s.subarray(i,s.length-r),l=0;if(!t||o<8)for(var c=0;c<=o;c+=65535){var d=c+65535;d<o?l=Ui(u,l,e.subarray(c,d)):(u[c]=a,l=Ui(u,l,e.subarray(c,o)))}else{for(var h=Bi[t-1],f=h>>>13,p=8191&h,g=(1<<n)-1,m=new hi(32768),v=new hi(g+1),y=Math.ceil(n/3),b=2*y,w=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<b)&g},_=new fi(25e3),S=new hi(288),T=new hi(32),x=0,k=0,A=(c=0,0),E=0,I=0;c<o;++c){var C=w(c),M=32767&c,P=v[C];if(m[M]=P,v[C]=M,E<=c){var R=o-c;if((x>7e3||A>24576)&&R>423){l=Fi(e,u,0,_,S,T,k,A,I,c-I,l),A=x=k=0,I=c;for(var D=0;D<286;++D)S[D]=0;for(D=0;D<30;++D)T[D]=0}var L=2,N=0,O=p,j=M-P&32767;if(R>2&&C==w(c-j))for(var U=Math.min(f,R)-1,F=Math.min(32767,c),B=Math.min(258,R);j<=F&&--O&&M!=P;){if(e[c+L]==e[c+L-j]){for(var H=0;H<B&&e[c+H]==e[c+H-j];++H);if(H>L){if(L=H,N=j,H>U)break;var V=Math.min(j,H-2),q=0;for(D=0;D<V;++D){var G=c-j+D+32768&32767,z=G-m[G]+32768&32767;z>q&&(q=z,P=G)}}}j+=(M=P)-(P=m[M])+32768&32767}if(N){_[A++]=268435456|wi[L]<<18|_i[N];var $=31&wi[L],K=31&_i[N];k+=pi[$]+gi[K],++S[257+$],++T[K],E=c+L,++x}else _[A++]=e[c],++S[e[c]]}}l=Fi(e,u,a,_,S,T,k,A,I,c-I,l)}return Pi(s,0,i+Mi(l)+r)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,i,!r)}(e,t,function(e){return 10+(e.filename&&e.filename.length+1||0)}(t),8),a=r.length;return function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&Vi(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var i=0;i<=n.length;++i)e[i+10]=n.charCodeAt(i)}}(r,t),Vi(r,a-8,n.d()),Vi(r,a-4,i),r}function Gi(e,t){var n=e.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);for(var i=new di(e.length+(e.length>>>1)),r=0,a=function(e){i[r++]=e},o=0;o<n;++o){if(r+5>i.length){var s=new di(r+8+(n-o<<1));s.set(i),i=s}var u=e.charCodeAt(o);u<128||t?a(u):u<2048?(a(192|u>>>6),a(128|63&u)):u>55295&&u<57344?(a(240|(u=65536+(1047552&u)|1023&e.charCodeAt(++o))>>>18),a(128|u>>>12&63),a(128|u>>>6&63),a(128|63&u)):(a(224|u>>>12),a(128|u>>>6&63),a(128|63&u))}return Pi(i,0,r)}var zi="[SessionRecording]",$i=V(zi),Ki=[En.MouseMove,En.MouseInteraction,En.Scroll,En.ViewportResize,En.Input,En.TouchMove,En.MediaInteraction,En.Drag],Wi=e=>({rrwebMethod:e,enqueuedAt:Date.now(),attempt:1});function Xi(e){return function(e){for(var t="",n=0;n<e.length;){var i=e[n++];t+=String.fromCharCode(i)}return t}(qi(Gi(JSON.stringify(e))))}function Yi(e){return e.type===An.Custom&&"sessionIdle"===e.data.tag}function Ji(e,t){return t.some((t=>"regex"===t.matching&&new RegExp(t.url).test(e)))}class Qi{get sessionIdleThresholdMilliseconds(){return this.instance.config.session_recording.session_idle_threshold_ms||3e5}get rrwebRecord(){var e,t;return null==m||null===(e=m.__PosthogExtensions__)||void 0===e||null===(t=e.rrweb)||void 0===t?void 0:t.record}get started(){return this._captureStarted}get sessionManager(){if(!this.instance.sessionManager)throw new Error(zi+" must be started with a valid sessionManager.");return this.instance.sessionManager}get fullSnapshotIntervalMillis(){var e,t;return"trigger_pending"===this.triggerStatus?6e4:null!==(e=null===(t=this.instance.config.session_recording)||void 0===t?void 0:t.full_snapshot_interval_millis)&&void 0!==e?e:3e5}get isSampled(){var e=this.instance.get_property(ke);return U(e)?e:null}get sessionDuration(){var e,t,n=null===(e=this.buffer)||void 0===e?void 0:e.data[(null===(t=this.buffer)||void 0===t?void 0:t.data.length)-1],{sessionStartTimestamp:i}=this.sessionManager.checkAndGetSessionAndWindowId(!0);return n?n.timestamp-i:null}get isRecordingEnabled(){var e=!!this.instance.get_property(ve),t=!this.instance.config.disable_session_recording;return r&&e&&t}get isConsoleLogCaptureEnabled(){var e=!!this.instance.get_property(ye),t=this.instance.config.enable_recording_console_log;return null!=t?t:e}get canvasRecording(){var e,t,n,i,r,a,o=this.instance.config.session_recording.captureCanvas,s=this.instance.get_property(we),u=null!==(e=null!==(t=null==o?void 0:o.recordCanvas)&&void 0!==t?t:null==s?void 0:s.enabled)&&void 0!==e&&e,l=null!==(n=null!==(i=null==o?void 0:o.canvasFps)&&void 0!==i?i:null==s?void 0:s.fps)&&void 0!==n?n:0,c=null!==(r=null!==(a=null==o?void 0:o.canvasQuality)&&void 0!==a?a:null==s?void 0:s.quality)&&void 0!==r?r:0;return{enabled:u,fps:li(l,0,12,"canvas recording fps"),quality:li(c,0,1,"canvas recording quality")}}get networkPayloadCapture(){var e,t,n=this.instance.get_property(be),i={recordHeaders:null===(e=this.instance.config.session_recording)||void 0===e?void 0:e.recordHeaders,recordBody:null===(t=this.instance.config.session_recording)||void 0===t?void 0:t.recordBody},r=(null==i?void 0:i.recordHeaders)||(null==n?void 0:n.recordHeaders),a=(null==i?void 0:i.recordBody)||(null==n?void 0:n.recordBody),o=M(this.instance.config.capture_performance)?this.instance.config.capture_performance.network_timing:this.instance.config.capture_performance,s=!!(U(o)?o:null==n?void 0:n.capturePerformance);return r||a||s?{recordHeaders:r,recordBody:a,recordPerformance:s}:void 0}get sampleRate(){var e=this.instance.get_property(_e);return j(e)?e:null}get minimumDuration(){var e=this.instance.get_property(Se);return j(e)?e:null}get status(){return this.receivedDecide?this.isRecordingEnabled?this._urlBlocked?"paused":O(this._linkedFlag)||this._linkedFlagSeen?"trigger_pending"===this.triggerStatus?"buffering":U(this.isSampled)?this.isSampled?"sampled":"disabled":"active":"buffering":"disabled":"buffering"}get urlTriggerStatus(){var e;return 0===this._urlTriggers.length?"trigger_disabled":(null===(e=this.instance)||void 0===e?void 0:e.get_property(Ae))===this.sessionId?"trigger_activated":"trigger_pending"}get eventTriggerStatus(){var e;return 0===this._eventTriggers.length?"trigger_disabled":(null===(e=this.instance)||void 0===e?void 0:e.get_property(Ee))===this.sessionId?"trigger_activated":"trigger_pending"}get triggerStatus(){var e="trigger_activated"===this.eventTriggerStatus||"trigger_activated"===this.urlTriggerStatus,t="trigger_pending"===this.eventTriggerStatus||"trigger_pending"===this.urlTriggerStatus;return e?"trigger_activated":t?"trigger_pending":"trigger_disabled"}constructor(e){if(K(this,"queuedRRWebEvents",[]),K(this,"isIdle",!1),K(this,"_linkedFlagSeen",!1),K(this,"_lastActivityTimestamp",Date.now()),K(this,"_linkedFlag",null),K(this,"_removePageViewCaptureHook",void 0),K(this,"_onSessionIdListener",void 0),K(this,"_persistDecideOnSessionListener",void 0),K(this,"_samplingSessionListener",void 0),K(this,"_urlTriggers",[]),K(this,"_urlBlocklist",[]),K(this,"_urlBlocked",!1),K(this,"_eventTriggers",[]),K(this,"_removeEventTriggerCaptureHook",void 0),K(this,"_forceAllowLocalhostNetworkCapture",!1),K(this,"_onBeforeUnload",(()=>{this._flushBuffer()})),K(this,"_onOffline",(()=>{this._tryAddCustomEvent("browser offline",{})})),K(this,"_onOnline",(()=>{this._tryAddCustomEvent("browser online",{})})),K(this,"_onVisibilityChange",(()=>{if(null!=c&&c.visibilityState){var e="window "+c.visibilityState;this._tryAddCustomEvent(e,{})}})),this.instance=e,this._captureStarted=!1,this._endpoint="/s/",this.stopRrweb=void 0,this.receivedDecide=!1,!this.instance.sessionManager)throw $i.error("started without valid sessionManager"),new Error(zi+" started without valid sessionManager. This is a bug.");if(this.instance.config.__preview_experimental_cookieless_mode)throw new Error(zi+" cannot be used with __preview_experimental_cookieless_mode.");var{sessionId:t,windowId:n}=this.sessionManager.checkAndGetSessionAndWindowId();this.sessionId=t,this.windowId=n,this.buffer=this.clearBuffer(),this.sessionIdleThresholdMilliseconds>=this.sessionManager.sessionTimeoutMs&&$i.warn("session_idle_threshold_ms (".concat(this.sessionIdleThresholdMilliseconds,") is greater than the session timeout (").concat(this.sessionManager.sessionTimeoutMs,"). Session will never be detected as idle"))}startIfEnabledOrStop(e){this.isRecordingEnabled?(this._startCapture(e),se(r,"beforeunload",this._onBeforeUnload),se(r,"offline",this._onOffline),se(r,"online",this._onOnline),se(r,"visibilitychange",this._onVisibilityChange),this._setupSampling(),this._addEventTriggerListener(),O(this._removePageViewCaptureHook)&&(this._removePageViewCaptureHook=this.instance.on("eventCaptured",(e=>{try{if("$pageview"===e.event){var t=null!=e&&e.properties.$current_url?this._maskUrl(null==e?void 0:e.properties.$current_url):"";if(!t)return;this._tryAddCustomEvent("$pageview",{href:t})}}catch(e){$i.error("Could not add $pageview to rrweb session",e)}}))),this._onSessionIdListener||(this._onSessionIdListener=this.sessionManager.onSessionId(((e,t,n)=>{var i,r,a,o;n&&(this._tryAddCustomEvent("$session_id_change",{sessionId:e,windowId:t,changeReason:n}),null===(i=this.instance)||void 0===i||null===(r=i.persistence)||void 0===r||r.unregister(Ee),null===(a=this.instance)||void 0===a||null===(o=a.persistence)||void 0===o||o.unregister(Ae))})))):this.stopRecording()}stopRecording(){var e,t,n,i;this._captureStarted&&this.stopRrweb&&(this.stopRrweb(),this.stopRrweb=void 0,this._captureStarted=!1,null==r||r.removeEventListener("beforeunload",this._onBeforeUnload),null==r||r.removeEventListener("offline",this._onOffline),null==r||r.removeEventListener("online",this._onOnline),null==r||r.removeEventListener("visibilitychange",this._onVisibilityChange),this.clearBuffer(),clearInterval(this._fullSnapshotTimer),null===(e=this._removePageViewCaptureHook)||void 0===e||e.call(this),this._removePageViewCaptureHook=void 0,null===(t=this._removeEventTriggerCaptureHook)||void 0===t||t.call(this),this._removeEventTriggerCaptureHook=void 0,null===(n=this._onSessionIdListener)||void 0===n||n.call(this),this._onSessionIdListener=void 0,null===(i=this._samplingSessionListener)||void 0===i||i.call(this),this._samplingSessionListener=void 0,$i.info("stopped"))}makeSamplingDecision(e){var t,n=this.sessionId!==e,i=this.sampleRate;if(j(i)){var r=this.isSampled,a=n||!U(r),o=a?function(e,t){return function(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Math.abs(t)}(e)%100<li(100*t,0,100)}(e,i):r;a&&(o?this._reportStarted("sampled"):$i.warn("Sample rate (".concat(i,") has determined that this sessionId (").concat(e,") will not be sent to the server.")),this._tryAddCustomEvent("samplingDecisionMade",{sampleRate:i,isSampled:o})),null===(t=this.instance.persistence)||void 0===t||t.register({[ke]:o})}else{var s;null===(s=this.instance.persistence)||void 0===s||s.register({[ke]:null})}}onRemoteConfig(e){var t,n,i,r,a,o;if(this._tryAddCustomEvent("$remote_config_received",e),this._persistRemoteConfig(e),this._linkedFlag=(null===(t=e.sessionRecording)||void 0===t?void 0:t.linkedFlag)||null,null!==(n=e.sessionRecording)&&void 0!==n&&n.endpoint&&(this._endpoint=null===(o=e.sessionRecording)||void 0===o?void 0:o.endpoint),this._setupSampling(),!O(this._linkedFlag)&&!this._linkedFlagSeen){var s=D(this._linkedFlag)?this._linkedFlag:this._linkedFlag.flag,u=D(this._linkedFlag)?null:this._linkedFlag.variant;this.instance.onFeatureFlags(((e,t)=>{var n=M(t)&&s in t,i=u?t[s]===u:n;i&&this._reportStarted("linked_flag_matched",{linkedFlag:s,linkedVariant:u}),this._linkedFlagSeen=i}))}null!==(i=e.sessionRecording)&&void 0!==i&&i.urlTriggers&&(this._urlTriggers=e.sessionRecording.urlTriggers),null!==(r=e.sessionRecording)&&void 0!==r&&r.urlBlocklist&&(this._urlBlocklist=e.sessionRecording.urlBlocklist),null!==(a=e.sessionRecording)&&void 0!==a&&a.eventTriggers&&(this._eventTriggers=e.sessionRecording.eventTriggers),this.receivedDecide=!0,this.startIfEnabledOrStop()}_setupSampling(){j(this.sampleRate)&&O(this._samplingSessionListener)&&(this._samplingSessionListener=this.sessionManager.onSessionId((e=>{this.makeSamplingDecision(e)})))}_persistRemoteConfig(e){if(this.instance.persistence){var t,n=this.instance.persistence,i=()=>{var t,i,r,a,o,s,u,l,c=null===(t=e.sessionRecording)||void 0===t?void 0:t.sampleRate,d=O(c)?null:parseFloat(c),h=null===(i=e.sessionRecording)||void 0===i?void 0:i.minimumDurationMilliseconds;n.register({[ve]:!!e.sessionRecording,[ye]:null===(r=e.sessionRecording)||void 0===r?void 0:r.consoleLogRecordingEnabled,[be]:$({capturePerformance:e.capturePerformance},null===(a=e.sessionRecording)||void 0===a?void 0:a.networkPayloadCapture),[we]:{enabled:null===(o=e.sessionRecording)||void 0===o?void 0:o.recordCanvas,fps:null===(s=e.sessionRecording)||void 0===s?void 0:s.canvasFps,quality:null===(u=e.sessionRecording)||void 0===u?void 0:u.canvasQuality},[_e]:d,[Se]:R(h)?null:h,[Te]:null===(l=e.sessionRecording)||void 0===l?void 0:l.scriptConfig})};i(),null===(t=this._persistDecideOnSessionListener)||void 0===t||t.call(this),this._persistDecideOnSessionListener=this.sessionManager.onSessionId(i)}}log(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log";null===(t=this.instance.sessionRecording)||void 0===t||t.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:n,trace:[],payload:[JSON.stringify(e)]}},timestamp:Date.now()})}_startCapture(e){var t,n;R(Object.assign)||R(Array.from)||(this._captureStarted||this.instance.config.disable_session_recording||this.instance.consent.isOptedOut())||(this._captureStarted=!0,this.sessionManager.checkAndGetSessionAndWindowId(),this.rrwebRecord?this._onScriptLoaded():null===(t=m.__PosthogExtensions__)||void 0===t||null===(n=t.loadExternalDependency)||void 0===n||n.call(t,this.instance,this.scriptName,(e=>{if(e)return $i.error("could not load recorder",e);this._onScriptLoaded()})),$i.info("starting"),"active"===this.status&&this._reportStarted(e||"recording_initialized"))}get scriptName(){var e,t,n;return(null===(e=this.instance)||void 0===e||null===(t=e.persistence)||void 0===t||null===(n=t.get_property(Te))||void 0===n?void 0:n.script)||"recorder"}isInteractiveEvent(e){var t;return 3===e.type&&-1!==Ki.indexOf(null===(t=e.data)||void 0===t?void 0:t.source)}_updateWindowAndSessionIds(e){var t=this.isInteractiveEvent(e);t||this.isIdle||e.timestamp-this._lastActivityTimestamp>this.sessionIdleThresholdMilliseconds&&(this.isIdle=!0,clearInterval(this._fullSnapshotTimer),this._tryAddCustomEvent("sessionIdle",{eventTimestamp:e.timestamp,lastActivityTimestamp:this._lastActivityTimestamp,threshold:this.sessionIdleThresholdMilliseconds,bufferLength:this.buffer.data.length,bufferSize:this.buffer.size}),this._flushBuffer());var n=!1;if(t&&(this._lastActivityTimestamp=e.timestamp,this.isIdle&&(this.isIdle=!1,this._tryAddCustomEvent("sessionNoLongerIdle",{reason:"user activity",type:e.type}),n=!0)),!this.isIdle){var{windowId:i,sessionId:r}=this.sessionManager.checkAndGetSessionAndWindowId(!t,e.timestamp),a=this.sessionId!==r,o=this.windowId!==i;this.windowId=i,this.sessionId=r,a||o?(this.stopRecording(),this.startIfEnabledOrStop("session_id_changed")):n&&this._scheduleFullSnapshot()}}_tryRRWebMethod(e){try{return e.rrwebMethod(),!0}catch(t){return this.queuedRRWebEvents.length<10?this.queuedRRWebEvents.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}):$i.warn("could not emit queued rrweb event.",t,e),!1}}_tryAddCustomEvent(e,t){return this._tryRRWebMethod(Wi((()=>this.rrwebRecord.addCustomEvent(e,t))))}_tryTakeFullSnapshot(){return this._tryRRWebMethod(Wi((()=>this.rrwebRecord.takeFullSnapshot())))}_onScriptLoaded(){var e,t={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},n=this.instance.config.session_recording;for(var[i,r]of Object.entries(n||{}))i in t&&("maskInputOptions"===i?t.maskInputOptions=$({password:!0},r):t[i]=r);if(this.canvasRecording&&this.canvasRecording.enabled&&(t.recordCanvas=!0,t.sampling={canvas:this.canvasRecording.fps},t.dataURLOptions={type:"image/webp",quality:this.canvasRecording.quality}),this.rrwebRecord){this.mutationRateLimiter=null!==(e=this.mutationRateLimiter)&&void 0!==e?e:new ci(this.rrwebRecord,{refillRate:this.instance.config.session_recording.__mutationRateLimiterRefillRate,bucketSize:this.instance.config.session_recording.__mutationRateLimiterBucketSize,onBlockedNode:(e,t)=>{var n="Too many mutations on node '".concat(e,"'. Rate limiting. This could be due to SVG animations or something similar");$i.info(n,{node:t}),this.log(zi+" "+n,"warn")}});var a=this._gatherRRWebPlugins();this.stopRrweb=this.rrwebRecord($({emit:e=>{this.onRRwebEmit(e)},plugins:a},t)),this._lastActivityTimestamp=Date.now(),this.isIdle=!1,this._tryAddCustomEvent("$session_options",{sessionRecordingOptions:t,activePlugins:a.map((e=>null==e?void 0:e.name))}),this._tryAddCustomEvent("$posthog_config",{config:this.instance.config})}else $i.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}_scheduleFullSnapshot(){if(this._fullSnapshotTimer&&clearInterval(this._fullSnapshotTimer),!this.isIdle){var e=this.fullSnapshotIntervalMillis;e&&(this._fullSnapshotTimer=setInterval((()=>{this._tryTakeFullSnapshot()}),e))}}_gatherRRWebPlugins(){var e,t,n,i,r=[],a=null===(e=m.__PosthogExtensions__)||void 0===e||null===(t=e.rrwebPlugins)||void 0===t?void 0:t.getRecordConsolePlugin;a&&this.isConsoleLogCaptureEnabled&&r.push(a());var o=null===(n=m.__PosthogExtensions__)||void 0===n||null===(i=n.rrwebPlugins)||void 0===i?void 0:i.getRecordNetworkPlugin;return this.networkPayloadCapture&&C(o)&&(!mt.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?r.push(o(((e,t)=>{var n,i,r,a={payloadSizeLimitBytes:ii.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...ii.performanceEntryTypeToObserve],payloadHostDenyList:[...t.payloadHostDenyList||[],...ii.payloadHostDenyList]},o=!1!==e.session_recording.recordHeaders&&t.recordHeaders,s=!1!==e.session_recording.recordBody&&t.recordBody,u=!1!==e.capture_performance&&t.recordPerformance,l=(n=a,r=Math.min(1e6,null!==(i=n.payloadSizeLimitBytes)&&void 0!==i?i:1e6),e=>(null!=e&&e.requestBody&&(e.requestBody=si(e.requestBody,e.requestHeaders,r,"Request")),null!=e&&e.responseBody&&(e.responseBody=si(e.responseBody,e.responseHeaders,r,"Response")),e)),c=t=>{return l(((e,t)=>{var n,i=vt(e.name),r=0===t.indexOf("http")?null===(n=vt(t))||void 0===n?void 0:n.pathname:t;"/"===r&&(r="");var a=null==i?void 0:i.pathname.replace(r||"","");if(!(i&&a&&oi.some((e=>0===a.indexOf(e)))))return e})((i=(n=t).requestHeaders,O(i)||J(Object.keys(null!=i?i:{}),(e=>{ri.includes(e.toLowerCase())&&(i[e]=ni)})),n),e.api_host));var n,i},d=C(e.session_recording.maskNetworkRequestFn);return d&&C(e.session_recording.maskCapturedNetworkRequestFn)&&H.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),d&&(e.session_recording.maskCapturedNetworkRequestFn=t=>{var n=e.session_recording.maskNetworkRequestFn({url:t.name});return $($({},t),{},{name:null==n?void 0:n.url})}),a.maskRequestFn=C(e.session_recording.maskCapturedNetworkRequestFn)?t=>{var n,i,r,a=c(t);return a&&null!==(n=null===(i=(r=e.session_recording).maskCapturedNetworkRequestFn)||void 0===i?void 0:i.call(r,a))&&void 0!==n?n:void 0}:e=>function(e){if(!R(e))return e.requestBody=ui(e.requestBody,"Request"),e.responseBody=ui(e.responseBody,"Response"),e}(c(e)),$($($({},ii),a),{},{recordHeaders:o,recordBody:s,recordPerformance:u,recordInitialRequests:u})})(this.instance.config,this.networkPayloadCapture))):$i.info("NetworkCapture not started because we are on localhost.")),r}onRRwebEmit(e){var t;if(this._processQueuedEvents(),e&&M(e)){if(e.type===An.Meta){var n=this._maskUrl(e.data.href);if(this._lastHref=n,!n)return;e.data.href=n}else this._pageViewFallBack();if(this._checkUrlTriggerConditions(),"paused"!==this.status||function(e){return e.type===An.Custom&&"recording paused"===e.data.tag}(e)){e.type===An.FullSnapshot&&this._scheduleFullSnapshot(),e.type===An.FullSnapshot&&"trigger_pending"===this.triggerStatus&&this.clearBuffer();var i=this.mutationRateLimiter?this.mutationRateLimiter.throttleMutations(e):e;if(i){var r=function(e){var t=e;if(t&&M(t)&&6===t.type&&M(t.data)&&"rrweb/console@1"===t.data.plugin){t.data.payload.payload.length>10&&(t.data.payload.payload=t.data.payload.payload.slice(0,10),t.data.payload.payload.push("...[truncated]"));for(var n=[],i=0;i<t.data.payload.payload.length;i++)t.data.payload.payload[i]&&t.data.payload.payload[i].length>2e3?n.push(t.data.payload.payload[i].slice(0,2e3)+"...[truncated]"):n.push(t.data.payload.payload[i]);return t.data.payload.payload=n,e}return e}(i);if(this._updateWindowAndSessionIds(r),!this.isIdle||Yi(r)){if(Yi(r)){var a=r.data.payload;if(a){var o=a.lastActivityTimestamp,s=a.threshold;r.timestamp=o+s}}var u=null===(t=this.instance.config.session_recording.compress_events)||void 0===t||t?function(e){if(xn(e)<1024)return e;try{if(e.type===An.FullSnapshot)return $($({},e),{},{data:Xi(e.data),cv:"2024-10"});if(e.type===An.IncrementalSnapshot&&e.data.source===En.Mutation)return $($({},e),{},{cv:"2024-10",data:$($({},e.data),{},{texts:Xi(e.data.texts),attributes:Xi(e.data.attributes),removes:Xi(e.data.removes),adds:Xi(e.data.adds)})});if(e.type===An.IncrementalSnapshot&&e.data.source===En.StyleSheetRule)return $($({},e),{},{cv:"2024-10",data:$($({},e.data),{},{adds:Xi(e.data.adds),removes:Xi(e.data.removes)})})}catch(e){$i.error("could not compress event - will use uncompressed event",e)}return e}(r):r,l={$snapshot_bytes:xn(u),$snapshot_data:u,$session_id:this.sessionId,$window_id:this.windowId};"disabled"!==this.status?this._captureSnapshotBuffered(l):this.clearBuffer()}}}}}_pageViewFallBack(){if(!this.instance.config.capture_pageview&&r){var e=this._maskUrl(r.location.href);this._lastHref!==e&&(this._tryAddCustomEvent("$url_changed",{href:e}),this._lastHref=e)}}_processQueuedEvents(){if(this.queuedRRWebEvents.length){var e=[...this.queuedRRWebEvents];this.queuedRRWebEvents=[],e.forEach((e=>{Date.now()-e.enqueuedAt<=2e3&&this._tryRRWebMethod(e)}))}}_maskUrl(e){var t=this.instance.config.session_recording;if(t.maskNetworkRequestFn){var n,i={url:e};return null===(n=i=t.maskNetworkRequestFn(i))||void 0===n?void 0:n.url}return e}clearBuffer(){return this.buffer={size:0,data:[],sessionId:this.sessionId,windowId:this.windowId},this.buffer}_flushBuffer(){this.flushBufferTimer&&(clearTimeout(this.flushBufferTimer),this.flushBufferTimer=void 0);var e=this.minimumDuration,t=this.sessionDuration,n=j(t)&&t>=0,i=j(e)&&n&&t<e;return"buffering"===this.status||"paused"===this.status||i?(this.flushBufferTimer=setTimeout((()=>{this._flushBuffer()}),2e3),this.buffer):(this.buffer.data.length>0&&kn(this.buffer).forEach((e=>{this._captureSnapshot({$snapshot_bytes:e.size,$snapshot_data:e.data,$session_id:e.sessionId,$window_id:e.windowId,$lib:"web",$lib_version:v.LIB_VERSION})})),this.clearBuffer())}_captureSnapshotBuffered(e){var t,n=2+((null===(t=this.buffer)||void 0===t?void 0:t.data.length)||0);!this.isIdle&&(this.buffer.size+e.$snapshot_bytes+n>943718.4||this.buffer.sessionId!==this.sessionId)&&(this.buffer=this._flushBuffer()),this.buffer.size+=e.$snapshot_bytes,this.buffer.data.push(e.$snapshot_data),this.flushBufferTimer||this.isIdle||(this.flushBufferTimer=setTimeout((()=>{this._flushBuffer()}),2e3))}_captureSnapshot(e){this.instance.capture("$snapshot",e,{_url:this.instance.requestRouter.endpointFor("api",this._endpoint),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}_checkUrlTriggerConditions(){if(void 0!==r&&r.location.href){var e=r.location.href,t="paused"===this.status,n=Ji(e,this._urlBlocklist);n&&!t?this._pauseRecording():!n&&t&&this._resumeRecording(),Ji(e,this._urlTriggers)&&this._activateTrigger("url")}}_activateTrigger(e){var t,n;"trigger_pending"===this.triggerStatus&&(null===(t=this.instance)||void 0===t||null===(n=t.persistence)||void 0===n||n.register({["url"===e?Ae:Ee]:this.sessionId}),this._flushBuffer(),this._reportStarted(e+"_trigger_matched"))}_pauseRecording(){"paused"!==this.status&&(this._urlBlocked=!0,clearInterval(this._fullSnapshotTimer),$i.info("recording paused due to URL blocker"),this._tryAddCustomEvent("recording paused",{reason:"url blocker"}))}_resumeRecording(){"paused"===this.status&&(this._urlBlocked=!1,this._tryTakeFullSnapshot(),this._scheduleFullSnapshot(),this._tryAddCustomEvent("recording resumed",{reason:"left blocked url"}),$i.info("recording resumed"))}_addEventTriggerListener(){0!==this._eventTriggers.length&&O(this._removeEventTriggerCaptureHook)&&(this._removeEventTriggerCaptureHook=this.instance.on("eventCaptured",(e=>{try{this._eventTriggers.includes(e.event)&&this._activateTrigger("event")}catch(e){$i.error("Could not activate event trigger",e)}})))}overrideLinkedFlag(){this._linkedFlagSeen=!0,this._tryTakeFullSnapshot(),this._reportStarted("linked_flag_overridden")}overrideSampling(){var e;null===(e=this.instance.persistence)||void 0===e||e.register({[ke]:!0}),this._tryTakeFullSnapshot(),this._reportStarted("sampling_overridden")}overrideTrigger(e){this._activateTrigger(e)}_reportStarted(e,t){this.instance.register_for_session({$session_recording_start_reason:e}),$i.info(e.replace("_"," "),t),_(["recording_initialized","session_id_changed"],e)||this._tryAddCustomEvent(e,t)}}var Zi=V("[RemoteConfig]");class er{constructor(e){this.instance=e}get remoteConfig(){var e,t;return null===(e=m._POSTHOG_REMOTE_CONFIG)||void 0===e||null===(t=e[this.instance.config.token])||void 0===t?void 0:t.config}_loadRemoteConfigJs(e){var t,n,i;null!==(t=m.__PosthogExtensions__)&&void 0!==t&&t.loadExternalDependency?null===(n=m.__PosthogExtensions__)||void 0===n||null===(i=n.loadExternalDependency)||void 0===i||i.call(n,this.instance,"remote-config",(()=>e(this.remoteConfig))):(Zi.error("PostHog Extensions not found. Cannot load remote config."),e())}_loadRemoteConfigJSON(e){this.instance._send_request({method:"GET",url:this.instance.requestRouter.endpointFor("assets","/array/".concat(this.instance.config.token,"/config")),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return Zi.info("Using preloaded remote config",this.remoteConfig),void this.onRemoteConfig(this.remoteConfig);if(this.instance.config.advanced_disable_decide)return void Zi.warn("Remote config is disabled. Falling back to local config.");this._loadRemoteConfigJs((e=>{if(!e)return Zi.info("No config found after loading remote JS config. Falling back to JSON."),void this._loadRemoteConfigJSON((e=>{this.onRemoteConfig(e)}));this.onRemoteConfig(e)}))}catch(e){Zi.error("Error loading remote config",e)}}onRemoteConfig(e){e?this.instance.config.__preview_remote_config?(this.instance._onRemoteConfig(e),!1!==e.hasFeatureFlags&&this.instance.featureFlags.ensureFlagsLoaded()):Zi.info("__preview_remote_config is disabled. Logging config instead",e):Zi.error("Failed to fetch remote config from PostHog.")}}var tr,nr=null!=r&&r.location?_t(r.location.hash,"__posthog")||_t(location.hash,"state"):null,ir="_postHogToolbarParams",rr=V("[Toolbar]");!function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED"}(tr||(tr={}));class ar{constructor(e){this.instance=e}setToolbarState(e){m.ph_toolbar_state=e}getToolbarState(){var e;return null!==(e=m.ph_toolbar_state)&&void 0!==e?e:tr.UNINITIALIZED}maybeLoadToolbar(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(!r||!c)return!1;n=null!==(e=n)&&void 0!==e?e:r.location,a=null!==(t=a)&&void 0!==t?t:r.history;try{if(!i){try{r.localStorage.setItem("test","test"),r.localStorage.removeItem("test")}catch(e){return!1}i=null==r?void 0:r.localStorage}var o,s=nr||_t(n.hash,"__posthog")||_t(n.hash,"state"),u=s?te((()=>JSON.parse(atob(decodeURIComponent(s)))))||te((()=>JSON.parse(decodeURIComponent(s)))):null;return u&&"ph_authorize"===u.action?((o=u).source="url",o&&Object.keys(o).length>0&&(u.desiredHash?n.hash=u.desiredHash:a?a.replaceState(a.state,"",n.pathname+n.search):n.hash="")):((o=JSON.parse(i.getItem(ir)||"{}")).source="localstorage",delete o.userIntent),!(!o.token||this.instance.config.token!==o.token||(this.loadToolbar(o),0))}catch(e){return!1}}_callLoadToolbar(e){var t=m.ph_load_toolbar||m.ph_load_editor;!O(t)&&C(t)?t(e,this.instance):rr.warn("No toolbar load function found")}loadToolbar(e){var t=!(null==c||!c.getElementById(Ve));if(!r||t)return!1;var n="custom"===this.instance.requestRouter.region&&this.instance.config.advanced_disable_toolbar_metrics,i=$($({token:this.instance.config.token},e),{},{apiURL:this.instance.requestRouter.endpointFor("ui")},n?{instrument:!1}:{});if(r.localStorage.setItem(ir,JSON.stringify($($({},i),{},{source:void 0}))),this.getToolbarState()===tr.LOADED)this._callLoadToolbar(i);else if(this.getToolbarState()===tr.UNINITIALIZED){var a,o;this.setToolbarState(tr.LOADING),null===(a=m.__PosthogExtensions__)||void 0===a||null===(o=a.loadExternalDependency)||void 0===o||o.call(a,this.instance,"toolbar",(e=>{if(e)return rr.error("[Toolbar] Failed to load",e),void this.setToolbarState(tr.UNINITIALIZED);this.setToolbarState(tr.LOADED),this._callLoadToolbar(i)})),se(r,"turbolinks:load",(()=>{this.setToolbarState(tr.UNINITIALIZED),this.loadToolbar(i)}))}return!0}_loadEditor(e){return this.loadToolbar(e)}maybeLoadEditor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return this.maybeLoadToolbar(e,t,n)}}class or{constructor(e){K(this,"isPaused",!0),K(this,"queue",[]),K(this,"flushTimeoutMs",3e3),this.sendRequest=e}enqueue(e){this.queue.push(e),this.flushTimeout||this.setFlushTimeout()}unload(){this.clearFlushTimeout();var e=this.queue.length>0?this.formatQueue():{},t=Object.values(e),n=[...t.filter((e=>0===e.url.indexOf("/e"))),...t.filter((e=>0!==e.url.indexOf("/e")))];n.map((e=>{this.sendRequest($($({},e),{},{transport:"sendBeacon"}))}))}enable(){this.isPaused=!1,this.setFlushTimeout()}setFlushTimeout(){var e=this;this.isPaused||(this.flushTimeout=setTimeout((()=>{if(this.clearFlushTimeout(),this.queue.length>0){var t=this.formatQueue(),n=function(n){var i=t[n],r=(new Date).getTime();i.data&&I(i.data)&&J(i.data,(e=>{e.offset=Math.abs(e.timestamp-r),delete e.timestamp})),e.sendRequest(i)};for(var i in t)n(i)}}),this.flushTimeoutMs))}clearFlushTimeout(){clearTimeout(this.flushTimeout),this.flushTimeout=void 0}formatQueue(){var e={};return J(this.queue,(t=>{var n,i=t,r=(i?i.batchKey:null)||i.url;R(e[r])&&(e[r]=$($({},i),{},{data:[]})),null===(n=e[r].data)||void 0===n||n.push(i.data)})),this.queue=[],e}}var sr=!!f||!!h,ur="text/plain",lr=(e,t)=>{var[n,i]=e.split("?"),r=$({},t);null==i||i.split("&").forEach((e=>{var[t]=e.split("=");delete r[t]}));var a=function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"&",r=[];return J(e,(function(e,i){R(e)||R(i)||"undefined"===i||(t=encodeURIComponent((e=>e instanceof File)(e)?e.name:e.toString()),n=encodeURIComponent(i),r[r.length]=n+"="+t)})),r.join(i)}(r);return a=a?(i?i+"&":"")+a:i,"".concat(n,"?").concat(a)},cr=(e,t)=>JSON.stringify(e,((e,t)=>"bigint"==typeof t?t.toString():t),t),dr=e=>{var{data:t,compression:n}=e;if(t){if(n===i.GZipJS){var r=qi(Gi(cr(t)),{mtime:0}),a=new Blob([r],{type:ur});return{contentType:ur,body:a,estimatedSize:a.size}}if(n===i.Base64){var o=function(e){var t,n,i,r,a,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=0,u=0,l="",c=[];if(!e)return e;e=function(e){var t,n,i,r,a="";for(t=n=0,i=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,r=0;r<i;r++){var o=e.charCodeAt(r),s=null;o<128?n++:s=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),N(s)||(n>t&&(a+=e.substring(t,n)),a+=s,t=n=r+1)}return n>t&&(a+=e.substring(t,e.length)),a}(e);do{t=(a=e.charCodeAt(s++)<<16|e.charCodeAt(s++)<<8|e.charCodeAt(s++))>>18&63,n=a>>12&63,i=a>>6&63,r=63&a,c[u++]=o.charAt(t)+o.charAt(n)+o.charAt(i)+o.charAt(r)}while(s<e.length);switch(l=c.join(""),e.length%3){case 1:l=l.slice(0,-2)+"==";break;case 2:l=l.slice(0,-1)+"="}return l}(cr(t)),s=(e=>"data="+encodeURIComponent("string"==typeof e?e:cr(e)))(o);return{contentType:"application/x-www-form-urlencoded",body:s,estimatedSize:new Blob([s]).size}}var u=cr(t);return{contentType:"application/json",body:u,estimatedSize:new Blob([u]).size}}},hr=[];h&&hr.push({transport:"fetch",method:e=>{var t,n,{contentType:i,body:r,estimatedSize:a}=null!==(t=dr(e))&&void 0!==t?t:{},o=new Headers;J(e.headers,(function(e,t){o.append(t,e)})),i&&o.append("Content-Type",i);var s=e.url,u=null;if(p){var l=new p;u={signal:l.signal,timeout:setTimeout((()=>l.abort()),e.timeout)}}h(s,$({method:(null==e?void 0:e.method)||"GET",headers:o,keepalive:"POST"===e.method&&(a||0)<52428.8,body:r,signal:null===(n=u)||void 0===n?void 0:n.signal},e.fetchOptions)).then((t=>t.text().then((n=>{var i,r={statusCode:t.status,text:n};if(200===t.status)try{r.json=JSON.parse(n)}catch(e){H.error(e)}null===(i=e.callback)||void 0===i||i.call(e,r)})))).catch((t=>{var n;H.error(t),null===(n=e.callback)||void 0===n||n.call(e,{statusCode:0,text:t})})).finally((()=>u?clearTimeout(u.timeout):null))}}),f&&hr.push({transport:"XHR",method:e=>{var t,n=new f;n.open(e.method||"GET",e.url,!0);var{contentType:i,body:r}=null!==(t=dr(e))&&void 0!==t?t:{};J(e.headers,(function(e,t){n.setRequestHeader(t,e)})),i&&n.setRequestHeader("Content-Type",i),e.timeout&&(n.timeout=e.timeout),n.withCredentials=!0,n.onreadystatechange=()=>{if(4===n.readyState){var t,i={statusCode:n.status,text:n.responseText};if(200===n.status)try{i.json=JSON.parse(n.responseText)}catch(e){}null===(t=e.callback)||void 0===t||t.call(e,i)}},n.send(r)}}),null!=l&&l.sendBeacon&&hr.push({transport:"sendBeacon",method:e=>{var t=lr(e.url,{beacon:"1"});try{var n,{contentType:i,body:r}=null!==(n=dr(e))&&void 0!==n?n:{},a="string"==typeof r?new Blob([r],{type:i}):r;l.sendBeacon(t,a)}catch(e){}}});var fr=["retriesPerformedSoFar"];class pr{constructor(e){K(this,"isPolling",!1),K(this,"pollIntervalMs",3e3),K(this,"queue",[]),this.instance=e,this.queue=[],this.areWeOnline=!0,!R(r)&&"onLine"in r.navigator&&(this.areWeOnline=r.navigator.onLine,se(r,"online",(()=>{this.areWeOnline=!0,this.flush()})),se(r,"offline",(()=>{this.areWeOnline=!1})))}retriableRequest(e){var{retriesPerformedSoFar:t}=e,n=W(e,fr);j(t)&&t>0&&(n.url=lr(n.url,{retry_count:t})),this.instance._send_request($($({},n),{},{callback:e=>{var i;200!==e.statusCode&&(e.statusCode<400||e.statusCode>=500)&&(null!=t?t:0)<10?this.enqueue($({retriesPerformedSoFar:t},n)):null===(i=n.callback)||void 0===i||i.call(n,e)}}))}enqueue(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var n=function(e){var t=3e3*Math.pow(2,e),n=t/2,i=Math.min(18e5,t),r=(Math.random()-.5)*(i-n);return Math.ceil(i+r)}(t),i=Date.now()+n;this.queue.push({retryAt:i,requestOptions:e});var r="Enqueued failed request for retry in ".concat(n);navigator.onLine||(r+=" (Browser is offline)"),H.warn(r),this.isPolling||(this.isPolling=!0,this.poll())}poll(){this.poller&&clearTimeout(this.poller),this.poller=setTimeout((()=>{this.areWeOnline&&this.queue.length>0&&this.flush(),this.poll()}),this.pollIntervalMs)}flush(){var e=Date.now(),t=[],n=this.queue.filter((n=>n.retryAt<e||(t.push(n),!1)));if(this.queue=t,n.length>0)for(var{requestOptions:i}of n)this.retriableRequest(i)}unload(){for(var{requestOptions:e}of(this.poller&&(clearTimeout(this.poller),this.poller=void 0),this.queue))try{this.instance._send_request($($({},e),{},{transport:"sendBeacon"}))}catch(e){H.error(e)}this.queue=[]}}var gr,mr=V("[SessionId]");class vr{constructor(e,t,n){var i;if(K(this,"_sessionIdChangedHandlers",[]),!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.__preview_experimental_cookieless_mode)throw new Error("SessionIdManager cannot be used with __preview_experimental_cookieless_mode");this.config=e.config,this.persistence=e.persistence,this._windowId=void 0,this._sessionId=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this._sessionIdGenerator=t||it,this._windowIdGenerator=n||it;var r=this.config.persistence_name||this.config.token,a=this.config.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*li(a,60,36e3,"session_idle_timeout_seconds",1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.resetIdleTimer(),this._window_id_storage_key="ph_"+r+"_window_id",this._primary_window_exists_storage_key="ph_"+r+"_primary_window_exists",this._canUseSessionStorage()){var o=gt.parse(this._window_id_storage_key),s=gt.parse(this._primary_window_exists_storage_key);o&&!s?this._windowId=o:gt.remove(this._window_id_storage_key),gt.set(this._primary_window_exists_storage_key,!0)}if(null!==(i=this.config.bootstrap)&&void 0!==i&&i.sessionID)try{var u=(()=>{var e=this.config.bootstrap.sessionID.replace(/-/g,"");if(32!==e.length)throw new Error("Not a valid UUID");if("7"!==e[12])throw new Error("Not a UUIDv7");return parseInt(e.substring(0,12),16)})();this._setSessionId(this.config.bootstrap.sessionID,(new Date).getTime(),u)}catch(e){mr.error("Invalid sessionID in bootstrap",e)}this._listenToReloadWindow()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return R(this._sessionIdChangedHandlers)&&(this._sessionIdChangedHandlers=[]),this._sessionIdChangedHandlers.push(e),this._sessionId&&e(this._sessionId,this._windowId),()=>{this._sessionIdChangedHandlers=this._sessionIdChangedHandlers.filter((t=>t!==e))}}_canUseSessionStorage(){return"memory"!==this.config.persistence&&!this.persistence.disabled&&gt.is_supported()}_setWindowId(e){e!==this._windowId&&(this._windowId=e,this._canUseSessionStorage()&&gt.set(this._window_id_storage_key,e))}_getWindowId(){return this._windowId?this._windowId:this._canUseSessionStorage()?gt.parse(this._window_id_storage_key):null}_setSessionId(e,t,n){e===this._sessionId&&t===this._sessionActivityTimestamp&&n===this._sessionStartTimestamp||(this._sessionStartTimestamp=n,this._sessionActivityTimestamp=t,this._sessionId=e,this.persistence.register({[xe]:[t,e,n]}))}_getSessionId(){if(this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];var e=this.persistence.props[xe];return I(e)&&2===e.length&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this._setSessionId(null,null,null)}_listenToReloadWindow(){se(r,"beforeunload",(()=>{this._canUseSessionStorage()&&gt.remove(this._primary_window_exists_storage_key)}),{capture:!1})}checkAndGetSessionAndWindowId(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.config.__preview_experimental_cookieless_mode)throw new Error("checkAndGetSessionAndWindowId should not be called in __preview_experimental_cookieless_mode");var n=t||(new Date).getTime(),[i,r,a]=this._getSessionId(),o=this._getWindowId(),s=j(a)&&a>0&&Math.abs(n-a)>864e5,u=!1,l=!r,c=!e&&Math.abs(n-i)>this.sessionTimeoutMs;l||c||s?(r=this._sessionIdGenerator(),o=this._windowIdGenerator(),mr.info("new session ID generated",{sessionId:r,windowId:o,changeReason:{noSessionId:l,activityTimeout:c,sessionPastMaximumLength:s}}),a=n,u=!0):o||(o=this._windowIdGenerator(),u=!0);var d=0===i||!e||s?n:i,h=0===a?(new Date).getTime():a;return this._setWindowId(o),this._setSessionId(r,d,h),e||this.resetIdleTimer(),u&&this._sessionIdChangedHandlers.forEach((e=>e(r,o,u?{noSessionId:l,activityTimeout:c,sessionPastMaximumLength:s}:void 0))),{sessionId:r,windowId:o,sessionStartTimestamp:h,changeReason:u?{noSessionId:l,activityTimeout:c,sessionPastMaximumLength:s}:void 0,lastActivityTimestamp:i}}resetIdleTimer(){clearTimeout(this._enforceIdleTimeout),this._enforceIdleTimeout=setTimeout((()=>{this.resetSessionId()}),1.1*this.sessionTimeoutMs)}}!function(e){e.US="us",e.EU="eu",e.CUSTOM="custom"}(gr||(gr={}));var yr="i.posthog.com";class br{constructor(e){K(this,"_regionCache",{}),this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return"https://app.posthog.com"===e?"https://us.i.posthog.com":e}get uiHost(){var e,t=null===(e=this.instance.config.ui_host)||void 0===e?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace(".".concat(yr),".posthog.com")),"https://app.posthog.com"===t?"https://us.posthog.com":t}get region(){return this._regionCache[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=gr.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=gr.EU:this._regionCache[this.apiHost]=gr.CUSTOM),this._regionCache[this.apiHost]}endpointFor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t&&(t="/"===t[0]?t:"/".concat(t)),"ui"===e)return this.uiHost+t;if(this.region===gr.CUSTOM)return this.apiHost+t;var n=yr+t;switch(e){case"assets":return"https://".concat(this.region,"-assets.").concat(n);case"api":return"https://".concat(this.region,".").concat(n)}}}var wr="posthog-js";function _r(e){var{organization:t,projectId:n,prefix:i,severityAllowList:r=["error"]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a=>{var o,s,u,l,c;if("*"!==r&&!r.includes(a.level)||!e.__loaded)return a;a.tags||(a.tags={});var d=e.requestRouter.endpointFor("ui","/project/".concat(e.config.token,"/person/").concat(e.get_distinct_id()));a.tags["PostHog Person URL"]=d,e.sessionRecordingStarted()&&(a.tags["PostHog Recording URL"]=e.get_session_replay_url({withTimestamp:!0}));var h=(null===(o=a.exception)||void 0===o?void 0:o.values)||[];h.forEach((e=>{e.stacktrace&&(e.stacktrace.type="raw",e.stacktrace.frames.forEach((e=>{e.platform="web:javascript"})))}));var f={$exception_message:(null===(s=h[0])||void 0===s?void 0:s.value)||a.message,$exception_type:null===(u=h[0])||void 0===u?void 0:u.type,$exception_personURL:d,$exception_level:a.level,$exception_list:h,$sentry_event_id:a.event_id,$sentry_exception:a.exception,$sentry_exception_message:(null===(l=h[0])||void 0===l?void 0:l.value)||a.message,$sentry_exception_type:null===(c=h[0])||void 0===c?void 0:c.type,$sentry_tags:a.tags};return t&&n&&(f.$sentry_url=(i||"https://sentry.io/organizations/")+t+"/issues/?project="+n+"&query="+a.event_id),e.exceptions.sendExceptionEvent(f),a}}class Sr{constructor(e,t,n,i,r){this.name=wr,this.setupOnce=function(a){a(_r(e,{organization:t,projectId:n,prefix:i,severityAllowList:r}))}}}var Tr=V("[SegmentIntegration]");class xr{constructor(e){this._instance=e}doPageView(e,t){var n,i=this._previousPageViewProperties(e,t);return this._currentPageview={pathname:null!==(n=null==r?void 0:r.location.pathname)&&void 0!==n?n:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),i}doPageLeave(e){var t;return this._previousPageViewProperties(e,null===(t=this._currentPageview)||void 0===t?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:null===(e=this._currentPageview)||void 0===e?void 0:e.pageViewId}}_previousPageViewProperties(e,t){var n=this._currentPageview;if(!n)return{$pageview_id:t};var i={$pageview_id:t,$prev_pageview_id:n.pageViewId},r=this._instance.scrollManager.getContext();if(r&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:a,lastScrollY:o,maxScrollY:s,maxContentHeight:u,lastContentY:l,maxContentY:c}=r;if(!(R(a)||R(o)||R(s)||R(u)||R(l)||R(c))){a=Math.ceil(a),o=Math.ceil(o),s=Math.ceil(s),u=Math.ceil(u),l=Math.ceil(l),c=Math.ceil(c);var d=a<=1?1:li(o/a,0,1),h=a<=1?1:li(s/a,0,1),f=u<=1?1:li(l/u,0,1),p=u<=1?1:li(c/u,0,1);i=Q(i,{$prev_pageview_last_scroll:o,$prev_pageview_last_scroll_percentage:d,$prev_pageview_max_scroll:s,$prev_pageview_max_scroll_percentage:h,$prev_pageview_last_content:l,$prev_pageview_last_content_percentage:f,$prev_pageview_max_content:c,$prev_pageview_max_content_percentage:p})}}return n.pathname&&(i.$prev_pageview_pathname=n.pathname),n.timestamp&&(i.$prev_pageview_duration=(e.getTime()-n.timestamp.getTime())/1e3),i}}var kr,Ar,Er,Ir,Cr,Mr,Pr,Rr,Dr,Lr,Nr,Or={},jr=[],Ur=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Fr=Array.isArray;function Br(e,t){for(var n in t)e[n]=t[n];return e}function Hr(e){var t=e.parentNode;t&&t.removeChild(e)}function Vr(e,t,n,i,r){var a={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==r?++Er:r,__i:-1,__u:0};return null==r&&null!=Ar.vnode&&Ar.vnode(a),a}function qr(e){return e.children}function Gr(e,t){this.props=e,this.context=t}function zr(e,t){if(null==t)return e.__?zr(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?zr(e):null}function $r(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return $r(e)}}function Kr(e){(!e.__d&&(e.__d=!0)&&Ir.push(e)&&!Wr.__r++||Cr!==Ar.debounceRendering)&&((Cr=Ar.debounceRendering)||Mr)(Wr)}function Wr(){var e,t,n,i,r,a,o,s,u;for(Ir.sort(Pr);e=Ir.shift();)e.__d&&(t=Ir.length,i=void 0,a=(r=(n=e).__v).__e,s=[],u=[],(o=n.__P)&&((i=Br({},r)).__v=r.__v+1,Ar.vnode&&Ar.vnode(i),na(o,i,r,n.__n,void 0!==o.ownerSVGElement,32&r.__u?[a]:null,s,null==a?zr(r):a,!!(32&r.__u),u),i.__.__k[i.__i]=i,ia(s,i,u),i.__e!=a&&$r(i)),Ir.length>t&&Ir.sort(Pr));Wr.__r=0}function Xr(e,t,n,i,r,a,o,s,u,l,c){var d,h,f,p,g,m=i&&i.__k||jr,v=t.length;for(n.__d=u,function(e,t,n){var i,r,a,o,s,u=t.length,l=n.length,c=l,d=0;for(e.__k=[],i=0;i<u;i++)null!=(r=e.__k[i]=null==(r=t[i])||"boolean"==typeof r||"function"==typeof r?null:"string"==typeof r||"number"==typeof r||"bigint"==typeof r||r.constructor==String?Vr(null,r,null,null,r):Fr(r)?Vr(qr,{children:r},null,null,null):void 0===r.constructor&&r.__b>0?Vr(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r)?(r.__=e,r.__b=e.__b+1,s=Jr(r,n,o=i+d,c),r.__i=s,a=null,-1!==s&&(c--,(a=n[s])&&(a.__u|=131072)),null==a||null===a.__v?(-1==s&&d--,"function"!=typeof r.type&&(r.__u|=65536)):s!==o&&(s===o+1?d++:s>o?c>u-o?d+=s-o:d--:d=s<o&&s==o-1?s-o:0,s!==i+d&&(r.__u|=65536))):(a=n[i])&&null==a.key&&a.__e&&(a.__e==e.__d&&(e.__d=zr(a)),aa(a,a,!1),n[i]=null,c--);if(c)for(i=0;i<l;i++)null!=(a=n[i])&&!(131072&a.__u)&&(a.__e==e.__d&&(e.__d=zr(a)),aa(a,a))}(n,t,m),u=n.__d,d=0;d<v;d++)null!=(f=n.__k[d])&&"boolean"!=typeof f&&"function"!=typeof f&&(h=-1===f.__i?Or:m[f.__i]||Or,f.__i=d,na(e,f,h,r,a,o,s,u,l,c),p=f.__e,f.ref&&h.ref!=f.ref&&(h.ref&&ra(h.ref,null,f),c.push(f.ref,f.__c||p,f)),null==g&&null!=p&&(g=p),65536&f.__u||h.__k===f.__k?u=Yr(f,u,e):"function"==typeof f.type&&void 0!==f.__d?u=f.__d:p&&(u=p.nextSibling),f.__d=void 0,f.__u&=-196609);n.__d=u,n.__e=g}function Yr(e,t,n){var i,r;if("function"==typeof e.type){for(i=e.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=e,t=Yr(i[r],t,n));return t}return e.__e!=t&&(n.insertBefore(e.__e,t||null),t=e.__e),t&&t.nextSibling}function Jr(e,t,n,i){var r=e.key,a=e.type,o=n-1,s=n+1,u=t[n];if(null===u||u&&r==u.key&&a===u.type)return n;if(i>(null==u||131072&u.__u?0:1))for(;o>=0||s<t.length;){if(o>=0){if((u=t[o])&&!(131072&u.__u)&&r==u.key&&a===u.type)return o;o--}if(s<t.length){if((u=t[s])&&!(131072&u.__u)&&r==u.key&&a===u.type)return s;s++}}return-1}function Qr(e,t,n){"-"===t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||Ur.test(t)?n:n+"px"}function Zr(e,t,n,i,r){var a;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||Qr(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||Qr(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])a=t!==(t=t.replace(/(PointerCapture)$|Capture$/,"$1")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?i?n.u=i.u:(n.u=Date.now(),e.addEventListener(t,a?ta:ea,a)):e.removeEventListener(t,a?ta:ea,a);else{if(r)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==t&&"height"!==t&&"href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&"rowSpan"!==t&&"colSpan"!==t&&"role"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,n))}}function ea(e){var t=this.l[e.type+!1];if(e.t){if(e.t<=t.u)return}else e.t=Date.now();return t(Ar.event?Ar.event(e):e)}function ta(e){return this.l[e.type+!0](Ar.event?Ar.event(e):e)}function na(e,t,n,i,r,a,o,s,u,l){var c,d,h,f,p,g,m,v,y,b,w,_,S,T,x,k=t.type;if(void 0!==t.constructor)return null;128&n.__u&&(u=!!(32&n.__u),a=[s=t.__e=n.__e]),(c=Ar.__b)&&c(t);e:if("function"==typeof k)try{if(v=t.props,y=(c=k.contextType)&&i[c.__c],b=c?y?y.props.value:c.__:i,n.__c?m=(d=t.__c=n.__c).__=d.__E:("prototype"in k&&k.prototype.render?t.__c=d=new k(v,b):(t.__c=d=new Gr(v,b),d.constructor=k,d.render=oa),y&&y.sub(d),d.props=v,d.state||(d.state={}),d.context=b,d.__n=i,h=d.__d=!0,d.__h=[],d._sb=[]),null==d.__s&&(d.__s=d.state),null!=k.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=Br({},d.__s)),Br(d.__s,k.getDerivedStateFromProps(v,d.__s))),f=d.props,p=d.state,d.__v=t,h)null==k.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==k.getDerivedStateFromProps&&v!==f&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(v,b),!d.__e&&(null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(v,d.__s,b)||t.__v===n.__v)){for(t.__v!==n.__v&&(d.props=v,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),w=0;w<d._sb.length;w++)d.__h.push(d._sb[w]);d._sb=[],d.__h.length&&o.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(v,d.__s,b),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(f,p,g)}))}if(d.context=b,d.props=v,d.__P=e,d.__e=!1,_=Ar.__r,S=0,"prototype"in k&&k.prototype.render){for(d.state=d.__s,d.__d=!1,_&&_(t),c=d.render(d.props,d.state,d.context),T=0;T<d._sb.length;T++)d.__h.push(d._sb[T]);d._sb=[]}else do{d.__d=!1,_&&_(t),c=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++S<25);d.state=d.__s,null!=d.getChildContext&&(i=Br(Br({},i),d.getChildContext())),h||null==d.getSnapshotBeforeUpdate||(g=d.getSnapshotBeforeUpdate(f,p)),Xr(e,Fr(x=null!=c&&c.type===qr&&null==c.key?c.props.children:c)?x:[x],t,n,i,r,a,o,s,u,l),d.base=t.__e,t.__u&=-161,d.__h.length&&o.push(d),m&&(d.__E=d.__=null)}catch(e){t.__v=null,u||null!=a?(t.__e=s,t.__u|=u?160:32,a[a.indexOf(s)]=null):(t.__e=n.__e,t.__k=n.__k),Ar.__e(e,t,n)}else null==a&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=function(e,t,n,i,r,a,o,s,u){var l,c,d,h,f,p,g,m=n.props,v=t.props,y=t.type;if("svg"===y&&(r=!0),null!=a)for(l=0;l<a.length;l++)if((f=a[l])&&"setAttribute"in f==!!y&&(y?f.localName===y:3===f.nodeType)){e=f,a[l]=null;break}if(null==e){if(null===y)return document.createTextNode(v);e=r?document.createElementNS("http://www.w3.org/2000/svg",y):document.createElement(y,v.is&&v),a=null,s=!1}if(null===y)m===v||s&&e.data===v||(e.data=v);else{if(a=a&&kr.call(e.childNodes),m=n.props||Or,!s&&null!=a)for(m={},l=0;l<e.attributes.length;l++)m[(f=e.attributes[l]).name]=f.value;for(l in m)f=m[l],"children"==l||("dangerouslySetInnerHTML"==l?d=f:"key"===l||l in v||Zr(e,l,null,f,r));for(l in v)f=v[l],"children"==l?h=f:"dangerouslySetInnerHTML"==l?c=f:"value"==l?p=f:"checked"==l?g=f:"key"===l||s&&"function"!=typeof f||m[l]===f||Zr(e,l,f,m[l],r);if(c)s||d&&(c.__html===d.__html||c.__html===e.innerHTML)||(e.innerHTML=c.__html),t.__k=[];else if(d&&(e.innerHTML=""),Xr(e,Fr(h)?h:[h],t,n,i,r&&"foreignObject"!==y,a,o,a?a[0]:n.__k&&zr(n,0),s,u),null!=a)for(l=a.length;l--;)null!=a[l]&&Hr(a[l]);s||(l="value",void 0!==p&&(p!==e[l]||"progress"===y&&!p||"option"===y&&p!==m[l])&&Zr(e,l,p,m[l],!1),l="checked",void 0!==g&&g!==e[l]&&Zr(e,l,g,m[l],!1))}return e}(n.__e,t,n,i,r,a,o,u,l);(c=Ar.diffed)&&c(t)}function ia(e,t,n){t.__d=void 0;for(var i=0;i<n.length;i++)ra(n[i],n[++i],n[++i]);Ar.__c&&Ar.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){Ar.__e(e,t.__v)}}))}function ra(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){Ar.__e(e,n)}}function aa(e,t,n){var i,r;if(Ar.unmount&&Ar.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||ra(i,null,t)),null!=(i=e.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(e){Ar.__e(e,t)}i.base=i.__P=null,e.__c=void 0}if(i=e.__k)for(r=0;r<i.length;r++)i[r]&&aa(i[r],t,n||"function"!=typeof e.type);n||null==e.__e||Hr(e.__e),e.__=e.__e=e.__d=void 0}function oa(e,t,n){return this.constructor(e,n)}kr=jr.slice,Ar={__e:function(e,t,n,i){for(var r,a,o;t=t.__;)if((r=t.__c)&&!r.__)try{if((a=r.constructor)&&null!=a.getDerivedStateFromError&&(r.setState(a.getDerivedStateFromError(e)),o=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(e,i||{}),o=r.__d),o)return r.__E=r}catch(t){e=t}throw e}},Er=0,Gr.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=Br({},this.state),"function"==typeof e&&(e=e(Br({},n),this.props)),e&&Br(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),Kr(this))},Gr.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Kr(this))},Gr.prototype.render=qr,Ir=[],Mr="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Pr=function(e,t){return e.__v.__b-t.__v.__b},Wr.__r=0,Rr=0,function(e,t){var n={__c:t="__cC"+Rr++,__:{isPreviewMode:!1,previewPageIndex:0,handleCloseSurveyPopup:()=>{},isPopup:!0,onPreviewSubmit:()=>{}},Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,i;return this.getChildContext||(n=[],(i={})[t]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some((function(e){e.__e=!0,Kr(e)}))},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};n.Provider.__=n.Consumer.contextType=n}(),function(e){e.Popover="popover",e.API="api",e.Widget="widget"}(Dr||(Dr={})),function(e){e.Open="open",e.MultipleChoice="multiple_choice",e.SingleChoice="single_choice",e.Rating="rating",e.Link="link"}(Lr||(Lr={})),function(e){e.NextQuestion="next_question",e.End="end",e.ResponseBased="response_based",e.SpecificQuestion="specific_question"}(Nr||(Nr={}));class sa{constructor(){K(this,"events",{}),this.events={}}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),()=>{this.events[e]=this.events[e].filter((e=>e!==t))}}emit(e,t){for(var n of this.events[e]||[])n(t);for(var i of this.events["*"]||[])i(e,t)}}class ua{constructor(e){K(this,"_debugEventEmitter",new sa),K(this,"checkStep",((e,t)=>this.checkStepEvent(e,t)&&this.checkStepUrl(e,t)&&this.checkStepElement(e,t))),K(this,"checkStepEvent",((e,t)=>null==t||!t.event||(null==e?void 0:e.event)===(null==t?void 0:t.event))),this.instance=e,this.actionEvents=new Set,this.actionRegistry=new Set}init(){var e,t;R(null===(e=this.instance)||void 0===e?void 0:e._addCaptureHook)||(null===(t=this.instance)||void 0===t||t._addCaptureHook(((e,t)=>{this.on(e,t)})))}register(e){var t,n;if(!R(null===(t=this.instance)||void 0===t?void 0:t._addCaptureHook)&&(e.forEach((e=>{var t,n;null===(t=this.actionRegistry)||void 0===t||t.add(e),null===(n=e.steps)||void 0===n||n.forEach((e=>{var t;null===(t=this.actionEvents)||void 0===t||t.add((null==e?void 0:e.event)||"")}))})),null!==(n=this.instance)&&void 0!==n&&n.autocapture)){var i,r=new Set;e.forEach((e=>{var t;null===(t=e.steps)||void 0===t||t.forEach((e=>{null!=e&&e.selector&&r.add(null==e?void 0:e.selector)}))})),null===(i=this.instance)||void 0===i||i.autocapture.setElementSelectors(r)}}on(e,t){var n;null!=t&&0!=e.length&&(this.actionEvents.has(e)||this.actionEvents.has(null==t?void 0:t.event))&&this.actionRegistry&&(null===(n=this.actionRegistry)||void 0===n?void 0:n.size)>0&&this.actionRegistry.forEach((e=>{this.checkAction(t,e)&&this._debugEventEmitter.emit("actionCaptured",e.name)}))}_addActionHook(e){this.onAction("actionCaptured",(t=>e(t)))}checkAction(e,t){if(null==(null==t?void 0:t.steps))return!1;for(var n of t.steps)if(this.checkStep(e,n))return!0;return!1}onAction(e,t){return this._debugEventEmitter.on(e,t)}checkStepUrl(e,t){if(null!=t&&t.url){var n,i=null==e||null===(n=e.properties)||void 0===n?void 0:n.$current_url;if(!i||"string"!=typeof i)return!1;if(!ua.matchString(i,null==t?void 0:t.url,(null==t?void 0:t.url_matching)||"contains"))return!1}return!0}static matchString(e,t,n){switch(n){case"regex":return!!r&&yt(e,t);case"exact":return t===e;case"contains":var i=ua.escapeStringRegexp(t).replace(/_/g,".").replace(/%/g,".*");return yt(e,i);default:return!1}}static escapeStringRegexp(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}checkStepElement(e,t){if((null!=t&&t.href||null!=t&&t.tag_name||null!=t&&t.text)&&!this.getElementsList(e).some((e=>!(null!=t&&t.href&&!ua.matchString(e.href||"",null==t?void 0:t.href,(null==t?void 0:t.href_matching)||"exact")||null!=t&&t.tag_name&&e.tag_name!==(null==t?void 0:t.tag_name)||null!=t&&t.text&&!ua.matchString(e.text||"",null==t?void 0:t.text,(null==t?void 0:t.text_matching)||"exact")&&!ua.matchString(e.$el_text||"",null==t?void 0:t.text,(null==t?void 0:t.text_matching)||"exact")))))return!1;if(null!=t&&t.selector){var n,i=null==e||null===(n=e.properties)||void 0===n?void 0:n.$element_selectors;if(!i)return!1;if(!i.includes(null==t?void 0:t.selector))return!1}return!0}getElementsList(e){return null==(null==e?void 0:e.properties.$elements)?[]:null==e?void 0:e.properties.$elements}}class la{constructor(e){this.instance=e,this.eventToSurveys=new Map,this.actionToSurveys=new Map}register(e){var t;R(null===(t=this.instance)||void 0===t?void 0:t._addCaptureHook)||(this.setupEventBasedSurveys(e),this.setupActionBasedSurveys(e))}setupActionBasedSurveys(e){var t=e.filter((e=>{var t,n,i,r;return(null===(t=e.conditions)||void 0===t?void 0:t.actions)&&(null===(n=e.conditions)||void 0===n||null===(i=n.actions)||void 0===i||null===(r=i.values)||void 0===r?void 0:r.length)>0}));0!==t.length&&(null==this.actionMatcher&&(this.actionMatcher=new ua(this.instance),this.actionMatcher.init(),this.actionMatcher._addActionHook((e=>{this.onAction(e)}))),t.forEach((e=>{var t,n,i,r,a,o,s,u,l,c;e.conditions&&null!==(t=e.conditions)&&void 0!==t&&t.actions&&null!==(n=e.conditions)&&void 0!==n&&null!==(i=n.actions)&&void 0!==i&&i.values&&(null===(r=e.conditions)||void 0===r||null===(a=r.actions)||void 0===a||null===(o=a.values)||void 0===o?void 0:o.length)>0&&(null===(s=this.actionMatcher)||void 0===s||s.register(e.conditions.actions.values),null===(u=e.conditions)||void 0===u||null===(l=u.actions)||void 0===l||null===(c=l.values)||void 0===c||c.forEach((t=>{if(t&&t.name){var n=this.actionToSurveys.get(t.name);n&&n.push(e.id),this.actionToSurveys.set(t.name,n||[e.id])}})))})))}setupEventBasedSurveys(e){var t;0!==e.filter((e=>{var t,n,i,r;return(null===(t=e.conditions)||void 0===t?void 0:t.events)&&(null===(n=e.conditions)||void 0===n||null===(i=n.events)||void 0===i||null===(r=i.values)||void 0===r?void 0:r.length)>0})).length&&(null===(t=this.instance)||void 0===t||t._addCaptureHook(((e,t)=>{this.onEvent(e,t)})),e.forEach((e=>{var t,n,i;null===(t=e.conditions)||void 0===t||null===(n=t.events)||void 0===n||null===(i=n.values)||void 0===i||i.forEach((t=>{if(t&&t.name){var n=this.eventToSurveys.get(t.name);n&&n.push(e.id),this.eventToSurveys.set(t.name,n||[e.id])}}))})))}onEvent(e,t){var n,i,r=(null===(n=this.instance)||void 0===n||null===(i=n.persistence)||void 0===i?void 0:i.props[De])||[];if(la.SURVEY_SHOWN_EVENT_NAME==e&&t&&r.length>0){var a,o=null==t||null===(a=t.properties)||void 0===a?void 0:a.$survey_id;if(o){var s=r.indexOf(o);s>=0&&(r.splice(s,1),this._updateActivatedSurveys(r))}}else this.eventToSurveys.has(e)&&this._updateActivatedSurveys(r.concat(this.eventToSurveys.get(e)||[]))}onAction(e){var t,n,i=(null===(t=this.instance)||void 0===t||null===(n=t.persistence)||void 0===n?void 0:n.props[De])||[];this.actionToSurveys.has(e)&&this._updateActivatedSurveys(i.concat(this.actionToSurveys.get(e)||[]))}_updateActivatedSurveys(e){var t,n;null===(t=this.instance)||void 0===t||null===(n=t.persistence)||void 0===n||n.register({[De]:[...new Set(e)]})}getSurveys(){var e,t;return(null===(e=this.instance)||void 0===e||null===(t=e.persistence)||void 0===t?void 0:t.props[De])||[]}getEventToSurveys(){return this.eventToSurveys}_getActionMatcher(){return this.actionMatcher}}K(la,"SURVEY_SHOWN_EVENT_NAME","survey shown");var ca=V("[Surveys]"),da={icontains:e=>!!r&&r.location.href.toLowerCase().indexOf(e.toLowerCase())>-1,not_icontains:e=>!!r&&-1===r.location.href.toLowerCase().indexOf(e.toLowerCase()),regex:e=>!!r&&yt(r.location.href,e),not_regex:e=>!!r&&!yt(r.location.href,e),exact:e=>(null==r?void 0:r.location.href)===e,is_not:e=>(null==r?void 0:r.location.href)!==e};function ha(e,t,n){var i,r=e.questions[t],a=t+1;if(null===(i=r.branching)||void 0===i||!i.type)return t===e.questions.length-1?Nr.End:a;if(r.branching.type===Nr.End)return Nr.End;if(r.branching.type===Nr.SpecificQuestion){if(Number.isInteger(r.branching.index))return r.branching.index}else if(r.branching.type===Nr.ResponseBased){if(r.type===Lr.SingleChoice){var o,s,u=r.choices.indexOf("".concat(n));if(null!==(o=r.branching)&&void 0!==o&&null!==(s=o.responseValues)&&void 0!==s&&s.hasOwnProperty(u)){var l=r.branching.responseValues[u];return Number.isInteger(l)?l:l===Nr.End?Nr.End:a}}else if(r.type===Lr.Rating){var c,d;if("number"!=typeof n||!Number.isInteger(n))throw new Error("The response type must be an integer");var h=function(e,t){if(3===t){if(e<1||e>3)throw new Error("The response must be in range 1-3");return 1===e?"negative":2===e?"neutral":"positive"}if(5===t){if(e<1||e>5)throw new Error("The response must be in range 1-5");return e<=2?"negative":3===e?"neutral":"positive"}if(7===t){if(e<1||e>7)throw new Error("The response must be in range 1-7");return e<=3?"negative":4===e?"neutral":"positive"}if(10===t){if(e<0||e>10)throw new Error("The response must be in range 0-10");return e<=6?"detractors":e<=8?"passives":"promoters"}throw new Error("The scale must be one of: 3, 5, 7, 10")}(n,r.scale);if(null!==(c=r.branching)&&void 0!==c&&null!==(d=c.responseValues)&&void 0!==d&&d.hasOwnProperty(h)){var f=r.branching.responseValues[h];return Number.isInteger(f)?f:f===Nr.End?Nr.End:a}}return a}return ca.warn("Falling back to next question index due to unexpected branching type"),a}class fa{constructor(e){K(this,"getNextSurveyStep",ha),this.instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){this._decideServerResponse=!!e.surveys,ca.info("decideServerResponse set to ".concat(this._decideServerResponse)),this.loadIfEnabled()}reset(){localStorage.removeItem("lastSeenSurveyDate");var e=(()=>{for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);null!=n&&n.startsWith("seenSurvey_")&&e.push(n)}return e})();e.forEach((e=>localStorage.removeItem(e)))}loadIfEnabled(){if(!this._surveyManager)if(this.instance.config.disable_surveys)ca.info("Disabled. Not loading surveys.");else{var e=null==m?void 0:m.__PosthogExtensions__;if(e){var t=e.generateSurveys;if(this._decideServerResponse)if(null==this._surveyEventReceiver&&(this._surveyEventReceiver=new la(this.instance)),t)this._surveyManager=t(this.instance);else{var n=e.loadExternalDependency;n?n(this.instance,"surveys",(t=>{var n;t?ca.error("Could not load surveys script",t):this._surveyManager=null===(n=e.generateSurveys)||void 0===n?void 0:n.call(e,this.instance)})):ca.error("PostHog loadExternalDependency extension not found. Cannot load remote config.")}else ca.warn("Decide not loaded yet. Not loading surveys.")}else ca.error("PostHog Extensions not found.")}}getSurveys(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.instance.config.disable_surveys)return ca.info("Disabled. Not loading surveys."),e([]);null==this._surveyEventReceiver&&(this._surveyEventReceiver=new la(this.instance));var n=this.instance.get_property(Re);if(n&&!t)return ca.info("Surveys already loaded, using existing data."),e(n);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/surveys/?token=".concat(this.instance.config.token)),method:"GET",callback:t=>{var n,i=t.statusCode;if(200!==i||!t.json)return ca.error("Surveys API could not be loaded, status: ".concat(i)),e([]);var r,a=t.json.surveys||[],o=a.filter((e=>{var t,n,i,r,a,o,s,u,l,c,d,h;return(null===(t=e.conditions)||void 0===t?void 0:t.events)&&(null===(n=e.conditions)||void 0===n||null===(i=n.events)||void 0===i?void 0:i.values)&&(null===(r=e.conditions)||void 0===r||null===(a=r.events)||void 0===a||null===(o=a.values)||void 0===o?void 0:o.length)>0||(null===(s=e.conditions)||void 0===s?void 0:s.actions)&&(null===(u=e.conditions)||void 0===u||null===(l=u.actions)||void 0===l?void 0:l.values)&&(null===(c=e.conditions)||void 0===c||null===(d=c.actions)||void 0===d||null===(h=d.values)||void 0===h?void 0:h.length)>0}));return o.length>0&&(null===(r=this._surveyEventReceiver)||void 0===r||r.register(o)),null===(n=this.instance.persistence)||void 0===n||n.register({[Re]:a}),e(a)}})}getActiveMatchingSurveys(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.getSurveys((t=>{var n,i=t.filter((e=>!(!e.start_date||e.end_date))).filter((e=>{var t;if(!e.conditions)return!0;var n=function(e){var t,n,i;return null===(t=e.conditions)||void 0===t||!t.url||da[null!==(n=null===(i=e.conditions)||void 0===i?void 0:i.urlMatchType)&&void 0!==n?n:"icontains"](e.conditions.url)}(e),i=null===(t=e.conditions)||void 0===t||!t.selector||(null==c?void 0:c.querySelector(e.conditions.selector));return n&&i})),r=null===(n=this._surveyEventReceiver)||void 0===n?void 0:n.getSurveys(),a=i.filter((e=>{var t,n,i,a,o,s,u,l,c,d,h;if(!(e.linked_flag_key||e.targeting_flag_key||e.internal_targeting_flag_key||null!==(t=e.feature_flag_keys)&&void 0!==t&&t.length))return!0;var f=!e.linked_flag_key||this.instance.featureFlags.isFeatureEnabled(e.linked_flag_key),p=!e.targeting_flag_key||this.instance.featureFlags.isFeatureEnabled(e.targeting_flag_key),g=(null===(n=e.conditions)||void 0===n?void 0:n.events)&&(null===(i=e.conditions)||void 0===i||null===(a=i.events)||void 0===a?void 0:a.values)&&(null===(o=e.conditions)||void 0===o||null===(s=o.events)||void 0===s?void 0:s.values.length)>0,m=(null===(u=e.conditions)||void 0===u?void 0:u.actions)&&(null===(l=e.conditions)||void 0===l||null===(c=l.actions)||void 0===c?void 0:c.values)&&(null===(d=e.conditions)||void 0===d||null===(h=d.actions)||void 0===h?void 0:h.values.length)>0,v=!g&&!m||(null==r?void 0:r.includes(e.id)),y=this._canActivateRepeatedly(e),b=!(e.internal_targeting_flag_key&&!y)||this.instance.featureFlags.isFeatureEnabled(e.internal_targeting_flag_key),w=this.checkFlags(e);return f&&p&&b&&v&&w}));return e(a)}),t)}checkFlags(e){var t;return null===(t=e.feature_flag_keys)||void 0===t||!t.length||e.feature_flag_keys.every((e=>{var{key:t,value:n}=e;return!t||!n||this.instance.featureFlags.isFeatureEnabled(n)}))}_canActivateRepeatedly(e){var t;return O(null===(t=m.__PosthogExtensions__)||void 0===t?void 0:t.canActivateRepeatedly)?(ca.warn("init was not called"),!1):m.__PosthogExtensions__.canActivateRepeatedly(e)}canRenderSurvey(e){O(this._surveyManager)?ca.warn("init was not called"):this.getSurveys((t=>{var n=t.filter((t=>t.id===e))[0];this._surveyManager.canRenderSurvey(n)}))}renderSurvey(e,t){O(this._surveyManager)?ca.warn("init was not called"):this.getSurveys((n=>{var i=n.filter((t=>t.id===e))[0];this._surveyManager.renderSurvey(i,null==c?void 0:c.querySelector(t))}))}}var pa=V("[RateLimiter]");class ga{constructor(e){var t,n;K(this,"serverLimits",{}),K(this,"lastEventRateLimited",!1),K(this,"checkForLimiting",(e=>{var t=e.text;if(t&&t.length)try{(JSON.parse(t).quota_limited||[]).forEach((e=>{pa.info("".concat(e||"events"," is quota limited.")),this.serverLimits[e]=(new Date).getTime()+6e4}))}catch(e){return void pa.warn('could not rate limit - continuing. Error: "'.concat(null==e?void 0:e.message,'"'),{text:t})}})),this.instance=e,this.captureEventsPerSecond=(null===(t=e.config.rate_limiting)||void 0===t?void 0:t.events_per_second)||10,this.captureEventsBurstLimit=Math.max((null===(n=e.config.rate_limiting)||void 0===n?void 0:n.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(){var e,t,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=(new Date).getTime(),a=null!==(e=null===(t=this.instance.persistence)||void 0===t?void 0:t.get_property(je))&&void 0!==e?e:{tokens:this.captureEventsBurstLimit,last:r};a.tokens+=(r-a.last)/1e3*this.captureEventsPerSecond,a.last=r,a.tokens>this.captureEventsBurstLimit&&(a.tokens=this.captureEventsBurstLimit);var o=a.tokens<1;return o||i||(a.tokens=Math.max(0,a.tokens-1)),!o||this.lastEventRateLimited||i||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to ".concat(this.captureEventsPerSecond," events per second and ").concat(this.captureEventsBurstLimit," events burst limit.")},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=o,null===(n=this.instance.persistence)||void 0===n||n.set_property(je,a),{isRateLimited:o,remainingTokens:a.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return!1!==t&&(new Date).getTime()<t}}var ma=e=>{var t=null==e?void 0:e.config;return $({initialPathName:(null==d?void 0:d.pathname)||"",referringDomain:_n.referringDomain()},_n.campaignParams({customTrackedParams:null==t?void 0:t.custom_campaign_params,maskPersonalDataProperties:null==t?void 0:t.mask_personal_data_properties,customPersonalDataProperties:null==t?void 0:t.custom_personal_data_properties}))};class va{constructor(e,t,n,i){K(this,"_onSessionIdCallback",(e=>{var t=this._getStoredProps();if(!t||t.sessionId!==e){var n={sessionId:e,props:this._sessionSourceParamGenerator(this.instance)};this._persistence.register({[Oe]:n})}})),this.instance=e,this._sessionIdManager=t,this._persistence=n,this._sessionSourceParamGenerator=i||ma,this._sessionIdManager.onSessionId(this._onSessionIdCallback)}_getStoredProps(){return this._persistence.props[Oe]}getSessionProps(){var e,t=null===(e=this._getStoredProps())||void 0===e?void 0:e.props;return t?{$client_session_initial_referring_host:t.referringDomain,$client_session_initial_pathname:t.initialPathName,$client_session_initial_utm_source:t.utm_source,$client_session_initial_utm_campaign:t.utm_campaign,$client_session_initial_utm_medium:t.utm_medium,$client_session_initial_utm_content:t.utm_content,$client_session_initial_utm_term:t.utm_term}:{}}}var ya=["ahrefsbot","ahrefssiteaudit","applebot","baiduspider","better uptime bot","bingbot","bingpreview","bot.htm","bot.php","crawler","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","linkedinbot","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","semrushbot","sitebulb","slurp","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","gptbot","oai-searchbot","chatgpt-user","headlesschrome","cypress","Google-HotelAdsVerifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleweblight","mediapartners-google","storebot-google","Bytespider;"],ba=function(e,t){if(!e)return!1;var n=e.toLowerCase();return ya.concat(t||[]).some((e=>{var t=e.toLowerCase();return-1!==n.indexOf(t)}))},wa=function(e,t){if(!e)return!1;var n=e.userAgent;if(n&&ba(n,t))return!0;try{var i=null==e?void 0:e.userAgentData;if(null!=i&&i.brands&&i.brands.some((e=>ba(null==e?void 0:e.brand,t))))return!0}catch(e){}return!!e.webdriver};class _a{constructor(){this.clicks=[]}isRageClick(e,t,n){var i=this.clicks[this.clicks.length-1];if(i&&Math.abs(e-i.x)+Math.abs(t-i.y)<30&&n-i.timestamp<1e3){if(this.clicks.push({x:e,y:t,timestamp:n}),3===this.clicks.length)return!0}else this.clicks=[{x:e,y:t,timestamp:n}];return!1}}var Sa=V("[Dead Clicks]"),Ta=()=>!0,xa=e=>{var t,n=!(null===(t=e.instance.persistence)||void 0===t||!t.get_property(ge)),i=e.instance.config.capture_dead_clicks;return U(i)?i:n};class ka{get lazyLoadedDeadClicksAutocapture(){return this._lazyLoadedDeadClicksAutocapture}constructor(e,t,n){this.instance=e,this.isEnabled=t,this.onCapture=n,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[ge]:null==e?void 0:e.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.loadScript((()=>{this.start()}))}loadScript(e){var t,n,i;null!==(t=m.__PosthogExtensions__)&&void 0!==t&&t.initDeadClicksAutocapture&&e(),null===(n=m.__PosthogExtensions__)||void 0===n||null===(i=n.loadExternalDependency)||void 0===i||i.call(n,this.instance,"dead-clicks-autocapture",(t=>{t?Sa.error("failed to load script",t):e()}))}start(){var e;if(c){if(!this._lazyLoadedDeadClicksAutocapture&&null!==(e=m.__PosthogExtensions__)&&void 0!==e&&e.initDeadClicksAutocapture){var t=M(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this._lazyLoadedDeadClicksAutocapture=m.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this._lazyLoadedDeadClicksAutocapture.start(c),Sa.info("starting...")}}else Sa.error("`document` not found. Cannot start.")}stop(){this._lazyLoadedDeadClicksAutocapture&&(this._lazyLoadedDeadClicksAutocapture.stop(),this._lazyLoadedDeadClicksAutocapture=void 0,Sa.info("stopping..."))}}var Aa=V("[Heatmaps]");function Ea(e){return M(e)&&"clientX"in e&&"clientY"in e&&j(e.clientX)&&j(e.clientY)}class Ia{constructor(e){var t;K(this,"rageclicks",new _a),K(this,"_enabledServerSide",!1),K(this,"_initialized",!1),K(this,"_flushInterval",null),this.instance=e,this._enabledServerSide=!(null===(t=this.instance.persistence)||void 0===t||!t.props[he]),se(r,"beforeunload",this.flush)}get flushIntervalMilliseconds(){var e=5e3;return M(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return R(this.instance.config.capture_heatmaps)?R(this.instance.config.enable_heatmaps)?this._enabledServerSide:this.instance.config.enable_heatmaps:!1!==this.instance.config.capture_heatmaps}startIfEnabled(){if(this.isEnabled){if(this._initialized)return;Aa.info("starting..."),this._setupListeners(),this._flushInterval=setInterval(this.flush.bind(this),this.flushIntervalMilliseconds)}else{var e,t;clearInterval(null!==(e=this._flushInterval)&&void 0!==e?e:void 0),null===(t=this.deadClicksCapture)||void 0===t||t.stop(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[he]:t}),this._enabledServerSide=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.buffer;return this.buffer=void 0,e}_onDeadClick(e){this._onClick(e.originalEvent,"deadclick")}_setupListeners(){r&&c&&(se(c,"click",(e=>this._onClick(e||(null==r?void 0:r.event))),{capture:!0}),se(c,"mousemove",(e=>this._onMouseMove(e||(null==r?void 0:r.event))),{capture:!0}),this.deadClicksCapture=new ka(this.instance,Ta,this._onDeadClick.bind(this)),this.deadClicksCapture.startIfEnabled(),this._initialized=!0)}_getProperties(e,t){var n=this.instance.scrollManager.scrollY(),i=this.instance.scrollManager.scrollX(),a=this.instance.scrollManager.scrollElement(),o=function(e,t,n){for(var i=e;i&&Cn(i)&&!Mn(i,"body");){if(i===n)return!1;if(_(t,null==r?void 0:r.getComputedStyle(i).position))return!0;i=Bn(i)}return!1}(Un(e),["fixed","sticky"],a);return{x:e.clientX+(o?0:i),y:e.clientY+(o?0:n),target_fixed:o,type:t}}_onClick(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click";if(!In(e.target)&&Ea(e)){var i=this._getProperties(e,n);null!==(t=this.rageclicks)&&void 0!==t&&t.isRageClick(e.clientX,e.clientY,(new Date).getTime())&&this._capture($($({},i),{},{type:"rageclick"})),this._capture(i)}}_onMouseMove(e){!In(e.target)&&Ea(e)&&(clearTimeout(this._mouseMoveTimeout),this._mouseMoveTimeout=setTimeout((()=>{this._capture(this._getProperties(e,"mousemove"))}),500))}_capture(e){if(r){var t=r.location.href;this.buffer=this.buffer||{},this.buffer[t]||(this.buffer[t]=[]),this.buffer[t].push(e)}}flush(){this.buffer&&!P(this.buffer)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class Ca{constructor(e){K(this,"_updateScrollData",(()=>{var e,t,n,i;this.context||(this.context={});var r=this.scrollElement(),a=this.scrollY(),o=r?Math.max(0,r.scrollHeight-r.clientHeight):0,s=a+((null==r?void 0:r.clientHeight)||0),u=(null==r?void 0:r.scrollHeight)||0;this.context.lastScrollY=Math.ceil(a),this.context.maxScrollY=Math.max(a,null!==(e=this.context.maxScrollY)&&void 0!==e?e:0),this.context.maxScrollHeight=Math.max(o,null!==(t=this.context.maxScrollHeight)&&void 0!==t?t:0),this.context.lastContentY=s,this.context.maxContentY=Math.max(s,null!==(n=this.context.maxContentY)&&void 0!==n?n:0),this.context.maxContentHeight=Math.max(u,null!==(i=this.context.maxContentHeight)&&void 0!==i?i:0)})),this.instance=e}getContext(){return this.context}resetContext(){var e=this.context;return setTimeout(this._updateScrollData,0),e}startMeasuringScrollPosition(){se(r,"scroll",this._updateScrollData,{capture:!0}),se(r,"scrollend",this._updateScrollData,{capture:!0}),se(r,"resize",this._updateScrollData)}scrollElement(){if(!this.instance.config.scroll_root_selector)return null==r?void 0:r.document.documentElement;var e=I(this.instance.config.scroll_root_selector)?this.instance.config.scroll_root_selector:[this.instance.config.scroll_root_selector];for(var t of e){var n=null==r?void 0:r.document.querySelector(t);if(n)return n}}scrollY(){if(this.instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return r&&(r.scrollY||r.pageYOffset||r.document.documentElement.scrollTop)||0}scrollX(){if(this.instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return r&&(r.scrollX||r.pageXOffset||r.document.documentElement.scrollLeft)||0}}var Ma=V("[AutoCapture]");function Pa(e,t){return t.length>e?t.slice(0,e)+"...":t}function Ra(e){if(e.previousElementSibling)return e.previousElementSibling;var t=e;do{t=t.previousSibling}while(t&&!Cn(t));return t}function Da(e,t){for(var n,i,{e:a,maskAllElementAttributes:o,maskAllText:s,elementAttributeIgnoreList:u,elementsChainAsString:l}=t,c=[e],d=e;d.parentNode&&!Mn(d,"body");)Rn(d.parentNode)?(c.push(d.parentNode.host),d=d.parentNode.host):(c.push(d.parentNode),d=d.parentNode);var h,f=[],p={},g=!1,m=!1;if(J(c,(e=>{var t=Hn(e);"a"===e.tagName.toLowerCase()&&(g=e.getAttribute("href"),g=t&&g&&Xn(g)&&g),_(Nn(e),"ph-no-capture")&&(m=!0),f.push(function(e,t,n,i){var r=e.tagName.toLowerCase(),a={tag_name:r};Fn.indexOf(r)>-1&&!n&&("a"===r.toLowerCase()||"button"===r.toLowerCase()?a.$el_text=Pa(1024,Yn(e)):a.$el_text=Pa(1024,jn(e)));var o=Nn(e);o.length>0&&(a.classes=o.filter((function(e){return""!==e}))),J(e.attributes,(function(n){var r;if((!Vn(e)||-1!==["name","id","class","aria-label"].indexOf(n.name))&&(null==i||!i.includes(n.name))&&!t&&Xn(n.value)&&(r=n.name,!D(r)||"_ngcontent"!==r.substring(0,10)&&"_nghost"!==r.substring(0,7))){var o=n.value;"class"===n.name&&(o=Dn(o).join(" ")),a["attr__"+n.name]=Pa(1024,o)}}));for(var s=1,u=1,l=e;l=Ra(l);)s++,l.tagName===e.tagName&&u++;return a.nth_child=s,a.nth_of_type=u,a}(e,o,s,u));var n=function(e){if(!Hn(e))return{};var t={};return J(e.attributes,(function(e){if(e.name&&0===e.name.indexOf("data-ph-capture-attribute")){var n=e.name.replace("data-ph-capture-attribute-",""),i=e.value;n&&i&&Xn(i)&&(t[n]=i)}})),t}(e);Q(p,n)})),m)return{props:{},explicitNoCapture:m};if(s||("a"===e.tagName.toLowerCase()||"button"===e.tagName.toLowerCase()?f[0].$el_text=Yn(e):f[0].$el_text=jn(e)),g){var v,y;f[0].attr__href=g;var b=null===(v=vt(g))||void 0===v?void 0:v.host,w=null==r||null===(y=r.location)||void 0===y?void 0:y.host;b&&w&&b!==w&&(h=g)}return{props:Q({$event_type:a.type,$ce_version:1},l?{}:{$elements:f},{$elements_chain:Qn(f)},null!==(n=f[0])&&void 0!==n&&n.$el_text?{$el_text:null===(i=f[0])||void 0===i?void 0:i.$el_text}:{},h&&"click"===a.type?{$external_click_url:h}:{},p)}}class La{constructor(e){K(this,"_initialized",!1),K(this,"_isDisabledServerSide",null),K(this,"rageclicks",new _a),K(this,"_elementsChainAsString",!1),this.instance=e,this._elementSelectors=null}get config(){var e,t,n=M(this.instance.config.autocapture)?this.instance.config.autocapture:{};return n.url_allowlist=null===(e=n.url_allowlist)||void 0===e?void 0:e.map((e=>new RegExp(e))),n.url_ignorelist=null===(t=n.url_ignorelist)||void 0===t?void 0:t.map((e=>new RegExp(e))),n}_addDomEventHandlers(){if(this.isBrowserSupported()){if(r&&c){var e=e=>{e=e||(null==r?void 0:r.event);try{this._captureEvent(e)}catch(e){Ma.error("Failed to capture event",e)}};if(se(c,"submit",e,{capture:!0}),se(c,"change",e,{capture:!0}),se(c,"click",e,{capture:!0}),this.config.capture_copied_text){var t=e=>{e=e||(null==r?void 0:r.event),this._captureEvent(e,y)};se(c,"copy",t,{capture:!0}),se(c,"cut",t,{capture:!0})}}}else Ma.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this._initialized&&(this._addDomEventHandlers(),this._initialized=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this._elementsChainAsString=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[de]:!!e.autocapture_opt_out}),this._isDisabledServerSide=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this._elementSelectors=e}getElementSelectors(e){var t,n=[];return null===(t=this._elementSelectors)||void 0===t||t.forEach((t=>{var i=null==c?void 0:c.querySelectorAll(t);null==i||i.forEach((i=>{e===i&&n.push(t)}))})),n}get isEnabled(){var e,t,n=null===(e=this.instance.persistence)||void 0===e?void 0:e.props[de],i=this._isDisabledServerSide;if(N(i)&&!U(n)&&!this.instance.config.advanced_disable_decide)return!1;var r=null!==(t=this._isDisabledServerSide)&&void 0!==t?t:!!n;return!!this.instance.config.autocapture&&!r}_captureEvent(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$autocapture";if(this.isEnabled){var n,i=Un(e);Pn(i)&&(i=i.parentNode||null),"$autocapture"===t&&"click"===e.type&&e instanceof MouseEvent&&this.instance.config.rageclick&&null!==(n=this.rageclicks)&&void 0!==n&&n.isRageClick(e.clientX,e.clientY,(new Date).getTime())&&this._captureEvent(e,"$rageclick");var a=t===y;if(i&&function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(!r||!e||Mn(e,"html")||!Cn(e))return!1;if(null!=n&&n.url_allowlist&&!Ln(n.url_allowlist))return!1;if(null!=n&&n.url_ignorelist&&Ln(n.url_ignorelist))return!1;if(null!=n&&n.dom_event_allowlist){var o=n.dom_event_allowlist;if(o&&!o.some((e=>t.type===e)))return!1}for(var s=!1,u=[e],l=!0,c=e;c.parentNode&&!Mn(c,"body");)if(Rn(c.parentNode))u.push(c.parentNode.host),c=c.parentNode.host;else{if(!(l=Bn(c)))break;if(i||Fn.indexOf(l.tagName.toLowerCase())>-1)s=!0;else{var d=r.getComputedStyle(l);d&&"pointer"===d.getPropertyValue("cursor")&&(s=!0)}u.push(l),c=l}if(!function(e,t){var n=null==t?void 0:t.element_allowlist;if(R(n))return!0;var i=function(e){if(n.some((t=>e.tagName.toLowerCase()===t)))return{v:!0}};for(var r of e){var a=i(r);if("object"==typeof a)return a.v}return!1}(u,n))return!1;if(!function(e,t){var n=null==t?void 0:t.css_selector_allowlist;if(R(n))return!0;var i=function(e){if(n.some((t=>e.matches(t))))return{v:!0}};for(var r of e){var a=i(r);if("object"==typeof a)return a.v}return!1}(u,n))return!1;var h=r.getComputedStyle(e);if(h&&"pointer"===h.getPropertyValue("cursor")&&"click"===t.type)return!0;var f=e.tagName.toLowerCase();switch(f){case"html":return!1;case"form":return(a||["submit"]).indexOf(t.type)>=0;case"input":case"select":case"textarea":return(a||["change","click"]).indexOf(t.type)>=0;default:return s?(a||["click"]).indexOf(t.type)>=0:(a||["click"]).indexOf(t.type)>=0&&(Fn.indexOf(f)>-1||"true"===e.getAttribute("contenteditable"))}}(i,e,this.config,a,a?["copy","cut"]:void 0)){var{props:o,explicitNoCapture:s}=Da(i,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.config.element_attribute_ignorelist,elementsChainAsString:this._elementsChainAsString});if(s)return!1;var u=this.getElementSelectors(i);if(u&&u.length>0&&(o.$element_selectors=u),t===y){var l,c=On(null==r||null===(l=r.getSelection())||void 0===l?void 0:l.toString()),d=e.type||"clipboard";if(!c)return!1;o.$selected_content=c,o.$copy_type=d}return this.instance.capture(t,o),!0}}}isBrowserSupported(){return C(null==c?void 0:c.querySelectorAll)}}var Na,Oa=V("[TracingHeaders]");class ja{constructor(e){K(this,"_restoreXHRPatch",void 0),K(this,"_restoreFetchPatch",void 0),K(this,"_startCapturing",(()=>{var e,t,n,i;R(this._restoreXHRPatch)&&(null===(e=m.__PosthogExtensions__)||void 0===e||null===(t=e.tracingHeadersPatchFns)||void 0===t||t._patchXHR(this.instance.sessionManager)),R(this._restoreFetchPatch)&&(null===(n=m.__PosthogExtensions__)||void 0===n||null===(i=n.tracingHeadersPatchFns)||void 0===i||i._patchFetch(this.instance.sessionManager))})),this.instance=e}_loadScript(e){var t,n,i;null!==(t=m.__PosthogExtensions__)&&void 0!==t&&t.tracingHeadersPatchFns&&e(),null===(n=m.__PosthogExtensions__)||void 0===n||null===(i=n.loadExternalDependency)||void 0===i||i.call(n,this.instance,"tracing-headers",(t=>{if(t)return Oa.error("failed to load script",t);e()}))}startIfEnabledOrStop(){var e,t;this.instance.config.__add_tracing_headers?this._loadScript(this._startCapturing):(null===(e=this._restoreXHRPatch)||void 0===e||e.call(this),null===(t=this._restoreFetchPatch)||void 0===t||t.call(this),this._restoreXHRPatch=void 0,this._restoreFetchPatch=void 0)}}!function(e){e[e.PENDING=-1]="PENDING",e[e.DENIED=0]="DENIED",e[e.GRANTED=1]="GRANTED"}(Na||(Na={}));class Ua{constructor(e){this.instance=e}get config(){return this.instance.config}get consent(){return this.getDnt()?Na.DENIED:this.storedConsent}isOptedOut(){return this.consent===Na.DENIED||this.consent===Na.PENDING&&this.config.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(e){this.storage.set(this.storageKey,e?1:0,this.config.cookie_expiration,this.config.cross_subdomain_cookie,this.config.secure_cookie)}reset(){this.storage.remove(this.storageKey,this.config.cross_subdomain_cookie)}get storageKey(){var{token:e,opt_out_capturing_cookie_prefix:t}=this.instance.config;return(t||"__ph_opt_in_out_")+e}get storedConsent(){var e=this.storage.get(this.storageKey);return"1"===e?Na.GRANTED:"0"===e?Na.DENIED:Na.PENDING}get storage(){if(!this._storage){var e=this.config.opt_out_capturing_persistence_type;this._storage="localStorage"===e?lt:st;var t="localStorage"===e?st:lt;t.get(this.storageKey)&&(this._storage.get(this.storageKey)||this.optInOut("1"===t.get(this.storageKey)),t.remove(this.storageKey,this.config.cross_subdomain_cookie))}return this._storage}getDnt(){return!!this.config.respect_dnt&&!!oe([null==l?void 0:l.doNotTrack,null==l?void 0:l.msDoNotTrack,m.doNotTrack],(e=>_([!0,1,"1","yes"],e)))}}var Fa=V("[ExceptionAutocapture]");class Ba{constructor(e){var t;K(this,"originalOnUnhandledRejectionHandler",void 0),K(this,"startCapturing",(()=>{var e,t,n,i;if(r&&this.isEnabled&&!this.hasHandlers&&!this.isCapturing){var a=null===(e=m.__PosthogExtensions__)||void 0===e||null===(t=e.errorWrappingFunctions)||void 0===t?void 0:t.wrapOnError,o=null===(n=m.__PosthogExtensions__)||void 0===n||null===(i=n.errorWrappingFunctions)||void 0===i?void 0:i.wrapUnhandledRejection;if(a&&o)try{this.unwrapOnError=a(this.captureException.bind(this)),this.unwrapUnhandledRejection=o(this.captureException.bind(this))}catch(e){Fa.error("failed to start",e),this.stopCapturing()}else Fa.error("failed to load error wrapping functions - cannot start")}})),this.instance=e,this.remoteEnabled=!(null===(t=this.instance.persistence)||void 0===t||!t.props[fe]),this.startIfEnabled()}get isEnabled(){var e;return null!==(e=this.remoteEnabled)&&void 0!==e&&e}get isCapturing(){var e;return!(null==r||null===(e=r.onerror)||void 0===e||!e.__POSTHOG_INSTRUMENTED__)}get hasHandlers(){return this.originalOnUnhandledRejectionHandler||this.unwrapOnError}startIfEnabled(){this.isEnabled&&!this.isCapturing&&(Fa.info("enabled, starting..."),this.loadScript(this.startCapturing))}loadScript(e){var t,n;this.hasHandlers&&e(),null===(t=m.__PosthogExtensions__)||void 0===t||null===(n=t.loadExternalDependency)||void 0===n||n.call(t,this.instance,"exception-autocapture",(t=>{if(t)return Fa.error("failed to load script",t);e()}))}stopCapturing(){var e,t;null===(e=this.unwrapOnError)||void 0===e||e.call(this),null===(t=this.unwrapUnhandledRejection)||void 0===t||t.call(this)}onRemoteConfig(e){var t=e.autocaptureExceptions;this.remoteEnabled=!!t||!1,this.instance.persistence&&this.instance.persistence.register({[fe]:this.remoteEnabled}),this.startIfEnabled()}captureException(e){var t=this.instance.requestRouter.endpointFor("ui");e.$exception_personURL="".concat(t,"/project/").concat(this.instance.config.token,"/person/").concat(this.instance.get_distinct_id()),this.instance.exceptions.sendExceptionEvent(e)}}var Ha=V("[Web Vitals]"),Va=9e5;class qa{constructor(e){var t;K(this,"_enabledServerSide",!1),K(this,"_initialized",!1),K(this,"buffer",{url:void 0,metrics:[],firstMetricTimestamp:void 0}),K(this,"_flushToCapture",(()=>{clearTimeout(this._delayedFlushTimer),0!==this.buffer.metrics.length&&(this.instance.capture("$web_vitals",this.buffer.metrics.reduce(((e,t)=>$($({},e),{},{["$web_vitals_".concat(t.name,"_event")]:$({},t),["$web_vitals_".concat(t.name,"_value")]:t.value})),{})),this.buffer={url:void 0,metrics:[],firstMetricTimestamp:void 0})})),K(this,"_addToBuffer",(e=>{var t,n=null===(t=this.instance.sessionManager)||void 0===t?void 0:t.checkAndGetSessionAndWindowId(!0);if(R(n))Ha.error("Could not read session ID. Dropping metrics!");else{this.buffer=this.buffer||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var i=this._currentURL();R(i)||(O(null==e?void 0:e.name)||O(null==e?void 0:e.value)?Ha.error("Invalid metric received",e):this._maxAllowedValue&&e.value>=this._maxAllowedValue?Ha.error("Ignoring metric with value >= "+this._maxAllowedValue,e):(this.buffer.url!==i&&(this._flushToCapture(),this._delayedFlushTimer=setTimeout(this._flushToCapture,this.flushToCaptureTimeoutMs)),R(this.buffer.url)&&(this.buffer.url=i),this.buffer.firstMetricTimestamp=R(this.buffer.firstMetricTimestamp)?Date.now():this.buffer.firstMetricTimestamp,e.attribution&&e.attribution.interactionTargetElement&&(e.attribution.interactionTargetElement=void 0),this.buffer.metrics.push($($({},e),{},{$current_url:i,$session_id:n.sessionId,$window_id:n.windowId,timestamp:Date.now()})),this.buffer.metrics.length===this.allowedMetrics.length&&this._flushToCapture()))}})),K(this,"_startCapturing",(()=>{var e,t,n,i,r=m.__PosthogExtensions__;R(r)||R(r.postHogWebVitalsCallbacks)||({onLCP:e,onCLS:t,onFCP:n,onINP:i}=r.postHogWebVitalsCallbacks),e&&t&&n&&i?(this.allowedMetrics.indexOf("LCP")>-1&&e(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&t(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&n(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&i(this._addToBuffer.bind(this)),this._initialized=!0):Ha.error("web vitals callbacks not loaded - not starting")})),this.instance=e,this._enabledServerSide=!(null===(t=this.instance.persistence)||void 0===t||!t.props[pe]),this.startIfEnabled()}get allowedMetrics(){var e,t,n=M(this.instance.config.capture_performance)?null===(e=this.instance.config.capture_performance)||void 0===e?void 0:e.web_vitals_allowed_metrics:void 0;return R(n)?(null===(t=this.instance.persistence)||void 0===t?void 0:t.props[me])||["CLS","FCP","INP","LCP"]:n}get flushToCaptureTimeoutMs(){return(M(this.instance.config.capture_performance)?this.instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get _maxAllowedValue(){var e=M(this.instance.config.capture_performance)&&j(this.instance.config.capture_performance.__web_vitals_max_value)?this.instance.config.capture_performance.__web_vitals_max_value:Va;return 0<e&&e<=6e4?Va:e}get isEnabled(){var e=M(this.instance.config.capture_performance)?this.instance.config.capture_performance.web_vitals:void 0;return U(e)?e:this._enabledServerSide}startIfEnabled(){this.isEnabled&&!this._initialized&&(Ha.info("enabled, starting..."),this.loadScript(this._startCapturing))}onRemoteConfig(e){var t=M(e.capturePerformance)&&!!e.capturePerformance.web_vitals,n=M(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this.instance.persistence&&(this.instance.persistence.register({[pe]:t}),this.instance.persistence.register({[me]:n})),this._enabledServerSide=t,this.startIfEnabled()}loadScript(e){var t,n,i;null!==(t=m.__PosthogExtensions__)&&void 0!==t&&t.postHogWebVitalsCallbacks&&e(),null===(n=m.__PosthogExtensions__)||void 0===n||null===(i=n.loadExternalDependency)||void 0===i||i.call(n,this.instance,"web-vitals",(t=>{t?Ha.error("failed to load script",t):e()}))}_currentURL(){var e=r?r.location.href:void 0;return e||Ha.error("Could not determine current URL"),e}}var Ga={icontains:(e,t)=>!!r&&t.href.toLowerCase().indexOf(e.toLowerCase())>-1,not_icontains:(e,t)=>!!r&&-1===t.href.toLowerCase().indexOf(e.toLowerCase()),regex:(e,t)=>!!r&&yt(t.href,e),not_regex:(e,t)=>!!r&&!yt(t.href,e),exact:(e,t)=>t.href===e,is_not:(e,t)=>t.href!==e};class za{constructor(e){var t=this;K(this,"getWebExperimentsAndEvaluateDisplayLogic",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.getWebExperiments((e=>{za.logInfo("retrieved web experiments from the server"),t._flagToExperiments=new Map,e.forEach((e=>{if(e.feature_flag_key){var n;t._flagToExperiments&&(za.logInfo("setting flag key ",e.feature_flag_key," to web experiment ",e),null===(n=t._flagToExperiments)||void 0===n||n.set(e.feature_flag_key,e));var i=t.instance.getFeatureFlag(e.feature_flag_key);D(i)&&e.variants[i]&&t.applyTransforms(e.name,i,e.variants[i].transforms)}else if(e.variants)for(var r in e.variants){var a=e.variants[r];za.matchesTestVariant(a)&&t.applyTransforms(e.name,r,a.transforms)}}))}),e)})),this.instance=e,this.instance.onFeatureFlags((e=>{this.onFeatureFlags(e)}))}onFeatureFlags(e){if(this._is_bot())za.logInfo("Refusing to render web experiment since the viewer is a likely bot");else if(!this.instance.config.disable_web_experiments){if(O(this._flagToExperiments))return this._flagToExperiments=new Map,this.loadIfEnabled(),void this.previewWebExperiment();za.logInfo("applying feature flags",e),e.forEach((e=>{var t;if(this._flagToExperiments&&null!==(t=this._flagToExperiments)&&void 0!==t&&t.has(e)){var n,i=this.instance.getFeatureFlag(e),r=null===(n=this._flagToExperiments)||void 0===n?void 0:n.get(e);i&&null!=r&&r.variants[i]&&this.applyTransforms(r.name,i,r.variants[i].transforms)}}))}}previewWebExperiment(){var e=za.getWindowLocation();if(null!=e&&e.search){var t=bt(null==e?void 0:e.search,"__experiment_id"),n=bt(null==e?void 0:e.search,"__experiment_variant");t&&n&&(za.logInfo("previewing web experiments ".concat(t," && ").concat(n)),this.getWebExperiments((e=>{this.showPreviewWebExperiment(parseInt(t),n,e)}),!1,!0))}}loadIfEnabled(){this.instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,n){if(this.instance.config.disable_web_experiments&&!n)return e([]);var i=this.instance.get_property("$web_experiments");if(i&&!t)return e(i);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/web_experiments/?token=".concat(this.instance.config.token)),method:"GET",callback:t=>{if(200!==t.statusCode||!t.json)return e([]);var n=t.json.experiments||[];return e(n)}})}showPreviewWebExperiment(e,t,n){var i=n.filter((t=>t.id===e));i&&i.length>0&&(za.logInfo("Previewing web experiment [".concat(i[0].name,"] with variant [").concat(t,"]")),this.applyTransforms(i[0].name,t,i[0].variants[t].transforms))}static matchesTestVariant(e){return!O(e.conditions)&&za.matchUrlConditions(e)&&za.matchUTMConditions(e)}static matchUrlConditions(e){var t;if(O(e.conditions)||O(null===(t=e.conditions)||void 0===t?void 0:t.url))return!0;var n,i,r,a=za.getWindowLocation();return!!a&&(null===(n=e.conditions)||void 0===n||!n.url||Ga[null!==(i=null===(r=e.conditions)||void 0===r?void 0:r.urlMatchType)&&void 0!==i?i:"icontains"](e.conditions.url,a))}static getWindowLocation(){return null==r?void 0:r.location}static matchUTMConditions(e){var t;if(O(e.conditions)||O(null===(t=e.conditions)||void 0===t?void 0:t.utm))return!0;var n=_n.campaignParams();if(n.utm_source){var i,r,a,o,s,u,l,c,d,h,f,p,g,m,v,y,b=null===(i=e.conditions)||void 0===i||null===(r=i.utm)||void 0===r||!r.utm_campaign||(null===(a=e.conditions)||void 0===a||null===(o=a.utm)||void 0===o?void 0:o.utm_campaign)==n.utm_campaign,w=null===(s=e.conditions)||void 0===s||null===(u=s.utm)||void 0===u||!u.utm_source||(null===(l=e.conditions)||void 0===l||null===(c=l.utm)||void 0===c?void 0:c.utm_source)==n.utm_source,_=null===(d=e.conditions)||void 0===d||null===(h=d.utm)||void 0===h||!h.utm_medium||(null===(f=e.conditions)||void 0===f||null===(p=f.utm)||void 0===p?void 0:p.utm_medium)==n.utm_medium,S=null===(g=e.conditions)||void 0===g||null===(m=g.utm)||void 0===m||!m.utm_term||(null===(v=e.conditions)||void 0===v||null===(y=v.utm)||void 0===y?void 0:y.utm_term)==n.utm_term;return b&&_&&S&&w}return!1}static logInfo(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];H.info("[WebExperiments] ".concat(e),n)}applyTransforms(e,t,n){this._is_bot()?za.logInfo("Refusing to render web experiment since the viewer is a likely bot"):"control"!==t?n.forEach((n=>{if(n.selector){var i;za.logInfo("applying transform of variant ".concat(t," for experiment ").concat(e," "),n);var r=null===(i=document)||void 0===i?void 0:i.querySelectorAll(n.selector);null==r||r.forEach((e=>{var t=e;n.attributes&&n.attributes.forEach((e=>{switch(e.name){case"text":t.innerText=e.value;break;case"html":t.innerHTML=e.value;break;case"cssClass":t.className=e.value;break;default:t.setAttribute(e.name,e.value)}})),n.text&&(t.innerText=n.text),n.html&&(t.parentElement?t.parentElement.innerHTML=n.html:t.innerHTML=n.html),n.css&&t.setAttribute("style",n.css)}))}})):za.logInfo("Control variants leave the page unmodified.")}_is_bot(){return l&&this.instance?wa(l,this.instance.config.custom_blocked_useragents):void 0}}class $a{constructor(e){this.instance=e}sendExceptionEvent(e){this.instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}}var Ka=["$set_once","$set"],Wa=V("[SiteApps]");class Xa{constructor(e){this.instance=e,this.bufferedInvocations=[],this.apps={}}get isEnabled(){return!!this.instance.config.opt_in_site_apps}eventCollector(e,t){if(t){var n=this.globalsForEvent(t);this.bufferedInvocations.push(n),this.bufferedInvocations.length>1e3&&(this.bufferedInvocations=this.bufferedInvocations.slice(10))}}get siteAppLoaders(){var e,t;return null===(e=m._POSTHOG_REMOTE_CONFIG)||void 0===e||null===(t=e[this.instance.config.token])||void 0===t?void 0:t.siteApps}init(){if(this.isEnabled){var e=this.instance._addCaptureHook(this.eventCollector.bind(this));this.stopBuffering=()=>{e(),this.bufferedInvocations=[],this.stopBuffering=void 0}}}globalsForEvent(e){var t,n,i,r,a,o,s;if(!e)throw new Error("Event payload is required");var u={},l=this.instance.get_property("$groups")||[],c=this.instance.get_property("$stored_group_properties")||{};for(var[d,h]of Object.entries(c))u[d]={id:l[d],type:d,properties:h};var{$set_once:f,$set:p}=e;return{event:$($({},W(e,Ka)),{},{properties:$($($({},e.properties),p?{$set:$($({},null!==(t=null===(n=e.properties)||void 0===n?void 0:n.$set)&&void 0!==t?t:{}),p)}:{}),f?{$set_once:$($({},null!==(i=null===(r=e.properties)||void 0===r?void 0:r.$set_once)&&void 0!==i?i:{}),f)}:{}),elements_chain:null!==(a=null===(o=e.properties)||void 0===o?void 0:o.$elements_chain)&&void 0!==a?a:"",distinct_id:null===(s=e.properties)||void 0===s?void 0:s.distinct_id}),person:{properties:this.instance.get_property("$stored_person_properties")},groups:u}}setupSiteApp(e){var t={id:e.id,loaded:!1,errored:!1};this.apps[e.id]=t;var n=n=>{var i;for(var r of(this.apps[e.id].errored=!n,this.apps[e.id].loaded=!0,Wa.info("Site app with id ".concat(e.id," ").concat(n?"loaded":"errored")),n&&this.bufferedInvocations.length&&(Wa.info("Processing ".concat(this.bufferedInvocations.length," events for site app with id ").concat(e.id)),this.bufferedInvocations.forEach((e=>{var n;return null===(n=t.processEvent)||void 0===n?void 0:n.call(t,e)}))),Object.values(this.apps)))if(!r.loaded)return;null===(i=this.stopBuffering)||void 0===i||i.call(this)};try{var{processEvent:i}=e.init({posthog:this.instance,callback:e=>{n(e)}});i&&(t.processEvent=i)}catch(t){Wa.error("Error while initializing PostHog app with config id ".concat(e.id),t),n(!1)}}onCapturedEvent(e){if(0!==Object.keys(this.apps).length){var t=this.globalsForEvent(e);for(var n of Object.values(this.apps))try{var i;null===(i=n.processEvent)||void 0===i||i.call(n,t)}catch(t){Wa.error("Error while processing event ".concat(e.event," for site app ").concat(n.id),t)}}}onRemoteConfig(e){var t,n,i,r=this;if(null!==(t=this.siteAppLoaders)&&void 0!==t&&t.length){if(!this.isEnabled)return void Wa.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');for(var a of this.siteAppLoaders)this.setupSiteApp(a);this.instance.on("eventCaptured",(e=>this.onCapturedEvent(e)))}else if(null===(n=this.stopBuffering)||void 0===n||n.call(this),null!==(i=e.siteApps)&&void 0!==i&&i.length)if(this.isEnabled){var o=function(e,t){var n,i;m["__$$ph_site_app_".concat(e)]=r.instance,null===(n=m.__PosthogExtensions__)||void 0===n||null===(i=n.loadSiteApp)||void 0===i||i.call(n,r.instance,t,(t=>{if(t)return Wa.error("Error while initializing PostHog app with config id ".concat(e),t)}))};for(var{id:s,url:u}of e.siteApps)o(s,u)}else Wa.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}function Ya(e,t,n){return cr({distinct_id:e,userPropertiesToSet:t,userPropertiesToSetOnce:n})}var Ja={},Qa=()=>{},Za="posthog",eo=!sr&&-1===(null==g?void 0:g.indexOf("MSIE"))&&-1===(null==g?void 0:g.indexOf("Mozilla")),to=()=>{var e;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:ae(null==c?void 0:c.location),persistence:"localStorage+cookie",persistence_name:"",loaded:Qa,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:!0,capture_pageleave:"if_capture_pageview",debug:d&&D(null==d?void 0:d.search)&&-1!==d.search.indexOf("__posthog_debug=true")||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:"https:"===(null==r||null===(e=r.location)||void 0===e?void 0:e.protocol),ip:!0,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,on_request_error:e=>{var t="Bad HTTP status: "+e.statusCode+" "+e.text;H.error(t)},get_device_id:e=>e,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,_onCapture:Qa}},no=e=>{var t={};R(e.process_person)||(t.person_profiles=e.process_person),R(e.xhr_headers)||(t.request_headers=e.xhr_headers),R(e.cookie_name)||(t.persistence_name=e.cookie_name),R(e.disable_cookie)||(t.disable_persistence=e.disable_cookie),R(e.store_google)||(t.save_campaign_params=e.store_google),R(e.verbose)||(t.debug=e.verbose);var n=Q({},t,e);return I(e.property_blacklist)&&(R(e.property_denylist)?n.property_denylist=e.property_blacklist:I(e.property_denylist)?n.property_denylist=[...e.property_blacklist,...e.property_denylist]:H.error("Invalid value for property_denylist config: "+e.property_denylist)),n};class io{constructor(){K(this,"__forceAllowLocalhost",!1)}get _forceAllowLocalhost(){return this.__forceAllowLocalhost}set _forceAllowLocalhost(e){H.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class ro{get decideEndpointWasHit(){var e,t;return null!==(e=null===(t=this.featureFlags)||void 0===t?void 0:t.hasLoadedFlags)&&void 0!==e&&e}constructor(){K(this,"webPerformance",new io),K(this,"version",v.LIB_VERSION),K(this,"_internalEventEmitter",new sa),this.config=to(),this.SentryIntegration=Sr,this.sentryIntegration=e=>function(e,t){var n=_r(e,t);return{name:wr,processEvent:e=>n(e)}}(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this._initialPageviewCaptured=!1,this._initialPersonProfilesConfig=null,this._cachedIdentify=null,this.featureFlags=new Ye(this),this.toolbar=new ar(this),this.scrollManager=new Ca(this),this.pageViewManager=new xr(this),this.surveys=new fa(this),this.experiments=new za(this),this.exceptions=new $a(this),this.rateLimiter=new ga(this),this.requestRouter=new br(this),this.consent=new Ua(this),this.people={set:(e,t,n)=>{var i=D(e)?{[e]:t}:e;this.setPersonProperties(i),null==n||n({})},set_once:(e,t,n)=>{var i=D(e)?{[e]:t}:e;this.setPersonProperties(void 0,i),null==n||n({})}},this.on("eventCaptured",(e=>H.info('send "'.concat(null==e?void 0:e.event,'"'),e)))}init(e,t,n){if(n&&n!==Za){var i,r=null!==(i=Ja[n])&&void 0!==i?i:new ro;return r._init(e,t,n),Ja[n]=r,Ja[Za][n]=r,r}return this._init(e,t,n)}_init(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;if(R(e)||L(e))return H.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return H.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},this._triggered_notifs=[],a.person_profiles&&(this._initialPersonProfilesConfig=a.person_profiles),this.set_config(Q({},to(),no(a),{name:o,token:e})),this.config.on_xhr_error&&H.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=a.disable_compression?void 0:i.GZipJS,this.persistence=new Tn(this.config),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new Tn($($({},this.config),{},{persistence:"sessionStorage"}));var s=$({},this.persistence.props),u=$({},this.sessionPersistence.props);if(this._requestQueue=new or((e=>this._send_retriable_request(e))),this._retryQueue=new pr(this),this.__request_queue=[],this.config.__preview_experimental_cookieless_mode||(this.sessionManager=new vr(this),this.sessionPropsManager=new va(this,this.sessionManager,this.persistence)),new ja(this).startIfEnabledOrStop(),this.siteApps=new Xa(this),null===(t=this.siteApps)||void 0===t||t.init(),this.config.__preview_experimental_cookieless_mode||(this.sessionRecording=new Qi(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new La(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new Ia(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new qa(this),this.exceptionObserver=new Ba(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new ka(this,xa),this.deadClicksAutocapture.startIfEnabled(),v.DEBUG=v.DEBUG||this.config.debug,v.DEBUG&&H.info("Starting in debug mode",{this:this,config:a,thisC:$({},this.config),p:s,s:u}),this._sync_opt_out_with_persistence(),void 0!==(null===(n=a.bootstrap)||void 0===n?void 0:n.distinctID)){var l,c,d=this.config.get_device_id(it()),h=null!==(l=a.bootstrap)&&void 0!==l&&l.isIdentifiedID?d:a.bootstrap.distinctID;this.persistence.set_property(Ne,null!==(c=a.bootstrap)&&void 0!==c&&c.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:a.bootstrap.distinctID,$device_id:h})}if(this._hasBootstrappedFeatureFlags()){var f,p,g=Object.keys((null===(f=a.bootstrap)||void 0===f?void 0:f.featureFlags)||{}).filter((e=>{var t,n;return!(null===(t=a.bootstrap)||void 0===t||null===(n=t.featureFlags)||void 0===n||!n[e])})).reduce(((e,t)=>{var n,i;return e[t]=(null===(n=a.bootstrap)||void 0===n||null===(i=n.featureFlags)||void 0===i?void 0:i[t])||!1,e}),{}),m=Object.keys((null===(p=a.bootstrap)||void 0===p?void 0:p.featureFlagPayloads)||{}).filter((e=>g[e])).reduce(((e,t)=>{var n,i,r,o;return null!==(n=a.bootstrap)&&void 0!==n&&null!==(i=n.featureFlagPayloads)&&void 0!==i&&i[t]&&(e[t]=null===(r=a.bootstrap)||void 0===r||null===(o=r.featureFlagPayloads)||void 0===o?void 0:o[t]),e}),{});this.featureFlags.receivedFeatureFlags({featureFlags:g,featureFlagPayloads:m})}if(this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:qe,$device_id:null},"");else if(!this.get_distinct_id()){var y=this.config.get_device_id(it());this.register_once({distinct_id:y,$device_id:y},""),this.persistence.set_property(Ne,"anonymous")}return se(r,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),a.segment?function(e,t){var n=e.config.segment;if(!n)return t();!function(e,t){var n=e.config.segment;if(!n)return t();var i=n=>{var i=()=>n.anonymousId()||it();e.config.get_device_id=i,n.id()&&(e.register({distinct_id:n.id(),$device_id:i()}),e.persistence.set_property(Ne,"identified")),t()},r=n.user();"then"in r&&C(r.then)?r.then((e=>i(e))):i(r)}(e,(()=>{n.register((e=>{Promise&&Promise.resolve||Tr.warn("This browser does not have Promise support, and can not use the segment integration");var t=(t,n)=>{var i;if(!n)return t;t.event.userId||t.event.anonymousId===e.get_distinct_id()||(Tr.info("No userId set, resetting PostHog"),e.reset()),t.event.userId&&t.event.userId!==e.get_distinct_id()&&(Tr.info("UserId set, identifying with PostHog"),e.identify(t.event.userId));var r=e._calculate_event_properties(n,null!==(i=t.event.properties)&&void 0!==i?i:{},new Date);return t.event.properties=Object.assign({},r,t.event.properties),t};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:e=>t(e,e.event.event),page:e=>t(e,"$pageview"),identify:e=>t(e,"$identify"),screen:e=>t(e,"$screen")}})(e)).then((()=>{t()}))}))}(this,(()=>this._loaded())):this._loaded(),C(this.config._onCapture)&&this.config._onCapture!==Qa&&(H.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",(e=>this.config._onCapture(e.event,e)))),this}_onRemoteConfig(e){var t,n,r,a,o,s,u,l;if(!c||!c.body)return H.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((()=>{this._onRemoteConfig(e)}),500);this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=_(e.supportedCompression,i.GZipJS)?i.GZipJS:_(e.supportedCompression,i.Base64)?i.Base64:void 0),null!==(t=e.analytics)&&void 0!==t&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this._initialPersonProfilesConfig?this._initialPersonProfilesConfig:"identified_only"}),null===(n=this.siteApps)||void 0===n||n.onRemoteConfig(e),null===(r=this.sessionRecording)||void 0===r||r.onRemoteConfig(e),null===(a=this.autocapture)||void 0===a||a.onRemoteConfig(e),null===(o=this.heatmaps)||void 0===o||o.onRemoteConfig(e),this.surveys.onRemoteConfig(e),null===(s=this.webVitalsAutocapture)||void 0===s||s.onRemoteConfig(e),null===(u=this.exceptionObserver)||void 0===u||u.onRemoteConfig(e),null===(l=this.deadClicksAutocapture)||void 0===l||l.onRemoteConfig(e)}_loaded(){try{this.config.loaded(this)}catch(e){H.critical("`loaded` function failed",e)}this._start_queue_if_opted_in(),this.config.capture_pageview&&setTimeout((()=>{this.consent.isOptedIn()&&this._captureInitialPageview()}),1),new er(this).load(),this.featureFlags.decide()}_start_queue_if_opted_in(){var e;this.has_opted_out_capturing()||this.config.request_batching&&(null===(e=this._requestQueue)||void 0===e||e.enable())}_dom_loaded(){this.has_opted_out_capturing()||Y(this.__request_queue,(e=>this._send_retriable_request(e))),this.__request_queue=[],this._start_queue_if_opted_in()}_handle_unload(){var e,t;this.config.request_batching?(this._shouldCapturePageleave()&&this.capture("$pageleave"),null===(e=this._requestQueue)||void 0===e||e.unload(),null===(t=this._retryQueue)||void 0===t||t.unload()):this._shouldCapturePageleave()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(e){this.__loaded&&(eo?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=lr(e.url,{ip:this.config.ip?1:0}),e.headers=$({},this.config.request_headers),e.compression="best-available"===e.compression?this.compression:e.compression,e.fetchOptions=e.fetchOptions||this.config.fetch_options,(e=>{var t,n,i,r=$({},e);r.timeout=r.timeout||6e4,r.url=lr(r.url,{_:(new Date).getTime().toString(),ver:v.LIB_VERSION,compression:r.compression});var a=null!==(t=r.transport)&&void 0!==t?t:"fetch",o=null!==(n=null===(i=oe(hr,(e=>e.transport===a)))||void 0===i?void 0:i.method)&&void 0!==n?n:hr[0].method;if(!o)throw new Error("No available transport method");o(r)})($($({},e),{},{callback:t=>{var n,i,r;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&(null===(i=(r=this.config).on_request_error)||void 0===i||i.call(r,t)),null===(n=e.callback)||void 0===n||n.call(e,t)}}))))}_send_retriable_request(e){this._retryQueue?this._retryQueue.retriableRequest(e):this._send_request(e)}_execute_array(e){var t,n=[],i=[],r=[];Y(e,(e=>{e&&(t=e[0],I(t)?r.push(e):C(e)?e.call(this):I(e)&&"alias"===t?n.push(e):I(e)&&-1!==t.indexOf("capture")&&C(this[t])?r.push(e):i.push(e))}));var a=function(e,t){Y(e,(function(e){if(I(e[0])){var n=t;J(e,(function(e){n=n[e[0]].apply(n,e.slice(1))}))}else this[e[0]].apply(this,e.slice(1))}),t)};a(n,this),a(i,this),a(r,this)}_hasBootstrappedFeatureFlags(){var e,t;return(null===(e=this.config.bootstrap)||void 0===e?void 0:e.featureFlags)&&Object.keys(null===(t=this.config.bootstrap)||void 0===t?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,n){var i;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this._requestQueue){if(!this.consent.isOptedOut())if(!R(e)&&D(e)){if(this.config.opt_out_useragent_filter||!this._is_bot()){var r=null!=n&&n.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(null==r||!r.isRateLimited){this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var a=new Date,o=(null==n?void 0:n.timestamp)||a,s=it(),u={uuid:s,event:e,properties:this._calculate_event_properties(e,t||{},o,s)};r&&(u.properties.$lib_rate_limit_remaining_tokens=r.remainingTokens),(null==n?void 0:n.$set)&&(u.$set=null==n?void 0:n.$set);var l=this._calculate_set_once_properties(null==n?void 0:n.$set_once);l&&(u.$set_once=l),(u=function(e,t){return n=e,i=e=>D(e)&&!N(t)?e.slice(0,t):e,r=new Set,function e(t,n){return t!==Object(t)?i?i(t):t:r.has(t)?void 0:(r.add(t),I(t)?(a=[],Y(t,(t=>{a.push(e(t))}))):(a={},J(t,((t,n)=>{r.has(t)||(a[n]=e(t,n))}))),a);var a}(n);var n,i,r}(u,null!=n&&n._noTruncate?null:this.config.properties_string_max_length)).timestamp=o,R(null==n?void 0:n.timestamp)||(u.properties.$event_time_override_provided=!0,u.properties.$event_time_override_system_time=a);var c=$($({},u.properties.$set),u.$set);if(P(c)||this.setPersonPropertiesForFlags(c),!O(this.config.before_send)){var d=this._runBeforeSend(u);if(!d)return;u=d}this._internalEventEmitter.emit("eventCaptured",u);var h={method:"POST",url:null!==(i=null==n?void 0:n._url)&&void 0!==i?i:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:u,compression:"best-available",batchKey:null==n?void 0:n._batchKey};return!this.config.request_batching||n&&(null==n||!n._batchKey)||null!=n&&n.send_instantly?this._send_retriable_request(h):this._requestQueue.enqueue(h),u}H.critical("This capture call is ignored due to client rate limiting.")}}else H.error("No event name provided to posthog.capture")}else H.uninitializedWarning("posthog.capture")}_addCaptureHook(e){return this.on("eventCaptured",(t=>e(t.event,t)))}_calculate_event_properties(e,t,n,i){if(n=n||new Date,!this.persistence||!this.sessionPersistence)return t;var r=this.persistence.remove_event_timer(e),a=$({},t);if(a.token=this.config.token,this.config.__preview_experimental_cookieless_mode&&(a.$cookieless_mode=!0),"$snapshot"===e){var o=$($({},this.persistence.properties()),this.sessionPersistence.properties());return a.distinct_id=o.distinct_id,(!D(a.distinct_id)&&!j(a.distinct_id)||L(a.distinct_id))&&H.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),a}var s,u=_n.properties({maskPersonalDataProperties:this.config.mask_personal_data_properties,customPersonalDataProperties:this.config.custom_personal_data_properties});if(this.sessionManager){var{sessionId:l,windowId:d}=this.sessionManager.checkAndGetSessionAndWindowId();a.$session_id=l,a.$window_id=d}if(this.sessionRecording&&(a.$recording_status=this.sessionRecording.status),this.requestRouter.region===gr.CUSTOM&&(a.$lib_custom_api_host=this.config.api_host),s="$pageview"===e?this.pageViewManager.doPageView(n,i):"$pageleave"===e?this.pageViewManager.doPageLeave(n):this.pageViewManager.doEvent(),a=Q(a,s),"$pageview"===e&&c&&(a.title=c.title),!R(r)){var h=n.getTime()-r;a.$duration=parseFloat((h/1e3).toFixed(3))}g&&this.config.opt_out_useragent_filter&&(a.$browser_type=this._is_bot()?"bot":"browser"),(a=Q({},u,this.persistence.properties(),this.sessionPersistence.properties(),a)).$is_identified=this._isIdentified(),I(this.config.property_denylist)?J(this.config.property_denylist,(function(e){delete a[e]})):H.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var f=this.config.sanitize_properties;f&&(H.error("sanitize_properties is deprecated. Use before_send instead"),a=f(a,e));var p=this._hasPersonProcessing();return a.$process_person_profile=p,p&&this._requirePersonProcessing("_calculate_event_properties"),a}_calculate_set_once_properties(e){if(!this.persistence||!this._hasPersonProcessing())return e;var t=Q({},this.persistence.get_initial_props(),e||{}),n=this.config.sanitize_properties;return n&&(H.error("sanitize_properties is deprecated. Use before_send instead"),t=n(t,"$set_once")),P(t)?void 0:t}register(e,t){var n;null===(n=this.persistence)||void 0===n||n.register(e,t)}register_once(e,t,n){var i;null===(i=this.persistence)||void 0===i||i.register_once(e,t,n)}register_for_session(e){var t;null===(t=this.sessionPersistence)||void 0===t||t.register(e)}unregister(e){var t;null===(t=this.persistence)||void 0===t||t.unregister(e)}unregister_for_session(e){var t;null===(t=this.sessionPersistence)||void 0===t||t.unregister(e)}_register_single(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){var t=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(t)}catch(e){return t}}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(e,t){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t)}getEarlyAccessFeatures(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.featureFlags.getEarlyAccessFeatures(e,t)}on(e,t){return this._internalEventEmitter.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSessionId(e){var t,n;return null!==(t=null===(n=this.sessionManager)||void 0===n?void 0:n.onSessionId(e))&&void 0!==t?t:()=>{}}getSurveys(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}canRenderSurvey(e){this.surveys.canRenderSurvey(e)}getNextSurveyStep(e,t,n){return this.surveys.getNextSurveyStep(e,t,n)}identify(e,t,n){if(!this.__loaded||!this.persistence)return H.uninitializedWarning("posthog.identify");if(j(e)&&(e=e.toString(),H.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e){if(["distinct_id","distinctid"].includes(e.toLowerCase()))H.critical('The string "'.concat(e,'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.'));else if(this._requirePersonProcessing("posthog.identify")){var i=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var r=i;this.register_once({$had_persisted_distinct_id:!0,$device_id:r},"")}e!==i&&e!==this.get_property(le)&&(this.unregister(le),this.register({distinct_id:e}));var a="anonymous"===(this.persistence.get_property(Ne)||"anonymous");e!==i&&a?(this.persistence.set_property(Ne,"identified"),this.setPersonPropertiesForFlags(t||{},!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:i},{$set:t||{},$set_once:n||{}}),this.featureFlags.setAnonymousDistinctId(i),this._cachedIdentify=Ya(e,t,n)):(t||n)&&(this._cachedIdentify!==Ya(e,t,n)?(this.setPersonProperties(t,n),this._cachedIdentify=Ya(e,t,n)):H.info("A duplicate posthog.identify call was made with the same properties. It has been ignored.")),e!==i&&(this.reloadFeatureFlags(),this.unregister(Le))}}else H.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){(e||t)&&this._requirePersonProcessing("posthog.setPersonProperties")&&(this.setPersonPropertiesForFlags(e||{}),this.capture("$set",{$set:e||{},$set_once:t||{}}))}group(e,t,n){if(e&&t){if(this._requirePersonProcessing("posthog.group")){var i=this.getGroups();i[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:$($({},i),{},{[e]:t})}),n&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:n}),this.setGroupPropertiesForFlags({[e]:n})),i[e]===t||n||this.reloadFeatureFlags()}}else H.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._requirePersonProcessing("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,n,i,r;if(H.info("reset"),!this.__loaded)return H.uninitializedWarning("posthog.reset");var a=this.get_property("$device_id");if(this.consent.reset(),null===(t=this.persistence)||void 0===t||t.clear(),null===(n=this.sessionPersistence)||void 0===n||n.clear(),this.surveys.reset(),null===(i=this.persistence)||void 0===i||i.set_property(Ne,"anonymous"),null===(r=this.sessionManager)||void 0===r||r.resetSessionId(),this._cachedIdentify=null,this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:qe,$device_id:null},"");else{var o=this.config.get_device_id(it());this.register_once({distinct_id:o,$device_id:e?o:a},"")}this.register({$last_posthog_reset:(new Date).toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return null!==(e=null===(t=this.sessionManager)||void 0===t?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)&&void 0!==e?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:n}=this.sessionManager.checkAndGetSessionAndWindowId(!0),i=this.requestRouter.endpointFor("ui","/project/".concat(this.config.token,"/replay/").concat(t));if(null!=e&&e.withTimestamp&&n){var r,a=null!==(r=e.timestampLookBack)&&void 0!==r?r:10;if(!n)return i;var o=Math.max(Math.floor(((new Date).getTime()-n)/1e3)-a,0);i+="?t=".concat(o)}return i}alias(e,t){return e===this.get_property(ue)?(H.critical("Attempting to create alias for existing People user - aborting."),-2):this._requirePersonProcessing("posthog.alias")?(R(t)&&(t=this.get_distinct_id()),e!==t?(this._register_single(le,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(H.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t,n,i,r,a=$({},this.config);M(e)&&(Q(this.config,no(e)),null===(t=this.persistence)||void 0===t||t.update_config(this.config,a),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new Tn($($({},this.config),{},{persistence:"sessionStorage"})),lt.is_supported()&&"true"===lt.get("ph_debug")&&(this.config.debug=!0),this.config.debug&&(v.DEBUG=!0,H.info("set_config",{config:e,oldConfig:a,newConfig:$({},this.config)})),null===(n=this.sessionRecording)||void 0===n||n.startIfEnabledOrStop(),null===(i=this.autocapture)||void 0===i||i.startIfEnabled(),null===(r=this.heatmaps)||void 0===r||r.startIfEnabled(),this.surveys.loadIfEnabled(),this._sync_opt_out_with_persistence())}startSessionRecording(e){var t,n,i,r,a,o=!0===e,s={sampling:o||!(null==e||!e.sampling),linked_flag:o||!(null==e||!e.linked_flag),url_trigger:o||!(null==e||!e.url_trigger),event_trigger:o||!(null==e||!e.event_trigger)};Object.values(s).some(Boolean)&&(null===(t=this.sessionManager)||void 0===t||t.checkAndGetSessionAndWindowId(),s.sampling&&(null===(n=this.sessionRecording)||void 0===n||n.overrideSampling()),s.linked_flag&&(null===(i=this.sessionRecording)||void 0===i||i.overrideLinkedFlag()),s.url_trigger&&(null===(r=this.sessionRecording)||void 0===r||r.overrideTrigger("url")),s.event_trigger&&(null===(a=this.sessionRecording)||void 0===a||a.overrideTrigger("event")));this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!(null===(e=this.sessionRecording)||void 0===e||!e.started)}captureException(e,t){var n,i=new Error("PostHog syntheticException"),r=C(null===(n=m.__PosthogExtensions__)||void 0===n?void 0:n.parseErrorAsProperties)?$($({},m.__PosthogExtensions__.parseErrorAsProperties([e.message,void 0,void 0,void 0,e],{syntheticException:i})),t):$({$exception_level:"error",$exception_list:[{type:e.name,value:e.message,mechanism:{handled:!0,synthetic:!1}}]},t);this.exceptions.sendExceptionEvent(r)}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return null===(t=this.persistence)||void 0===t?void 0:t.props[e]}getSessionProperty(e){var t;return null===(t=this.sessionPersistence)||void 0===t?void 0:t.props[e]}toString(){var e,t=null!==(e=this.config.name)&&void 0!==e?e:Za;return t!==Za&&(t=Za+"."+t),t}_isIdentified(){var e,t;return"identified"===(null===(e=this.persistence)||void 0===e?void 0:e.get_property(Ne))||"identified"===(null===(t=this.sessionPersistence)||void 0===t?void 0:t.get_property(Ne))}_hasPersonProcessing(){var e,t,n,i;return!("never"===this.config.person_profiles||"identified_only"===this.config.person_profiles&&!this._isIdentified()&&P(this.getGroups())&&(null===(e=this.persistence)||void 0===e||null===(t=e.props)||void 0===t||!t[le])&&(null===(n=this.persistence)||void 0===n||null===(i=n.props)||void 0===i||!i[He]))}_shouldCapturePageleave(){return!0===this.config.capture_pageleave||"if_capture_pageview"===this.config.capture_pageleave&&this.config.capture_pageview}createPersonProfile(){this._hasPersonProcessing()||this._requirePersonProcessing("posthog.createPersonProfile")&&this.setPersonProperties({},{})}_requirePersonProcessing(e){return"never"===this.config.person_profiles?(H.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this._register_single(He,!0),!0)}_sync_opt_out_with_persistence(){var e,t,n,i,r=this.consent.isOptedOut(),a=this.config.opt_out_persistence_by_default,o=this.config.disable_persistence||r&&!!a;(null===(e=this.persistence)||void 0===e?void 0:e.disabled)!==o&&(null===(n=this.persistence)||void 0===n||n.set_disabled(o)),(null===(t=this.sessionPersistence)||void 0===t?void 0:t.disabled)!==o&&(null===(i=this.sessionPersistence)||void 0===i||i.set_disabled(o))}opt_in_capturing(e){var t;this.consent.optInOut(!0),this._sync_opt_out_with_persistence(),(R(null==e?void 0:e.captureEventName)||null!=e&&e.captureEventName)&&this.capture(null!==(t=null==e?void 0:e.captureEventName)&&void 0!==t?t:"$opt_in",null==e?void 0:e.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this._captureInitialPageview()}opt_out_capturing(){this.consent.optInOut(!1),this._sync_opt_out_with_persistence()}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}clear_opt_in_out_capturing(){this.consent.reset(),this._sync_opt_out_with_persistence()}_is_bot(){return l?wa(l,this.config.custom_blocked_useragents):void 0}_captureInitialPageview(){c&&!this._initialPageviewCaptured&&(this._initialPageviewCaptured=!0,this.capture("$pageview",{title:c.title},{send_instantly:!0}))}debug(e){!1===e?(null==r||r.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(null==r||r.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}_runBeforeSend(e){if(O(this.config.before_send))return e;var t=I(this.config.before_send)?this.config.before_send:[this.config.before_send],n=e;for(var i of t){if(n=i(n),O(n)){var r="Event '".concat(e.event,"' was rejected in beforeSend function");return F(e.event)?H.warn("".concat(r,". This can cause unexpected behavior.")):H.info(r),null}n.properties&&!P(n.properties)||H.warn("Event '".concat(e.event,"' has no properties after beforeSend function, this is likely an error."))}return n}getPageViewId(){var e;return null===(e=this.pageViewManager._currentPageview)||void 0===e?void 0:e.pageViewId}}!function(e,t){for(var n=0;n<t.length;n++)e.prototype[t[n]]=ne(e.prototype[t[n]])}(ro,["identify"]);var ao,oo=(ao=Ja[Za]=new ro,function(){function e(){e.done||(e.done=!0,eo=!1,J(Ja,(function(e){e._dom_loaded()})))}null!=c&&c.addEventListener?"complete"===c.readyState?e():se(c,"DOMContentLoaded",e,{capture:!1}):r&&H.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),ao)},919:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Middle=0]="Middle",e[e.Right=1]="Right",e[e.Left=2]="Left"}(n||(n={}));t.default=class{static initCheckboxes(){document.querySelectorAll("[role=checkbox]").forEach((e=>{var t,i;const r=[...e.querySelectorAll("input")],a=r[0],o=a.parentNode.querySelector("span"),s=()=>(l||(l=parseFloat(getComputedStyle(o).width)),c||(c=l/3),d||(d=2*c)),u=a.go2=t=>{const i=t=>{h=t,r.filter((e=>e.value===t.toString()))[0].checked=!0,e.ariaChecked={[n.Middle]:"mixed",[n.Right]:"true",[n.Left]:"false"}[t]};s()?i(t):setTimeout((()=>s()&&i(t)))};let l,c,d,h=+(null!==(i=null===(t=r.filter((e=>e.checked))[0])||void 0===t?void 0:t.value)&&void 0!==i?i:0);u(h),a.addEventListener("click",(e=>{const t=e.clientX-o.getBoundingClientRect().x;t>=c&&t<=d?u(n.Middle):h===n.Middle?u(t>d?n.Right:n.Left):h===n.Left?u(t<c?n.Middle:n.Right):u(t>d?n.Middle:n.Left)})),e.addEventListener("keydown",(e=>{" "===e.key&&(u(++h%3),e.preventDefault())}))})),document.querySelectorAll("label[tabindex]:has(input[type=checkbox])").forEach((e=>e.addEventListener("keydown",(t=>{" "===t.key&&(e.click(),t.preventDefault())}))))}}},980:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseParam=function(e){const t=RegExp("[?&]"+e+"=([^&]*)").exec(location.search);return t&&decodeURIComponent(t[1])}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,n),a.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(275),n(226),n(208),n(66),n(89);var i=n(919);self.Checkbox=i.default})();